ARM GAS  /tmp/cckIjmWf.s 			page 1


   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 6
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"bluetooth.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.data
  19              		.align	2
  22              	iap_entry:
  23 0000 F11FFF1F 		.word	536813553
  24              		.comm	target,16,8
  25              		.comm	syncword,8,8
  26              		.comm	afh_enabled,1,1
  27              		.comm	afh_map,10,4
  28              		.comm	a1,1,1
  29              		.comm	b,1,1
  30              		.comm	c1,1,1
  31              		.comm	e,1,1
  32              		.comm	d1,2,2
  33              		.comm	bank,79,4
  34              		.comm	afh_bank,79,4
  35              		.comm	used_channels,1,1
  36              		.section	.text.count_bits,"ax",%progbits
  37              		.align	2
  38              		.global	count_bits
  39              		.thumb
  40              		.thumb_func
  42              	count_bits:
  43              	.LFB0:
  44              		.file 1 "bluetooth.c"
   1:bluetooth.c   **** /*
   2:bluetooth.c   ****  * Copyright 2012 Dominic Spill
   3:bluetooth.c   ****  *
   4:bluetooth.c   ****  * This file is part of Project Ubertooth.
   5:bluetooth.c   ****  *
   6:bluetooth.c   ****  * This program is free software; you can redistribute it and/or modify
   7:bluetooth.c   ****  * it under the terms of the GNU General Public License as published by
   8:bluetooth.c   ****  * the Free Software Foundation; either version 2, or (at your option)
   9:bluetooth.c   ****  * any later version.
  10:bluetooth.c   ****  *
  11:bluetooth.c   ****  * This program is distributed in the hope that it will be useful,
  12:bluetooth.c   ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  13:bluetooth.c   ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  14:bluetooth.c   ****  * GNU General Public License for more details.
  15:bluetooth.c   ****  *
  16:bluetooth.c   ****  * You should have received a copy of the GNU General Public License
ARM GAS  /tmp/cckIjmWf.s 			page 2


  17:bluetooth.c   ****  * along with this program; see the file COPYING.  If not, write to
  18:bluetooth.c   ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  19:bluetooth.c   ****  * Boston, MA 02110-1301, USA.
  20:bluetooth.c   ****  */
  21:bluetooth.c   **** 
  22:bluetooth.c   **** #include "bluetooth.h"
  23:bluetooth.c   **** 
  24:bluetooth.c   **** /* these values for hop() can be precalculated (at leastin part) */
  25:bluetooth.c   **** u8 a1, b, c1, e;
  26:bluetooth.c   **** u16 d1;
  27:bluetooth.c   **** /* frequency register bank */
  28:bluetooth.c   **** u8 bank[CHANNELS];
  29:bluetooth.c   **** u8 afh_bank[CHANNELS];
  30:bluetooth.c   **** u8 used_channels;
  31:bluetooth.c   **** 
  32:bluetooth.c   **** /* count the number of 1 bits in a uint64_t */
  33:bluetooth.c   **** uint8_t count_bits(uint64_t n)
  34:bluetooth.c   **** {
  45              		.loc 1 34 0
  46              		.cfi_startproc
  47              		@ args = 0, pretend = 0, frame = 16
  48              		@ frame_needed = 1, uses_anonymous_args = 0
  49              		@ link register save eliminated.
  50 0000 80B4     		push	{r7}
  51              		.cfi_def_cfa_offset 4
  52              		.cfi_offset 7, -4
  53 0002 85B0     		sub	sp, sp, #20
  54              		.cfi_def_cfa_offset 24
  55 0004 00AF     		add	r7, sp, #0
  56              		.cfi_def_cfa_register 7
  57 0006 C7E90001 		strd	r0, [r7]
  35:bluetooth.c   **** 	uint8_t i = 0;
  58              		.loc 1 35 0
  59 000a 0023     		movs	r3, #0
  60 000c FB73     		strb	r3, [r7, #15]
  36:bluetooth.c   **** 	for (i = 0; n != 0; i++)
  61              		.loc 1 36 0
  62 000e 0023     		movs	r3, #0
  63 0010 FB73     		strb	r3, [r7, #15]
  64 0012 10E0     		b	.L2
  65              	.L3:
  37:bluetooth.c   **** 		n &= n - 1;
  66              		.loc 1 37 0 discriminator 3
  67 0014 D7E90023 		ldrd	r2, [r7]
  68 0018 12F1FF32 		adds	r2, r2, #-1
  69 001c 43F1FF33 		adc	r3, r3, #-1
  70 0020 D7E90001 		ldrd	r0, [r7]
  71 0024 02EA0002 		and	r2, r2, r0
  72 0028 03EA0103 		and	r3, r3, r1
  73 002c C7E90023 		strd	r2, [r7]
  36:bluetooth.c   **** 	for (i = 0; n != 0; i++)
  74              		.loc 1 36 0 discriminator 3
  75 0030 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
  76 0032 0133     		adds	r3, r3, #1
  77 0034 FB73     		strb	r3, [r7, #15]
  78              	.L2:
  36:bluetooth.c   **** 	for (i = 0; n != 0; i++)
ARM GAS  /tmp/cckIjmWf.s 			page 3


  79              		.loc 1 36 0 is_stmt 0 discriminator 1
  80 0036 D7E90023 		ldrd	r2, [r7]
  81 003a 1343     		orrs	r3, r2, r3
  82 003c EAD1     		bne	.L3
  38:bluetooth.c   **** 	return i;
  83              		.loc 1 38 0 is_stmt 1
  84 003e FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
  39:bluetooth.c   **** }
  85              		.loc 1 39 0
  86 0040 1846     		mov	r0, r3
  87 0042 1437     		adds	r7, r7, #20
  88              		.cfi_def_cfa_offset 4
  89 0044 BD46     		mov	sp, r7
  90              		.cfi_def_cfa_register 13
  91              		@ sp needed
  92 0046 5DF8047B 		ldr	r7, [sp], #4
  93              		.cfi_restore 7
  94              		.cfi_def_cfa_offset 0
  95 004a 7047     		bx	lr
  96              		.cfi_endproc
  97              	.LFE0:
  99              		.section	.text.precalc,"ax",%progbits
 100              		.align	2
 101              		.global	precalc
 102              		.thumb
 103              		.thumb_func
 105              	precalc:
 106              	.LFB1:
  40:bluetooth.c   **** 
  41:bluetooth.c   **** /* do all of the one time precalculation */
  42:bluetooth.c   **** void precalc(void)
  43:bluetooth.c   **** {
 107              		.loc 1 43 0
 108              		.cfi_startproc
 109              		@ args = 0, pretend = 0, frame = 16
 110              		@ frame_needed = 1, uses_anonymous_args = 0
 111 0000 80B5     		push	{r7, lr}
 112              		.cfi_def_cfa_offset 8
 113              		.cfi_offset 7, -8
 114              		.cfi_offset 14, -4
 115 0002 84B0     		sub	sp, sp, #16
 116              		.cfi_def_cfa_offset 24
 117 0004 00AF     		add	r7, sp, #0
 118              		.cfi_def_cfa_register 7
  44:bluetooth.c   **** 	u8 i, j, chan;
  45:bluetooth.c   **** 	u32 address;
  46:bluetooth.c   **** 	address = target.address & 0xffffffff;
 119              		.loc 1 46 0
 120 0006 7A4B     		ldr	r3, .L13
 121 0008 D3E90023 		ldrd	r2, [r3]
 122 000c 1346     		mov	r3, r2
 123 000e BB60     		str	r3, [r7, #8]
  47:bluetooth.c   **** 	syncword = 0;
 124              		.loc 1 47 0
 125 0010 7849     		ldr	r1, .L13+4
 126 0012 4FF00002 		mov	r2, #0
 127 0016 4FF00003 		mov	r3, #0
ARM GAS  /tmp/cckIjmWf.s 			page 4


 128 001a C1E90023 		strd	r2, [r1]
  48:bluetooth.c   **** 
  49:bluetooth.c   **** 	/* populate frequency register bank*/
  50:bluetooth.c   **** 	for (i = 0; i < CHANNELS; i++)
 129              		.loc 1 50 0
 130 001e 0023     		movs	r3, #0
 131 0020 FB73     		strb	r3, [r7, #15]
 132 0022 14E0     		b	.L6
 133              	.L7:
  51:bluetooth.c   **** 		bank[i] = ((i * 2) % CHANNELS);
 134              		.loc 1 51 0 discriminator 3
 135 0024 F87B     		ldrb	r0, [r7, #15]	@ zero_extendqisi2
 136 0026 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 137 0028 5900     		lsls	r1, r3, #1
 138 002a 734B     		ldr	r3, .L13+8
 139 002c 83FB0123 		smull	r2, r3, r3, r1
 140 0030 5A11     		asrs	r2, r3, #5
 141 0032 CB17     		asrs	r3, r1, #31
 142 0034 D21A     		subs	r2, r2, r3
 143 0036 1346     		mov	r3, r2
 144 0038 9B00     		lsls	r3, r3, #2
 145 003a 1344     		add	r3, r3, r2
 146 003c 1B01     		lsls	r3, r3, #4
 147 003e 9B1A     		subs	r3, r3, r2
 148 0040 CA1A     		subs	r2, r1, r3
 149 0042 D2B2     		uxtb	r2, r2
 150 0044 6D4B     		ldr	r3, .L13+12
 151 0046 1A54     		strb	r2, [r3, r0]
  50:bluetooth.c   **** 		bank[i] = ((i * 2) % CHANNELS);
 152              		.loc 1 50 0 discriminator 3
 153 0048 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 154 004a 0133     		adds	r3, r3, #1
 155 004c FB73     		strb	r3, [r7, #15]
 156              	.L6:
  50:bluetooth.c   **** 		bank[i] = ((i * 2) % CHANNELS);
 157              		.loc 1 50 0 is_stmt 0 discriminator 1
 158 004e FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 159 0050 4E2B     		cmp	r3, #78
 160 0052 E7D9     		bls	.L7
  52:bluetooth.c   **** 		/* actual frequency is 2402 + bank[i] MHz */
  53:bluetooth.c   **** 
  54:bluetooth.c   **** 
  55:bluetooth.c   **** 	/* precalculate some of next_hop()'s variables */
  56:bluetooth.c   **** 	a1 = (address >> 23) & 0x1f;
 161              		.loc 1 56 0 is_stmt 1
 162 0054 BB68     		ldr	r3, [r7, #8]
 163 0056 DB0D     		lsrs	r3, r3, #23
 164 0058 DBB2     		uxtb	r3, r3
 165 005a 03F01F03 		and	r3, r3, #31
 166 005e DAB2     		uxtb	r2, r3
 167 0060 674B     		ldr	r3, .L13+16
 168 0062 1A70     		strb	r2, [r3]
  57:bluetooth.c   **** 	b = (address >> 19) & 0x0f;
 169              		.loc 1 57 0
 170 0064 BB68     		ldr	r3, [r7, #8]
 171 0066 DB0C     		lsrs	r3, r3, #19
 172 0068 DBB2     		uxtb	r3, r3
ARM GAS  /tmp/cckIjmWf.s 			page 5


 173 006a 03F00F03 		and	r3, r3, #15
 174 006e DAB2     		uxtb	r2, r3
 175 0070 644B     		ldr	r3, .L13+20
 176 0072 1A70     		strb	r2, [r3]
  58:bluetooth.c   **** 	c1 = ((address >> 4) & 0x10) +
 177              		.loc 1 58 0
 178 0074 BB68     		ldr	r3, [r7, #8]
 179 0076 1B09     		lsrs	r3, r3, #4
 180 0078 DBB2     		uxtb	r3, r3
 181 007a 03F01003 		and	r3, r3, #16
 182 007e DAB2     		uxtb	r2, r3
  59:bluetooth.c   **** 		((address >> 3) & 0x08) +
 183              		.loc 1 59 0
 184 0080 BB68     		ldr	r3, [r7, #8]
 185 0082 DB08     		lsrs	r3, r3, #3
  58:bluetooth.c   **** 	c1 = ((address >> 4) & 0x10) +
 186              		.loc 1 58 0
 187 0084 DBB2     		uxtb	r3, r3
 188 0086 03F00803 		and	r3, r3, #8
 189 008a DBB2     		uxtb	r3, r3
 190 008c 1344     		add	r3, r3, r2
 191 008e DAB2     		uxtb	r2, r3
  60:bluetooth.c   **** 		((address >> 2) & 0x04) +
 192              		.loc 1 60 0
 193 0090 BB68     		ldr	r3, [r7, #8]
 194 0092 9B08     		lsrs	r3, r3, #2
  58:bluetooth.c   **** 	c1 = ((address >> 4) & 0x10) +
 195              		.loc 1 58 0
 196 0094 DBB2     		uxtb	r3, r3
 197 0096 03F00403 		and	r3, r3, #4
 198 009a DBB2     		uxtb	r3, r3
 199 009c 1344     		add	r3, r3, r2
 200 009e DAB2     		uxtb	r2, r3
  61:bluetooth.c   **** 		((address >> 1) & 0x02) +
 201              		.loc 1 61 0
 202 00a0 BB68     		ldr	r3, [r7, #8]
 203 00a2 5B08     		lsrs	r3, r3, #1
  58:bluetooth.c   **** 		((address >> 3) & 0x08) +
 204              		.loc 1 58 0
 205 00a4 DBB2     		uxtb	r3, r3
 206 00a6 03F00203 		and	r3, r3, #2
 207 00aa DBB2     		uxtb	r3, r3
 208 00ac 1344     		add	r3, r3, r2
 209 00ae DAB2     		uxtb	r2, r3
 210 00b0 BB68     		ldr	r3, [r7, #8]
 211 00b2 DBB2     		uxtb	r3, r3
 212 00b4 03F00103 		and	r3, r3, #1
 213 00b8 DBB2     		uxtb	r3, r3
 214 00ba 1344     		add	r3, r3, r2
 215 00bc DAB2     		uxtb	r2, r3
 216 00be 524B     		ldr	r3, .L13+24
 217 00c0 1A70     		strb	r2, [r3]
  62:bluetooth.c   **** 		(address & 0x01);
  63:bluetooth.c   **** 	d1 = (address >> 10) & 0x1ff;
 218              		.loc 1 63 0
 219 00c2 BB68     		ldr	r3, [r7, #8]
 220 00c4 9B0A     		lsrs	r3, r3, #10
ARM GAS  /tmp/cckIjmWf.s 			page 6


 221 00c6 9BB2     		uxth	r3, r3
 222 00c8 C3F30803 		ubfx	r3, r3, #0, #9
 223 00cc 9AB2     		uxth	r2, r3
 224 00ce 4F4B     		ldr	r3, .L13+28
 225 00d0 1A80     		strh	r2, [r3]	@ movhi
  64:bluetooth.c   **** 	e = ((address >> 7) & 0x40) +
 226              		.loc 1 64 0
 227 00d2 BB68     		ldr	r3, [r7, #8]
 228 00d4 DB09     		lsrs	r3, r3, #7
 229 00d6 DBB2     		uxtb	r3, r3
 230 00d8 03F04003 		and	r3, r3, #64
 231 00dc DAB2     		uxtb	r2, r3
  65:bluetooth.c   **** 		((address >> 6) & 0x20) +
 232              		.loc 1 65 0
 233 00de BB68     		ldr	r3, [r7, #8]
 234 00e0 9B09     		lsrs	r3, r3, #6
  64:bluetooth.c   **** 	e = ((address >> 7) & 0x40) +
 235              		.loc 1 64 0
 236 00e2 DBB2     		uxtb	r3, r3
 237 00e4 03F02003 		and	r3, r3, #32
 238 00e8 DBB2     		uxtb	r3, r3
 239 00ea 1344     		add	r3, r3, r2
 240 00ec DAB2     		uxtb	r2, r3
  66:bluetooth.c   **** 		((address >> 5) & 0x10) +
 241              		.loc 1 66 0
 242 00ee BB68     		ldr	r3, [r7, #8]
 243 00f0 5B09     		lsrs	r3, r3, #5
  64:bluetooth.c   **** 	e = ((address >> 7) & 0x40) +
 244              		.loc 1 64 0
 245 00f2 DBB2     		uxtb	r3, r3
 246 00f4 03F01003 		and	r3, r3, #16
 247 00f8 DBB2     		uxtb	r3, r3
 248 00fa 1344     		add	r3, r3, r2
 249 00fc DAB2     		uxtb	r2, r3
  67:bluetooth.c   **** 		((address >> 4) & 0x08) +
 250              		.loc 1 67 0
 251 00fe BB68     		ldr	r3, [r7, #8]
 252 0100 1B09     		lsrs	r3, r3, #4
  64:bluetooth.c   **** 		((address >> 6) & 0x20) +
 253              		.loc 1 64 0
 254 0102 DBB2     		uxtb	r3, r3
 255 0104 03F00803 		and	r3, r3, #8
 256 0108 DBB2     		uxtb	r3, r3
 257 010a 1344     		add	r3, r3, r2
 258 010c DAB2     		uxtb	r2, r3
  68:bluetooth.c   **** 		((address >> 3) & 0x04) +
 259              		.loc 1 68 0
 260 010e BB68     		ldr	r3, [r7, #8]
 261 0110 DB08     		lsrs	r3, r3, #3
  64:bluetooth.c   **** 		((address >> 6) & 0x20) +
 262              		.loc 1 64 0
 263 0112 DBB2     		uxtb	r3, r3
 264 0114 03F00403 		and	r3, r3, #4
 265 0118 DBB2     		uxtb	r3, r3
 266 011a 1344     		add	r3, r3, r2
 267 011c DAB2     		uxtb	r2, r3
  69:bluetooth.c   **** 		((address >> 2) & 0x02) +
ARM GAS  /tmp/cckIjmWf.s 			page 7


 268              		.loc 1 69 0
 269 011e BB68     		ldr	r3, [r7, #8]
 270 0120 9B08     		lsrs	r3, r3, #2
  64:bluetooth.c   **** 		((address >> 6) & 0x20) +
 271              		.loc 1 64 0
 272 0122 DBB2     		uxtb	r3, r3
 273 0124 03F00203 		and	r3, r3, #2
 274 0128 DBB2     		uxtb	r3, r3
 275 012a 1344     		add	r3, r3, r2
 276 012c DAB2     		uxtb	r2, r3
  70:bluetooth.c   **** 		((address >> 1) & 0x01);
 277              		.loc 1 70 0
 278 012e BB68     		ldr	r3, [r7, #8]
 279 0130 5B08     		lsrs	r3, r3, #1
  64:bluetooth.c   **** 		((address >> 6) & 0x20) +
 280              		.loc 1 64 0
 281 0132 DBB2     		uxtb	r3, r3
 282 0134 03F00103 		and	r3, r3, #1
 283 0138 DBB2     		uxtb	r3, r3
 284 013a 1344     		add	r3, r3, r2
 285 013c DAB2     		uxtb	r2, r3
 286 013e 344B     		ldr	r3, .L13+32
 287 0140 1A70     		strb	r2, [r3]
  71:bluetooth.c   **** 
  72:bluetooth.c   **** 	if(afh_enabled) {
 288              		.loc 1 72 0
 289 0142 344B     		ldr	r3, .L13+36
 290 0144 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 291 0146 002B     		cmp	r3, #0
 292 0148 4FD0     		beq	.L5
  73:bluetooth.c   **** 		used_channels = 0;
 293              		.loc 1 73 0
 294 014a 334B     		ldr	r3, .L13+40
 295 014c 0022     		movs	r2, #0
 296 014e 1A70     		strb	r2, [r3]
  74:bluetooth.c   **** 		for(i = 0; i < 10; i++)
 297              		.loc 1 74 0
 298 0150 0023     		movs	r3, #0
 299 0152 FB73     		strb	r3, [r7, #15]
 300 0154 14E0     		b	.L9
 301              	.L10:
  75:bluetooth.c   **** 			used_channels += count_bits((uint64_t) afh_map[i]);
 302              		.loc 1 75 0 discriminator 3
 303 0156 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 304 0158 304A     		ldr	r2, .L13+44
 305 015a D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
 306 015c DAB2     		uxtb	r2, r3
 307 015e 4FF00003 		mov	r3, #0
 308 0162 1046     		mov	r0, r2
 309 0164 1946     		mov	r1, r3
 310 0166 FFF7FEFF 		bl	count_bits
 311 016a 0346     		mov	r3, r0
 312 016c 1A46     		mov	r2, r3
 313 016e 2A4B     		ldr	r3, .L13+40
 314 0170 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 315 0172 1344     		add	r3, r3, r2
 316 0174 DAB2     		uxtb	r2, r3
ARM GAS  /tmp/cckIjmWf.s 			page 8


 317 0176 284B     		ldr	r3, .L13+40
 318 0178 1A70     		strb	r2, [r3]
  74:bluetooth.c   **** 		for(i = 0; i < 10; i++)
 319              		.loc 1 74 0 discriminator 3
 320 017a FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 321 017c 0133     		adds	r3, r3, #1
 322 017e FB73     		strb	r3, [r7, #15]
 323              	.L9:
  74:bluetooth.c   **** 		for(i = 0; i < 10; i++)
 324              		.loc 1 74 0 is_stmt 0 discriminator 1
 325 0180 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 326 0182 092B     		cmp	r3, #9
 327 0184 E7D9     		bls	.L10
  76:bluetooth.c   **** 		j = 0;
 328              		.loc 1 76 0 is_stmt 1
 329 0186 0023     		movs	r3, #0
 330 0188 FB71     		strb	r3, [r7, #7]
  77:bluetooth.c   **** 		for (i = 0; i < CHANNELS; i++)
 331              		.loc 1 77 0
 332 018a 0023     		movs	r3, #0
 333 018c FB73     		strb	r3, [r7, #15]
 334 018e 12E0     		b	.L11
 335              	.L12:
  78:bluetooth.c   **** 			chan = (i * 2) % CHANNELS;
 336              		.loc 1 78 0 discriminator 3
 337 0190 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 338 0192 5900     		lsls	r1, r3, #1
 339 0194 184B     		ldr	r3, .L13+8
 340 0196 83FB0123 		smull	r2, r3, r3, r1
 341 019a 5A11     		asrs	r2, r3, #5
 342 019c CB17     		asrs	r3, r1, #31
 343 019e D21A     		subs	r2, r2, r3
 344 01a0 1346     		mov	r3, r2
 345 01a2 9B00     		lsls	r3, r3, #2
 346 01a4 1344     		add	r3, r3, r2
 347 01a6 1B01     		lsls	r3, r3, #4
 348 01a8 9B1A     		subs	r3, r3, r2
 349 01aa CA1A     		subs	r2, r1, r3
 350 01ac 1346     		mov	r3, r2
 351 01ae BB73     		strb	r3, [r7, #14]
  77:bluetooth.c   **** 		for (i = 0; i < CHANNELS; i++)
 352              		.loc 1 77 0 discriminator 3
 353 01b0 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 354 01b2 0133     		adds	r3, r3, #1
 355 01b4 FB73     		strb	r3, [r7, #15]
 356              	.L11:
  77:bluetooth.c   **** 		for (i = 0; i < CHANNELS; i++)
 357              		.loc 1 77 0 is_stmt 0 discriminator 1
 358 01b6 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 359 01b8 4E2B     		cmp	r3, #78
 360 01ba E9D9     		bls	.L12
  79:bluetooth.c   **** 			if(afh_map[chan/8] & (0x1 << (chan % 8)))
 361              		.loc 1 79 0 is_stmt 1
 362 01bc BB7B     		ldrb	r3, [r7, #14]	@ zero_extendqisi2
 363 01be DB08     		lsrs	r3, r3, #3
 364 01c0 DBB2     		uxtb	r3, r3
 365 01c2 1A46     		mov	r2, r3
ARM GAS  /tmp/cckIjmWf.s 			page 9


 366 01c4 154B     		ldr	r3, .L13+44
 367 01c6 9B5C     		ldrb	r3, [r3, r2]	@ zero_extendqisi2
 368 01c8 1A46     		mov	r2, r3
 369 01ca BB7B     		ldrb	r3, [r7, #14]	@ zero_extendqisi2
 370 01cc 03F00703 		and	r3, r3, #7
 371 01d0 42FA03F3 		asr	r3, r2, r3
 372 01d4 03F00103 		and	r3, r3, #1
 373 01d8 002B     		cmp	r3, #0
 374 01da 06D0     		beq	.L5
  80:bluetooth.c   **** 				bank[j++] = chan;
 375              		.loc 1 80 0
 376 01dc FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 377 01de 5A1C     		adds	r2, r3, #1
 378 01e0 FA71     		strb	r2, [r7, #7]
 379 01e2 1946     		mov	r1, r3
 380 01e4 054A     		ldr	r2, .L13+12
 381 01e6 BB7B     		ldrb	r3, [r7, #14]
 382 01e8 5354     		strb	r3, [r2, r1]
 383              	.L5:
  81:bluetooth.c   **** 	}
  82:bluetooth.c   **** }
 384              		.loc 1 82 0
 385 01ea 1037     		adds	r7, r7, #16
 386              		.cfi_def_cfa_offset 8
 387 01ec BD46     		mov	sp, r7
 388              		.cfi_def_cfa_register 13
 389              		@ sp needed
 390 01ee 80BD     		pop	{r7, pc}
 391              	.L14:
 392              		.align	2
 393              	.L13:
 394 01f0 00000000 		.word	target
 395 01f4 00000000 		.word	syncword
 396 01f8 553AB267 		.word	1739733589
 397 01fc 00000000 		.word	bank
 398 0200 00000000 		.word	a1
 399 0204 00000000 		.word	b
 400 0208 00000000 		.word	c1
 401 020c 00000000 		.word	d1
 402 0210 00000000 		.word	e
 403 0214 00000000 		.word	afh_enabled
 404 0218 00000000 		.word	used_channels
 405 021c 00000000 		.word	afh_map
 406              		.cfi_endproc
 407              	.LFE1:
 409              		.section	.rodata
 410              		.align	2
 411              	.LC0:
 412 0000 00       		.byte	0
 413 0001 02       		.byte	2
 414 0002 01       		.byte	1
 415 0003 03       		.byte	3
 416 0004 00       		.byte	0
 417 0005 01       		.byte	1
 418 0006 00       		.byte	0
 419 0007 03       		.byte	3
 420 0008 01       		.byte	1
ARM GAS  /tmp/cckIjmWf.s 			page 10


 421 0009 00       		.byte	0
 422 000a 02       		.byte	2
 423 000b 01       		.byte	1
 424 000c 00       		.byte	0
 425 000d 01       		.byte	1
 426 000e 0000     		.align	2
 427              	.LC1:
 428 0010 01       		.byte	1
 429 0011 03       		.byte	3
 430 0012 02       		.byte	2
 431 0013 04       		.byte	4
 432 0014 04       		.byte	4
 433 0015 03       		.byte	3
 434 0016 02       		.byte	2
 435 0017 04       		.byte	4
 436 0018 04       		.byte	4
 437 0019 03       		.byte	3
 438 001a 04       		.byte	4
 439 001b 03       		.byte	3
 440 001c 03       		.byte	3
 441 001d 02       		.byte	2
 442              		.section	.text.perm5,"ax",%progbits
 443              		.align	2
 444              		.global	perm5
 445              		.thumb
 446              		.thumb_func
 448              	perm5:
 449              	.LFB2:
  83:bluetooth.c   **** 
  84:bluetooth.c   **** /* 5 bit permutation */
  85:bluetooth.c   **** u8 perm5(u8 z, u8 p_high, u16 p_low)
  86:bluetooth.c   **** {
 450              		.loc 1 86 0
 451              		.cfi_startproc
 452              		@ args = 0, pretend = 0, frame = 72
 453              		@ frame_needed = 1, uses_anonymous_args = 0
 454              		@ link register save eliminated.
 455 0000 90B4     		push	{r4, r7}
 456              		.cfi_def_cfa_offset 8
 457              		.cfi_offset 4, -8
 458              		.cfi_offset 7, -4
 459 0002 92B0     		sub	sp, sp, #72
 460              		.cfi_def_cfa_offset 80
 461 0004 00AF     		add	r7, sp, #0
 462              		.cfi_def_cfa_register 7
 463 0006 0346     		mov	r3, r0
 464 0008 FB71     		strb	r3, [r7, #7]
 465 000a 0B46     		mov	r3, r1
 466 000c BB71     		strb	r3, [r7, #6]
 467 000e 1346     		mov	r3, r2	@ movhi
 468 0010 BB80     		strh	r3, [r7, #4]	@ movhi
  87:bluetooth.c   **** 	/* z is constrained to 5 bits, p_high to 5 bits, p_low to 9 bits */
  88:bluetooth.c   **** 	z &= 0x1f;
 469              		.loc 1 88 0
 470 0012 FB79     		ldrb	r3, [r7, #7]
 471 0014 03F01F03 		and	r3, r3, #31
 472 0018 FB71     		strb	r3, [r7, #7]
ARM GAS  /tmp/cckIjmWf.s 			page 11


  89:bluetooth.c   **** 	p_high &= 0x1f;
 473              		.loc 1 89 0
 474 001a BB79     		ldrb	r3, [r7, #6]
 475 001c 03F01F03 		and	r3, r3, #31
 476 0020 BB71     		strb	r3, [r7, #6]
  90:bluetooth.c   **** 	p_low &= 0x1ff;
 477              		.loc 1 90 0
 478 0022 BB88     		ldrh	r3, [r7, #4]	@ movhi
 479 0024 C3F30803 		ubfx	r3, r3, #0, #9
 480 0028 BB80     		strh	r3, [r7, #4]	@ movhi
  91:bluetooth.c   **** 
  92:bluetooth.c   **** 	int i;
  93:bluetooth.c   **** 	u8 tmp, output, z_bit[5], p[14];
  94:bluetooth.c   **** 	u8 index1[] = {0, 2, 1, 3, 0, 1, 0, 3, 1, 0, 2, 1, 0, 1};
 481              		.loc 1 94 0
 482 002a 5C4A     		ldr	r2, .L28
 483 002c 07F11C03 		add	r3, r7, #28
 484 0030 1446     		mov	r4, r2
 485 0032 2068     		ldr	r0, [r4]	@ unaligned
 486 0034 6168     		ldr	r1, [r4, #4]	@ unaligned
 487 0036 A268     		ldr	r2, [r4, #8]	@ unaligned
 488 0038 07C3     		stmia	r3!, {r0, r1, r2}
 489 003a A289     		ldrh	r2, [r4, #12]	@ unaligned
 490 003c 1A80     		strh	r2, [r3]	@ unaligned
  95:bluetooth.c   **** 	u8 index2[] = {1, 3, 2, 4, 4, 3, 2, 4, 4, 3, 4, 3, 3, 2};
 491              		.loc 1 95 0
 492 003e 584A     		ldr	r2, .L28+4
 493 0040 07F10C03 		add	r3, r7, #12
 494 0044 1446     		mov	r4, r2
 495 0046 2068     		ldr	r0, [r4]	@ unaligned
 496 0048 6168     		ldr	r1, [r4, #4]	@ unaligned
 497 004a A268     		ldr	r2, [r4, #8]	@ unaligned
 498 004c 07C3     		stmia	r3!, {r0, r1, r2}
 499 004e A289     		ldrh	r2, [r4, #12]	@ unaligned
 500 0050 1A80     		strh	r2, [r3]	@ unaligned
  96:bluetooth.c   **** 
  97:bluetooth.c   **** 	/* bits of p_low and p_high are control signals */
  98:bluetooth.c   **** 	for (i = 0; i < 9; i++)
 501              		.loc 1 98 0
 502 0052 0023     		movs	r3, #0
 503 0054 7B64     		str	r3, [r7, #68]
 504 0056 10E0     		b	.L16
 505              	.L17:
  99:bluetooth.c   **** 		p[i] = (p_low >> i) & 0x01;
 506              		.loc 1 99 0 discriminator 3
 507 0058 BA88     		ldrh	r2, [r7, #4]
 508 005a 7B6C     		ldr	r3, [r7, #68]
 509 005c 42FA03F3 		asr	r3, r2, r3
 510 0060 DBB2     		uxtb	r3, r3
 511 0062 03F00103 		and	r3, r3, #1
 512 0066 D9B2     		uxtb	r1, r3
 513 0068 07F12C02 		add	r2, r7, #44
 514 006c 7B6C     		ldr	r3, [r7, #68]
 515 006e 1344     		add	r3, r3, r2
 516 0070 0A46     		mov	r2, r1
 517 0072 1A70     		strb	r2, [r3]
  98:bluetooth.c   **** 		p[i] = (p_low >> i) & 0x01;
ARM GAS  /tmp/cckIjmWf.s 			page 12


 518              		.loc 1 98 0 discriminator 3
 519 0074 7B6C     		ldr	r3, [r7, #68]
 520 0076 0133     		adds	r3, r3, #1
 521 0078 7B64     		str	r3, [r7, #68]
 522              	.L16:
  98:bluetooth.c   **** 		p[i] = (p_low >> i) & 0x01;
 523              		.loc 1 98 0 is_stmt 0 discriminator 1
 524 007a 7B6C     		ldr	r3, [r7, #68]
 525 007c 082B     		cmp	r3, #8
 526 007e EBDD     		ble	.L17
 100:bluetooth.c   **** 	for (i = 0; i < 5; i++)
 527              		.loc 1 100 0 is_stmt 1
 528 0080 0023     		movs	r3, #0
 529 0082 7B64     		str	r3, [r7, #68]
 530 0084 11E0     		b	.L18
 531              	.L19:
 101:bluetooth.c   **** 		p[i+9] = (p_high >> i) & 0x01;
 532              		.loc 1 101 0 discriminator 3
 533 0086 7B6C     		ldr	r3, [r7, #68]
 534 0088 0933     		adds	r3, r3, #9
 535 008a B979     		ldrb	r1, [r7, #6]	@ zero_extendqisi2
 536 008c 7A6C     		ldr	r2, [r7, #68]
 537 008e 41FA02F2 		asr	r2, r1, r2
 538 0092 D2B2     		uxtb	r2, r2
 539 0094 02F00102 		and	r2, r2, #1
 540 0098 D2B2     		uxtb	r2, r2
 541 009a 07F14801 		add	r1, r7, #72
 542 009e 0B44     		add	r3, r3, r1
 543 00a0 03F81C2C 		strb	r2, [r3, #-28]
 100:bluetooth.c   **** 	for (i = 0; i < 5; i++)
 544              		.loc 1 100 0 discriminator 3
 545 00a4 7B6C     		ldr	r3, [r7, #68]
 546 00a6 0133     		adds	r3, r3, #1
 547 00a8 7B64     		str	r3, [r7, #68]
 548              	.L18:
 100:bluetooth.c   **** 	for (i = 0; i < 5; i++)
 549              		.loc 1 100 0 is_stmt 0 discriminator 1
 550 00aa 7B6C     		ldr	r3, [r7, #68]
 551 00ac 042B     		cmp	r3, #4
 552 00ae EADD     		ble	.L19
 102:bluetooth.c   **** 
 103:bluetooth.c   **** 	/* bit swapping will be easier with an array of bits */
 104:bluetooth.c   **** 	for (i = 0; i < 5; i++)
 553              		.loc 1 104 0 is_stmt 1
 554 00b0 0023     		movs	r3, #0
 555 00b2 7B64     		str	r3, [r7, #68]
 556 00b4 10E0     		b	.L20
 557              	.L21:
 105:bluetooth.c   **** 		z_bit[i] = (z >> i) & 0x01;
 558              		.loc 1 105 0 discriminator 3
 559 00b6 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 560 00b8 7B6C     		ldr	r3, [r7, #68]
 561 00ba 42FA03F3 		asr	r3, r2, r3
 562 00be DBB2     		uxtb	r3, r3
 563 00c0 03F00103 		and	r3, r3, #1
 564 00c4 D9B2     		uxtb	r1, r3
 565 00c6 07F13C02 		add	r2, r7, #60
ARM GAS  /tmp/cckIjmWf.s 			page 13


 566 00ca 7B6C     		ldr	r3, [r7, #68]
 567 00cc 1344     		add	r3, r3, r2
 568 00ce 0A46     		mov	r2, r1
 569 00d0 1A70     		strb	r2, [r3]
 104:bluetooth.c   **** 		z_bit[i] = (z >> i) & 0x01;
 570              		.loc 1 104 0 discriminator 3
 571 00d2 7B6C     		ldr	r3, [r7, #68]
 572 00d4 0133     		adds	r3, r3, #1
 573 00d6 7B64     		str	r3, [r7, #68]
 574              	.L20:
 104:bluetooth.c   **** 		z_bit[i] = (z >> i) & 0x01;
 575              		.loc 1 104 0 is_stmt 0 discriminator 1
 576 00d8 7B6C     		ldr	r3, [r7, #68]
 577 00da 042B     		cmp	r3, #4
 578 00dc EBDD     		ble	.L21
 106:bluetooth.c   **** 
 107:bluetooth.c   **** 	/* butterfly operations */
 108:bluetooth.c   **** 	for (i = 13; i >= 0; i--) {
 579              		.loc 1 108 0 is_stmt 1
 580 00de 0D23     		movs	r3, #13
 581 00e0 7B64     		str	r3, [r7, #68]
 582 00e2 36E0     		b	.L22
 583              	.L24:
 109:bluetooth.c   **** 		/* swap bits according to index arrays if control signal tells us to */
 110:bluetooth.c   **** 		if (p[i]) {
 584              		.loc 1 110 0
 585 00e4 07F12C02 		add	r2, r7, #44
 586 00e8 7B6C     		ldr	r3, [r7, #68]
 587 00ea 1344     		add	r3, r3, r2
 588 00ec 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 589 00ee 002B     		cmp	r3, #0
 590 00f0 2CD0     		beq	.L23
 111:bluetooth.c   **** 			tmp = z_bit[index1[i]];
 591              		.loc 1 111 0
 592 00f2 07F11C02 		add	r2, r7, #28
 593 00f6 7B6C     		ldr	r3, [r7, #68]
 594 00f8 1344     		add	r3, r3, r2
 595 00fa 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 596 00fc 07F14802 		add	r2, r7, #72
 597 0100 1344     		add	r3, r3, r2
 598 0102 13F80C3C 		ldrb	r3, [r3, #-12]
 599 0106 87F84230 		strb	r3, [r7, #66]
 112:bluetooth.c   **** 			z_bit[index1[i]] = z_bit[index2[i]];
 600              		.loc 1 112 0
 601 010a 07F11C02 		add	r2, r7, #28
 602 010e 7B6C     		ldr	r3, [r7, #68]
 603 0110 1344     		add	r3, r3, r2
 604 0112 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 605 0114 1946     		mov	r1, r3
 606 0116 07F10C02 		add	r2, r7, #12
 607 011a 7B6C     		ldr	r3, [r7, #68]
 608 011c 1344     		add	r3, r3, r2
 609 011e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 610 0120 07F14802 		add	r2, r7, #72
 611 0124 1344     		add	r3, r3, r2
 612 0126 13F80C2C 		ldrb	r2, [r3, #-12]	@ zero_extendqisi2
 613 012a 07F14803 		add	r3, r7, #72
ARM GAS  /tmp/cckIjmWf.s 			page 14


 614 012e 0B44     		add	r3, r3, r1
 615 0130 03F80C2C 		strb	r2, [r3, #-12]
 113:bluetooth.c   **** 			z_bit[index2[i]] = tmp;
 616              		.loc 1 113 0
 617 0134 07F10C02 		add	r2, r7, #12
 618 0138 7B6C     		ldr	r3, [r7, #68]
 619 013a 1344     		add	r3, r3, r2
 620 013c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 621 013e 07F14802 		add	r2, r7, #72
 622 0142 1344     		add	r3, r3, r2
 623 0144 97F84220 		ldrb	r2, [r7, #66]
 624 0148 03F80C2C 		strb	r2, [r3, #-12]
 625              	.L23:
 108:bluetooth.c   **** 		/* swap bits according to index arrays if control signal tells us to */
 626              		.loc 1 108 0 discriminator 2
 627 014c 7B6C     		ldr	r3, [r7, #68]
 628 014e 013B     		subs	r3, r3, #1
 629 0150 7B64     		str	r3, [r7, #68]
 630              	.L22:
 108:bluetooth.c   **** 		/* swap bits according to index arrays if control signal tells us to */
 631              		.loc 1 108 0 is_stmt 0 discriminator 1
 632 0152 7B6C     		ldr	r3, [r7, #68]
 633 0154 002B     		cmp	r3, #0
 634 0156 C5DA     		bge	.L24
 114:bluetooth.c   **** 		}
 115:bluetooth.c   **** 	}
 116:bluetooth.c   **** 
 117:bluetooth.c   **** 	/* reconstruct output from rearranged bits */
 118:bluetooth.c   **** 	output = 0;
 635              		.loc 1 118 0 is_stmt 1
 636 0158 0023     		movs	r3, #0
 637 015a 87F84330 		strb	r3, [r7, #67]
 119:bluetooth.c   **** 	for (i = 0; i < 5; i++)
 638              		.loc 1 119 0
 639 015e 0023     		movs	r3, #0
 640 0160 7B64     		str	r3, [r7, #68]
 641 0162 11E0     		b	.L25
 642              	.L26:
 120:bluetooth.c   **** 		output += z_bit[i] << i;
 643              		.loc 1 120 0 discriminator 3
 644 0164 07F13C02 		add	r2, r7, #60
 645 0168 7B6C     		ldr	r3, [r7, #68]
 646 016a 1344     		add	r3, r3, r2
 647 016c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 648 016e 1A46     		mov	r2, r3
 649 0170 7B6C     		ldr	r3, [r7, #68]
 650 0172 02FA03F3 		lsl	r3, r2, r3
 651 0176 DAB2     		uxtb	r2, r3
 652 0178 97F84330 		ldrb	r3, [r7, #67]
 653 017c 1344     		add	r3, r3, r2
 654 017e 87F84330 		strb	r3, [r7, #67]
 119:bluetooth.c   **** 	for (i = 0; i < 5; i++)
 655              		.loc 1 119 0 discriminator 3
 656 0182 7B6C     		ldr	r3, [r7, #68]
 657 0184 0133     		adds	r3, r3, #1
 658 0186 7B64     		str	r3, [r7, #68]
 659              	.L25:
ARM GAS  /tmp/cckIjmWf.s 			page 15


 119:bluetooth.c   **** 	for (i = 0; i < 5; i++)
 660              		.loc 1 119 0 is_stmt 0 discriminator 1
 661 0188 7B6C     		ldr	r3, [r7, #68]
 662 018a 042B     		cmp	r3, #4
 663 018c EADD     		ble	.L26
 121:bluetooth.c   **** 
 122:bluetooth.c   **** 	return output;
 664              		.loc 1 122 0 is_stmt 1
 665 018e 97F84330 		ldrb	r3, [r7, #67]	@ zero_extendqisi2
 123:bluetooth.c   **** }
 666              		.loc 1 123 0
 667 0192 1846     		mov	r0, r3
 668 0194 4837     		adds	r7, r7, #72
 669              		.cfi_def_cfa_offset 8
 670 0196 BD46     		mov	sp, r7
 671              		.cfi_def_cfa_register 13
 672              		@ sp needed
 673 0198 90BC     		pop	{r4, r7}
 674              		.cfi_restore 7
 675              		.cfi_restore 4
 676              		.cfi_def_cfa_offset 0
 677 019a 7047     		bx	lr
 678              	.L29:
 679              		.align	2
 680              	.L28:
 681 019c 00000000 		.word	.LC0
 682 01a0 10000000 		.word	.LC1
 683              		.cfi_endproc
 684              	.LFE2:
 686              		.section	.text.next_hop,"ax",%progbits
 687              		.align	2
 688              		.global	next_hop
 689              		.thumb
 690              		.thumb_func
 692              	next_hop:
 693              	.LFB3:
 124:bluetooth.c   **** 
 125:bluetooth.c   **** u16 next_hop(u32 clock)
 126:bluetooth.c   **** {
 694              		.loc 1 126 0
 695              		.cfi_startproc
 696              		@ args = 0, pretend = 0, frame = 40
 697              		@ frame_needed = 1, uses_anonymous_args = 0
 698 0000 80B5     		push	{r7, lr}
 699              		.cfi_def_cfa_offset 8
 700              		.cfi_offset 7, -8
 701              		.cfi_offset 14, -4
 702 0002 8AB0     		sub	sp, sp, #40
 703              		.cfi_def_cfa_offset 48
 704 0004 00AF     		add	r7, sp, #0
 705              		.cfi_def_cfa_register 7
 706 0006 7860     		str	r0, [r7, #4]
 127:bluetooth.c   **** 	u8 a, c, x, y1, perm, next_channel;
 128:bluetooth.c   **** 	u16 d, y2;
 129:bluetooth.c   **** 	u32 base_f, f, f_dash;
 130:bluetooth.c   **** 
 131:bluetooth.c   **** 	clock &= 0xffffffff;
ARM GAS  /tmp/cckIjmWf.s 			page 16


 132:bluetooth.c   **** 	/* Variable names used in Vol 2, Part B, Section 2.6 of the spec */
 133:bluetooth.c   **** 	x = (clock >> 2) & 0x1f;
 707              		.loc 1 133 0
 708 0008 7B68     		ldr	r3, [r7, #4]
 709 000a 9B08     		lsrs	r3, r3, #2
 710 000c DBB2     		uxtb	r3, r3
 711 000e 03F01F03 		and	r3, r3, #31
 712 0012 87F82630 		strb	r3, [r7, #38]
 134:bluetooth.c   **** 	y1 = (clock >> 1) & 0x01;
 713              		.loc 1 134 0
 714 0016 7B68     		ldr	r3, [r7, #4]
 715 0018 5B08     		lsrs	r3, r3, #1
 716 001a DBB2     		uxtb	r3, r3
 717 001c 03F00103 		and	r3, r3, #1
 718 0020 87F82530 		strb	r3, [r7, #37]
 135:bluetooth.c   **** 	y2 = y1 << 5;
 719              		.loc 1 135 0
 720 0024 97F82530 		ldrb	r3, [r7, #37]	@ zero_extendqisi2
 721 0028 9BB2     		uxth	r3, r3
 722 002a 5B01     		lsls	r3, r3, #5
 723 002c 7B84     		strh	r3, [r7, #34]	@ movhi
 136:bluetooth.c   **** 	a = (a1 ^ (clock >> 21)) & 0x1f;
 724              		.loc 1 136 0
 725 002e 7B68     		ldr	r3, [r7, #4]
 726 0030 5B0D     		lsrs	r3, r3, #21
 727 0032 DAB2     		uxtb	r2, r3
 728 0034 4B4B     		ldr	r3, .L33
 729 0036 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 730 0038 5340     		eors	r3, r3, r2
 731 003a DBB2     		uxtb	r3, r3
 732 003c 03F01F03 		and	r3, r3, #31
 733 0040 87F82130 		strb	r3, [r7, #33]
 137:bluetooth.c   **** 	/* b is already defined */
 138:bluetooth.c   **** 	c = (c1 ^ (clock >> 16)) & 0x1f;
 734              		.loc 1 138 0
 735 0044 7B68     		ldr	r3, [r7, #4]
 736 0046 1B0C     		lsrs	r3, r3, #16
 737 0048 DAB2     		uxtb	r2, r3
 738 004a 474B     		ldr	r3, .L33+4
 739 004c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 740 004e 5340     		eors	r3, r3, r2
 741 0050 DBB2     		uxtb	r3, r3
 742 0052 03F01F03 		and	r3, r3, #31
 743 0056 87F82030 		strb	r3, [r7, #32]
 139:bluetooth.c   **** 	d = (d1 ^ (clock >> 7)) & 0x1ff;
 744              		.loc 1 139 0
 745 005a 7B68     		ldr	r3, [r7, #4]
 746 005c DB09     		lsrs	r3, r3, #7
 747 005e 9AB2     		uxth	r2, r3
 748 0060 424B     		ldr	r3, .L33+8
 749 0062 1B88     		ldrh	r3, [r3]
 750 0064 5340     		eors	r3, r3, r2
 751 0066 9BB2     		uxth	r3, r3
 752 0068 C3F30803 		ubfx	r3, r3, #0, #9
 753 006c FB83     		strh	r3, [r7, #30]	@ movhi
 140:bluetooth.c   **** 	/* e is already defined */
 141:bluetooth.c   **** 	base_f = (clock >> 3) & 0x1fffff0;
ARM GAS  /tmp/cckIjmWf.s 			page 17


 754              		.loc 1 141 0
 755 006e 7B68     		ldr	r3, [r7, #4]
 756 0070 DB08     		lsrs	r3, r3, #3
 757 0072 23F07E43 		bic	r3, r3, #-33554432
 758 0076 23F00F03 		bic	r3, r3, #15
 759 007a BB61     		str	r3, [r7, #24]
 142:bluetooth.c   **** 	f = base_f % 79;
 760              		.loc 1 142 0
 761 007c B969     		ldr	r1, [r7, #24]
 762 007e 3C4B     		ldr	r3, .L33+12
 763 0080 A3FB0123 		umull	r2, r3, r3, r1
 764 0084 9A09     		lsrs	r2, r3, #6
 765 0086 1346     		mov	r3, r2
 766 0088 9B00     		lsls	r3, r3, #2
 767 008a 1344     		add	r3, r3, r2
 768 008c 1B01     		lsls	r3, r3, #4
 769 008e 9B1A     		subs	r3, r3, r2
 770 0090 CB1A     		subs	r3, r1, r3
 771 0092 7B61     		str	r3, [r7, #20]
 143:bluetooth.c   **** 
 144:bluetooth.c   **** 	perm = perm5(
 772              		.loc 1 144 0
 773 0094 97F82620 		ldrb	r2, [r7, #38]
 774 0098 97F82130 		ldrb	r3, [r7, #33]
 775 009c 1344     		add	r3, r3, r2
 776 009e DBB2     		uxtb	r3, r3
 777 00a0 DBB2     		uxtb	r3, r3
 778 00a2 03F01F03 		and	r3, r3, #31
 779 00a6 DAB2     		uxtb	r2, r3
 780 00a8 324B     		ldr	r3, .L33+16
 781 00aa 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 782 00ac DBB2     		uxtb	r3, r3
 783 00ae 5340     		eors	r3, r3, r2
 784 00b0 DBB2     		uxtb	r3, r3
 785 00b2 D9B2     		uxtb	r1, r3
 786 00b4 97F82530 		ldrb	r3, [r7, #37]
 787 00b8 1A46     		mov	r2, r3
 788 00ba 5201     		lsls	r2, r2, #5
 789 00bc D31A     		subs	r3, r2, r3
 790 00be DBB2     		uxtb	r3, r3
 791 00c0 DAB2     		uxtb	r2, r3
 792 00c2 97F82030 		ldrb	r3, [r7, #32]	@ zero_extendqisi2
 793 00c6 5340     		eors	r3, r3, r2
 794 00c8 DBB2     		uxtb	r3, r3
 795 00ca DAB2     		uxtb	r2, r3
 796 00cc FB8B     		ldrh	r3, [r7, #30]
 797 00ce 0846     		mov	r0, r1
 798 00d0 1146     		mov	r1, r2
 799 00d2 1A46     		mov	r2, r3
 800 00d4 FFF7FEFF 		bl	perm5
 801 00d8 0346     		mov	r3, r0
 802 00da FB74     		strb	r3, [r7, #19]
 145:bluetooth.c   **** 		((x + a) % 32) ^ b,
 146:bluetooth.c   **** 		(y1 * 0x1f) ^ c,
 147:bluetooth.c   **** 		d);
 148:bluetooth.c   **** 	/* hop selection */
 149:bluetooth.c   **** 	next_channel = bank[(perm + e + f + y2) % CHANNELS];
ARM GAS  /tmp/cckIjmWf.s 			page 18


 803              		.loc 1 149 0
 804 00dc FB7C     		ldrb	r3, [r7, #19]	@ zero_extendqisi2
 805 00de 264A     		ldr	r2, .L33+20
 806 00e0 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 807 00e2 1344     		add	r3, r3, r2
 808 00e4 1A46     		mov	r2, r3
 809 00e6 7B69     		ldr	r3, [r7, #20]
 810 00e8 1A44     		add	r2, r2, r3
 811 00ea 7B8C     		ldrh	r3, [r7, #34]
 812 00ec D118     		adds	r1, r2, r3
 813 00ee 204B     		ldr	r3, .L33+12
 814 00f0 A3FB0123 		umull	r2, r3, r3, r1
 815 00f4 9A09     		lsrs	r2, r3, #6
 816 00f6 1346     		mov	r3, r2
 817 00f8 9B00     		lsls	r3, r3, #2
 818 00fa 1344     		add	r3, r3, r2
 819 00fc 1B01     		lsls	r3, r3, #4
 820 00fe 9B1A     		subs	r3, r3, r2
 821 0100 CA1A     		subs	r2, r1, r3
 822 0102 1E4B     		ldr	r3, .L33+24
 823 0104 9B5C     		ldrb	r3, [r3, r2]
 824 0106 87F82730 		strb	r3, [r7, #39]
 150:bluetooth.c   **** 	if(afh_enabled) {
 825              		.loc 1 150 0
 826 010a 1D4B     		ldr	r3, .L33+28
 827 010c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 828 010e 002B     		cmp	r3, #0
 829 0110 1DD0     		beq	.L31
 151:bluetooth.c   **** 		f_dash = base_f % used_channels;
 830              		.loc 1 151 0
 831 0112 1C4B     		ldr	r3, .L33+32
 832 0114 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 833 0116 1A46     		mov	r2, r3
 834 0118 BB69     		ldr	r3, [r7, #24]
 835 011a B3FBF2F1 		udiv	r1, r3, r2
 836 011e 02FB01F2 		mul	r2, r2, r1
 837 0122 9B1A     		subs	r3, r3, r2
 838 0124 FB60     		str	r3, [r7, #12]
 152:bluetooth.c   **** 		next_channel = afh_bank[(perm + e + f_dash + y2) % used_channels];
 839              		.loc 1 152 0
 840 0126 FB7C     		ldrb	r3, [r7, #19]	@ zero_extendqisi2
 841 0128 134A     		ldr	r2, .L33+20
 842 012a 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 843 012c 1344     		add	r3, r3, r2
 844 012e 1A46     		mov	r2, r3
 845 0130 FB68     		ldr	r3, [r7, #12]
 846 0132 1A44     		add	r2, r2, r3
 847 0134 7B8C     		ldrh	r3, [r7, #34]
 848 0136 1344     		add	r3, r3, r2
 849 0138 124A     		ldr	r2, .L33+32
 850 013a 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 851 013c B3FBF2F1 		udiv	r1, r3, r2
 852 0140 02FB01F2 		mul	r2, r2, r1
 853 0144 9B1A     		subs	r3, r3, r2
 854 0146 104A     		ldr	r2, .L33+36
 855 0148 D35C     		ldrb	r3, [r2, r3]
 856 014a 87F82730 		strb	r3, [r7, #39]
ARM GAS  /tmp/cckIjmWf.s 			page 19


 857              	.L31:
 153:bluetooth.c   **** 	}
 154:bluetooth.c   **** 	return (2402 + next_channel);
 858              		.loc 1 154 0
 859 014e 97F82730 		ldrb	r3, [r7, #39]	@ zero_extendqisi2
 860 0152 9BB2     		uxth	r3, r3
 861 0154 03F66213 		addw	r3, r3, #2402
 862 0158 9BB2     		uxth	r3, r3
 155:bluetooth.c   **** 
 156:bluetooth.c   **** }
 863              		.loc 1 156 0
 864 015a 1846     		mov	r0, r3
 865 015c 2837     		adds	r7, r7, #40
 866              		.cfi_def_cfa_offset 8
 867 015e BD46     		mov	sp, r7
 868              		.cfi_def_cfa_register 13
 869              		@ sp needed
 870 0160 80BD     		pop	{r7, pc}
 871              	.L34:
 872 0162 00BF     		.align	2
 873              	.L33:
 874 0164 00000000 		.word	a1
 875 0168 00000000 		.word	c1
 876 016c 00000000 		.word	d1
 877 0170 A97464CF 		.word	-815500119
 878 0174 00000000 		.word	b
 879 0178 00000000 		.word	e
 880 017c 00000000 		.word	bank
 881 0180 00000000 		.word	afh_enabled
 882 0184 00000000 		.word	used_channels
 883 0188 00000000 		.word	afh_bank
 884              		.cfi_endproc
 885              	.LFE3:
 887              		.section	.text.find_access_code,"ax",%progbits
 888              		.align	2
 889              		.global	find_access_code
 890              		.thumb
 891              		.thumb_func
 893              	find_access_code:
 894              	.LFB4:
 157:bluetooth.c   **** 
 158:bluetooth.c   **** int find_access_code(u8 *idle_rxbuf)
 159:bluetooth.c   **** {
 895              		.loc 1 159 0
 896              		.cfi_startproc
 897              		@ args = 0, pretend = 0, frame = 24
 898              		@ frame_needed = 1, uses_anonymous_args = 0
 899 0000 B0B5     		push	{r4, r5, r7, lr}
 900              		.cfi_def_cfa_offset 16
 901              		.cfi_offset 4, -16
 902              		.cfi_offset 5, -12
 903              		.cfi_offset 7, -8
 904              		.cfi_offset 14, -4
 905 0002 86B0     		sub	sp, sp, #24
 906              		.cfi_def_cfa_offset 40
 907 0004 00AF     		add	r7, sp, #0
 908              		.cfi_def_cfa_register 7
ARM GAS  /tmp/cckIjmWf.s 			page 20


 909 0006 7860     		str	r0, [r7, #4]
 160:bluetooth.c   **** 	/* Looks for an AC in the stream */
 161:bluetooth.c   **** 	u8 bit_errors, curr_buf;
 162:bluetooth.c   **** 	int i = 0, count = 0;
 910              		.loc 1 162 0
 911 0008 0021     		movs	r1, #0
 912 000a 3961     		str	r1, [r7, #16]
 913 000c 0021     		movs	r1, #0
 914 000e F960     		str	r1, [r7, #12]
 163:bluetooth.c   **** 
 164:bluetooth.c   **** 	if (syncword == 0) {
 915              		.loc 1 164 0
 916 0010 4349     		ldr	r1, .L44
 917 0012 D1E90001 		ldrd	r0, [r1]
 918 0016 0143     		orrs	r1, r0, r1
 919 0018 2BD1     		bne	.L36
 165:bluetooth.c   **** 		for (; i<8; i++) {
 920              		.loc 1 165 0
 921 001a 25E0     		b	.L37
 922              	.L38:
 166:bluetooth.c   **** 			syncword <<= 8;
 923              		.loc 1 166 0 discriminator 2
 924 001c 4049     		ldr	r1, .L44
 925 001e D1E90001 		ldrd	r0, [r1]
 926 0022 0B02     		lsls	r3, r1, #8
 927 0024 43EA1063 		orr	r3, r3, r0, lsr #24
 928 0028 0202     		lsls	r2, r0, #8
 929 002a 3D49     		ldr	r1, .L44
 930 002c C1E90023 		strd	r2, [r1]
 167:bluetooth.c   **** 			syncword = (syncword & 0xffffffffffffff00) | idle_rxbuf[i];
 931              		.loc 1 167 0 discriminator 2
 932 0030 3B49     		ldr	r1, .L44
 933 0032 D1E90001 		ldrd	r0, [r1]
 934 0036 6FF0FF04 		mvn	r4, #255
 935 003a 4FF0FF35 		mov	r5, #-1
 936 003e 04EA0004 		and	r4, r4, r0
 937 0042 05EA0105 		and	r5, r5, r1
 938 0046 3969     		ldr	r1, [r7, #16]
 939 0048 7868     		ldr	r0, [r7, #4]
 940 004a 0144     		add	r1, r1, r0
 941 004c 0978     		ldrb	r1, [r1]	@ zero_extendqisi2
 942 004e C8B2     		uxtb	r0, r1
 943 0050 4FF00001 		mov	r1, #0
 944 0054 40EA0400 		orr	r0, r0, r4
 945 0058 41EA0501 		orr	r1, r1, r5
 946 005c 304C     		ldr	r4, .L44
 947 005e C4E90001 		strd	r0, [r4]
 165:bluetooth.c   **** 		for (; i<8; i++) {
 948              		.loc 1 165 0 discriminator 2
 949 0062 3969     		ldr	r1, [r7, #16]
 950 0064 0131     		adds	r1, r1, #1
 951 0066 3961     		str	r1, [r7, #16]
 952              	.L37:
 165:bluetooth.c   **** 		for (; i<8; i++) {
 953              		.loc 1 165 0 is_stmt 0 discriminator 1
 954 0068 3969     		ldr	r1, [r7, #16]
 955 006a 0729     		cmp	r1, #7
ARM GAS  /tmp/cckIjmWf.s 			page 21


 956 006c D6DD     		ble	.L38
 168:bluetooth.c   **** 		}
 169:bluetooth.c   **** 		count = 64;
 957              		.loc 1 169 0 is_stmt 1
 958 006e 4023     		movs	r3, #64
 959 0070 FB60     		str	r3, [r7, #12]
 960              	.L36:
 170:bluetooth.c   **** 	}
 171:bluetooth.c   **** 	curr_buf = idle_rxbuf[i];
 961              		.loc 1 171 0
 962 0072 3B69     		ldr	r3, [r7, #16]
 963 0074 7A68     		ldr	r2, [r7, #4]
 964 0076 1344     		add	r3, r3, r2
 965 0078 1B78     		ldrb	r3, [r3]
 966 007a FB75     		strb	r3, [r7, #23]
 172:bluetooth.c   **** 
 173:bluetooth.c   **** 	// Search until we're 64 symbols from the end of the buffer
 174:bluetooth.c   **** 	for(; count < ((8 * DMA_SIZE) - 64); count++)
 967              		.loc 1 174 0
 968 007c 46E0     		b	.L39
 969              	.L43:
 175:bluetooth.c   **** 	{
 176:bluetooth.c   **** 		bit_errors = count_bits(syncword ^ target.access_code);
 970              		.loc 1 176 0
 971 007e 294B     		ldr	r3, .L44+4
 972 0080 D3E90201 		ldrd	r0, [r3, #8]
 973 0084 264B     		ldr	r3, .L44
 974 0086 D3E90023 		ldrd	r2, [r3]
 975 008a 80EA0200 		eor	r0, r0, r2
 976 008e 81EA0301 		eor	r1, r1, r3
 977 0092 FFF7FEFF 		bl	count_bits
 978 0096 0346     		mov	r3, r0
 979 0098 FB72     		strb	r3, [r7, #11]
 177:bluetooth.c   **** 
 178:bluetooth.c   **** 		if (bit_errors < MAX_SYNCWORD_ERRS)
 980              		.loc 1 178 0
 981 009a FB7A     		ldrb	r3, [r7, #11]	@ zero_extendqisi2
 982 009c 042B     		cmp	r3, #4
 983 009e 01D8     		bhi	.L40
 179:bluetooth.c   **** 			return count;
 984              		.loc 1 179 0
 985 00a0 FB68     		ldr	r3, [r7, #12]
 986 00a2 39E0     		b	.L41
 987              	.L40:
 180:bluetooth.c   **** 
 181:bluetooth.c   **** 		if (count%8 == 0)
 988              		.loc 1 181 0
 989 00a4 FB68     		ldr	r3, [r7, #12]
 990 00a6 03F00703 		and	r3, r3, #7
 991 00aa 002B     		cmp	r3, #0
 992 00ac 07D1     		bne	.L42
 182:bluetooth.c   **** 			curr_buf = idle_rxbuf[++i];
 993              		.loc 1 182 0
 994 00ae 3B69     		ldr	r3, [r7, #16]
 995 00b0 0133     		adds	r3, r3, #1
 996 00b2 3B61     		str	r3, [r7, #16]
 997 00b4 3B69     		ldr	r3, [r7, #16]
ARM GAS  /tmp/cckIjmWf.s 			page 22


 998 00b6 7A68     		ldr	r2, [r7, #4]
 999 00b8 1344     		add	r3, r3, r2
 1000 00ba 1B78     		ldrb	r3, [r3]
 1001 00bc FB75     		strb	r3, [r7, #23]
 1002              	.L42:
 183:bluetooth.c   **** 
 184:bluetooth.c   **** 		syncword <<= 1;
 1003              		.loc 1 184 0
 1004 00be 184B     		ldr	r3, .L44
 1005 00c0 D3E90023 		ldrd	r2, [r3]
 1006 00c4 9218     		adds	r2, r2, r2
 1007 00c6 43EB0303 		adc	r3, r3, r3
 1008 00ca 1549     		ldr	r1, .L44
 1009 00cc C1E90023 		strd	r2, [r1]
 185:bluetooth.c   **** 		syncword = (syncword & 0xfffffffffffffffe) | ((curr_buf & 0x80) >> 7);
 1010              		.loc 1 185 0
 1011 00d0 134B     		ldr	r3, .L44
 1012 00d2 D3E90023 		ldrd	r2, [r3]
 1013 00d6 6FF00100 		mvn	r0, #1
 1014 00da 4FF0FF31 		mov	r1, #-1
 1015 00de 00EA0200 		and	r0, r0, r2
 1016 00e2 01EA0301 		and	r1, r1, r3
 1017 00e6 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1018 00e8 DB09     		lsrs	r3, r3, #7
 1019 00ea DBB2     		uxtb	r3, r3
 1020 00ec DAB2     		uxtb	r2, r3
 1021 00ee 4FF00003 		mov	r3, #0
 1022 00f2 42EA0002 		orr	r2, r2, r0
 1023 00f6 43EA0103 		orr	r3, r3, r1
 1024 00fa 0949     		ldr	r1, .L44
 1025 00fc C1E90023 		strd	r2, [r1]
 186:bluetooth.c   **** 		curr_buf <<= 1;
 1026              		.loc 1 186 0
 1027 0100 FB7D     		ldrb	r3, [r7, #23]
 1028 0102 5B00     		lsls	r3, r3, #1
 1029 0104 FB75     		strb	r3, [r7, #23]
 174:bluetooth.c   **** 	{
 1030              		.loc 1 174 0
 1031 0106 FB68     		ldr	r3, [r7, #12]
 1032 0108 0133     		adds	r3, r3, #1
 1033 010a FB60     		str	r3, [r7, #12]
 1034              	.L39:
 174:bluetooth.c   **** 	{
 1035              		.loc 1 174 0 is_stmt 0 discriminator 1
 1036 010c FB68     		ldr	r3, [r7, #12]
 1037 010e B3F5A87F 		cmp	r3, #336
 1038 0112 B4DB     		blt	.L43
 187:bluetooth.c   **** 	}
 188:bluetooth.c   **** 	return -1;
 1039              		.loc 1 188 0 is_stmt 1
 1040 0114 4FF0FF33 		mov	r3, #-1
 1041              	.L41:
 189:bluetooth.c   **** }
 1042              		.loc 1 189 0
 1043 0118 1846     		mov	r0, r3
 1044 011a 1837     		adds	r7, r7, #24
 1045              		.cfi_def_cfa_offset 16
ARM GAS  /tmp/cckIjmWf.s 			page 23


 1046 011c BD46     		mov	sp, r7
 1047              		.cfi_def_cfa_register 13
 1048              		@ sp needed
 1049 011e B0BD     		pop	{r4, r5, r7, pc}
 1050              	.L45:
 1051              		.align	2
 1052              	.L44:
 1053 0120 00000000 		.word	syncword
 1054 0124 00000000 		.word	target
 1055              		.cfi_endproc
 1056              	.LFE4:
 1058              		.text
 1059              	.Letext0:
 1060              		.file 2 "/usr/lib/gcc/arm-none-eabi/4.9.3/include/stdint-gcc.h"
 1061              		.file 3 "../../host/libubertooth/src/ubertooth_interface.h"
 1062              		.file 4 "../common/ubertooth.h"
 1063              		.file 5 "bluetooth.h"
ARM GAS  /tmp/cckIjmWf.s 			page 24


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bluetooth.c
     /tmp/cckIjmWf.s:19     .data:0000000000000000 $d
     /tmp/cckIjmWf.s:22     .data:0000000000000000 iap_entry
                            *COM*:0000000000000010 target
                            *COM*:0000000000000008 syncword
                            *COM*:0000000000000001 afh_enabled
                            *COM*:000000000000000a afh_map
                            *COM*:0000000000000001 a1
                            *COM*:0000000000000001 b
                            *COM*:0000000000000001 c1
                            *COM*:0000000000000001 e
                            *COM*:0000000000000002 d1
                            *COM*:000000000000004f bank
                            *COM*:000000000000004f afh_bank
                            *COM*:0000000000000001 used_channels
     /tmp/cckIjmWf.s:37     .text.count_bits:0000000000000000 $t
     /tmp/cckIjmWf.s:42     .text.count_bits:0000000000000000 count_bits
     /tmp/cckIjmWf.s:100    .text.precalc:0000000000000000 $t
     /tmp/cckIjmWf.s:105    .text.precalc:0000000000000000 precalc
     /tmp/cckIjmWf.s:394    .text.precalc:00000000000001f0 $d
     /tmp/cckIjmWf.s:410    .rodata:0000000000000000 $d
     /tmp/cckIjmWf.s:443    .text.perm5:0000000000000000 $t
     /tmp/cckIjmWf.s:448    .text.perm5:0000000000000000 perm5
     /tmp/cckIjmWf.s:681    .text.perm5:000000000000019c $d
     /tmp/cckIjmWf.s:687    .text.next_hop:0000000000000000 $t
     /tmp/cckIjmWf.s:692    .text.next_hop:0000000000000000 next_hop
     /tmp/cckIjmWf.s:874    .text.next_hop:0000000000000164 $d
     /tmp/cckIjmWf.s:888    .text.find_access_code:0000000000000000 $t
     /tmp/cckIjmWf.s:893    .text.find_access_code:0000000000000000 find_access_code
     /tmp/cckIjmWf.s:1053   .text.find_access_code:0000000000000120 $d
                     .debug_frame:0000000000000010 $d

NO UNDEFINED SYMBOLS
