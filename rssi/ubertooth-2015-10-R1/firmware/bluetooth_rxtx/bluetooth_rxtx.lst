ARM GAS  /tmp/ccUeeWpa.s 			page 1


   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 6
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"bluetooth_rxtx.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.data
  19              		.align	2
  22              	iap_entry:
  23 0000 F11FFF1F 		.word	536813553
  24              		.comm	target,16,8
  25              		.comm	syncword,8,8
  26              		.comm	afh_enabled,1,1
  27              		.comm	afh_map,10,4
  28              		.section	.rodata
  29              		.align	2
  32              	advertising_channels:
  33 0000 00       		.byte	0
  34 0001 0C       		.byte	12
  35 0002 27       		.byte	39
  36 0003 00       		.align	2
  39              	data_channels:
  40 0004 01       		.byte	1
  41 0005 02       		.byte	2
  42 0006 03       		.byte	3
  43 0007 04       		.byte	4
  44 0008 05       		.byte	5
  45 0009 06       		.byte	6
  46 000a 07       		.byte	7
  47 000b 08       		.byte	8
  48 000c 09       		.byte	9
  49 000d 0A       		.byte	10
  50 000e 0B       		.byte	11
  51 000f 0D       		.byte	13
  52 0010 0E       		.byte	14
  53 0011 0F       		.byte	15
  54 0012 10       		.byte	16
  55 0013 11       		.byte	17
  56 0014 12       		.byte	18
  57 0015 13       		.byte	19
  58 0016 14       		.byte	20
  59 0017 15       		.byte	21
  60 0018 16       		.byte	22
  61 0019 17       		.byte	23
  62 001a 18       		.byte	24
  63 001b 19       		.byte	25
ARM GAS  /tmp/ccUeeWpa.s 			page 2


  64 001c 1A       		.byte	26
  65 001d 1B       		.byte	27
  66 001e 1C       		.byte	28
  67 001f 1D       		.byte	29
  68 0020 1E       		.byte	30
  69 0021 1F       		.byte	31
  70 0022 20       		.byte	32
  71 0023 21       		.byte	33
  72 0024 22       		.byte	34
  73 0025 23       		.byte	35
  74 0026 24       		.byte	36
  75 0027 25       		.byte	37
  76 0028 26       		.byte	38
  77 0029 000000   		.align	2
  80              	whitening:
  81 002c 01       		.byte	1
  82 002d 01       		.byte	1
  83 002e 01       		.byte	1
  84 002f 01       		.byte	1
  85 0030 00       		.byte	0
  86 0031 01       		.byte	1
  87 0032 00       		.byte	0
  88 0033 01       		.byte	1
  89 0034 00       		.byte	0
  90 0035 01       		.byte	1
  91 0036 00       		.byte	0
  92 0037 00       		.byte	0
  93 0038 00       		.byte	0
  94 0039 00       		.byte	0
  95 003a 01       		.byte	1
  96 003b 00       		.byte	0
  97 003c 01       		.byte	1
  98 003d 01       		.byte	1
  99 003e 00       		.byte	0
 100 003f 01       		.byte	1
 101 0040 01       		.byte	1
 102 0041 01       		.byte	1
 103 0042 01       		.byte	1
 104 0043 00       		.byte	0
 105 0044 00       		.byte	0
 106 0045 01       		.byte	1
 107 0046 01       		.byte	1
 108 0047 01       		.byte	1
 109 0048 00       		.byte	0
 110 0049 00       		.byte	0
 111 004a 01       		.byte	1
 112 004b 00       		.byte	0
 113 004c 01       		.byte	1
 114 004d 00       		.byte	0
 115 004e 01       		.byte	1
 116 004f 01       		.byte	1
 117 0050 00       		.byte	0
 118 0051 00       		.byte	0
 119 0052 01       		.byte	1
 120 0053 01       		.byte	1
 121 0054 00       		.byte	0
 122 0055 00       		.byte	0
ARM GAS  /tmp/ccUeeWpa.s 			page 3


 123 0056 00       		.byte	0
 124 0057 00       		.byte	0
 125 0058 00       		.byte	0
 126 0059 01       		.byte	1
 127 005a 01       		.byte	1
 128 005b 00       		.byte	0
 129 005c 01       		.byte	1
 130 005d 01       		.byte	1
 131 005e 00       		.byte	0
 132 005f 01       		.byte	1
 133 0060 00       		.byte	0
 134 0061 01       		.byte	1
 135 0062 01       		.byte	1
 136 0063 01       		.byte	1
 137 0064 00       		.byte	0
 138 0065 01       		.byte	1
 139 0066 00       		.byte	0
 140 0067 00       		.byte	0
 141 0068 00       		.byte	0
 142 0069 01       		.byte	1
 143 006a 01       		.byte	1
 144 006b 00       		.byte	0
 145 006c 00       		.byte	0
 146 006d 01       		.byte	1
 147 006e 00       		.byte	0
 148 006f 00       		.byte	0
 149 0070 00       		.byte	0
 150 0071 01       		.byte	1
 151 0072 00       		.byte	0
 152 0073 00       		.byte	0
 153 0074 00       		.byte	0
 154 0075 00       		.byte	0
 155 0076 00       		.byte	0
 156 0077 00       		.byte	0
 157 0078 01       		.byte	1
 158 0079 00       		.byte	0
 159 007a 00       		.byte	0
 160 007b 01       		.byte	1
 161 007c 00       		.byte	0
 162 007d 00       		.byte	0
 163 007e 01       		.byte	1
 164 007f 01       		.byte	1
 165 0080 00       		.byte	0
 166 0081 01       		.byte	1
 167 0082 00       		.byte	0
 168 0083 00       		.byte	0
 169 0084 01       		.byte	1
 170 0085 01       		.byte	1
 171 0086 01       		.byte	1
 172 0087 01       		.byte	1
 173 0088 00       		.byte	0
 174 0089 01       		.byte	1
 175 008a 01       		.byte	1
 176 008b 01       		.byte	1
 177 008c 00       		.byte	0
 178 008d 00       		.byte	0
 179 008e 00       		.byte	0
ARM GAS  /tmp/ccUeeWpa.s 			page 4


 180 008f 00       		.byte	0
 181 0090 01       		.byte	1
 182 0091 01       		.byte	1
 183 0092 01       		.byte	1
 184 0093 01       		.byte	1
 185 0094 01       		.byte	1
 186 0095 01       		.byte	1
 187 0096 01       		.byte	1
 188 0097 00       		.byte	0
 189 0098 00       		.byte	0
 190 0099 00       		.byte	0
 191 009a 01       		.byte	1
 192 009b 01       		.byte	1
 193 009c 01       		.byte	1
 194 009d 00       		.byte	0
 195 009e 01       		.byte	1
 196 009f 01       		.byte	1
 197 00a0 00       		.byte	0
 198 00a1 00       		.byte	0
 199 00a2 00       		.byte	0
 200 00a3 01       		.byte	1
 201 00a4 00       		.byte	0
 202 00a5 01       		.byte	1
 203 00a6 00       		.byte	0
 204 00a7 00       		.byte	0
 205 00a8 01       		.byte	1
 206 00a9 00       		.byte	0
 207 00aa 01       		.byte	1
 208 00ab 00       		.align	2
 211              	whitening_index:
 212 00ac 46       		.byte	70
 213 00ad 3E       		.byte	62
 214 00ae 78       		.byte	120
 215 00af 6F       		.byte	111
 216 00b0 4D       		.byte	77
 217 00b1 2E       		.byte	46
 218 00b2 0F       		.byte	15
 219 00b3 65       		.byte	101
 220 00b4 42       		.byte	66
 221 00b5 27       		.byte	39
 222 00b6 1F       		.byte	31
 223 00b7 1A       		.byte	26
 224 00b8 50       		.byte	80
 225 00b9 53       		.byte	83
 226 00ba 7D       		.byte	125
 227 00bb 59       		.byte	89
 228 00bc 0A       		.byte	10
 229 00bd 23       		.byte	35
 230 00be 08       		.byte	8
 231 00bf 36       		.byte	54
 232 00c0 7A       		.byte	122
 233 00c1 11       		.byte	17
 234 00c2 21       		.byte	33
 235 00c3 00       		.byte	0
 236 00c4 3A       		.byte	58
 237 00c5 73       		.byte	115
 238 00c6 06       		.byte	6
ARM GAS  /tmp/ccUeeWpa.s 			page 5


 239 00c7 5E       		.byte	94
 240 00c8 56       		.byte	86
 241 00c9 31       		.byte	49
 242 00ca 34       		.byte	52
 243 00cb 14       		.byte	20
 244 00cc 28       		.byte	40
 245 00cd 1B       		.byte	27
 246 00ce 54       		.byte	84
 247 00cf 5A       		.byte	90
 248 00d0 3F       		.byte	63
 249 00d1 70       		.byte	112
 250 00d2 2F       		.byte	47
 251 00d3 66       		.byte	102
 252              		.align	2
 255              	hop_interval_lut:
 256 00d4 00       		.byte	0
 257 00d5 01       		.byte	1
 258 00d6 13       		.byte	19
 259 00d7 19       		.byte	25
 260 00d8 1C       		.byte	28
 261 00d9 0F       		.byte	15
 262 00da 1F       		.byte	31
 263 00db 10       		.byte	16
 264 00dc 0E       		.byte	14
 265 00dd 21       		.byte	33
 266 00de 1A       		.byte	26
 267 00df 1B       		.byte	27
 268 00e0 22       		.byte	34
 269 00e1 14       		.byte	20
 270 00e2 08       		.byte	8
 271 00e3 05       		.byte	5
 272 00e4 07       		.byte	7
 273 00e5 18       		.byte	24
 274 00e6 23       		.byte	35
 275 00e7 02       		.byte	2
 276 00e8 0D       		.byte	13
 277 00e9 1E       		.byte	30
 278 00ea 20       		.byte	32
 279 00eb 1D       		.byte	29
 280 00ec 11       		.byte	17
 281 00ed 03       		.byte	3
 282 00ee 0A       		.byte	10
 283 00ef 0B       		.byte	11
 284 00f0 04       		.byte	4
 285 00f1 17       		.byte	23
 286 00f2 15       		.byte	21
 287 00f3 06       		.byte	6
 288 00f4 16       		.byte	22
 289 00f5 09       		.byte	9
 290 00f6 0C       		.byte	12
 291 00f7 12       		.byte	18
 292 00f8 24       		.byte	36
 293 00f9 000000   		.align	2
 296              	whitening_word:
 297 00fc 40B2BCC3 		.word	-1011043776
 298 0100 1F374A5F 		.word	1598699295
 299 0104 85F69C9A 		.word	-1700989307
ARM GAS  /tmp/ccUeeWpa.s 			page 6


 300 0108 C1D6C544 		.word	1153816257
 301 010c 2059DEE1 		.word	-505521888
 302 0110 8F1BA5AF 		.word	-1348134001
 303 0114 427B4ECD 		.word	-850494654
 304 0118 60EB6222 		.word	576908128
 305 011c 902CEFF0 		.word	-252760944
 306 0120 C78DD257 		.word	1473416647
 307 0124 A13DA766 		.word	1722236321
 308 0128 B0753111 		.word	288454064
 309 012c 8940B2BC 		.word	-1129168759
 310 0130 C31F374A 		.word	1245126595
 311 0134 5F85F69C 		.word	-1661565601
 312 0138 9AC1D6C5 		.word	-975781478
 313 013c 442059DE 		.word	-564584380
 314 0140 E18F1BA5 		.word	-1524920351
 315 0144 AF427B4E 		.word	1316700847
 316 0148 CD60EB62 		.word	1659592909
 317 014c 22902CEF 		.word	-282292190
 318 0150 F0C78DD2 		.word	-762460176
 319 0154 57A13DA7 		.word	-1489133225
 320 0158 66B07531 		.word	829796454
 321 015c D257A13D 		.word	1033983954
 322 0160 A766B075 		.word	1974494887
 323 0164 31114896 		.word	-1773661903
 324 0168 77F8E346 		.word	1189345399
 325 016c E9ABD09E 		.word	-1630491671
 326 0170 5333D8BA 		.word	-1160236205
 327 0174 980824CB 		.word	-886830952
 328 0178 3BFC71A3 		.word	-1552810949
 329 017c F45568CF 		.word	-815245836
 330 0180 A9196C5D 		.word	1567365545
 331 0184 4C0492E5 		.word	-443415476
 332 0188 1DFEB851 		.word	1371078173
 333 018c 1BA5AF42 		.word	1118807323
 334 0190 7B4ECD60 		.word	1624067707
 335 0194 EB622290 		.word	-1876794645
 336 0198 2CEFF0C7 		.word	-940511444
 337 019c 8DD257A1 		.word	-1588079987
 338 01a0 3DA766B0 		.word	-1335449795
 339 01a4 75311148 		.word	1209086325
 340 01a8 9677F8E3 		.word	-470255722
 341 01ac 46E9ABD0 		.word	-794039994
 342 01b0 9E5333D8 		.word	-667724898
 343 01b4 BA980824 		.word	604543162
 344 01b8 CB3BFC71 		.word	1912355787
 345 01bc 6479873F 		.word	1065843044
 346 01c0 6E94BE0A 		.word	180261998
 347 01c4 ED393583 		.word	-2093663763
 348 01c8 AD8B8940 		.word	1082756013
 349 01cc B2BCC31F 		.word	532921522
 350 01d0 374A5F85 		.word	-2057352649
 351 01d4 F69C9AC1 		.word	-1046831882
 352 01d8 D6C54420 		.word	541378006
 353 01dc 59DEE18F 		.word	-1881022887
 354 01e0 1BA5AF42 		.word	1118807323
 355 01e4 7B4ECD60 		.word	1624067707
 356 01e8 EB622290 		.word	-1876794645
ARM GAS  /tmp/ccUeeWpa.s 			page 7


 357 01ec AD8B8940 		.word	1082756013
 358 01f0 B2BCC31F 		.word	532921522
 359 01f4 374A5F85 		.word	-2057352649
 360 01f8 F69C9AC1 		.word	-1046831882
 361 01fc D6C54420 		.word	541378006
 362 0200 59DEE18F 		.word	-1881022887
 363 0204 1BA5AF42 		.word	1118807323
 364 0208 7B4ECD60 		.word	1624067707
 365 020c EB622290 		.word	-1876794645
 366 0210 2CEFF0C7 		.word	-940511444
 367 0214 8DD257A1 		.word	-1588079987
 368 0218 3DA766B0 		.word	-1335449795
 369 021c F69C9AC1 		.word	-1046831882
 370 0220 D6C54420 		.word	541378006
 371 0224 59DEE18F 		.word	-1881022887
 372 0228 1BA5AF42 		.word	1118807323
 373 022c 7B4ECD60 		.word	1624067707
 374 0230 EB622290 		.word	-1876794645
 375 0234 2CEFF0C7 		.word	-940511444
 376 0238 8DD257A1 		.word	-1588079987
 377 023c 3DA766B0 		.word	-1335449795
 378 0240 75311148 		.word	1209086325
 379 0244 9677F8E3 		.word	-470255722
 380 0248 46E9ABD0 		.word	-794039994
 381 024c 3F6E94BE 		.word	-1097568705
 382 0250 0AED3935 		.word	892988682
 383 0254 83AD8B89 		.word	-1987334781
 384 0258 40B2BCC3 		.word	-1011043776
 385 025c 1F374A5F 		.word	1598699295
 386 0260 85F69C9A 		.word	-1700989307
 387 0264 C1D6C544 		.word	1153816257
 388 0268 2059DEE1 		.word	-505521888
 389 026c 8F1BA5AF 		.word	-1348134001
 390 0270 427B4ECD 		.word	-850494654
 391 0274 60EB6222 		.word	576908128
 392 0278 902CEFF0 		.word	-252760944
 393 027c 0824CB3B 		.word	1003168776
 394 0280 FC71A3F4 		.word	-190615044
 395 0284 5568CFA9 		.word	-1446025131
 396 0288 196C5D4C 		.word	1281190937
 397 028c 0492E51D 		.word	501584388
 398 0290 FEB851FA 		.word	-95307522
 399 0294 2AB4E7D4 		.word	-723012566
 400 0298 0CB62E26 		.word	640595468
 401 029c 02C9F20E 		.word	250792194
 402 02a0 7FDC287D 		.word	2099829887
 403 02a4 15DA736A 		.word	1785977365
 404 02a8 065B1713 		.word	320297734
 405 02ac C1D6C544 		.word	1153816257
 406 02b0 2059DEE1 		.word	-505521888
 407 02b4 8F1BA5AF 		.word	-1348134001
 408 02b8 427B4ECD 		.word	-850494654
 409 02bc 60EB6222 		.word	576908128
 410 02c0 902CEFF0 		.word	-252760944
 411 02c4 C78DD257 		.word	1473416647
 412 02c8 A13DA766 		.word	1722236321
 413 02cc B0753111 		.word	288454064
ARM GAS  /tmp/ccUeeWpa.s 			page 8


 414 02d0 489677F8 		.word	-126380472
 415 02d4 E346E9AB 		.word	-1410775325
 416 02d8 D09E5333 		.word	861118160
 417 02dc 9AC1D6C5 		.word	-975781478
 418 02e0 442059DE 		.word	-564584380
 419 02e4 E18F1BA5 		.word	-1524920351
 420 02e8 AF427B4E 		.word	1316700847
 421 02ec CD60EB62 		.word	1659592909
 422 02f0 22902CEF 		.word	-282292190
 423 02f4 F0C78DD2 		.word	-762460176
 424 02f8 57A13DA7 		.word	-1489133225
 425 02fc 66B07531 		.word	829796454
 426 0300 11489677 		.word	2006337553
 427 0304 F8E346E9 		.word	-381230088
 428 0308 ABD09E53 		.word	1402917035
 429 030c 5333D8BA 		.word	-1160236205
 430 0310 980824CB 		.word	-886830952
 431 0314 3BFC71A3 		.word	-1552810949
 432 0318 F45568CF 		.word	-815245836
 433 031c A9196C5D 		.word	1567365545
 434 0320 4C0492E5 		.word	-443415476
 435 0324 1DFEB851 		.word	1371078173
 436 0328 FA2AB4E7 		.word	-407622918
 437 032c D40CB62E 		.word	783682772
 438 0330 2602C9F2 		.word	-221707738
 439 0334 0E7FDC28 		.word	685539086
 440 0338 7D15DA73 		.word	1943672189
 441 033c 2CEFF0C7 		.word	-940511444
 442 0340 8DD257A1 		.word	-1588079987
 443 0344 3DA766B0 		.word	-1335449795
 444 0348 75311148 		.word	1209086325
 445 034c 9677F8E3 		.word	-470255722
 446 0350 46E9ABD0 		.word	-794039994
 447 0354 9E5333D8 		.word	-667724898
 448 0358 BA980824 		.word	604543162
 449 035c CB3BFC71 		.word	1912355787
 450 0360 A3F45568 		.word	1750463651
 451 0364 CFA9196C 		.word	1813621199
 452 0368 5D4C0492 		.word	-1845212067
 453 036c E51DFEB8 		.word	-1191305755
 454 0370 51FA2AB4 		.word	-1272251823
 455 0374 E7D40CB6 		.word	-1240673049
 456 0378 2E2602C9 		.word	-922606034
 457 037c F20E7FDC 		.word	-595652878
 458 0380 287D15DA 		.word	-636125912
 459 0384 736A065B 		.word	1527147123
 460 0388 17138164 		.word	1686180631
 461 038c 79873F6E 		.word	1849657209
 462 0390 94BE0AED 		.word	-318062956
 463 0394 393583AD 		.word	-1383910087
 464 0398 8B8940B2 		.word	-1304393333
 465 039c BE0AED39 		.word	971836094
 466 03a0 3583AD8B 		.word	-1951562955
 467 03a4 8940B2BC 		.word	-1129168759
 468 03a8 C31F374A 		.word	1245126595
 469 03ac 5F85F69C 		.word	-1661565601
 470 03b0 9AC1D6C5 		.word	-975781478
ARM GAS  /tmp/ccUeeWpa.s 			page 9


 471 03b4 442059DE 		.word	-564584380
 472 03b8 E18F1BA5 		.word	-1524920351
 473 03bc AF427B4E 		.word	1316700847
 474 03c0 CD60EB62 		.word	1659592909
 475 03c4 22902CEF 		.word	-282292190
 476 03c8 F0C78DD2 		.word	-762460176
 477 03cc 77F8E346 		.word	1189345399
 478 03d0 E9ABD09E 		.word	-1630491671
 479 03d4 5333D8BA 		.word	-1160236205
 480 03d8 980824CB 		.word	-886830952
 481 03dc 3BFC71A3 		.word	-1552810949
 482 03e0 F45568CF 		.word	-815245836
 483 03e4 A9196C5D 		.word	1567365545
 484 03e8 4C0492E5 		.word	-443415476
 485 03ec 1DFEB851 		.word	1371078173
 486 03f0 FA2AB4E7 		.word	-407622918
 487 03f4 D40CB62E 		.word	783682772
 488 03f8 2602C9F2 		.word	-221707738
 489 03fc D09E5333 		.word	861118160
 490 0400 D8BA9808 		.word	144227032
 491 0404 24CB3BFC 		.word	-63190236
 492 0408 71A3F455 		.word	1442095985
 493 040c 68CFA919 		.word	430559080
 494 0410 6C5D4C04 		.word	72113516
 495 0414 92E51DFE 		.word	-31595118
 496 0418 B851FA2A 		.word	721047992
 497 041c B4E7D40C 		.word	215279540
 498 0420 B62E2602 		.word	36056758
 499 0424 C9F20E7F 		.word	2131686089
 500 0428 DC287D15 		.word	360523996
 501 042c 196C5D4C 		.word	1281190937
 502 0430 0492E51D 		.word	501584388
 503 0434 FEB851FA 		.word	-95307522
 504 0438 2AB4E7D4 		.word	-723012566
 505 043c 0CB62E26 		.word	640595468
 506 0440 02C9F20E 		.word	250792194
 507 0444 7FDC287D 		.word	2099829887
 508 0448 15DA736A 		.word	1785977365
 509 044c 065B1713 		.word	320297734
 510 0450 81647987 		.word	-2022087551
 511 0454 3F6E94BE 		.word	-1097568705
 512 0458 0AED3935 		.word	892988682
 513 045c 427B4ECD 		.word	-850494654
 514 0460 60EB6222 		.word	576908128
 515 0464 902CEFF0 		.word	-252760944
 516 0468 C78DD257 		.word	1473416647
 517 046c A13DA766 		.word	1722236321
 518 0470 B0753111 		.word	288454064
 519 0474 489677F8 		.word	-126380472
 520 0478 E346E9AB 		.word	-1410775325
 521 047c D09E5333 		.word	861118160
 522 0480 D8BA9808 		.word	144227032
 523 0484 24CB3BFC 		.word	-63190236
 524 0488 71A3F455 		.word	1442095985
 525 048c 8B8940B2 		.word	-1304393333
 526 0490 BCC31F37 		.word	924828604
 527 0494 4A5F85F6 		.word	-159031478
ARM GAS  /tmp/ccUeeWpa.s 			page 10


 528 0498 9C9AC1D6 		.word	-691955044
 529 049c C5442059 		.word	1495286981
 530 04a0 DEE18F1B 		.word	462414302
 531 04a4 A5AF427B 		.word	2067967909
 532 04a8 4ECD60EB 		.word	-345977522
 533 04ac 6222902C 		.word	747643490
 534 04b0 EFF0C78D 		.word	-1916276497
 535 04b4 D257A13D 		.word	1033983954
 536 04b8 A766B075 		.word	1974494887
 537 04bc F45568CF 		.word	-815245836
 538 04c0 A9196C5D 		.word	1567365545
 539 04c4 4C0492E5 		.word	-443415476
 540 04c8 1DFEB851 		.word	1371078173
 541 04cc FA2AB4E7 		.word	-407622918
 542 04d0 D40CB62E 		.word	783682772
 543 04d4 2602C9F2 		.word	-221707738
 544 04d8 0E7FDC28 		.word	685539086
 545 04dc 7D15DA73 		.word	1943672189
 546 04e0 6A065B17 		.word	391841386
 547 04e4 13816479 		.word	2036629779
 548 04e8 873F6E94 		.word	-1804714105
 549 04ec 3DA766B0 		.word	-1335449795
 550 04f0 75311148 		.word	1209086325
 551 04f4 9677F8E3 		.word	-470255722
 552 04f8 46E9ABD0 		.word	-794039994
 553 04fc 9E5333D8 		.word	-667724898
 554 0500 BA980824 		.word	604543162
 555 0504 CB3BFC71 		.word	1912355787
 556 0508 A3F45568 		.word	1750463651
 557 050c CFA9196C 		.word	1813621199
 558 0510 5D4C0492 		.word	-1845212067
 559 0514 E51DFEB8 		.word	-1191305755
 560 0518 51FA2AB4 		.word	-1272251823
 561 051c 66B07531 		.word	829796454
 562 0520 11489677 		.word	2006337553
 563 0524 F8E346E9 		.word	-381230088
 564 0528 ABD09E53 		.word	1402917035
 565 052c 33D8BA98 		.word	-1732585421
 566 0530 0824CB3B 		.word	1003168776
 567 0534 FC71A3F4 		.word	-190615044
 568 0538 5568CFA9 		.word	-1446025131
 569 053c 196C5D4C 		.word	1281190937
 570 0540 0492E51D 		.word	501584388
 571 0544 FEB851FA 		.word	-95307522
 572 0548 2AB4E7D4 		.word	-723012566
 573 054c AF427B4E 		.word	1316700847
 574 0550 CD60EB62 		.word	1659592909
 575 0554 22902CEF 		.word	-282292190
 576 0558 F0C78DD2 		.word	-762460176
 577 055c 57A13DA7 		.word	-1489133225
 578 0560 66B07531 		.word	829796454
 579 0564 11489677 		.word	2006337553
 580 0568 F8E346E9 		.word	-381230088
 581 056c ABD09E53 		.word	1402917035
 582 0570 33D8BA98 		.word	-1732585421
 583 0574 0824CB3B 		.word	1003168776
 584 0578 FC71A3F4 		.word	-190615044
ARM GAS  /tmp/ccUeeWpa.s 			page 11


 585 057c 980824CB 		.word	-886830952
 586 0580 3BFC71A3 		.word	-1552810949
 587 0584 F45568CF 		.word	-815245836
 588 0588 A9196C5D 		.word	1567365545
 589 058c 4C0492E5 		.word	-443415476
 590 0590 1DFEB851 		.word	1371078173
 591 0594 FA2AB4E7 		.word	-407622918
 592 0598 D40CB62E 		.word	783682772
 593 059c 2602C9F2 		.word	-221707738
 594 05a0 0E7FDC28 		.word	685539086
 595 05a4 7D15DA73 		.word	1943672189
 596 05a8 6A065B17 		.word	391841386
 597 05ac 51FA2AB4 		.word	-1272251823
 598 05b0 E7D40CB6 		.word	-1240673049
 599 05b4 2E2602C9 		.word	-922606034
 600 05b8 F20E7FDC 		.word	-595652878
 601 05bc 287D15DA 		.word	-636125912
 602 05c0 736A065B 		.word	1527147123
 603 05c4 17138164 		.word	1686180631
 604 05c8 79873F6E 		.word	1849657209
 605 05cc 94BE0AED 		.word	-318062956
 606 05d0 393583AD 		.word	-1383910087
 607 05d4 8B8940B2 		.word	-1304393333
 608 05d8 BCC31F37 		.word	924828604
 609 05dc 0AED3935 		.word	892988682
 610 05e0 83AD8B89 		.word	-1987334781
 611 05e4 40B2BCC3 		.word	-1011043776
 612 05e8 1F374A5F 		.word	1598699295
 613 05ec 85F69C9A 		.word	-1700989307
 614 05f0 C1D6C544 		.word	1153816257
 615 05f4 2059DEE1 		.word	-505521888
 616 05f8 8F1BA5AF 		.word	-1348134001
 617 05fc 427B4ECD 		.word	-850494654
 618 0600 60EB6222 		.word	576908128
 619 0604 902CEFF0 		.word	-252760944
 620 0608 C78DD257 		.word	1473416647
 621 060c C31F374A 		.word	1245126595
 622 0610 5F85F69C 		.word	-1661565601
 623 0614 9AC1D6C5 		.word	-975781478
 624 0618 442059DE 		.word	-564584380
 625 061c E18F1BA5 		.word	-1524920351
 626 0620 AF427B4E 		.word	1316700847
 627 0624 CD60EB62 		.word	1659592909
 628 0628 22902CEF 		.word	-282292190
 629 062c F0C78DD2 		.word	-762460176
 630 0630 57A13DA7 		.word	-1489133225
 631 0634 66B07531 		.word	829796454
 632 0638 11489677 		.word	2006337553
 633 063c BCC31F37 		.word	924828604
 634 0640 4A5F85F6 		.word	-159031478
 635 0644 9C9AC1D6 		.word	-691955044
 636 0648 C5442059 		.word	1495286981
 637 064c DEE18F1B 		.word	462414302
 638 0650 A5AF427B 		.word	2067967909
 639 0654 4ECD60EB 		.word	-345977522
 640 0658 6222902C 		.word	747643490
 641 065c EFF0C78D 		.word	-1916276497
ARM GAS  /tmp/ccUeeWpa.s 			page 12


 642 0660 D257A13D 		.word	1033983954
 643 0664 A766B075 		.word	1974494887
 644 0668 31114896 		.word	-1773661903
 645 066c 75311148 		.word	1209086325
 646 0670 9677F8E3 		.word	-470255722
 647 0674 46E9ABD0 		.word	-794039994
 648 0678 9E5333D8 		.word	-667724898
 649 067c BA980824 		.word	604543162
 650 0680 CB3BFC71 		.word	1912355787
 651 0684 A3F45568 		.word	1750463651
 652 0688 CFA9196C 		.word	1813621199
 653 068c 5D4C0492 		.word	-1845212067
 654 0690 E51DFEB8 		.word	-1191305755
 655 0694 51FA2AB4 		.word	-1272251823
 656 0698 E7D40CB6 		.word	-1240673049
 657 069c 2E2602C9 		.word	-922606034
 658 06a0 F20E7FDC 		.word	-595652878
 659 06a4 287D15DA 		.word	-636125912
 660 06a8 736A065B 		.word	1527147123
 661 06ac 17138164 		.word	1686180631
 662 06b0 79873F6E 		.word	1849657209
 663 06b4 94BE0AED 		.word	-318062956
 664 06b8 393583AD 		.word	-1383910087
 665 06bc 8B8940B2 		.word	-1304393333
 666 06c0 BCC31F37 		.word	924828604
 667 06c4 4A5F85F6 		.word	-159031478
 668 06c8 9C9AC1D6 		.word	-691955044
 669 06cc E7D40CB6 		.word	-1240673049
 670 06d0 2E2602C9 		.word	-922606034
 671 06d4 F20E7FDC 		.word	-595652878
 672 06d8 287D15DA 		.word	-636125912
 673 06dc 736A065B 		.word	1527147123
 674 06e0 17138164 		.word	1686180631
 675 06e4 79873F6E 		.word	1849657209
 676 06e8 94BE0AED 		.word	-318062956
 677 06ec 393583AD 		.word	-1383910087
 678 06f0 8B8940B2 		.word	-1304393333
 679 06f4 BCC31F37 		.word	924828604
 680 06f8 4A5F85F6 		.word	-159031478
 681 06fc 60EB6222 		.word	576908128
 682 0700 902CEFF0 		.word	-252760944
 683 0704 C78DD257 		.word	1473416647
 684 0708 A13DA766 		.word	1722236321
 685 070c B0753111 		.word	288454064
 686 0710 489677F8 		.word	-126380472
 687 0714 E346E9AB 		.word	-1410775325
 688 0718 D09E5333 		.word	861118160
 689 071c D8BA9808 		.word	144227032
 690 0720 24CB3BFC 		.word	-63190236
 691 0724 71A3F455 		.word	1442095985
 692 0728 68CFA919 		.word	430559080
 693 072c A9196C5D 		.word	1567365545
 694 0730 4C0492E5 		.word	-443415476
 695 0734 1DFEB851 		.word	1371078173
 696 0738 FA2AB4E7 		.word	-407622918
 697 073c D40CB62E 		.word	783682772
 698 0740 2602C9F2 		.word	-221707738
ARM GAS  /tmp/ccUeeWpa.s 			page 13


 699 0744 0E7FDC28 		.word	685539086
 700 0748 7D15DA73 		.word	1943672189
 701 074c 6A065B17 		.word	391841386
 702 0750 13816479 		.word	2036629779
 703 0754 873F6E94 		.word	-1804714105
 704 0758 BE0AED39 		.word	971836094
 705 075c F20E7FDC 		.word	-595652878
 706 0760 287D15DA 		.word	-636125912
 707 0764 736A065B 		.word	1527147123
 708 0768 17138164 		.word	1686180631
 709 076c 79873F6E 		.word	1849657209
 710 0770 94BE0AED 		.word	-318062956
 711 0774 393583AD 		.word	-1383910087
 712 0778 8B8940B2 		.word	-1304393333
 713 077c BCC31F37 		.word	924828604
 714 0780 4A5F85F6 		.word	-159031478
 715 0784 9C9AC1D6 		.word	-691955044
 716 0788 C5442059 		.word	1495286981
 717 078c 3BFC71A3 		.word	-1552810949
 718 0790 F45568CF 		.word	-815245836
 719 0794 A9196C5D 		.word	1567365545
 720 0798 4C0492E5 		.word	-443415476
 721 079c 1DFEB851 		.word	1371078173
 722 07a0 FA2AB4E7 		.word	-407622918
 723 07a4 D40CB62E 		.word	783682772
 724 07a8 2602C9F2 		.word	-221707738
 725 07ac 0E7FDC28 		.word	685539086
 726 07b0 7D15DA73 		.word	1943672189
 727 07b4 6A065B17 		.word	391841386
 728 07b8 13816479 		.word	2036629779
 729 07bc 442059DE 		.word	-564584380
 730 07c0 E18F1BA5 		.word	-1524920351
 731 07c4 AF427B4E 		.word	1316700847
 732 07c8 CD60EB62 		.word	1659592909
 733 07cc 22902CEF 		.word	-282292190
 734 07d0 F0C78DD2 		.word	-762460176
 735 07d4 57A13DA7 		.word	-1489133225
 736 07d8 66B07531 		.word	829796454
 737 07dc 11489677 		.word	2006337553
 738 07e0 F8E346E9 		.word	-381230088
 739 07e4 ABD09E53 		.word	1402917035
 740 07e8 33D8BA98 		.word	-1732585421
 741 07ec 8DD257A1 		.word	-1588079987
 742 07f0 3DA766B0 		.word	-1335449795
 743 07f4 75311148 		.word	1209086325
 744 07f8 9677F8E3 		.word	-470255722
 745 07fc 46E9ABD0 		.word	-794039994
 746 0800 9E5333D8 		.word	-667724898
 747 0804 BA980824 		.word	604543162
 748 0808 CB3BFC71 		.word	1912355787
 749 080c A3F45568 		.word	1750463651
 750 0810 CFA9196C 		.word	1813621199
 751 0814 5D4C0492 		.word	-1845212067
 752 0818 E51DFEB8 		.word	-1191305755
 753 081c D6C54420 		.word	541378006
 754 0820 59DEE18F 		.word	-1881022887
 755 0824 1BA5AF42 		.word	1118807323
ARM GAS  /tmp/ccUeeWpa.s 			page 14


 756 0828 7B4ECD60 		.word	1624067707
 757 082c EB622290 		.word	-1876794645
 758 0830 2CEFF0C7 		.word	-940511444
 759 0834 8DD257A1 		.word	-1588079987
 760 0838 3DA766B0 		.word	-1335449795
 761 083c 75311148 		.word	1209086325
 762 0840 9677F8E3 		.word	-470255722
 763 0844 46E9ABD0 		.word	-794039994
 764 0848 9E5333D8 		.word	-667724898
 765 084c 1F374A5F 		.word	1598699295
 766 0850 85F69C9A 		.word	-1700989307
 767 0854 C1D6C544 		.word	1153816257
 768 0858 2059DEE1 		.word	-505521888
 769 085c 8F1BA5AF 		.word	-1348134001
 770 0860 427B4ECD 		.word	-850494654
 771 0864 60EB6222 		.word	576908128
 772 0868 902CEFF0 		.word	-252760944
 773 086c C78DD257 		.word	1473416647
 774 0870 A13DA766 		.word	1722236321
 775 0874 B0753111 		.word	288454064
 776 0878 489677F8 		.word	-126380472
 777              		.comm	rr,5,4
 778              		.global	compile_info
 779              		.align	2
 782              	compile_info:
 783 087c 75626572 		.ascii	"ubertooth 2015-10-R1 (root@weiping) Sat Oct 15 14:3"
 783      746F6F74 
 783      68203230 
 783      31352D31 
 783      302D5231 
 784 08af 353A3130 		.ascii	"5:10 KST 2016\000"
 784      204B5354 
 784      20323031 
 784      3600
 785              		.comm	clkn,4,4
 786              		.global	hop_mode
 787              		.bss
 790              	hop_mode:
 791 0000 00       		.space	1
 792              		.global	do_hop
 795              	do_hop:
 796 0001 00       		.space	1
 797              		.global	cs_no_squelch
 800              	cs_no_squelch:
 801 0002 00       		.space	1
 802              		.global	cs_threshold_req
 803              		.data
 806              	cs_threshold_req:
 807 0004 88       		.byte	-120
 808              		.global	cs_threshold_cur
 811              	cs_threshold_cur:
 812 0005 88       		.byte	-120
 813              		.comm	cs_trigger,1,1
 814              		.comm	keepalive_trigger,1,1
 815              		.comm	cs_timestamp,4,4
 816              		.global	hop_direct_channel
 817              		.bss
ARM GAS  /tmp/ccUeeWpa.s 			page 15


 818 0003 00       		.align	1
 821              	hop_direct_channel:
 822 0004 0000     		.space	2
 823              		.global	clock_trim
 824 0006 0000     		.align	2
 827              	clock_trim:
 828 0008 00000000 		.space	4
 829              		.comm	idle_buf_clkn_high,4,4
 830              		.comm	active_buf_clkn_high,4,4
 831              		.comm	idle_buf_clk100ns,4,4
 832              		.comm	active_buf_clk100ns,4,4
 833              		.global	idle_buf_channel
 834              		.align	1
 837              	idle_buf_channel:
 838 000c 0000     		.space	2
 839              		.global	active_buf_channel
 840              		.align	1
 843              	active_buf_channel:
 844 000e 0000     		.space	2
 845              		.global	slave_mac_address
 846              		.align	2
 849              	slave_mac_address:
 850 0010 00000000 		.space	6
 850      0000
 851              		.comm	rxbuf1,50,4
 852              		.comm	rxbuf2,50,4
 853              		.global	active_rxbuf
 854              		.data
 855 0006 0000     		.align	2
 858              	active_rxbuf:
 859 0008 00000000 		.word	rxbuf1
 860              		.global	idle_rxbuf
 861              		.align	2
 864              	idle_rxbuf:
 865 000c 00000000 		.word	rxbuf2
 866              		.global	le
 867              		.align	2
 870              	le:
 871 0010 D6BE898E 		.word	-1903575338
 872 0014 7D6B     		.short	27517
 873 0016 7191     		.short	-28303
 874 0018 55555500 		.word	5592405
 875 001c AAAAAA00 		.word	11184810
 876 0020 01000000 		.word	1
 877 0024 00       		.byte	0
 878 0025 000000   		.space	3
 879 0028 00000000 		.word	0
 880 002c 00000000 		.space	32
 880      00000000 
 880      00000000 
 880      00000000 
 880      00000000 
 881 004c 00000000 		.word	0
 882 0050 00000000 		.word	0
 883              		.comm	le_promisc,264,4
 884              		.global	le_jam_count
 885              		.bss
ARM GAS  /tmp/ccUeeWpa.s 			page 16


 886 0016 0000     		.align	2
 889              	le_jam_count:
 890 0018 00000000 		.space	4
 891              		.global	data_cb
 892              		.align	2
 895              	data_cb:
 896 001c 00000000 		.space	4
 897              		.global	packet_cb
 898              		.align	2
 901              	packet_cb:
 902 0020 00000000 		.space	4
 903              		.global	rssi_iir
 904              		.align	2
 907              	rssi_iir:
 908 0024 00000000 		.space	158
 908      00000000 
 908      00000000 
 908      00000000 
 908      00000000 
 909              		.comm	unpacked,800,4
 910              		.global	mode
 913              	mode:
 914 00c2 00       		.space	1
 915              		.global	requested_mode
 918              	requested_mode:
 919 00c3 00       		.space	1
 920              		.global	jam_mode
 923              	jam_mode:
 924 00c4 00       		.space	1
 925              		.global	ego_mode
 928              	ego_mode:
 929 00c5 00       		.space	1
 930              		.global	modulation
 933              	modulation:
 934 00c6 00       		.space	1
 935              		.global	channel
 936              		.data
 937              		.align	1
 940              	channel:
 941 0054 6209     		.short	2402
 942              		.global	requested_channel
 943              		.bss
 944 00c7 00       		.align	1
 947              	requested_channel:
 948 00c8 0000     		.space	2
 949              		.global	saved_request
 950              		.align	1
 953              	saved_request:
 954 00ca 0000     		.space	2
 955              		.global	low_freq
 956              		.data
 957              		.align	1
 960              	low_freq:
 961 0056 6009     		.short	2400
 962              		.global	high_freq
 963              		.align	1
 966              	high_freq:
ARM GAS  /tmp/ccUeeWpa.s 			page 17


 967 0058 B309     		.short	2483
 968              		.global	rssi_threshold
 971              	rssi_threshold:
 972 005a E2       		.byte	-30
 973              		.comm	rx_dma_lli1,16,4
 974              		.comm	rx_dma_lli2,16,4
 975              		.comm	le_dma_lli,176,4
 976              		.comm	rx_tc,4,4
 977              		.comm	rx_err,4,4
 978              		.global	status
 979              		.bss
 982              	status:
 983 00cc 00       		.space	1
 984              		.comm	rssi_max,1,1
 985              		.comm	rssi_min,1,1
 986              		.global	rssi_count
 989              	rssi_count:
 990 00cd 00       		.space	1
 991              		.global	rssi_sum
 992 00ce 0000     		.align	2
 995              	rssi_sum:
 996 00d0 00000000 		.space	4
 997              		.section	.text.rssi_reset,"ax",%progbits
 998              		.align	2
 999              		.thumb
 1000              		.thumb_func
 1002              	rssi_reset:
 1003              	.LFB0:
 1004              		.file 1 "bluetooth_rxtx.c"
   1:bluetooth_rxtx.c **** /*
   2:bluetooth_rxtx.c ****  * Copyright 2010-2013 Michael Ossmann
   3:bluetooth_rxtx.c ****  * Copyright 2011-2013 Dominic Spill
   4:bluetooth_rxtx.c ****  *
   5:bluetooth_rxtx.c ****  * This file is part of Project Ubertooth.
   6:bluetooth_rxtx.c ****  *
   7:bluetooth_rxtx.c ****  * This program is free software; you can redistribute it and/or modify
   8:bluetooth_rxtx.c ****  * it under the terms of the GNU General Public License as published by
   9:bluetooth_rxtx.c ****  * the Free Software Foundation; either version 2, or (at your option)
  10:bluetooth_rxtx.c ****  * any later version.
  11:bluetooth_rxtx.c ****  *
  12:bluetooth_rxtx.c ****  * This program is distributed in the hope that it will be useful,
  13:bluetooth_rxtx.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  14:bluetooth_rxtx.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  15:bluetooth_rxtx.c ****  * GNU General Public License for more details.
  16:bluetooth_rxtx.c ****  *
  17:bluetooth_rxtx.c ****  * You should have received a copy of the GNU General Public License
  18:bluetooth_rxtx.c ****  * along with this program; see the file COPYING.  If not, write to
  19:bluetooth_rxtx.c ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  20:bluetooth_rxtx.c ****  * Boston, MA 02110-1301, USA.
  21:bluetooth_rxtx.c ****  */
  22:bluetooth_rxtx.c **** 
  23:bluetooth_rxtx.c **** #include <string.h>
  24:bluetooth_rxtx.c **** 
  25:bluetooth_rxtx.c **** #include "ubertooth.h"
  26:bluetooth_rxtx.c **** #include "ubertooth_usb.h"
  27:bluetooth_rxtx.c **** #include "ubertooth_interface.h"
  28:bluetooth_rxtx.c **** #include "bluetooth.h"
ARM GAS  /tmp/ccUeeWpa.s 			page 18


  29:bluetooth_rxtx.c **** #include "bluetooth_le.h"
  30:bluetooth_rxtx.c **** #include "cc2400_rangetest.h"
  31:bluetooth_rxtx.c **** #include "ego.h"
  32:bluetooth_rxtx.c **** 
  33:bluetooth_rxtx.c **** #define MIN(x,y)	((x)<(y)?(x):(y))
  34:bluetooth_rxtx.c **** #define MAX(x,y)	((x)>(y)?(x):(y))
  35:bluetooth_rxtx.c **** 
  36:bluetooth_rxtx.c **** /* build info */
  37:bluetooth_rxtx.c **** const char compile_info[] =
  38:bluetooth_rxtx.c **** 	"ubertooth " GIT_REVISION " (" COMPILE_BY "@" COMPILE_HOST ") " TIMESTAMP;
  39:bluetooth_rxtx.c **** 
  40:bluetooth_rxtx.c **** /*
  41:bluetooth_rxtx.c ****  * CLK100NS is a free-running clock with a period of 100 ns.  It resets every
  42:bluetooth_rxtx.c ****  * 2^15 * 10^5 cycles (about 5.5 minutes) - computed from clkn and timer0 (T0TC)
  43:bluetooth_rxtx.c ****  *
  44:bluetooth_rxtx.c ****  * clkn is the native (local) clock as defined in the Bluetooth specification.
  45:bluetooth_rxtx.c ****  * It advances 3200 times per second.  Two clkn periods make a Bluetooth time
  46:bluetooth_rxtx.c ****  * slot.
  47:bluetooth_rxtx.c ****  */
  48:bluetooth_rxtx.c **** 
  49:bluetooth_rxtx.c **** volatile u32 clkn;                       // clkn 3200 Hz counter
  50:bluetooth_rxtx.c **** #define CLK100NS (3125*(clkn & 0xfffff) + T0TC)
  51:bluetooth_rxtx.c **** #define LE_BASECLK (12500)               // 1.25 ms in units of 100ns
  52:bluetooth_rxtx.c **** 
  53:bluetooth_rxtx.c **** #define HOP_NONE      0
  54:bluetooth_rxtx.c **** #define HOP_SWEEP     1
  55:bluetooth_rxtx.c **** #define HOP_BLUETOOTH 2
  56:bluetooth_rxtx.c **** #define HOP_BTLE      3
  57:bluetooth_rxtx.c **** #define HOP_DIRECT    4
  58:bluetooth_rxtx.c **** 
  59:bluetooth_rxtx.c **** #define CS_THRESHOLD_DEFAULT (uint8_t)(-120)
  60:bluetooth_rxtx.c **** #define CS_HOLD_TIME  2                     // min pkts to send on trig (>=1)
  61:bluetooth_rxtx.c **** u8 hop_mode = HOP_NONE;
  62:bluetooth_rxtx.c **** volatile u8 do_hop = 0;                     // set by timer interrupt
  63:bluetooth_rxtx.c **** 
  64:bluetooth_rxtx.c **** u8 cs_no_squelch = 0;                       // rx all packets if set
  65:bluetooth_rxtx.c **** int8_t cs_threshold_req=CS_THRESHOLD_DEFAULT; // requested CS threshold in dBm
  66:bluetooth_rxtx.c **** int8_t cs_threshold_cur=CS_THRESHOLD_DEFAULT; // current CS threshold in dBm
  67:bluetooth_rxtx.c **** volatile u8 cs_trigger;                     // set by intr on P2.2 falling (CS)
  68:bluetooth_rxtx.c **** volatile u8 keepalive_trigger;              // set by timer 1/s
  69:bluetooth_rxtx.c **** volatile u32 cs_timestamp;                  // CLK100NS at time of cs_trigger
  70:bluetooth_rxtx.c **** u16 hop_direct_channel = 0;                 // for hopping directly to a channel
  71:bluetooth_rxtx.c **** int clock_trim = 0;                         // to counteract clock drift
  72:bluetooth_rxtx.c **** volatile u32 idle_buf_clkn_high;
  73:bluetooth_rxtx.c **** volatile u32 active_buf_clkn_high;
  74:bluetooth_rxtx.c **** volatile u32 idle_buf_clk100ns;
  75:bluetooth_rxtx.c **** volatile u32 active_buf_clk100ns;
  76:bluetooth_rxtx.c **** volatile u16 idle_buf_channel = 0;
  77:bluetooth_rxtx.c **** volatile u16 active_buf_channel = 0;
  78:bluetooth_rxtx.c **** u8 slave_mac_address[6] = { 0, };
  79:bluetooth_rxtx.c **** 
  80:bluetooth_rxtx.c **** /* DMA buffers */
  81:bluetooth_rxtx.c **** u8 rxbuf1[DMA_SIZE];
  82:bluetooth_rxtx.c **** u8 rxbuf2[DMA_SIZE];
  83:bluetooth_rxtx.c **** 
  84:bluetooth_rxtx.c **** /*
  85:bluetooth_rxtx.c ****  * The active buffer is the one with an active DMA transfer.
ARM GAS  /tmp/ccUeeWpa.s 			page 19


  86:bluetooth_rxtx.c ****  * The idle buffer is the one we can read/write between transfers.
  87:bluetooth_rxtx.c ****  */
  88:bluetooth_rxtx.c **** u8 *active_rxbuf = &rxbuf1[0];
  89:bluetooth_rxtx.c **** u8 *idle_rxbuf = &rxbuf2[0];
  90:bluetooth_rxtx.c **** 
  91:bluetooth_rxtx.c **** le_state_t le = {
  92:bluetooth_rxtx.c **** 	.access_address = 0x8e89bed6,           // advertising channel access address
  93:bluetooth_rxtx.c **** 	.synch = 0x6b7d,                        // bit-reversed adv channel AA
  94:bluetooth_rxtx.c **** 	.syncl = 0x9171,
  95:bluetooth_rxtx.c **** 	.crc_init  = 0x555555,                  // advertising channel CRCInit
  96:bluetooth_rxtx.c **** 	.crc_init_reversed = 0xAAAAAA,
  97:bluetooth_rxtx.c **** 	.crc_verify = 1,
  98:bluetooth_rxtx.c **** 
  99:bluetooth_rxtx.c **** 	.link_state = LINK_INACTIVE,
 100:bluetooth_rxtx.c **** 	.conn_epoch = 0,
 101:bluetooth_rxtx.c **** 	.target_set = 0,
 102:bluetooth_rxtx.c **** 	.last_packet = 0,
 103:bluetooth_rxtx.c **** };
 104:bluetooth_rxtx.c **** 
 105:bluetooth_rxtx.c **** typedef struct _le_promisc_active_aa_t {
 106:bluetooth_rxtx.c **** 	u32 aa;
 107:bluetooth_rxtx.c **** 	int count;
 108:bluetooth_rxtx.c **** } le_promisc_active_aa_t;
 109:bluetooth_rxtx.c **** 
 110:bluetooth_rxtx.c **** typedef struct _le_promisc_state_t {
 111:bluetooth_rxtx.c **** 	// LFU cache of recently seen AA's
 112:bluetooth_rxtx.c **** 	le_promisc_active_aa_t active_aa[32];
 113:bluetooth_rxtx.c **** 
 114:bluetooth_rxtx.c **** 	// recovering hop interval
 115:bluetooth_rxtx.c **** 	u32 smallest_hop_interval;
 116:bluetooth_rxtx.c **** 	int consec_intervals;
 117:bluetooth_rxtx.c **** } le_promisc_state_t;
 118:bluetooth_rxtx.c **** le_promisc_state_t le_promisc;
 119:bluetooth_rxtx.c **** #define AA_LIST_SIZE (int)(sizeof(le_promisc.active_aa) / sizeof(le_promisc_active_aa_t))
 120:bluetooth_rxtx.c **** 
 121:bluetooth_rxtx.c **** /* LE jamming */
 122:bluetooth_rxtx.c **** #define JAM_COUNT_DEFAULT 40
 123:bluetooth_rxtx.c **** int le_jam_count = 0;
 124:bluetooth_rxtx.c **** 
 125:bluetooth_rxtx.c **** /* set LE access address */
 126:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa);
 127:bluetooth_rxtx.c **** 
 128:bluetooth_rxtx.c **** typedef int (*data_cb_t)(char *);
 129:bluetooth_rxtx.c **** data_cb_t data_cb = NULL;
 130:bluetooth_rxtx.c **** 
 131:bluetooth_rxtx.c **** typedef void (*packet_cb_t)(u8 *);
 132:bluetooth_rxtx.c **** packet_cb_t packet_cb = NULL;
 133:bluetooth_rxtx.c **** 
 134:bluetooth_rxtx.c **** /* Moving average (IIR) of average RSSI of packets as scaled integers (x256). */
 135:bluetooth_rxtx.c **** int16_t rssi_iir[79] = {0};
 136:bluetooth_rxtx.c **** #define RSSI_IIR_ALPHA 3       // 3/256 = .012
 137:bluetooth_rxtx.c **** 
 138:bluetooth_rxtx.c **** /*
 139:bluetooth_rxtx.c ****  * CLK_TUNE_TIME is the duration in units of 100 ns that we reserve for tuning
 140:bluetooth_rxtx.c ****  * the radio while frequency hopping.  We start the tuning process
 141:bluetooth_rxtx.c ****  * CLK_TUNE_TIME * 100 ns prior to the start of an upcoming time slot.
 142:bluetooth_rxtx.c **** */
ARM GAS  /tmp/ccUeeWpa.s 			page 20


 143:bluetooth_rxtx.c **** #define CLK_TUNE_TIME   2250
 144:bluetooth_rxtx.c **** 
 145:bluetooth_rxtx.c **** /* Unpacked symbol buffers (two rxbufs) */
 146:bluetooth_rxtx.c **** char unpacked[DMA_SIZE*8*2];
 147:bluetooth_rxtx.c **** 
 148:bluetooth_rxtx.c **** volatile u8 mode = MODE_IDLE;
 149:bluetooth_rxtx.c **** volatile u8 requested_mode = MODE_IDLE;
 150:bluetooth_rxtx.c **** volatile u8 jam_mode = JAM_NONE;
 151:bluetooth_rxtx.c **** volatile u8 ego_mode = 0;
 152:bluetooth_rxtx.c **** volatile u8 modulation = MOD_BT_BASIC_RATE;
 153:bluetooth_rxtx.c **** volatile u16 channel = 2402;
 154:bluetooth_rxtx.c **** volatile u16 requested_channel = 0;
 155:bluetooth_rxtx.c **** volatile u16 saved_request = 0;
 156:bluetooth_rxtx.c **** volatile u16 low_freq = 2400;
 157:bluetooth_rxtx.c **** volatile u16 high_freq = 2483;
 158:bluetooth_rxtx.c **** volatile int8_t rssi_threshold = -30;  // -54dBm - 30 = -84dBm
 159:bluetooth_rxtx.c **** 
 160:bluetooth_rxtx.c **** /* DMA linked list items */
 161:bluetooth_rxtx.c **** typedef struct {
 162:bluetooth_rxtx.c **** 	u32 src;
 163:bluetooth_rxtx.c **** 	u32 dest;
 164:bluetooth_rxtx.c **** 	u32 next_lli;
 165:bluetooth_rxtx.c **** 	u32 control;
 166:bluetooth_rxtx.c **** } dma_lli;
 167:bluetooth_rxtx.c **** 
 168:bluetooth_rxtx.c **** dma_lli rx_dma_lli1;
 169:bluetooth_rxtx.c **** dma_lli rx_dma_lli2;
 170:bluetooth_rxtx.c **** 
 171:bluetooth_rxtx.c **** dma_lli le_dma_lli[11]; // 11 x 4 bytes
 172:bluetooth_rxtx.c **** 
 173:bluetooth_rxtx.c **** /* rx terminal count and error interrupt counters */
 174:bluetooth_rxtx.c **** volatile u32 rx_tc;
 175:bluetooth_rxtx.c **** volatile u32 rx_err;
 176:bluetooth_rxtx.c **** 
 177:bluetooth_rxtx.c **** /* status information byte */
 178:bluetooth_rxtx.c **** volatile u8 status = 0;
 179:bluetooth_rxtx.c **** 
 180:bluetooth_rxtx.c **** #define DMA_OVERFLOW  0x01
 181:bluetooth_rxtx.c **** #define DMA_ERROR     0x02
 182:bluetooth_rxtx.c **** #define FIFO_OVERFLOW 0x04
 183:bluetooth_rxtx.c **** #define CS_TRIGGER    0x08
 184:bluetooth_rxtx.c **** #define RSSI_TRIGGER  0x10
 185:bluetooth_rxtx.c **** 
 186:bluetooth_rxtx.c **** /*
 187:bluetooth_rxtx.c ****  * RSSI
 188:bluetooth_rxtx.c ****  */
 189:bluetooth_rxtx.c **** int8_t rssi_max;
 190:bluetooth_rxtx.c **** int8_t rssi_min;
 191:bluetooth_rxtx.c **** uint8_t rssi_count = 0;
 192:bluetooth_rxtx.c **** int32_t rssi_sum = 0;
 193:bluetooth_rxtx.c **** 
 194:bluetooth_rxtx.c **** static void rssi_reset(void)
 195:bluetooth_rxtx.c **** {
 1005              		.loc 1 195 0
 1006              		.cfi_startproc
 1007              		@ args = 0, pretend = 0, frame = 0
 1008              		@ frame_needed = 1, uses_anonymous_args = 0
ARM GAS  /tmp/ccUeeWpa.s 			page 21


 1009              		@ link register save eliminated.
 1010 0000 80B4     		push	{r7}
 1011              		.cfi_def_cfa_offset 4
 1012              		.cfi_offset 7, -4
 1013 0002 00AF     		add	r7, sp, #0
 1014              		.cfi_def_cfa_register 7
 196:bluetooth_rxtx.c **** 	rssi_count = 0;
 1015              		.loc 1 196 0
 1016 0004 074B     		ldr	r3, .L2
 1017 0006 0022     		movs	r2, #0
 1018 0008 1A70     		strb	r2, [r3]
 197:bluetooth_rxtx.c **** 	rssi_sum = 0;
 1019              		.loc 1 197 0
 1020 000a 074B     		ldr	r3, .L2+4
 1021 000c 0022     		movs	r2, #0
 1022 000e 1A60     		str	r2, [r3]
 198:bluetooth_rxtx.c **** 	rssi_max = INT8_MIN;
 1023              		.loc 1 198 0
 1024 0010 064B     		ldr	r3, .L2+8
 1025 0012 8022     		movs	r2, #128
 1026 0014 1A70     		strb	r2, [r3]
 199:bluetooth_rxtx.c **** 	rssi_min = INT8_MAX;
 1027              		.loc 1 199 0
 1028 0016 064B     		ldr	r3, .L2+12
 1029 0018 7F22     		movs	r2, #127
 1030 001a 1A70     		strb	r2, [r3]
 200:bluetooth_rxtx.c **** }
 1031              		.loc 1 200 0
 1032 001c BD46     		mov	sp, r7
 1033              		.cfi_def_cfa_register 13
 1034              		@ sp needed
 1035 001e 5DF8047B 		ldr	r7, [sp], #4
 1036              		.cfi_restore 7
 1037              		.cfi_def_cfa_offset 0
 1038 0022 7047     		bx	lr
 1039              	.L3:
 1040              		.align	2
 1041              	.L2:
 1042 0024 00000000 		.word	rssi_count
 1043 0028 00000000 		.word	rssi_sum
 1044 002c 00000000 		.word	rssi_max
 1045 0030 00000000 		.word	rssi_min
 1046              		.cfi_endproc
 1047              	.LFE0:
 1049              		.section	.text.rssi_add,"ax",%progbits
 1050              		.align	2
 1051              		.thumb
 1052              		.thumb_func
 1054              	rssi_add:
 1055              	.LFB1:
 201:bluetooth_rxtx.c **** 
 202:bluetooth_rxtx.c **** static void rssi_add(int8_t v)
 203:bluetooth_rxtx.c **** {
 1056              		.loc 1 203 0
 1057              		.cfi_startproc
 1058              		@ args = 0, pretend = 0, frame = 8
 1059              		@ frame_needed = 1, uses_anonymous_args = 0
ARM GAS  /tmp/ccUeeWpa.s 			page 22


 1060              		@ link register save eliminated.
 1061 0000 80B4     		push	{r7}
 1062              		.cfi_def_cfa_offset 4
 1063              		.cfi_offset 7, -4
 1064 0002 83B0     		sub	sp, sp, #12
 1065              		.cfi_def_cfa_offset 16
 1066 0004 00AF     		add	r7, sp, #0
 1067              		.cfi_def_cfa_register 7
 1068 0006 0346     		mov	r3, r0
 1069 0008 FB71     		strb	r3, [r7, #7]
 204:bluetooth_rxtx.c **** 	rssi_max = (v > rssi_max) ? v : rssi_max;
 1070              		.loc 1 204 0
 1071 000a 144B     		ldr	r3, .L5
 1072 000c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1073 000e 5AB2     		sxtb	r2, r3
 1074 0010 97F90730 		ldrsb	r3, [r7, #7]
 1075 0014 9342     		cmp	r3, r2
 1076 0016 B8BF     		it	lt
 1077 0018 1346     		movlt	r3, r2
 1078 001a DAB2     		uxtb	r2, r3
 1079 001c 0F4B     		ldr	r3, .L5
 1080 001e 1A70     		strb	r2, [r3]
 205:bluetooth_rxtx.c **** 	rssi_min = (v < rssi_min) ? v : rssi_min;
 1081              		.loc 1 205 0
 1082 0020 0F4B     		ldr	r3, .L5+4
 1083 0022 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1084 0024 5AB2     		sxtb	r2, r3
 1085 0026 97F90730 		ldrsb	r3, [r7, #7]
 1086 002a 9342     		cmp	r3, r2
 1087 002c A8BF     		it	ge
 1088 002e 1346     		movge	r3, r2
 1089 0030 DAB2     		uxtb	r2, r3
 1090 0032 0B4B     		ldr	r3, .L5+4
 1091 0034 1A70     		strb	r2, [r3]
 206:bluetooth_rxtx.c **** 	rssi_sum += ((int32_t)v * 256);  // scaled int math (x256)
 1092              		.loc 1 206 0
 1093 0036 97F90730 		ldrsb	r3, [r7, #7]
 1094 003a 1A02     		lsls	r2, r3, #8
 1095 003c 094B     		ldr	r3, .L5+8
 1096 003e 1B68     		ldr	r3, [r3]
 1097 0040 1344     		add	r3, r3, r2
 1098 0042 084A     		ldr	r2, .L5+8
 1099 0044 1360     		str	r3, [r2]
 207:bluetooth_rxtx.c **** 	rssi_count += 1;
 1100              		.loc 1 207 0
 1101 0046 084B     		ldr	r3, .L5+12
 1102 0048 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1103 004a 0133     		adds	r3, r3, #1
 1104 004c DAB2     		uxtb	r2, r3
 1105 004e 064B     		ldr	r3, .L5+12
 1106 0050 1A70     		strb	r2, [r3]
 208:bluetooth_rxtx.c **** }
 1107              		.loc 1 208 0
 1108 0052 0C37     		adds	r7, r7, #12
 1109              		.cfi_def_cfa_offset 4
 1110 0054 BD46     		mov	sp, r7
 1111              		.cfi_def_cfa_register 13
ARM GAS  /tmp/ccUeeWpa.s 			page 23


 1112              		@ sp needed
 1113 0056 5DF8047B 		ldr	r7, [sp], #4
 1114              		.cfi_restore 7
 1115              		.cfi_def_cfa_offset 0
 1116 005a 7047     		bx	lr
 1117              	.L6:
 1118              		.align	2
 1119              	.L5:
 1120 005c 00000000 		.word	rssi_max
 1121 0060 00000000 		.word	rssi_min
 1122 0064 00000000 		.word	rssi_sum
 1123 0068 00000000 		.word	rssi_count
 1124              		.cfi_endproc
 1125              	.LFE1:
 1127              		.section	.text.rssi_iir_update,"ax",%progbits
 1128              		.align	2
 1129              		.thumb
 1130              		.thumb_func
 1132              	rssi_iir_update:
 1133              	.LFB2:
 209:bluetooth_rxtx.c **** 
 210:bluetooth_rxtx.c **** /* For sweep mode, update IIR per channel. Otherwise, use single value. */
 211:bluetooth_rxtx.c **** static void rssi_iir_update(void)
 212:bluetooth_rxtx.c **** {
 1134              		.loc 1 212 0
 1135              		.cfi_startproc
 1136              		@ args = 0, pretend = 0, frame = 16
 1137              		@ frame_needed = 1, uses_anonymous_args = 0
 1138              		@ link register save eliminated.
 1139 0000 80B4     		push	{r7}
 1140              		.cfi_def_cfa_offset 4
 1141              		.cfi_offset 7, -4
 1142 0002 85B0     		sub	sp, sp, #20
 1143              		.cfi_def_cfa_offset 24
 1144 0004 00AF     		add	r7, sp, #0
 1145              		.cfi_def_cfa_register 7
 213:bluetooth_rxtx.c **** 	int i;
 214:bluetooth_rxtx.c **** 	int32_t avg;
 215:bluetooth_rxtx.c **** 	int32_t rssi_iir_acc;
 216:bluetooth_rxtx.c **** 
 217:bluetooth_rxtx.c **** 	/* Use array to track 79 Bluetooth channels, or just first
 218:bluetooth_rxtx.c **** 	 * slot of array if not sweeping. */
 219:bluetooth_rxtx.c **** 	if (hop_mode > 0)
 1146              		.loc 1 219 0
 1147 0006 1F4B     		ldr	r3, .L13
 1148 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1149 000a 002B     		cmp	r3, #0
 1150 000c 06D0     		beq	.L8
 220:bluetooth_rxtx.c **** 		i = channel - 2402;
 1151              		.loc 1 220 0
 1152 000e 1E4B     		ldr	r3, .L13+4
 1153 0010 1B88     		ldrh	r3, [r3]	@ movhi
 1154 0012 9BB2     		uxth	r3, r3
 1155 0014 A3F66213 		subw	r3, r3, #2402
 1156 0018 FB60     		str	r3, [r7, #12]
 1157 001a 01E0     		b	.L9
 1158              	.L8:
ARM GAS  /tmp/ccUeeWpa.s 			page 24


 221:bluetooth_rxtx.c **** 	else
 222:bluetooth_rxtx.c **** 		i = 0;
 1159              		.loc 1 222 0
 1160 001c 0023     		movs	r3, #0
 1161 001e FB60     		str	r3, [r7, #12]
 1162              	.L9:
 223:bluetooth_rxtx.c **** 
 224:bluetooth_rxtx.c **** 	// IIR using scaled int math (x256)
 225:bluetooth_rxtx.c **** 	if (rssi_count != 0)
 1163              		.loc 1 225 0
 1164 0020 1A4B     		ldr	r3, .L13+8
 1165 0022 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1166 0024 002B     		cmp	r3, #0
 1167 0026 08D0     		beq	.L10
 226:bluetooth_rxtx.c **** 		avg = (rssi_sum  + 128) / rssi_count;
 1168              		.loc 1 226 0
 1169 0028 194B     		ldr	r3, .L13+12
 1170 002a 1B68     		ldr	r3, [r3]
 1171 002c 8033     		adds	r3, r3, #128
 1172 002e 174A     		ldr	r2, .L13+8
 1173 0030 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 1174 0032 93FBF2F3 		sdiv	r3, r3, r2
 1175 0036 BB60     		str	r3, [r7, #8]
 1176 0038 01E0     		b	.L11
 1177              	.L10:
 227:bluetooth_rxtx.c **** 	else
 228:bluetooth_rxtx.c **** 		avg = 0; // really an error
 1178              		.loc 1 228 0
 1179 003a 0023     		movs	r3, #0
 1180 003c BB60     		str	r3, [r7, #8]
 1181              	.L11:
 229:bluetooth_rxtx.c **** 	rssi_iir_acc = rssi_iir[i] * (256-RSSI_IIR_ALPHA);
 1182              		.loc 1 229 0
 1183 003e 154A     		ldr	r2, .L13+16
 1184 0040 FB68     		ldr	r3, [r7, #12]
 1185 0042 32F81330 		ldrh	r3, [r2, r3, lsl #1]
 1186 0046 1AB2     		sxth	r2, r3
 1187 0048 1346     		mov	r3, r2
 1188 004a 9B01     		lsls	r3, r3, #6
 1189 004c 9B1A     		subs	r3, r3, r2
 1190 004e 9B00     		lsls	r3, r3, #2
 1191 0050 1344     		add	r3, r3, r2
 1192 0052 7B60     		str	r3, [r7, #4]
 230:bluetooth_rxtx.c **** 	rssi_iir_acc += avg * RSSI_IIR_ALPHA;
 1193              		.loc 1 230 0
 1194 0054 BA68     		ldr	r2, [r7, #8]
 1195 0056 1346     		mov	r3, r2
 1196 0058 5B00     		lsls	r3, r3, #1
 1197 005a 1344     		add	r3, r3, r2
 1198 005c 7A68     		ldr	r2, [r7, #4]
 1199 005e 1344     		add	r3, r3, r2
 1200 0060 7B60     		str	r3, [r7, #4]
 231:bluetooth_rxtx.c **** 	rssi_iir[i] = (int16_t)((rssi_iir_acc + 128) / 256);
 1201              		.loc 1 231 0
 1202 0062 7B68     		ldr	r3, [r7, #4]
 1203 0064 8033     		adds	r3, r3, #128
 1204 0066 002B     		cmp	r3, #0
ARM GAS  /tmp/ccUeeWpa.s 			page 25


 1205 0068 00DA     		bge	.L12
 1206 006a FF33     		adds	r3, r3, #255
 1207              	.L12:
 1208 006c 1B12     		asrs	r3, r3, #8
 1209 006e 99B2     		uxth	r1, r3
 1210 0070 084A     		ldr	r2, .L13+16
 1211 0072 FB68     		ldr	r3, [r7, #12]
 1212 0074 22F81310 		strh	r1, [r2, r3, lsl #1]	@ movhi
 232:bluetooth_rxtx.c **** }
 1213              		.loc 1 232 0
 1214 0078 1437     		adds	r7, r7, #20
 1215              		.cfi_def_cfa_offset 4
 1216 007a BD46     		mov	sp, r7
 1217              		.cfi_def_cfa_register 13
 1218              		@ sp needed
 1219 007c 5DF8047B 		ldr	r7, [sp], #4
 1220              		.cfi_restore 7
 1221              		.cfi_def_cfa_offset 0
 1222 0080 7047     		bx	lr
 1223              	.L14:
 1224 0082 00BF     		.align	2
 1225              	.L13:
 1226 0084 00000000 		.word	hop_mode
 1227 0088 00000000 		.word	channel
 1228 008c 00000000 		.word	rssi_count
 1229 0090 00000000 		.word	rssi_sum
 1230 0094 00000000 		.word	rssi_iir
 1231              		.cfi_endproc
 1232              	.LFE2:
 1234              		.section	.text.cs_threshold_set,"ax",%progbits
 1235              		.align	2
 1236              		.thumb
 1237              		.thumb_func
 1239              	cs_threshold_set:
 1240              	.LFB3:
 233:bluetooth_rxtx.c **** 
 234:bluetooth_rxtx.c **** #define CS_SAMPLES_1 1
 235:bluetooth_rxtx.c **** #define CS_SAMPLES_2 2
 236:bluetooth_rxtx.c **** #define CS_SAMPLES_4 3
 237:bluetooth_rxtx.c **** #define CS_SAMPLES_8 4
 238:bluetooth_rxtx.c **** /* Set CC2400 carrier sense threshold and store value to
 239:bluetooth_rxtx.c ****  * global. CC2400 RSSI is determined by 54dBm + level. CS threshold is
 240:bluetooth_rxtx.c ****  * in 4dBm steps, so the provided level is rounded to the nearest
 241:bluetooth_rxtx.c ****  * multiple of 4 by adding 56. Useful range is -100 to -20. */
 242:bluetooth_rxtx.c **** static void cs_threshold_set(int8_t level, u8 samples)
 243:bluetooth_rxtx.c **** {
 1241              		.loc 1 243 0
 1242              		.cfi_startproc
 1243              		@ args = 0, pretend = 0, frame = 8
 1244              		@ frame_needed = 1, uses_anonymous_args = 0
 1245 0000 80B5     		push	{r7, lr}
 1246              		.cfi_def_cfa_offset 8
 1247              		.cfi_offset 7, -8
 1248              		.cfi_offset 14, -4
 1249 0002 82B0     		sub	sp, sp, #8
 1250              		.cfi_def_cfa_offset 16
 1251 0004 00AF     		add	r7, sp, #0
ARM GAS  /tmp/ccUeeWpa.s 			page 26


 1252              		.cfi_def_cfa_register 7
 1253 0006 0346     		mov	r3, r0
 1254 0008 0A46     		mov	r2, r1
 1255 000a FB71     		strb	r3, [r7, #7]
 1256 000c 1346     		mov	r3, r2
 1257 000e BB71     		strb	r3, [r7, #6]
 244:bluetooth_rxtx.c **** 	level = MIN(MAX(level,-120),(-20));
 1258              		.loc 1 244 0
 1259 0010 97F90730 		ldrsb	r3, [r7, #7]
 1260 0014 13F1140F 		cmn	r3, #20
 1261 0018 0DD0     		beq	.L16
 1262              		.loc 1 244 0 is_stmt 0 discriminator 1
 1263 001a 97F90730 		ldrsb	r3, [r7, #7]
 1264 001e 13F1130F 		cmn	r3, #19
 1265 0022 08DA     		bge	.L16
 1266              		.loc 1 244 0 discriminator 3
 1267 0024 97F90730 		ldrsb	r3, [r7, #7]
 1268 0028 6FF07702 		mvn	r2, #119
 1269 002c 9342     		cmp	r3, r2
 1270 002e B8BF     		it	lt
 1271 0030 1346     		movlt	r3, r2
 1272 0032 DBB2     		uxtb	r3, r3
 1273 0034 00E0     		b	.L17
 1274              	.L16:
 1275              		.loc 1 244 0 discriminator 4
 1276 0036 EC23     		movs	r3, #236
 1277              	.L17:
 1278              		.loc 1 244 0 discriminator 6
 1279 0038 FB71     		strb	r3, [r7, #7]
 245:bluetooth_rxtx.c **** 	cc2400_set(RSSI, (uint8_t)((level + 56) & (0x3f << 2)) | (samples&3));
 1280              		.loc 1 245 0 is_stmt 1 discriminator 6
 1281 003a FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1282 003c 3833     		adds	r3, r3, #56
 1283 003e DBB2     		uxtb	r3, r3
 1284 0040 9BB2     		uxth	r3, r3
 1285 0042 03F0FC03 		and	r3, r3, #252
 1286 0046 9AB2     		uxth	r2, r3
 1287 0048 BB79     		ldrb	r3, [r7, #6]	@ zero_extendqisi2
 1288 004a 9BB2     		uxth	r3, r3
 1289 004c 03F00303 		and	r3, r3, #3
 1290 0050 9BB2     		uxth	r3, r3
 1291 0052 1343     		orrs	r3, r3, r2
 1292 0054 9BB2     		uxth	r3, r3
 1293 0056 9BB2     		uxth	r3, r3
 1294 0058 0620     		movs	r0, #6
 1295 005a 1946     		mov	r1, r3
 1296 005c FFF7FEFF 		bl	cc2400_set
 246:bluetooth_rxtx.c **** 	cs_threshold_cur = level;
 1297              		.loc 1 246 0 discriminator 6
 1298 0060 084A     		ldr	r2, .L18
 1299 0062 FB79     		ldrb	r3, [r7, #7]
 1300 0064 1370     		strb	r3, [r2]
 247:bluetooth_rxtx.c **** 	cs_no_squelch = (level <= -120);
 1301              		.loc 1 247 0 discriminator 6
 1302 0066 97F90730 		ldrsb	r3, [r7, #7]
 1303 006a 13F1770F 		cmn	r3, #119
 1304 006e B4BF     		ite	lt
ARM GAS  /tmp/ccUeeWpa.s 			page 27


 1305 0070 0123     		movlt	r3, #1
 1306 0072 0023     		movge	r3, #0
 1307 0074 DBB2     		uxtb	r3, r3
 1308 0076 1A46     		mov	r2, r3
 1309 0078 034B     		ldr	r3, .L18+4
 1310 007a 1A70     		strb	r2, [r3]
 248:bluetooth_rxtx.c **** }
 1311              		.loc 1 248 0 discriminator 6
 1312 007c 0837     		adds	r7, r7, #8
 1313              		.cfi_def_cfa_offset 8
 1314 007e BD46     		mov	sp, r7
 1315              		.cfi_def_cfa_register 13
 1316              		@ sp needed
 1317 0080 80BD     		pop	{r7, pc}
 1318              	.L19:
 1319 0082 00BF     		.align	2
 1320              	.L18:
 1321 0084 00000000 		.word	cs_threshold_cur
 1322 0088 00000000 		.word	cs_no_squelch
 1323              		.cfi_endproc
 1324              	.LFE3:
 1326              		.section	.text.enqueue,"ax",%progbits
 1327              		.align	2
 1328              		.thumb
 1329              		.thumb_func
 1331              	enqueue:
 1332              	.LFB4:
 249:bluetooth_rxtx.c **** 
 250:bluetooth_rxtx.c **** static int enqueue(u8 type, u8 *buf)
 251:bluetooth_rxtx.c **** {
 1333              		.loc 1 251 0
 1334              		.cfi_startproc
 1335              		@ args = 0, pretend = 0, frame = 32
 1336              		@ frame_needed = 1, uses_anonymous_args = 0
 1337 0000 80B5     		push	{r7, lr}
 1338              		.cfi_def_cfa_offset 8
 1339              		.cfi_offset 7, -8
 1340              		.cfi_offset 14, -4
 1341 0002 88B0     		sub	sp, sp, #32
 1342              		.cfi_def_cfa_offset 40
 1343 0004 00AF     		add	r7, sp, #0
 1344              		.cfi_def_cfa_register 7
 1345 0006 0346     		mov	r3, r0
 1346 0008 3960     		str	r1, [r7]
 1347 000a FB71     		strb	r3, [r7, #7]
 252:bluetooth_rxtx.c **** 	usb_pkt_rx *f = usb_enqueue();
 1348              		.loc 1 252 0
 1349 000c FFF7FEFF 		bl	usb_enqueue
 1350 0010 F861     		str	r0, [r7, #28]
 253:bluetooth_rxtx.c **** 
 254:bluetooth_rxtx.c **** 	/* fail if queue is full */
 255:bluetooth_rxtx.c **** 	if (f == NULL) {
 1351              		.loc 1 255 0
 1352 0012 FB69     		ldr	r3, [r7, #28]
 1353 0014 002B     		cmp	r3, #0
 1354 0016 09D1     		bne	.L21
 256:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
ARM GAS  /tmp/ccUeeWpa.s 			page 28


 1355              		.loc 1 256 0
 1356 0018 594B     		ldr	r3, .L27
 1357 001a 1B78     		ldrb	r3, [r3]
 1358 001c DBB2     		uxtb	r3, r3
 1359 001e 43F00403 		orr	r3, r3, #4
 1360 0022 DAB2     		uxtb	r2, r3
 1361 0024 564B     		ldr	r3, .L27
 1362 0026 1A70     		strb	r2, [r3]
 257:bluetooth_rxtx.c **** 		return 0;
 1363              		.loc 1 257 0
 1364 0028 0023     		movs	r3, #0
 1365 002a A5E0     		b	.L22
 1366              	.L21:
 258:bluetooth_rxtx.c **** 	}
 259:bluetooth_rxtx.c **** 
 260:bluetooth_rxtx.c **** 	f->pkt_type = type;
 1367              		.loc 1 260 0
 1368 002c FB69     		ldr	r3, [r7, #28]
 1369 002e FA79     		ldrb	r2, [r7, #7]
 1370 0030 1A70     		strb	r2, [r3]
 261:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 1371              		.loc 1 261 0
 1372 0032 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1373 0034 042B     		cmp	r3, #4
 1374 0036 13D1     		bne	.L23
 262:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 1375              		.loc 1 262 0
 1376 0038 524B     		ldr	r3, .L27+4
 1377 003a 1B68     		ldr	r3, [r3]
 1378 003c 1B0D     		lsrs	r3, r3, #20
 1379 003e DAB2     		uxtb	r2, r3
 1380 0040 FB69     		ldr	r3, [r7, #28]
 1381 0042 DA70     		strb	r2, [r3, #3]
 263:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 1382              		.loc 1 263 0
 1383 0044 4F4B     		ldr	r3, .L27+4
 1384 0046 1B68     		ldr	r3, [r3]
 1385 0048 C3F31303 		ubfx	r3, r3, #0, #20
 1386 004c 40F63542 		movw	r2, #3125
 1387 0050 02FB03F2 		mul	r2, r2, r3
 1388 0054 4C4B     		ldr	r3, .L27+8
 1389 0056 1B68     		ldr	r3, [r3]
 1390 0058 1A44     		add	r2, r2, r3
 1391 005a FB69     		ldr	r3, [r7, #28]
 1392 005c 5A60     		str	r2, [r3, #4]
 1393 005e 08E0     		b	.L24
 1394              	.L23:
 264:bluetooth_rxtx.c **** 	} else {
 265:bluetooth_rxtx.c **** 		f->clkn_high = idle_buf_clkn_high;
 1395              		.loc 1 265 0
 1396 0060 4A4B     		ldr	r3, .L27+12
 1397 0062 1B68     		ldr	r3, [r3]
 1398 0064 DAB2     		uxtb	r2, r3
 1399 0066 FB69     		ldr	r3, [r7, #28]
 1400 0068 DA70     		strb	r2, [r3, #3]
 266:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 1401              		.loc 1 266 0
ARM GAS  /tmp/ccUeeWpa.s 			page 29


 1402 006a 494B     		ldr	r3, .L27+16
 1403 006c 1A68     		ldr	r2, [r3]
 1404 006e FB69     		ldr	r3, [r7, #28]
 1405 0070 5A60     		str	r2, [r3, #4]
 1406              	.L24:
 267:bluetooth_rxtx.c **** 	}
 268:bluetooth_rxtx.c **** 	f->channel = idle_buf_channel - 2402;
 1407              		.loc 1 268 0
 1408 0072 484B     		ldr	r3, .L27+20
 1409 0074 1B88     		ldrh	r3, [r3]	@ movhi
 1410 0076 9BB2     		uxth	r3, r3
 1411 0078 DBB2     		uxtb	r3, r3
 1412 007a 623B     		subs	r3, r3, #98
 1413 007c DAB2     		uxtb	r2, r3
 1414 007e FB69     		ldr	r3, [r7, #28]
 1415 0080 9A70     		strb	r2, [r3, #2]
 269:bluetooth_rxtx.c **** 	f->rssi_min = rssi_min;
 1416              		.loc 1 269 0
 1417 0082 454B     		ldr	r3, .L27+24
 1418 0084 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1419 0086 DAB2     		uxtb	r2, r3
 1420 0088 FB69     		ldr	r3, [r7, #28]
 1421 008a 5A72     		strb	r2, [r3, #9]
 270:bluetooth_rxtx.c **** 	f->rssi_max = rssi_max;
 1422              		.loc 1 270 0
 1423 008c 434B     		ldr	r3, .L27+28
 1424 008e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1425 0090 DAB2     		uxtb	r2, r3
 1426 0092 FB69     		ldr	r3, [r7, #28]
 1427 0094 1A72     		strb	r2, [r3, #8]
 271:bluetooth_rxtx.c **** 	if (hop_mode != HOP_NONE)
 1428              		.loc 1 271 0
 1429 0096 424B     		ldr	r3, .L27+32
 1430 0098 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1431 009a 002B     		cmp	r3, #0
 1432 009c 09D0     		beq	.L25
 272:bluetooth_rxtx.c **** 	//	f->rssi_avg = (int8_t)((rssi_iir[idle_buf_channel-2402] + 128)/256);
 273:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_sum/rssi_count;
 1433              		.loc 1 273 0
 1434 009e 414B     		ldr	r3, .L27+36
 1435 00a0 1B68     		ldr	r3, [r3]
 1436 00a2 414A     		ldr	r2, .L27+40
 1437 00a4 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 1438 00a6 93FBF2F3 		sdiv	r3, r3, r2
 1439 00aa DAB2     		uxtb	r2, r3
 1440 00ac FB69     		ldr	r3, [r7, #28]
 1441 00ae 9A72     		strb	r2, [r3, #10]
 1442 00b0 08E0     		b	.L26
 1443              	.L25:
 274:bluetooth_rxtx.c **** 	else
 275:bluetooth_rxtx.c **** 		//f->rssi_avg = (int8_t)((rssi_iir[0] + 128)/256);
 276:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_sum/rssi_count;
 1444              		.loc 1 276 0
 1445 00b2 3C4B     		ldr	r3, .L27+36
 1446 00b4 1B68     		ldr	r3, [r3]
 1447 00b6 3C4A     		ldr	r2, .L27+40
 1448 00b8 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
ARM GAS  /tmp/ccUeeWpa.s 			page 30


 1449 00ba 93FBF2F3 		sdiv	r3, r3, r2
 1450 00be DAB2     		uxtb	r2, r3
 1451 00c0 FB69     		ldr	r3, [r7, #28]
 1452 00c2 9A72     		strb	r2, [r3, #10]
 1453              	.L26:
 277:bluetooth_rxtx.c **** 	f->rssi_count = rssi_count;
 1454              		.loc 1 277 0
 1455 00c4 384B     		ldr	r3, .L27+40
 1456 00c6 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1457 00c8 FB69     		ldr	r3, [r7, #28]
 1458 00ca DA72     		strb	r2, [r3, #11]
 278:bluetooth_rxtx.c **** 
 279:bluetooth_rxtx.c **** 	USRLED_SET;
 1459              		.loc 1 279 0
 1460 00cc 374B     		ldr	r3, .L27+44
 1461 00ce 0222     		movs	r2, #2
 1462 00d0 1A60     		str	r2, [r3]
 280:bluetooth_rxtx.c **** 
 281:bluetooth_rxtx.c **** 	// Unrolled copy of 50 bytes from buf to fifo
 282:bluetooth_rxtx.c **** 	u32 *p1 = (u32 *)f->data;
 1463              		.loc 1 282 0
 1464 00d2 FB69     		ldr	r3, [r7, #28]
 1465 00d4 0E33     		adds	r3, r3, #14
 1466 00d6 BB61     		str	r3, [r7, #24]
 283:bluetooth_rxtx.c **** 	u32 *p2 = (u32 *)buf;
 1467              		.loc 1 283 0
 1468 00d8 3B68     		ldr	r3, [r7]
 1469 00da 7B61     		str	r3, [r7, #20]
 284:bluetooth_rxtx.c **** 	p1[0] = p2[0];
 1470              		.loc 1 284 0
 1471 00dc 7B69     		ldr	r3, [r7, #20]
 1472 00de 1A68     		ldr	r2, [r3]
 1473 00e0 BB69     		ldr	r3, [r7, #24]
 1474 00e2 1A60     		str	r2, [r3]
 285:bluetooth_rxtx.c **** 	p1[1] = p2[1];
 1475              		.loc 1 285 0
 1476 00e4 BB69     		ldr	r3, [r7, #24]
 1477 00e6 0433     		adds	r3, r3, #4
 1478 00e8 7A69     		ldr	r2, [r7, #20]
 1479 00ea 5268     		ldr	r2, [r2, #4]
 1480 00ec 1A60     		str	r2, [r3]
 286:bluetooth_rxtx.c **** 	p1[2] = p2[2];
 1481              		.loc 1 286 0
 1482 00ee BB69     		ldr	r3, [r7, #24]
 1483 00f0 0833     		adds	r3, r3, #8
 1484 00f2 7A69     		ldr	r2, [r7, #20]
 1485 00f4 9268     		ldr	r2, [r2, #8]
 1486 00f6 1A60     		str	r2, [r3]
 287:bluetooth_rxtx.c **** 	p1[3] = p2[3];
 1487              		.loc 1 287 0
 1488 00f8 BB69     		ldr	r3, [r7, #24]
 1489 00fa 0C33     		adds	r3, r3, #12
 1490 00fc 7A69     		ldr	r2, [r7, #20]
 1491 00fe D268     		ldr	r2, [r2, #12]
 1492 0100 1A60     		str	r2, [r3]
 288:bluetooth_rxtx.c **** 	p1[4] = p2[4];
 1493              		.loc 1 288 0
ARM GAS  /tmp/ccUeeWpa.s 			page 31


 1494 0102 BB69     		ldr	r3, [r7, #24]
 1495 0104 1033     		adds	r3, r3, #16
 1496 0106 7A69     		ldr	r2, [r7, #20]
 1497 0108 1269     		ldr	r2, [r2, #16]
 1498 010a 1A60     		str	r2, [r3]
 289:bluetooth_rxtx.c **** 	p1[5] = p2[5];
 1499              		.loc 1 289 0
 1500 010c BB69     		ldr	r3, [r7, #24]
 1501 010e 1433     		adds	r3, r3, #20
 1502 0110 7A69     		ldr	r2, [r7, #20]
 1503 0112 5269     		ldr	r2, [r2, #20]
 1504 0114 1A60     		str	r2, [r3]
 290:bluetooth_rxtx.c **** 	p1[6] = p2[6];
 1505              		.loc 1 290 0
 1506 0116 BB69     		ldr	r3, [r7, #24]
 1507 0118 1833     		adds	r3, r3, #24
 1508 011a 7A69     		ldr	r2, [r7, #20]
 1509 011c 9269     		ldr	r2, [r2, #24]
 1510 011e 1A60     		str	r2, [r3]
 291:bluetooth_rxtx.c **** 	p1[7] = p2[7];
 1511              		.loc 1 291 0
 1512 0120 BB69     		ldr	r3, [r7, #24]
 1513 0122 1C33     		adds	r3, r3, #28
 1514 0124 7A69     		ldr	r2, [r7, #20]
 1515 0126 D269     		ldr	r2, [r2, #28]
 1516 0128 1A60     		str	r2, [r3]
 292:bluetooth_rxtx.c **** 	p1[8] = p2[8];
 1517              		.loc 1 292 0
 1518 012a BB69     		ldr	r3, [r7, #24]
 1519 012c 2033     		adds	r3, r3, #32
 1520 012e 7A69     		ldr	r2, [r7, #20]
 1521 0130 126A     		ldr	r2, [r2, #32]
 1522 0132 1A60     		str	r2, [r3]
 293:bluetooth_rxtx.c **** 	p1[9] = p2[9];
 1523              		.loc 1 293 0
 1524 0134 BB69     		ldr	r3, [r7, #24]
 1525 0136 2433     		adds	r3, r3, #36
 1526 0138 7A69     		ldr	r2, [r7, #20]
 1527 013a 526A     		ldr	r2, [r2, #36]
 1528 013c 1A60     		str	r2, [r3]
 294:bluetooth_rxtx.c **** 	p1[10] = p2[10];
 1529              		.loc 1 294 0
 1530 013e BB69     		ldr	r3, [r7, #24]
 1531 0140 2833     		adds	r3, r3, #40
 1532 0142 7A69     		ldr	r2, [r7, #20]
 1533 0144 926A     		ldr	r2, [r2, #40]
 1534 0146 1A60     		str	r2, [r3]
 295:bluetooth_rxtx.c **** 	p1[11] = p2[11];
 1535              		.loc 1 295 0
 1536 0148 BB69     		ldr	r3, [r7, #24]
 1537 014a 2C33     		adds	r3, r3, #44
 1538 014c 7A69     		ldr	r2, [r7, #20]
 1539 014e D26A     		ldr	r2, [r2, #44]
 1540 0150 1A60     		str	r2, [r3]
 296:bluetooth_rxtx.c **** 	/* Avoid gcc warning about strict-aliasing */
 297:bluetooth_rxtx.c **** 	u16 *p3 = (u16 *)f->data;
 1541              		.loc 1 297 0
ARM GAS  /tmp/ccUeeWpa.s 			page 32


 1542 0152 FB69     		ldr	r3, [r7, #28]
 1543 0154 0E33     		adds	r3, r3, #14
 1544 0156 3B61     		str	r3, [r7, #16]
 298:bluetooth_rxtx.c **** 	u16 *p4 = (u16 *)buf;
 1545              		.loc 1 298 0
 1546 0158 3B68     		ldr	r3, [r7]
 1547 015a FB60     		str	r3, [r7, #12]
 299:bluetooth_rxtx.c **** 	p3[24] = p4[24];
 1548              		.loc 1 299 0
 1549 015c 3B69     		ldr	r3, [r7, #16]
 1550 015e 3033     		adds	r3, r3, #48
 1551 0160 FA68     		ldr	r2, [r7, #12]
 1552 0162 128E     		ldrh	r2, [r2, #48]
 1553 0164 1A80     		strh	r2, [r3]	@ movhi
 300:bluetooth_rxtx.c **** 
 301:bluetooth_rxtx.c **** 	f->status = status;
 1554              		.loc 1 301 0
 1555 0166 064B     		ldr	r3, .L27
 1556 0168 1B78     		ldrb	r3, [r3]
 1557 016a DAB2     		uxtb	r2, r3
 1558 016c FB69     		ldr	r3, [r7, #28]
 1559 016e 5A70     		strb	r2, [r3, #1]
 302:bluetooth_rxtx.c **** 	status = 0;
 1560              		.loc 1 302 0
 1561 0170 034B     		ldr	r3, .L27
 1562 0172 0022     		movs	r2, #0
 1563 0174 1A70     		strb	r2, [r3]
 303:bluetooth_rxtx.c **** 
 304:bluetooth_rxtx.c **** 	return 1;
 1564              		.loc 1 304 0
 1565 0176 0123     		movs	r3, #1
 1566              	.L22:
 305:bluetooth_rxtx.c **** }
 1567              		.loc 1 305 0
 1568 0178 1846     		mov	r0, r3
 1569 017a 2037     		adds	r7, r7, #32
 1570              		.cfi_def_cfa_offset 8
 1571 017c BD46     		mov	sp, r7
 1572              		.cfi_def_cfa_register 13
 1573              		@ sp needed
 1574 017e 80BD     		pop	{r7, pc}
 1575              	.L28:
 1576              		.align	2
 1577              	.L27:
 1578 0180 00000000 		.word	status
 1579 0184 00000000 		.word	clkn
 1580 0188 08400040 		.word	1073758216
 1581 018c 00000000 		.word	idle_buf_clkn_high
 1582 0190 00000000 		.word	idle_buf_clk100ns
 1583 0194 00000000 		.word	idle_buf_channel
 1584 0198 00000000 		.word	rssi_min
 1585 019c 00000000 		.word	rssi_max
 1586 01a0 00000000 		.word	hop_mode
 1587 01a4 00000000 		.word	rssi_sum
 1588 01a8 00000000 		.word	rssi_count
 1589 01ac 38C00920 		.word	537509944
 1590              		.cfi_endproc
ARM GAS  /tmp/ccUeeWpa.s 			page 33


 1591              	.LFE4:
 1593              		.section	.text.enqueue_with_ts,"ax",%progbits
 1594              		.align	2
 1595              		.global	enqueue_with_ts
 1596              		.thumb
 1597              		.thumb_func
 1599              	enqueue_with_ts:
 1600              	.LFB5:
 306:bluetooth_rxtx.c **** 
 307:bluetooth_rxtx.c **** int enqueue_with_ts(u8 type, u8 *buf, u32 ts)
 308:bluetooth_rxtx.c **** {
 1601              		.loc 1 308 0
 1602              		.cfi_startproc
 1603              		@ args = 0, pretend = 0, frame = 40
 1604              		@ frame_needed = 1, uses_anonymous_args = 0
 1605 0000 80B5     		push	{r7, lr}
 1606              		.cfi_def_cfa_offset 8
 1607              		.cfi_offset 7, -8
 1608              		.cfi_offset 14, -4
 1609 0002 8AB0     		sub	sp, sp, #40
 1610              		.cfi_def_cfa_offset 48
 1611 0004 00AF     		add	r7, sp, #0
 1612              		.cfi_def_cfa_register 7
 1613 0006 0346     		mov	r3, r0
 1614 0008 B960     		str	r1, [r7, #8]
 1615 000a 7A60     		str	r2, [r7, #4]
 1616 000c FB73     		strb	r3, [r7, #15]
 309:bluetooth_rxtx.c **** 	usb_pkt_rx *f = usb_enqueue();
 1617              		.loc 1 309 0
 1618 000e FFF7FEFF 		bl	usb_enqueue
 1619 0012 7862     		str	r0, [r7, #36]
 310:bluetooth_rxtx.c **** 
 311:bluetooth_rxtx.c **** 	/* fail if queue is full */
 312:bluetooth_rxtx.c **** 	if (f == NULL) {
 1620              		.loc 1 312 0
 1621 0014 7B6A     		ldr	r3, [r7, #36]
 1622 0016 002B     		cmp	r3, #0
 1623 0018 09D1     		bne	.L30
 313:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 1624              		.loc 1 313 0
 1625 001a 3C4B     		ldr	r3, .L32
 1626 001c 1B78     		ldrb	r3, [r3]
 1627 001e DBB2     		uxtb	r3, r3
 1628 0020 43F00403 		orr	r3, r3, #4
 1629 0024 DAB2     		uxtb	r2, r3
 1630 0026 394B     		ldr	r3, .L32
 1631 0028 1A70     		strb	r2, [r3]
 314:bluetooth_rxtx.c **** 		return 0;
 1632              		.loc 1 314 0
 1633 002a 0023     		movs	r3, #0
 1634 002c 69E0     		b	.L31
 1635              	.L30:
 315:bluetooth_rxtx.c **** 	}
 316:bluetooth_rxtx.c **** 
 317:bluetooth_rxtx.c **** 	f->clkn_high = 0;
 1636              		.loc 1 317 0
 1637 002e 7B6A     		ldr	r3, [r7, #36]
ARM GAS  /tmp/ccUeeWpa.s 			page 34


 1638 0030 0022     		movs	r2, #0
 1639 0032 DA70     		strb	r2, [r3, #3]
 318:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 1640              		.loc 1 318 0
 1641 0034 7B6A     		ldr	r3, [r7, #36]
 1642 0036 7A68     		ldr	r2, [r7, #4]
 1643 0038 5A60     		str	r2, [r3, #4]
 319:bluetooth_rxtx.c **** 
 320:bluetooth_rxtx.c **** 	f->channel = channel - 2402;
 1644              		.loc 1 320 0
 1645 003a 354B     		ldr	r3, .L32+4
 1646 003c 1B88     		ldrh	r3, [r3]	@ movhi
 1647 003e 9BB2     		uxth	r3, r3
 1648 0040 DBB2     		uxtb	r3, r3
 1649 0042 623B     		subs	r3, r3, #98
 1650 0044 DAB2     		uxtb	r2, r3
 1651 0046 7B6A     		ldr	r3, [r7, #36]
 1652 0048 9A70     		strb	r2, [r3, #2]
 321:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 1653              		.loc 1 321 0
 1654 004a 7B6A     		ldr	r3, [r7, #36]
 1655 004c 0022     		movs	r2, #0
 1656 004e 9A72     		strb	r2, [r3, #10]
 322:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 1657              		.loc 1 322 0
 1658 0050 7B6A     		ldr	r3, [r7, #36]
 1659 0052 0022     		movs	r2, #0
 1660 0054 DA72     		strb	r2, [r3, #11]
 323:bluetooth_rxtx.c **** 
 324:bluetooth_rxtx.c **** 	USRLED_SET;
 1661              		.loc 1 324 0
 1662 0056 2F4B     		ldr	r3, .L32+8
 1663 0058 0222     		movs	r2, #2
 1664 005a 1A60     		str	r2, [r3]
 325:bluetooth_rxtx.c **** 
 326:bluetooth_rxtx.c **** 	// Unrolled copy of 50 bytes from buf to fifo
 327:bluetooth_rxtx.c **** 	u32 *p1 = (u32 *)f->data;
 1665              		.loc 1 327 0
 1666 005c 7B6A     		ldr	r3, [r7, #36]
 1667 005e 0E33     		adds	r3, r3, #14
 1668 0060 3B62     		str	r3, [r7, #32]
 328:bluetooth_rxtx.c **** 	u32 *p2 = (u32 *)buf;
 1669              		.loc 1 328 0
 1670 0062 BB68     		ldr	r3, [r7, #8]
 1671 0064 FB61     		str	r3, [r7, #28]
 329:bluetooth_rxtx.c **** 	p1[0] = p2[0];
 1672              		.loc 1 329 0
 1673 0066 FB69     		ldr	r3, [r7, #28]
 1674 0068 1A68     		ldr	r2, [r3]
 1675 006a 3B6A     		ldr	r3, [r7, #32]
 1676 006c 1A60     		str	r2, [r3]
 330:bluetooth_rxtx.c **** 	p1[1] = p2[1];
 1677              		.loc 1 330 0
 1678 006e 3B6A     		ldr	r3, [r7, #32]
 1679 0070 0433     		adds	r3, r3, #4
 1680 0072 FA69     		ldr	r2, [r7, #28]
 1681 0074 5268     		ldr	r2, [r2, #4]
ARM GAS  /tmp/ccUeeWpa.s 			page 35


 1682 0076 1A60     		str	r2, [r3]
 331:bluetooth_rxtx.c **** 	p1[2] = p2[2];
 1683              		.loc 1 331 0
 1684 0078 3B6A     		ldr	r3, [r7, #32]
 1685 007a 0833     		adds	r3, r3, #8
 1686 007c FA69     		ldr	r2, [r7, #28]
 1687 007e 9268     		ldr	r2, [r2, #8]
 1688 0080 1A60     		str	r2, [r3]
 332:bluetooth_rxtx.c **** 	p1[3] = p2[3];
 1689              		.loc 1 332 0
 1690 0082 3B6A     		ldr	r3, [r7, #32]
 1691 0084 0C33     		adds	r3, r3, #12
 1692 0086 FA69     		ldr	r2, [r7, #28]
 1693 0088 D268     		ldr	r2, [r2, #12]
 1694 008a 1A60     		str	r2, [r3]
 333:bluetooth_rxtx.c **** 	p1[4] = p2[4];
 1695              		.loc 1 333 0
 1696 008c 3B6A     		ldr	r3, [r7, #32]
 1697 008e 1033     		adds	r3, r3, #16
 1698 0090 FA69     		ldr	r2, [r7, #28]
 1699 0092 1269     		ldr	r2, [r2, #16]
 1700 0094 1A60     		str	r2, [r3]
 334:bluetooth_rxtx.c **** 	p1[5] = p2[5];
 1701              		.loc 1 334 0
 1702 0096 3B6A     		ldr	r3, [r7, #32]
 1703 0098 1433     		adds	r3, r3, #20
 1704 009a FA69     		ldr	r2, [r7, #28]
 1705 009c 5269     		ldr	r2, [r2, #20]
 1706 009e 1A60     		str	r2, [r3]
 335:bluetooth_rxtx.c **** 	p1[6] = p2[6];
 1707              		.loc 1 335 0
 1708 00a0 3B6A     		ldr	r3, [r7, #32]
 1709 00a2 1833     		adds	r3, r3, #24
 1710 00a4 FA69     		ldr	r2, [r7, #28]
 1711 00a6 9269     		ldr	r2, [r2, #24]
 1712 00a8 1A60     		str	r2, [r3]
 336:bluetooth_rxtx.c **** 	p1[7] = p2[7];
 1713              		.loc 1 336 0
 1714 00aa 3B6A     		ldr	r3, [r7, #32]
 1715 00ac 1C33     		adds	r3, r3, #28
 1716 00ae FA69     		ldr	r2, [r7, #28]
 1717 00b0 D269     		ldr	r2, [r2, #28]
 1718 00b2 1A60     		str	r2, [r3]
 337:bluetooth_rxtx.c **** 	p1[8] = p2[8];
 1719              		.loc 1 337 0
 1720 00b4 3B6A     		ldr	r3, [r7, #32]
 1721 00b6 2033     		adds	r3, r3, #32
 1722 00b8 FA69     		ldr	r2, [r7, #28]
 1723 00ba 126A     		ldr	r2, [r2, #32]
 1724 00bc 1A60     		str	r2, [r3]
 338:bluetooth_rxtx.c **** 	p1[9] = p2[9];
 1725              		.loc 1 338 0
 1726 00be 3B6A     		ldr	r3, [r7, #32]
 1727 00c0 2433     		adds	r3, r3, #36
 1728 00c2 FA69     		ldr	r2, [r7, #28]
 1729 00c4 526A     		ldr	r2, [r2, #36]
 1730 00c6 1A60     		str	r2, [r3]
ARM GAS  /tmp/ccUeeWpa.s 			page 36


 339:bluetooth_rxtx.c **** 	p1[10] = p2[10];
 1731              		.loc 1 339 0
 1732 00c8 3B6A     		ldr	r3, [r7, #32]
 1733 00ca 2833     		adds	r3, r3, #40
 1734 00cc FA69     		ldr	r2, [r7, #28]
 1735 00ce 926A     		ldr	r2, [r2, #40]
 1736 00d0 1A60     		str	r2, [r3]
 340:bluetooth_rxtx.c **** 	p1[11] = p2[11];
 1737              		.loc 1 340 0
 1738 00d2 3B6A     		ldr	r3, [r7, #32]
 1739 00d4 2C33     		adds	r3, r3, #44
 1740 00d6 FA69     		ldr	r2, [r7, #28]
 1741 00d8 D26A     		ldr	r2, [r2, #44]
 1742 00da 1A60     		str	r2, [r3]
 341:bluetooth_rxtx.c **** 	/* Avoid gcc warning about strict-aliasing */
 342:bluetooth_rxtx.c **** 	u16 *p3 = (u16 *)f->data;
 1743              		.loc 1 342 0
 1744 00dc 7B6A     		ldr	r3, [r7, #36]
 1745 00de 0E33     		adds	r3, r3, #14
 1746 00e0 BB61     		str	r3, [r7, #24]
 343:bluetooth_rxtx.c **** 	u16 *p4 = (u16 *)buf;
 1747              		.loc 1 343 0
 1748 00e2 BB68     		ldr	r3, [r7, #8]
 1749 00e4 7B61     		str	r3, [r7, #20]
 344:bluetooth_rxtx.c **** 	p3[24] = p4[24];
 1750              		.loc 1 344 0
 1751 00e6 BB69     		ldr	r3, [r7, #24]
 1752 00e8 3033     		adds	r3, r3, #48
 1753 00ea 7A69     		ldr	r2, [r7, #20]
 1754 00ec 128E     		ldrh	r2, [r2, #48]
 1755 00ee 1A80     		strh	r2, [r3]	@ movhi
 345:bluetooth_rxtx.c **** 
 346:bluetooth_rxtx.c **** 	f->status = status;
 1756              		.loc 1 346 0
 1757 00f0 064B     		ldr	r3, .L32
 1758 00f2 1B78     		ldrb	r3, [r3]
 1759 00f4 DAB2     		uxtb	r2, r3
 1760 00f6 7B6A     		ldr	r3, [r7, #36]
 1761 00f8 5A70     		strb	r2, [r3, #1]
 347:bluetooth_rxtx.c **** 	status = 0;
 1762              		.loc 1 347 0
 1763 00fa 044B     		ldr	r3, .L32
 1764 00fc 0022     		movs	r2, #0
 1765 00fe 1A70     		strb	r2, [r3]
 348:bluetooth_rxtx.c **** 
 349:bluetooth_rxtx.c **** 	return 1;
 1766              		.loc 1 349 0
 1767 0100 0123     		movs	r3, #1
 1768              	.L31:
 350:bluetooth_rxtx.c **** }
 1769              		.loc 1 350 0
 1770 0102 1846     		mov	r0, r3
 1771 0104 2837     		adds	r7, r7, #40
 1772              		.cfi_def_cfa_offset 8
 1773 0106 BD46     		mov	sp, r7
 1774              		.cfi_def_cfa_register 13
 1775              		@ sp needed
ARM GAS  /tmp/ccUeeWpa.s 			page 37


 1776 0108 80BD     		pop	{r7, pc}
 1777              	.L33:
 1778 010a 00BF     		.align	2
 1779              	.L32:
 1780 010c 00000000 		.word	status
 1781 0110 00000000 		.word	channel
 1782 0114 38C00920 		.word	537509944
 1783              		.cfi_endproc
 1784              	.LFE5:
 1786              		.section	.text.cs_threshold_calc_and_set,"ax",%progbits
 1787              		.align	2
 1788              		.thumb
 1789              		.thumb_func
 1791              	cs_threshold_calc_and_set:
 1792              	.LFB6:
 351:bluetooth_rxtx.c **** 
 352:bluetooth_rxtx.c **** static void cs_threshold_calc_and_set(void)
 353:bluetooth_rxtx.c **** {
 1793              		.loc 1 353 0
 1794              		.cfi_startproc
 1795              		@ args = 0, pretend = 0, frame = 8
 1796              		@ frame_needed = 1, uses_anonymous_args = 0
 1797 0000 80B5     		push	{r7, lr}
 1798              		.cfi_def_cfa_offset 8
 1799              		.cfi_offset 7, -8
 1800              		.cfi_offset 14, -4
 1801 0002 82B0     		sub	sp, sp, #8
 1802              		.cfi_def_cfa_offset 16
 1803 0004 00AF     		add	r7, sp, #0
 1804              		.cfi_def_cfa_register 7
 354:bluetooth_rxtx.c **** 	int8_t level;
 355:bluetooth_rxtx.c **** 
 356:bluetooth_rxtx.c **** 	/* If threshold is max/avg based (>0), reset here while rx is
 357:bluetooth_rxtx.c **** 	 * off.  TODO - max-to-iir only works in SWEEP mode, where the
 358:bluetooth_rxtx.c **** 	 * channel is known to be in the BT band, i.e., rssi_iir has a
 359:bluetooth_rxtx.c **** 	 * value for it. */
 360:bluetooth_rxtx.c **** 	if ((hop_mode > 0) && (cs_threshold_req > 0)) {
 1805              		.loc 1 360 0
 1806 0006 174B     		ldr	r3, .L38
 1807 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1808 000a 002B     		cmp	r3, #0
 1809 000c 1DD0     		beq	.L35
 1810              		.loc 1 360 0 is_stmt 0 discriminator 1
 1811 000e 164B     		ldr	r3, .L38+4
 1812 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1813 0012 5BB2     		sxtb	r3, r3
 1814 0014 002B     		cmp	r3, #0
 1815 0016 18DD     		ble	.L35
 1816              	.LBB2:
 361:bluetooth_rxtx.c **** 		int8_t rssi = (int8_t)((rssi_iir[channel-2402] + 128)/256);
 1817              		.loc 1 361 0 is_stmt 1
 1818 0018 144B     		ldr	r3, .L38+8
 1819 001a 1B88     		ldrh	r3, [r3]	@ movhi
 1820 001c 9BB2     		uxth	r3, r3
 1821 001e A3F66213 		subw	r3, r3, #2402
 1822 0022 134A     		ldr	r2, .L38+12
 1823 0024 32F81330 		ldrh	r3, [r2, r3, lsl #1]
ARM GAS  /tmp/ccUeeWpa.s 			page 38


 1824 0028 1BB2     		sxth	r3, r3
 1825 002a 8033     		adds	r3, r3, #128
 1826 002c 002B     		cmp	r3, #0
 1827 002e 00DA     		bge	.L36
 1828 0030 FF33     		adds	r3, r3, #255
 1829              	.L36:
 1830 0032 1B12     		asrs	r3, r3, #8
 1831 0034 BB71     		strb	r3, [r7, #6]
 362:bluetooth_rxtx.c **** 		level = rssi - 54 + cs_threshold_req;
 1832              		.loc 1 362 0
 1833 0036 BA79     		ldrb	r2, [r7, #6]	@ zero_extendqisi2
 1834 0038 0B4B     		ldr	r3, .L38+4
 1835 003a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1836 003c DBB2     		uxtb	r3, r3
 1837 003e 1344     		add	r3, r3, r2
 1838 0040 DBB2     		uxtb	r3, r3
 1839 0042 363B     		subs	r3, r3, #54
 1840 0044 DBB2     		uxtb	r3, r3
 1841 0046 FB71     		strb	r3, [r7, #7]
 1842              	.LBE2:
 360:bluetooth_rxtx.c **** 		int8_t rssi = (int8_t)((rssi_iir[channel-2402] + 128)/256);
 1843              		.loc 1 360 0
 1844 0048 02E0     		b	.L37
 1845              	.L35:
 363:bluetooth_rxtx.c **** 	}
 364:bluetooth_rxtx.c **** 	else {
 365:bluetooth_rxtx.c **** 		level = cs_threshold_req;
 1846              		.loc 1 365 0
 1847 004a 074B     		ldr	r3, .L38+4
 1848 004c 1B78     		ldrb	r3, [r3]
 1849 004e FB71     		strb	r3, [r7, #7]
 1850              	.L37:
 366:bluetooth_rxtx.c **** 	}
 367:bluetooth_rxtx.c **** 	cs_threshold_set(level, CS_SAMPLES_4);
 1851              		.loc 1 367 0
 1852 0050 97F90730 		ldrsb	r3, [r7, #7]
 1853 0054 1846     		mov	r0, r3
 1854 0056 0321     		movs	r1, #3
 1855 0058 FFF7FEFF 		bl	cs_threshold_set
 368:bluetooth_rxtx.c **** }
 1856              		.loc 1 368 0
 1857 005c 0837     		adds	r7, r7, #8
 1858              		.cfi_def_cfa_offset 8
 1859 005e BD46     		mov	sp, r7
 1860              		.cfi_def_cfa_register 13
 1861              		@ sp needed
 1862 0060 80BD     		pop	{r7, pc}
 1863              	.L39:
 1864 0062 00BF     		.align	2
 1865              	.L38:
 1866 0064 00000000 		.word	hop_mode
 1867 0068 00000000 		.word	cs_threshold_req
 1868 006c 00000000 		.word	channel
 1869 0070 00000000 		.word	rssi_iir
 1870              		.cfi_endproc
 1871              	.LFE6:
 1873              		.section	.text.cs_trigger_enable,"ax",%progbits
ARM GAS  /tmp/ccUeeWpa.s 			page 39


 1874              		.align	2
 1875              		.thumb
 1876              		.thumb_func
 1878              	cs_trigger_enable:
 1879              	.LFB7:
 369:bluetooth_rxtx.c **** 
 370:bluetooth_rxtx.c **** /* CS comes from CC2400 GIO6, which is LPC P2.2, active low. GPIO
 371:bluetooth_rxtx.c ****  * triggers EINT3, which could be used for other things (but is not
 372:bluetooth_rxtx.c ****  * currently). TODO - EINT3 should be managed globally, not turned on
 373:bluetooth_rxtx.c ****  * and off here. */
 374:bluetooth_rxtx.c **** static void cs_trigger_enable(void)
 375:bluetooth_rxtx.c **** {
 1880              		.loc 1 375 0
 1881              		.cfi_startproc
 1882              		@ args = 0, pretend = 0, frame = 0
 1883              		@ frame_needed = 1, uses_anonymous_args = 0
 1884              		@ link register save eliminated.
 1885 0000 80B4     		push	{r7}
 1886              		.cfi_def_cfa_offset 4
 1887              		.cfi_offset 7, -4
 1888 0002 00AF     		add	r7, sp, #0
 1889              		.cfi_def_cfa_register 7
 376:bluetooth_rxtx.c **** 	cs_trigger = 0;
 1890              		.loc 1 376 0
 1891 0004 094B     		ldr	r3, .L41
 1892 0006 0022     		movs	r2, #0
 1893 0008 1A70     		strb	r2, [r3]
 377:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_EINT3;
 1894              		.loc 1 377 0
 1895 000a 094B     		ldr	r3, .L41+4
 1896 000c 4FF40012 		mov	r2, #2097152
 1897 0010 1A60     		str	r2, [r3]
 378:bluetooth_rxtx.c **** 	IO2IntClr = PIN_GIO6;      // Clear pending
 1898              		.loc 1 378 0
 1899 0012 084B     		ldr	r3, .L41+8
 1900 0014 0422     		movs	r2, #4
 1901 0016 1A60     		str	r2, [r3]
 379:bluetooth_rxtx.c **** 	IO2IntEnF |= PIN_GIO6;     // Enable port 2.2 falling (CS active low)
 1902              		.loc 1 379 0
 1903 0018 074A     		ldr	r2, .L41+12
 1904 001a 074B     		ldr	r3, .L41+12
 1905 001c 1B68     		ldr	r3, [r3]
 1906 001e 43F00403 		orr	r3, r3, #4
 1907 0022 1360     		str	r3, [r2]
 380:bluetooth_rxtx.c **** }
 1908              		.loc 1 380 0
 1909 0024 BD46     		mov	sp, r7
 1910              		.cfi_def_cfa_register 13
 1911              		@ sp needed
 1912 0026 5DF8047B 		ldr	r7, [sp], #4
 1913              		.cfi_restore 7
 1914              		.cfi_def_cfa_offset 0
 1915 002a 7047     		bx	lr
 1916              	.L42:
 1917              		.align	2
 1918              	.L41:
 1919 002c 00000000 		.word	cs_trigger
ARM GAS  /tmp/ccUeeWpa.s 			page 40


 1920 0030 00E100E0 		.word	-536813312
 1921 0034 AC800240 		.word	1073905836
 1922 0038 B4800240 		.word	1073905844
 1923              		.cfi_endproc
 1924              	.LFE7:
 1926              		.section	.text.cs_trigger_disable,"ax",%progbits
 1927              		.align	2
 1928              		.thumb
 1929              		.thumb_func
 1931              	cs_trigger_disable:
 1932              	.LFB8:
 381:bluetooth_rxtx.c **** 
 382:bluetooth_rxtx.c **** static void cs_trigger_disable(void)
 383:bluetooth_rxtx.c **** {
 1933              		.loc 1 383 0
 1934              		.cfi_startproc
 1935              		@ args = 0, pretend = 0, frame = 0
 1936              		@ frame_needed = 1, uses_anonymous_args = 0
 1937              		@ link register save eliminated.
 1938 0000 80B4     		push	{r7}
 1939              		.cfi_def_cfa_offset 4
 1940              		.cfi_offset 7, -4
 1941 0002 00AF     		add	r7, sp, #0
 1942              		.cfi_def_cfa_register 7
 384:bluetooth_rxtx.c **** 	IO2IntEnF &= ~PIN_GIO6;    // Disable port 2.2 falling (CS active low)
 1943              		.loc 1 384 0
 1944 0004 094A     		ldr	r2, .L44
 1945 0006 094B     		ldr	r3, .L44
 1946 0008 1B68     		ldr	r3, [r3]
 1947 000a 23F00403 		bic	r3, r3, #4
 1948 000e 1360     		str	r3, [r2]
 385:bluetooth_rxtx.c **** 	IO2IntClr = PIN_GIO6;      // Clear pending
 1949              		.loc 1 385 0
 1950 0010 074B     		ldr	r3, .L44+4
 1951 0012 0422     		movs	r2, #4
 1952 0014 1A60     		str	r2, [r3]
 386:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_EINT3;
 1953              		.loc 1 386 0
 1954 0016 074B     		ldr	r3, .L44+8
 1955 0018 4FF40012 		mov	r2, #2097152
 1956 001c 1A60     		str	r2, [r3]
 387:bluetooth_rxtx.c **** 	cs_trigger = 0;
 1957              		.loc 1 387 0
 1958 001e 064B     		ldr	r3, .L44+12
 1959 0020 0022     		movs	r2, #0
 1960 0022 1A70     		strb	r2, [r3]
 388:bluetooth_rxtx.c **** }
 1961              		.loc 1 388 0
 1962 0024 BD46     		mov	sp, r7
 1963              		.cfi_def_cfa_register 13
 1964              		@ sp needed
 1965 0026 5DF8047B 		ldr	r7, [sp], #4
 1966              		.cfi_restore 7
 1967              		.cfi_def_cfa_offset 0
 1968 002a 7047     		bx	lr
 1969              	.L45:
 1970              		.align	2
ARM GAS  /tmp/ccUeeWpa.s 			page 41


 1971              	.L44:
 1972 002c B4800240 		.word	1073905844
 1973 0030 AC800240 		.word	1073905836
 1974 0034 80E100E0 		.word	-536813184
 1975 0038 00000000 		.word	cs_trigger
 1976              		.cfi_endproc
 1977              	.LFE8:
 1979              		.section	.rodata
 1980 08bd 000000   		.align	2
 1981              	.LC3:
 1982 08c0 32303135 		.ascii	"2015-10-R1\000"
 1982      2D31302D 
 1982      523100
 1983              		.section	.text.vendor_request_handler,"ax",%progbits
 1984              		.align	2
 1985              		.thumb
 1986              		.thumb_func
 1988              	vendor_request_handler:
 1989              	.LFB9:
 389:bluetooth_rxtx.c **** 
 390:bluetooth_rxtx.c **** static int vendor_request_handler(u8 request, u16 *request_params, u8 *data, int *data_len)
 391:bluetooth_rxtx.c **** {
 1990              		.loc 1 391 0
 1991              		.cfi_startproc
 1992              		@ args = 0, pretend = 0, frame = 80
 1993              		@ frame_needed = 1, uses_anonymous_args = 0
 1994 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 1995              		.cfi_def_cfa_offset 36
 1996              		.cfi_offset 4, -36
 1997              		.cfi_offset 5, -32
 1998              		.cfi_offset 6, -28
 1999              		.cfi_offset 7, -24
 2000              		.cfi_offset 8, -20
 2001              		.cfi_offset 9, -16
 2002              		.cfi_offset 10, -12
 2003              		.cfi_offset 11, -8
 2004              		.cfi_offset 14, -4
 2005 0004 95B0     		sub	sp, sp, #84
 2006              		.cfi_def_cfa_offset 120
 2007 0006 00AF     		add	r7, sp, #0
 2008              		.cfi_def_cfa_register 7
 2009 0008 B960     		str	r1, [r7, #8]
 2010 000a 7A60     		str	r2, [r7, #4]
 2011 000c 3B60     		str	r3, [r7]
 2012 000e 0346     		mov	r3, r0
 2013 0010 FB73     		strb	r3, [r7, #15]
 392:bluetooth_rxtx.c **** 	u32 command[5];
 393:bluetooth_rxtx.c **** 	u32 result[5];
 394:bluetooth_rxtx.c **** 	u64 ac_copy;
 395:bluetooth_rxtx.c **** 	int i; // loop counter
 396:bluetooth_rxtx.c **** 	u32 clock;
 397:bluetooth_rxtx.c **** 	int clock_offset;
 398:bluetooth_rxtx.c **** 	u8 length; // string length
 399:bluetooth_rxtx.c **** 	usb_pkt_rx *p = NULL;
 2014              		.loc 1 399 0
 2015 0012 0023     		movs	r3, #0
 2016 0014 7B64     		str	r3, [r7, #68]
ARM GAS  /tmp/ccUeeWpa.s 			page 42


 400:bluetooth_rxtx.c **** 	u16 reg_val;
 401:bluetooth_rxtx.c **** 
 402:bluetooth_rxtx.c **** 	switch (request) {
 2017              		.loc 1 402 0
 2018 0016 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2019 0018 3C2B     		cmp	r3, #60
 2020 001a 00F25185 		bhi	.L47
 2021 001e 01A2     		adr	r2, .L49
 2022 0020 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 2023              		.p2align 2
 2024              	.L49:
 2025 0024 19010000 		.word	.L48+1
 2026 0028 23010000 		.word	.L50+1
 2027 002c C10A0000 		.word	.L47+1
 2028 0030 33010000 		.word	.L51+1
 2029 0034 55010000 		.word	.L52+1
 2030 0038 71010000 		.word	.L53+1
 2031 003c 93010000 		.word	.L54+1
 2032 0040 AF010000 		.word	.L55+1
 2033 0044 D1010000 		.word	.L56+1
 2034 0048 F1010000 		.word	.L57+1
 2035 004c 13020000 		.word	.L58+1
 2036 0050 B7040000 		.word	.L59+1
 2037 0054 DD040000 		.word	.L60+1
 2038 0058 89020000 		.word	.L61+1
 2039 005c 93020000 		.word	.L62+1
 2040 0060 33020000 		.word	.L63+1
 2041 0064 71030000 		.word	.L64+1
 2042 0068 91030000 		.word	.L65+1
 2043 006c C9030000 		.word	.L66+1
 2044 0070 E9030000 		.word	.L67+1
 2045 0074 05040000 		.word	.L68+1
 2046 0078 91040000 		.word	.L69+1
 2047 007c 99040000 		.word	.L70+1
 2048 0080 AB040000 		.word	.L71+1
 2049 0084 67050000 		.word	.L72+1
 2050 0088 85050000 		.word	.L73+1
 2051 008c C10A0000 		.word	.L47+1
 2052 0090 91050000 		.word	.L74+1
 2053 0094 0D040000 		.word	.L75+1
 2054 0098 29040000 		.word	.L76+1
 2055 009c 51040000 		.word	.L77+1
 2056 00a0 49040000 		.word	.L78+1
 2057 00a4 59040000 		.word	.L79+1
 2058 00a8 55060000 		.word	.L80+1
 2059 00ac ED050000 		.word	.L81+1
 2060 00b0 C9060000 		.word	.L82+1
 2061 00b4 D7060000 		.word	.L83+1
 2062 00b8 E7060000 		.word	.L84+1
 2063 00bc F9060000 		.word	.L85+1
 2064 00c0 C5070000 		.word	.L86+1
 2065 00c4 0B080000 		.word	.L87+1
 2066 00c8 99080000 		.word	.L88+1
 2067 00cc CD080000 		.word	.L89+1
 2068 00d0 EF080000 		.word	.L90+1
 2069 00d4 47090000 		.word	.L91+1
 2070 00d8 C50A0000 		.word	.L150+1
ARM GAS  /tmp/ccUeeWpa.s 			page 43


 2071 00dc 79090000 		.word	.L93+1
 2072 00e0 8F090000 		.word	.L94+1
 2073 00e4 AB090000 		.word	.L95+1
 2074 00e8 C1090000 		.word	.L96+1
 2075 00ec ED090000 		.word	.L97+1
 2076 00f0 3D080000 		.word	.L98+1
 2077 00f4 6F080000 		.word	.L99+1
 2078 00f8 090A0000 		.word	.L100+1
 2079 00fc 4D0A0000 		.word	.L101+1
 2080 0100 97060000 		.word	.L102+1
 2081 0104 5F0A0000 		.word	.L103+1
 2082 0108 C10A0000 		.word	.L47+1
 2083 010c 370A0000 		.word	.L104+1
 2084 0110 A30A0000 		.word	.L105+1
 2085 0114 AF0A0000 		.word	.L106+1
 2086              		.p2align 1
 2087              	.L48:
 403:bluetooth_rxtx.c **** 
 404:bluetooth_rxtx.c **** 	case UBERTOOTH_PING:
 405:bluetooth_rxtx.c **** 		*data_len = 0;
 2088              		.loc 1 405 0
 2089 0118 3B68     		ldr	r3, [r7]
 2090 011a 0022     		movs	r2, #0
 2091 011c 1A60     		str	r2, [r3]
 406:bluetooth_rxtx.c **** 		break;
 2092              		.loc 1 406 0
 2093 011e 00F0D2BC 		b	.L107
 2094              	.L50:
 407:bluetooth_rxtx.c **** 
 408:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_SYMBOLS:
 409:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_SYMBOLS;
 2095              		.loc 1 409 0
 2096 0122 A14B     		ldr	r3, .L151
 2097 0124 0122     		movs	r2, #1
 2098 0126 1A70     		strb	r2, [r3]
 410:bluetooth_rxtx.c **** 		*data_len = 0;
 2099              		.loc 1 410 0
 2100 0128 3B68     		ldr	r3, [r7]
 2101 012a 0022     		movs	r2, #0
 2102 012c 1A60     		str	r2, [r3]
 411:bluetooth_rxtx.c **** 		break;
 2103              		.loc 1 411 0
 2104 012e 00F0CABC 		b	.L107
 2105              	.L51:
 412:bluetooth_rxtx.c **** 
 413:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_USRLED:
 414:bluetooth_rxtx.c **** 		data[0] = (USRLED) ? 1 : 0;
 2106              		.loc 1 414 0
 2107 0132 9E4B     		ldr	r3, .L151+4
 2108 0134 1B68     		ldr	r3, [r3]
 2109 0136 03F00203 		and	r3, r3, #2
 2110 013a 002B     		cmp	r3, #0
 2111 013c 14BF     		ite	ne
 2112 013e 0123     		movne	r3, #1
 2113 0140 0023     		moveq	r3, #0
 2114 0142 DBB2     		uxtb	r3, r3
 2115 0144 1A46     		mov	r2, r3
ARM GAS  /tmp/ccUeeWpa.s 			page 44


 2116 0146 7B68     		ldr	r3, [r7, #4]
 2117 0148 1A70     		strb	r2, [r3]
 415:bluetooth_rxtx.c **** 		*data_len = 1;
 2118              		.loc 1 415 0
 2119 014a 3B68     		ldr	r3, [r7]
 2120 014c 0122     		movs	r2, #1
 2121 014e 1A60     		str	r2, [r3]
 416:bluetooth_rxtx.c **** 		break;
 2122              		.loc 1 416 0
 2123 0150 00F0B9BC 		b	.L107
 2124              	.L52:
 417:bluetooth_rxtx.c **** 
 418:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_USRLED:
 419:bluetooth_rxtx.c **** 		if (request_params[0])
 2125              		.loc 1 419 0
 2126 0154 BB68     		ldr	r3, [r7, #8]
 2127 0156 1B88     		ldrh	r3, [r3]
 2128 0158 002B     		cmp	r3, #0
 2129 015a 04D0     		beq	.L108
 420:bluetooth_rxtx.c **** 			USRLED_SET;
 2130              		.loc 1 420 0
 2131 015c 944B     		ldr	r3, .L151+8
 2132 015e 0222     		movs	r2, #2
 2133 0160 1A60     		str	r2, [r3]
 421:bluetooth_rxtx.c **** 		else
 422:bluetooth_rxtx.c **** 			USRLED_CLR;
 423:bluetooth_rxtx.c **** 		break;
 2134              		.loc 1 423 0
 2135 0162 00F0B0BC 		b	.L107
 2136              	.L108:
 422:bluetooth_rxtx.c **** 		break;
 2137              		.loc 1 422 0
 2138 0166 934B     		ldr	r3, .L151+12
 2139 0168 0222     		movs	r2, #2
 2140 016a 1A60     		str	r2, [r3]
 2141              		.loc 1 423 0
 2142 016c 00F0ABBC 		b	.L107
 2143              	.L53:
 424:bluetooth_rxtx.c **** 
 425:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_RXLED:
 426:bluetooth_rxtx.c **** 		data[0] = (RXLED) ? 1 : 0;
 2144              		.loc 1 426 0
 2145 0170 8E4B     		ldr	r3, .L151+4
 2146 0172 1B68     		ldr	r3, [r3]
 2147 0174 03F01003 		and	r3, r3, #16
 2148 0178 002B     		cmp	r3, #0
 2149 017a 14BF     		ite	ne
 2150 017c 0123     		movne	r3, #1
 2151 017e 0023     		moveq	r3, #0
 2152 0180 DBB2     		uxtb	r3, r3
 2153 0182 1A46     		mov	r2, r3
 2154 0184 7B68     		ldr	r3, [r7, #4]
 2155 0186 1A70     		strb	r2, [r3]
 427:bluetooth_rxtx.c **** 		*data_len = 1;
 2156              		.loc 1 427 0
 2157 0188 3B68     		ldr	r3, [r7]
 2158 018a 0122     		movs	r2, #1
ARM GAS  /tmp/ccUeeWpa.s 			page 45


 2159 018c 1A60     		str	r2, [r3]
 428:bluetooth_rxtx.c **** 		break;
 2160              		.loc 1 428 0
 2161 018e 00F09ABC 		b	.L107
 2162              	.L54:
 429:bluetooth_rxtx.c **** 
 430:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_RXLED:
 431:bluetooth_rxtx.c **** 		if (request_params[0])
 2163              		.loc 1 431 0
 2164 0192 BB68     		ldr	r3, [r7, #8]
 2165 0194 1B88     		ldrh	r3, [r3]
 2166 0196 002B     		cmp	r3, #0
 2167 0198 04D0     		beq	.L110
 432:bluetooth_rxtx.c **** 			RXLED_SET;
 2168              		.loc 1 432 0
 2169 019a 854B     		ldr	r3, .L151+8
 2170 019c 1022     		movs	r2, #16
 2171 019e 1A60     		str	r2, [r3]
 433:bluetooth_rxtx.c **** 		else
 434:bluetooth_rxtx.c **** 			RXLED_CLR;
 435:bluetooth_rxtx.c **** 		break;
 2172              		.loc 1 435 0
 2173 01a0 00F091BC 		b	.L107
 2174              	.L110:
 434:bluetooth_rxtx.c **** 		break;
 2175              		.loc 1 434 0
 2176 01a4 834B     		ldr	r3, .L151+12
 2177 01a6 1022     		movs	r2, #16
 2178 01a8 1A60     		str	r2, [r3]
 2179              		.loc 1 435 0
 2180 01aa 00F08CBC 		b	.L107
 2181              	.L55:
 436:bluetooth_rxtx.c **** 
 437:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_TXLED:
 438:bluetooth_rxtx.c **** 		data[0] = (TXLED) ? 1 : 0;
 2182              		.loc 1 438 0
 2183 01ae 7F4B     		ldr	r3, .L151+4
 2184 01b0 1B68     		ldr	r3, [r3]
 2185 01b2 03F48073 		and	r3, r3, #256
 2186 01b6 002B     		cmp	r3, #0
 2187 01b8 14BF     		ite	ne
 2188 01ba 0123     		movne	r3, #1
 2189 01bc 0023     		moveq	r3, #0
 2190 01be DBB2     		uxtb	r3, r3
 2191 01c0 1A46     		mov	r2, r3
 2192 01c2 7B68     		ldr	r3, [r7, #4]
 2193 01c4 1A70     		strb	r2, [r3]
 439:bluetooth_rxtx.c **** 		*data_len = 1;
 2194              		.loc 1 439 0
 2195 01c6 3B68     		ldr	r3, [r7]
 2196 01c8 0122     		movs	r2, #1
 2197 01ca 1A60     		str	r2, [r3]
 440:bluetooth_rxtx.c **** 		break;
 2198              		.loc 1 440 0
 2199 01cc 00F07BBC 		b	.L107
 2200              	.L56:
 441:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccUeeWpa.s 			page 46


 442:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_TXLED:
 443:bluetooth_rxtx.c **** 		if (request_params[0])
 2201              		.loc 1 443 0
 2202 01d0 BB68     		ldr	r3, [r7, #8]
 2203 01d2 1B88     		ldrh	r3, [r3]
 2204 01d4 002B     		cmp	r3, #0
 2205 01d6 05D0     		beq	.L112
 444:bluetooth_rxtx.c **** 			TXLED_SET;
 2206              		.loc 1 444 0
 2207 01d8 754B     		ldr	r3, .L151+8
 2208 01da 4FF48072 		mov	r2, #256
 2209 01de 1A60     		str	r2, [r3]
 445:bluetooth_rxtx.c **** 		else
 446:bluetooth_rxtx.c **** 			TXLED_CLR;
 447:bluetooth_rxtx.c **** 		break;
 2210              		.loc 1 447 0
 2211 01e0 00F071BC 		b	.L107
 2212              	.L112:
 446:bluetooth_rxtx.c **** 		break;
 2213              		.loc 1 446 0
 2214 01e4 734B     		ldr	r3, .L151+12
 2215 01e6 4FF48072 		mov	r2, #256
 2216 01ea 1A60     		str	r2, [r3]
 2217              		.loc 1 447 0
 2218 01ec 00F06BBC 		b	.L107
 2219              	.L57:
 448:bluetooth_rxtx.c **** 
 449:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_1V8:
 450:bluetooth_rxtx.c **** 		data[0] = (CC1V8) ? 1 : 0;
 2220              		.loc 1 450 0
 2221 01f0 6E4B     		ldr	r3, .L151+4
 2222 01f2 1B68     		ldr	r3, [r3]
 2223 01f4 03F40073 		and	r3, r3, #512
 2224 01f8 002B     		cmp	r3, #0
 2225 01fa 14BF     		ite	ne
 2226 01fc 0123     		movne	r3, #1
 2227 01fe 0023     		moveq	r3, #0
 2228 0200 DBB2     		uxtb	r3, r3
 2229 0202 1A46     		mov	r2, r3
 2230 0204 7B68     		ldr	r3, [r7, #4]
 2231 0206 1A70     		strb	r2, [r3]
 451:bluetooth_rxtx.c **** 		*data_len = 1;
 2232              		.loc 1 451 0
 2233 0208 3B68     		ldr	r3, [r7]
 2234 020a 0122     		movs	r2, #1
 2235 020c 1A60     		str	r2, [r3]
 452:bluetooth_rxtx.c **** 		break;
 2236              		.loc 1 452 0
 2237 020e 00F05ABC 		b	.L107
 2238              	.L58:
 453:bluetooth_rxtx.c **** 
 454:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_1V8:
 455:bluetooth_rxtx.c **** 		if (request_params[0])
 2239              		.loc 1 455 0
 2240 0212 BB68     		ldr	r3, [r7, #8]
 2241 0214 1B88     		ldrh	r3, [r3]
 2242 0216 002B     		cmp	r3, #0
ARM GAS  /tmp/ccUeeWpa.s 			page 47


 2243 0218 05D0     		beq	.L114
 456:bluetooth_rxtx.c **** 			CC1V8_SET;
 2244              		.loc 1 456 0
 2245 021a 654B     		ldr	r3, .L151+8
 2246 021c 4FF40072 		mov	r2, #512
 2247 0220 1A60     		str	r2, [r3]
 457:bluetooth_rxtx.c **** 		else
 458:bluetooth_rxtx.c **** 			CC1V8_CLR;
 459:bluetooth_rxtx.c **** 		break;
 2248              		.loc 1 459 0
 2249 0222 00F050BC 		b	.L107
 2250              	.L114:
 458:bluetooth_rxtx.c **** 		break;
 2251              		.loc 1 458 0
 2252 0226 634B     		ldr	r3, .L151+12
 2253 0228 4FF40072 		mov	r2, #512
 2254 022c 1A60     		str	r2, [r3]
 2255              		.loc 1 459 0
 2256 022e 00F04ABC 		b	.L107
 2257              	.L63:
 460:bluetooth_rxtx.c **** 
 461:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PARTNUM:
 462:bluetooth_rxtx.c **** 		command[0] = 54; /* read part number */
 2258              		.loc 1 462 0
 2259 0232 3623     		movs	r3, #54
 2260 0234 7B62     		str	r3, [r7, #36]
 463:bluetooth_rxtx.c **** 		iap_entry(command, result);
 2261              		.loc 1 463 0
 2262 0236 604B     		ldr	r3, .L151+16
 2263 0238 1B68     		ldr	r3, [r3]
 2264 023a 07F12401 		add	r1, r7, #36
 2265 023e 07F11002 		add	r2, r7, #16
 2266 0242 0846     		mov	r0, r1
 2267 0244 1146     		mov	r1, r2
 2268 0246 9847     		blx	r3
 464:bluetooth_rxtx.c **** 		data[0] = result[0] & 0xFF; /* status */
 2269              		.loc 1 464 0
 2270 0248 3B69     		ldr	r3, [r7, #16]
 2271 024a DAB2     		uxtb	r2, r3
 2272 024c 7B68     		ldr	r3, [r7, #4]
 2273 024e 1A70     		strb	r2, [r3]
 465:bluetooth_rxtx.c **** 		data[1] = result[1] & 0xFF;
 2274              		.loc 1 465 0
 2275 0250 7B68     		ldr	r3, [r7, #4]
 2276 0252 0133     		adds	r3, r3, #1
 2277 0254 7A69     		ldr	r2, [r7, #20]
 2278 0256 D2B2     		uxtb	r2, r2
 2279 0258 1A70     		strb	r2, [r3]
 466:bluetooth_rxtx.c **** 		data[2] = (result[1] >> 8) & 0xFF;
 2280              		.loc 1 466 0
 2281 025a 7B68     		ldr	r3, [r7, #4]
 2282 025c 0233     		adds	r3, r3, #2
 2283 025e 7A69     		ldr	r2, [r7, #20]
 2284 0260 120A     		lsrs	r2, r2, #8
 2285 0262 D2B2     		uxtb	r2, r2
 2286 0264 1A70     		strb	r2, [r3]
 467:bluetooth_rxtx.c **** 		data[3] = (result[1] >> 16) & 0xFF;
ARM GAS  /tmp/ccUeeWpa.s 			page 48


 2287              		.loc 1 467 0
 2288 0266 7B68     		ldr	r3, [r7, #4]
 2289 0268 0333     		adds	r3, r3, #3
 2290 026a 7A69     		ldr	r2, [r7, #20]
 2291 026c 120C     		lsrs	r2, r2, #16
 2292 026e D2B2     		uxtb	r2, r2
 2293 0270 1A70     		strb	r2, [r3]
 468:bluetooth_rxtx.c **** 		data[4] = (result[1] >> 24) & 0xFF;
 2294              		.loc 1 468 0
 2295 0272 7B68     		ldr	r3, [r7, #4]
 2296 0274 0433     		adds	r3, r3, #4
 2297 0276 7A69     		ldr	r2, [r7, #20]
 2298 0278 120E     		lsrs	r2, r2, #24
 2299 027a D2B2     		uxtb	r2, r2
 2300 027c 1A70     		strb	r2, [r3]
 469:bluetooth_rxtx.c **** 		*data_len = 5;
 2301              		.loc 1 469 0
 2302 027e 3B68     		ldr	r3, [r7]
 2303 0280 0522     		movs	r2, #5
 2304 0282 1A60     		str	r2, [r3]
 470:bluetooth_rxtx.c **** 		break;
 2305              		.loc 1 470 0
 2306 0284 00F01FBC 		b	.L107
 2307              	.L61:
 471:bluetooth_rxtx.c **** 
 472:bluetooth_rxtx.c **** 	case UBERTOOTH_RESET:
 473:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 2308              		.loc 1 473 0
 2309 0288 474B     		ldr	r3, .L151
 2310 028a 0B22     		movs	r2, #11
 2311 028c 1A70     		strb	r2, [r3]
 474:bluetooth_rxtx.c **** 		break;
 2312              		.loc 1 474 0
 2313 028e 00F01ABC 		b	.L107
 2314              	.L62:
 475:bluetooth_rxtx.c **** 
 476:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SERIAL:
 477:bluetooth_rxtx.c **** 		command[0] = 58; /* read device serial number */
 2315              		.loc 1 477 0
 2316 0292 3A23     		movs	r3, #58
 2317 0294 7B62     		str	r3, [r7, #36]
 478:bluetooth_rxtx.c **** 		iap_entry(command, result);
 2318              		.loc 1 478 0
 2319 0296 484B     		ldr	r3, .L151+16
 2320 0298 1B68     		ldr	r3, [r3]
 2321 029a 07F12401 		add	r1, r7, #36
 2322 029e 07F11002 		add	r2, r7, #16
 2323 02a2 0846     		mov	r0, r1
 2324 02a4 1146     		mov	r1, r2
 2325 02a6 9847     		blx	r3
 479:bluetooth_rxtx.c **** 		data[0] = result[0] & 0xFF; /* status */
 2326              		.loc 1 479 0
 2327 02a8 3B69     		ldr	r3, [r7, #16]
 2328 02aa DAB2     		uxtb	r2, r3
 2329 02ac 7B68     		ldr	r3, [r7, #4]
 2330 02ae 1A70     		strb	r2, [r3]
 480:bluetooth_rxtx.c **** 		data[1] = result[1] & 0xFF;
ARM GAS  /tmp/ccUeeWpa.s 			page 49


 2331              		.loc 1 480 0
 2332 02b0 7B68     		ldr	r3, [r7, #4]
 2333 02b2 0133     		adds	r3, r3, #1
 2334 02b4 7A69     		ldr	r2, [r7, #20]
 2335 02b6 D2B2     		uxtb	r2, r2
 2336 02b8 1A70     		strb	r2, [r3]
 481:bluetooth_rxtx.c **** 		data[2] = (result[1] >> 8) & 0xFF;
 2337              		.loc 1 481 0
 2338 02ba 7B68     		ldr	r3, [r7, #4]
 2339 02bc 0233     		adds	r3, r3, #2
 2340 02be 7A69     		ldr	r2, [r7, #20]
 2341 02c0 120A     		lsrs	r2, r2, #8
 2342 02c2 D2B2     		uxtb	r2, r2
 2343 02c4 1A70     		strb	r2, [r3]
 482:bluetooth_rxtx.c **** 		data[3] = (result[1] >> 16) & 0xFF;
 2344              		.loc 1 482 0
 2345 02c6 7B68     		ldr	r3, [r7, #4]
 2346 02c8 0333     		adds	r3, r3, #3
 2347 02ca 7A69     		ldr	r2, [r7, #20]
 2348 02cc 120C     		lsrs	r2, r2, #16
 2349 02ce D2B2     		uxtb	r2, r2
 2350 02d0 1A70     		strb	r2, [r3]
 483:bluetooth_rxtx.c **** 		data[4] = (result[1] >> 24) & 0xFF;
 2351              		.loc 1 483 0
 2352 02d2 7B68     		ldr	r3, [r7, #4]
 2353 02d4 0433     		adds	r3, r3, #4
 2354 02d6 7A69     		ldr	r2, [r7, #20]
 2355 02d8 120E     		lsrs	r2, r2, #24
 2356 02da D2B2     		uxtb	r2, r2
 2357 02dc 1A70     		strb	r2, [r3]
 484:bluetooth_rxtx.c **** 		data[5] = result[2] & 0xFF;
 2358              		.loc 1 484 0
 2359 02de 7B68     		ldr	r3, [r7, #4]
 2360 02e0 0533     		adds	r3, r3, #5
 2361 02e2 BA69     		ldr	r2, [r7, #24]
 2362 02e4 D2B2     		uxtb	r2, r2
 2363 02e6 1A70     		strb	r2, [r3]
 485:bluetooth_rxtx.c **** 		data[6] = (result[2] >> 8) & 0xFF;
 2364              		.loc 1 485 0
 2365 02e8 7B68     		ldr	r3, [r7, #4]
 2366 02ea 0633     		adds	r3, r3, #6
 2367 02ec BA69     		ldr	r2, [r7, #24]
 2368 02ee 120A     		lsrs	r2, r2, #8
 2369 02f0 D2B2     		uxtb	r2, r2
 2370 02f2 1A70     		strb	r2, [r3]
 486:bluetooth_rxtx.c **** 		data[7] = (result[2] >> 16) & 0xFF;
 2371              		.loc 1 486 0
 2372 02f4 7B68     		ldr	r3, [r7, #4]
 2373 02f6 0733     		adds	r3, r3, #7
 2374 02f8 BA69     		ldr	r2, [r7, #24]
 2375 02fa 120C     		lsrs	r2, r2, #16
 2376 02fc D2B2     		uxtb	r2, r2
 2377 02fe 1A70     		strb	r2, [r3]
 487:bluetooth_rxtx.c **** 		data[8] = (result[2] >> 24) & 0xFF;
 2378              		.loc 1 487 0
 2379 0300 7B68     		ldr	r3, [r7, #4]
 2380 0302 0833     		adds	r3, r3, #8
ARM GAS  /tmp/ccUeeWpa.s 			page 50


 2381 0304 BA69     		ldr	r2, [r7, #24]
 2382 0306 120E     		lsrs	r2, r2, #24
 2383 0308 D2B2     		uxtb	r2, r2
 2384 030a 1A70     		strb	r2, [r3]
 488:bluetooth_rxtx.c **** 		data[9] = result[3] & 0xFF;
 2385              		.loc 1 488 0
 2386 030c 7B68     		ldr	r3, [r7, #4]
 2387 030e 0933     		adds	r3, r3, #9
 2388 0310 FA69     		ldr	r2, [r7, #28]
 2389 0312 D2B2     		uxtb	r2, r2
 2390 0314 1A70     		strb	r2, [r3]
 489:bluetooth_rxtx.c **** 		data[10] = (result[3] >> 8) & 0xFF;
 2391              		.loc 1 489 0
 2392 0316 7B68     		ldr	r3, [r7, #4]
 2393 0318 0A33     		adds	r3, r3, #10
 2394 031a FA69     		ldr	r2, [r7, #28]
 2395 031c 120A     		lsrs	r2, r2, #8
 2396 031e D2B2     		uxtb	r2, r2
 2397 0320 1A70     		strb	r2, [r3]
 490:bluetooth_rxtx.c **** 		data[11] = (result[3] >> 16) & 0xFF;
 2398              		.loc 1 490 0
 2399 0322 7B68     		ldr	r3, [r7, #4]
 2400 0324 0B33     		adds	r3, r3, #11
 2401 0326 FA69     		ldr	r2, [r7, #28]
 2402 0328 120C     		lsrs	r2, r2, #16
 2403 032a D2B2     		uxtb	r2, r2
 2404 032c 1A70     		strb	r2, [r3]
 491:bluetooth_rxtx.c **** 		data[12] = (result[3] >> 24) & 0xFF;
 2405              		.loc 1 491 0
 2406 032e 7B68     		ldr	r3, [r7, #4]
 2407 0330 0C33     		adds	r3, r3, #12
 2408 0332 FA69     		ldr	r2, [r7, #28]
 2409 0334 120E     		lsrs	r2, r2, #24
 2410 0336 D2B2     		uxtb	r2, r2
 2411 0338 1A70     		strb	r2, [r3]
 492:bluetooth_rxtx.c **** 		data[13] = result[4] & 0xFF;
 2412              		.loc 1 492 0
 2413 033a 7B68     		ldr	r3, [r7, #4]
 2414 033c 0D33     		adds	r3, r3, #13
 2415 033e 3A6A     		ldr	r2, [r7, #32]
 2416 0340 D2B2     		uxtb	r2, r2
 2417 0342 1A70     		strb	r2, [r3]
 493:bluetooth_rxtx.c **** 		data[14] = (result[4] >> 8) & 0xFF;
 2418              		.loc 1 493 0
 2419 0344 7B68     		ldr	r3, [r7, #4]
 2420 0346 0E33     		adds	r3, r3, #14
 2421 0348 3A6A     		ldr	r2, [r7, #32]
 2422 034a 120A     		lsrs	r2, r2, #8
 2423 034c D2B2     		uxtb	r2, r2
 2424 034e 1A70     		strb	r2, [r3]
 494:bluetooth_rxtx.c **** 		data[15] = (result[4] >> 16) & 0xFF;
 2425              		.loc 1 494 0
 2426 0350 7B68     		ldr	r3, [r7, #4]
 2427 0352 0F33     		adds	r3, r3, #15
 2428 0354 3A6A     		ldr	r2, [r7, #32]
 2429 0356 120C     		lsrs	r2, r2, #16
 2430 0358 D2B2     		uxtb	r2, r2
ARM GAS  /tmp/ccUeeWpa.s 			page 51


 2431 035a 1A70     		strb	r2, [r3]
 495:bluetooth_rxtx.c **** 		data[16] = (result[4] >> 24) & 0xFF;
 2432              		.loc 1 495 0
 2433 035c 7B68     		ldr	r3, [r7, #4]
 2434 035e 1033     		adds	r3, r3, #16
 2435 0360 3A6A     		ldr	r2, [r7, #32]
 2436 0362 120E     		lsrs	r2, r2, #24
 2437 0364 D2B2     		uxtb	r2, r2
 2438 0366 1A70     		strb	r2, [r3]
 496:bluetooth_rxtx.c **** 		*data_len = 17;
 2439              		.loc 1 496 0
 2440 0368 3B68     		ldr	r3, [r7]
 2441 036a 1122     		movs	r2, #17
 2442 036c 1A60     		str	r2, [r3]
 497:bluetooth_rxtx.c **** 		break;
 2443              		.loc 1 497 0
 2444 036e AAE3     		b	.L107
 2445              	.L64:
 498:bluetooth_rxtx.c **** 
 499:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 500:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PAEN:
 501:bluetooth_rxtx.c **** 		data[0] = (PAEN) ? 1 : 0;
 2446              		.loc 1 501 0
 2447 0370 124B     		ldr	r3, .L151+20
 2448 0372 1B68     		ldr	r3, [r3]
 2449 0374 03F08003 		and	r3, r3, #128
 2450 0378 002B     		cmp	r3, #0
 2451 037a 14BF     		ite	ne
 2452 037c 0123     		movne	r3, #1
 2453 037e 0023     		moveq	r3, #0
 2454 0380 DBB2     		uxtb	r3, r3
 2455 0382 1A46     		mov	r2, r3
 2456 0384 7B68     		ldr	r3, [r7, #4]
 2457 0386 1A70     		strb	r2, [r3]
 502:bluetooth_rxtx.c **** 		*data_len = 1;
 2458              		.loc 1 502 0
 2459 0388 3B68     		ldr	r3, [r7]
 2460 038a 0122     		movs	r2, #1
 2461 038c 1A60     		str	r2, [r3]
 503:bluetooth_rxtx.c **** 		break;
 2462              		.loc 1 503 0
 2463 038e 9AE3     		b	.L107
 2464              	.L65:
 504:bluetooth_rxtx.c **** 
 505:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PAEN:
 506:bluetooth_rxtx.c **** 		if (request_params[0])
 2465              		.loc 1 506 0
 2466 0390 BB68     		ldr	r3, [r7, #8]
 2467 0392 1B88     		ldrh	r3, [r3]
 2468 0394 002B     		cmp	r3, #0
 2469 0396 03D0     		beq	.L116
 507:bluetooth_rxtx.c **** 			PAEN_SET;
 2470              		.loc 1 507 0
 2471 0398 094B     		ldr	r3, .L151+24
 2472 039a 8022     		movs	r2, #128
 2473 039c 1A60     		str	r2, [r3]
 508:bluetooth_rxtx.c **** 		else
ARM GAS  /tmp/ccUeeWpa.s 			page 52


 509:bluetooth_rxtx.c **** 			PAEN_CLR;
 510:bluetooth_rxtx.c **** 		break;
 2474              		.loc 1 510 0
 2475 039e 92E3     		b	.L107
 2476              	.L116:
 509:bluetooth_rxtx.c **** 		break;
 2477              		.loc 1 509 0
 2478 03a0 084B     		ldr	r3, .L151+28
 2479 03a2 8022     		movs	r2, #128
 2480 03a4 1A60     		str	r2, [r3]
 2481              		.loc 1 510 0
 2482 03a6 8EE3     		b	.L107
 2483              	.L152:
 2484              		.align	2
 2485              	.L151:
 2486 03a8 00000000 		.word	requested_mode
 2487 03ac 34C00920 		.word	537509940
 2488 03b0 38C00920 		.word	537509944
 2489 03b4 3CC00920 		.word	537509948
 2490 03b8 00000000 		.word	iap_entry
 2491 03bc 54C00920 		.word	537509972
 2492 03c0 58C00920 		.word	537509976
 2493 03c4 5CC00920 		.word	537509980
 2494              	.L66:
 511:bluetooth_rxtx.c **** 
 512:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_HGM:
 513:bluetooth_rxtx.c **** 		data[0] = (HGM) ? 1 : 0;
 2495              		.loc 1 513 0
 2496 03c8 924B     		ldr	r3, .L153
 2497 03ca 1B68     		ldr	r3, [r3]
 2498 03cc 03F48073 		and	r3, r3, #256
 2499 03d0 002B     		cmp	r3, #0
 2500 03d2 14BF     		ite	ne
 2501 03d4 0123     		movne	r3, #1
 2502 03d6 0023     		moveq	r3, #0
 2503 03d8 DBB2     		uxtb	r3, r3
 2504 03da 1A46     		mov	r2, r3
 2505 03dc 7B68     		ldr	r3, [r7, #4]
 2506 03de 1A70     		strb	r2, [r3]
 514:bluetooth_rxtx.c **** 		*data_len = 1;
 2507              		.loc 1 514 0
 2508 03e0 3B68     		ldr	r3, [r7]
 2509 03e2 0122     		movs	r2, #1
 2510 03e4 1A60     		str	r2, [r3]
 515:bluetooth_rxtx.c **** 		break;
 2511              		.loc 1 515 0
 2512 03e6 6EE3     		b	.L107
 2513              	.L67:
 516:bluetooth_rxtx.c **** 
 517:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_HGM:
 518:bluetooth_rxtx.c **** 		if (request_params[0])
 2514              		.loc 1 518 0
 2515 03e8 BB68     		ldr	r3, [r7, #8]
 2516 03ea 1B88     		ldrh	r3, [r3]
 2517 03ec 002B     		cmp	r3, #0
 2518 03ee 04D0     		beq	.L118
 519:bluetooth_rxtx.c **** 			HGM_SET;
ARM GAS  /tmp/ccUeeWpa.s 			page 53


 2519              		.loc 1 519 0
 2520 03f0 894B     		ldr	r3, .L153+4
 2521 03f2 4FF48072 		mov	r2, #256
 2522 03f6 1A60     		str	r2, [r3]
 520:bluetooth_rxtx.c **** 		else
 521:bluetooth_rxtx.c **** 			HGM_CLR;
 522:bluetooth_rxtx.c **** 		break;
 2523              		.loc 1 522 0
 2524 03f8 65E3     		b	.L107
 2525              	.L118:
 521:bluetooth_rxtx.c **** 		break;
 2526              		.loc 1 521 0
 2527 03fa 884B     		ldr	r3, .L153+8
 2528 03fc 4FF48072 		mov	r2, #256
 2529 0400 1A60     		str	r2, [r3]
 2530              		.loc 1 522 0
 2531 0402 60E3     		b	.L107
 2532              	.L68:
 523:bluetooth_rxtx.c **** #endif
 524:bluetooth_rxtx.c **** 
 525:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 526:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_TEST:
 527:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_TEST;
 2533              		.loc 1 527 0
 2534 0404 864B     		ldr	r3, .L153+12
 2535 0406 0322     		movs	r2, #3
 2536 0408 1A70     		strb	r2, [r3]
 528:bluetooth_rxtx.c **** 		break;
 2537              		.loc 1 528 0
 2538 040a 5CE3     		b	.L107
 2539              	.L75:
 529:bluetooth_rxtx.c **** 
 530:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PALEVEL:
 531:bluetooth_rxtx.c **** 		data[0] = cc2400_get(FREND) & 0x7;
 2540              		.loc 1 531 0
 2541 040c 0520     		movs	r0, #5
 2542 040e FFF7FEFF 		bl	cc2400_get
 2543 0412 0346     		mov	r3, r0
 2544 0414 DBB2     		uxtb	r3, r3
 2545 0416 03F00703 		and	r3, r3, #7
 2546 041a DAB2     		uxtb	r2, r3
 2547 041c 7B68     		ldr	r3, [r7, #4]
 2548 041e 1A70     		strb	r2, [r3]
 532:bluetooth_rxtx.c **** 		*data_len = 1;
 2549              		.loc 1 532 0
 2550 0420 3B68     		ldr	r3, [r7]
 2551 0422 0122     		movs	r2, #1
 2552 0424 1A60     		str	r2, [r3]
 533:bluetooth_rxtx.c **** 		break;
 2553              		.loc 1 533 0
 2554 0426 4EE3     		b	.L107
 2555              	.L76:
 534:bluetooth_rxtx.c **** 
 535:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PALEVEL:
 536:bluetooth_rxtx.c **** 		if( request_params[0] < 8 ) {
 2556              		.loc 1 536 0
 2557 0428 BB68     		ldr	r3, [r7, #8]
ARM GAS  /tmp/ccUeeWpa.s 			page 54


 2558 042a 1B88     		ldrh	r3, [r3]
 2559 042c 072B     		cmp	r3, #7
 2560 042e 09D8     		bhi	.L120
 537:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 2561              		.loc 1 537 0
 2562 0430 BB68     		ldr	r3, [r7, #8]
 2563 0432 1B88     		ldrh	r3, [r3]
 2564 0434 43F00803 		orr	r3, r3, #8
 2565 0438 9BB2     		uxth	r3, r3
 2566 043a 0520     		movs	r0, #5
 2567 043c 1946     		mov	r1, r3
 2568 043e FFF7FEFF 		bl	cc2400_set
 538:bluetooth_rxtx.c **** 		} else {
 539:bluetooth_rxtx.c **** 			return 0;
 540:bluetooth_rxtx.c **** 		}
 541:bluetooth_rxtx.c **** 		break;
 2569              		.loc 1 541 0
 2570 0442 40E3     		b	.L107
 2571              	.L120:
 539:bluetooth_rxtx.c **** 		}
 2572              		.loc 1 539 0
 2573 0444 0023     		movs	r3, #0
 2574 0446 3FE3     		b	.L149
 2575              	.L78:
 542:bluetooth_rxtx.c **** 
 543:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_TEST:
 544:bluetooth_rxtx.c **** 		requested_mode = MODE_RANGE_TEST;
 2576              		.loc 1 544 0
 2577 0448 754B     		ldr	r3, .L153+12
 2578 044a 0522     		movs	r2, #5
 2579 044c 1A70     		strb	r2, [r3]
 545:bluetooth_rxtx.c **** 		break;
 2580              		.loc 1 545 0
 2581 044e 3AE3     		b	.L107
 2582              	.L77:
 546:bluetooth_rxtx.c **** 
 547:bluetooth_rxtx.c **** 	case UBERTOOTH_REPEATER:
 548:bluetooth_rxtx.c **** 		requested_mode = MODE_REPEATER;
 2583              		.loc 1 548 0
 2584 0450 734B     		ldr	r3, .L153+12
 2585 0452 0622     		movs	r2, #6
 2586 0454 1A70     		strb	r2, [r3]
 549:bluetooth_rxtx.c **** 		break;
 2587              		.loc 1 549 0
 2588 0456 36E3     		b	.L107
 2589              	.L79:
 550:bluetooth_rxtx.c **** #endif
 551:bluetooth_rxtx.c **** 
 552:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_CHECK:
 553:bluetooth_rxtx.c **** 		data[0] = rr.valid;
 2590              		.loc 1 553 0
 2591 0458 724B     		ldr	r3, .L153+16
 2592 045a 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 2593 045c 7B68     		ldr	r3, [r7, #4]
 2594 045e 1A70     		strb	r2, [r3]
 554:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 2595              		.loc 1 554 0
ARM GAS  /tmp/ccUeeWpa.s 			page 55


 2596 0460 7B68     		ldr	r3, [r7, #4]
 2597 0462 0133     		adds	r3, r3, #1
 2598 0464 6F4A     		ldr	r2, .L153+16
 2599 0466 5278     		ldrb	r2, [r2, #1]	@ zero_extendqisi2
 2600 0468 1A70     		strb	r2, [r3]
 555:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 2601              		.loc 1 555 0
 2602 046a 7B68     		ldr	r3, [r7, #4]
 2603 046c 0233     		adds	r3, r3, #2
 2604 046e 6D4A     		ldr	r2, .L153+16
 2605 0470 9278     		ldrb	r2, [r2, #2]	@ zero_extendqisi2
 2606 0472 1A70     		strb	r2, [r3]
 556:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 2607              		.loc 1 556 0
 2608 0474 7B68     		ldr	r3, [r7, #4]
 2609 0476 0333     		adds	r3, r3, #3
 2610 0478 6A4A     		ldr	r2, .L153+16
 2611 047a D278     		ldrb	r2, [r2, #3]	@ zero_extendqisi2
 2612 047c 1A70     		strb	r2, [r3]
 557:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 2613              		.loc 1 557 0
 2614 047e 7B68     		ldr	r3, [r7, #4]
 2615 0480 0433     		adds	r3, r3, #4
 2616 0482 684A     		ldr	r2, .L153+16
 2617 0484 1279     		ldrb	r2, [r2, #4]	@ zero_extendqisi2
 2618 0486 1A70     		strb	r2, [r3]
 558:bluetooth_rxtx.c **** 		*data_len = 5;
 2619              		.loc 1 558 0
 2620 0488 3B68     		ldr	r3, [r7]
 2621 048a 0522     		movs	r2, #5
 2622 048c 1A60     		str	r2, [r3]
 559:bluetooth_rxtx.c **** 		break;
 2623              		.loc 1 559 0
 2624 048e 1AE3     		b	.L107
 2625              	.L69:
 560:bluetooth_rxtx.c **** 
 561:bluetooth_rxtx.c **** 	case UBERTOOTH_STOP:
 562:bluetooth_rxtx.c **** 		requested_mode = MODE_IDLE;
 2626              		.loc 1 562 0
 2627 0490 634B     		ldr	r3, .L153+12
 2628 0492 0022     		movs	r2, #0
 2629 0494 1A70     		strb	r2, [r3]
 563:bluetooth_rxtx.c **** 		break;
 2630              		.loc 1 563 0
 2631 0496 16E3     		b	.L107
 2632              	.L70:
 564:bluetooth_rxtx.c **** 
 565:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_MOD:
 566:bluetooth_rxtx.c **** 		data[0] = modulation;
 2633              		.loc 1 566 0
 2634 0498 634B     		ldr	r3, .L153+20
 2635 049a 1B78     		ldrb	r3, [r3]
 2636 049c DAB2     		uxtb	r2, r3
 2637 049e 7B68     		ldr	r3, [r7, #4]
 2638 04a0 1A70     		strb	r2, [r3]
 567:bluetooth_rxtx.c **** 		*data_len = 1;
 2639              		.loc 1 567 0
ARM GAS  /tmp/ccUeeWpa.s 			page 56


 2640 04a2 3B68     		ldr	r3, [r7]
 2641 04a4 0122     		movs	r2, #1
 2642 04a6 1A60     		str	r2, [r3]
 568:bluetooth_rxtx.c **** 		break;
 2643              		.loc 1 568 0
 2644 04a8 0DE3     		b	.L107
 2645              	.L71:
 569:bluetooth_rxtx.c **** 
 570:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_MOD:
 571:bluetooth_rxtx.c **** 		modulation = request_params[0];
 2646              		.loc 1 571 0
 2647 04aa BB68     		ldr	r3, [r7, #8]
 2648 04ac 1B88     		ldrh	r3, [r3]
 2649 04ae DAB2     		uxtb	r2, r3
 2650 04b0 5D4B     		ldr	r3, .L153+20
 2651 04b2 1A70     		strb	r2, [r3]
 572:bluetooth_rxtx.c **** 		break;
 2652              		.loc 1 572 0
 2653 04b4 07E3     		b	.L107
 2654              	.L59:
 573:bluetooth_rxtx.c **** 
 574:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CHANNEL:
 575:bluetooth_rxtx.c **** 		data[0] = channel & 0xFF;
 2655              		.loc 1 575 0
 2656 04b6 5D4B     		ldr	r3, .L153+24
 2657 04b8 1B88     		ldrh	r3, [r3]	@ movhi
 2658 04ba 9BB2     		uxth	r3, r3
 2659 04bc DAB2     		uxtb	r2, r3
 2660 04be 7B68     		ldr	r3, [r7, #4]
 2661 04c0 1A70     		strb	r2, [r3]
 576:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 2662              		.loc 1 576 0
 2663 04c2 7B68     		ldr	r3, [r7, #4]
 2664 04c4 0133     		adds	r3, r3, #1
 2665 04c6 594A     		ldr	r2, .L153+24
 2666 04c8 1288     		ldrh	r2, [r2]	@ movhi
 2667 04ca 92B2     		uxth	r2, r2
 2668 04cc 120A     		lsrs	r2, r2, #8
 2669 04ce 92B2     		uxth	r2, r2
 2670 04d0 D2B2     		uxtb	r2, r2
 2671 04d2 1A70     		strb	r2, [r3]
 577:bluetooth_rxtx.c **** 		*data_len = 2;
 2672              		.loc 1 577 0
 2673 04d4 3B68     		ldr	r3, [r7]
 2674 04d6 0222     		movs	r2, #2
 2675 04d8 1A60     		str	r2, [r3]
 578:bluetooth_rxtx.c **** 		break;
 2676              		.loc 1 578 0
 2677 04da F4E2     		b	.L107
 2678              	.L60:
 579:bluetooth_rxtx.c **** 
 580:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CHANNEL:
 581:bluetooth_rxtx.c **** 		requested_channel = request_params[0];
 2679              		.loc 1 581 0
 2680 04dc BB68     		ldr	r3, [r7, #8]
 2681 04de 1A88     		ldrh	r2, [r3]
 2682 04e0 534B     		ldr	r3, .L153+28
ARM GAS  /tmp/ccUeeWpa.s 			page 57


 2683 04e2 1A80     		strh	r2, [r3]	@ movhi
 582:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 583:bluetooth_rxtx.c **** 		if (requested_channel > MAX_FREQ) {
 2684              		.loc 1 583 0
 2685 04e4 524B     		ldr	r3, .L153+28
 2686 04e6 1B88     		ldrh	r3, [r3]	@ movhi
 2687 04e8 9BB2     		uxth	r3, r3
 2688 04ea 40F6EA22 		movw	r2, #2794
 2689 04ee 9342     		cmp	r3, r2
 2690 04f0 07D9     		bls	.L123
 584:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 2691              		.loc 1 584 0
 2692 04f2 504B     		ldr	r3, .L153+32
 2693 04f4 0122     		movs	r2, #1
 2694 04f6 1A70     		strb	r2, [r3]
 585:bluetooth_rxtx.c **** 			requested_channel = 2402;
 2695              		.loc 1 585 0
 2696 04f8 4D4B     		ldr	r3, .L153+28
 2697 04fa 40F66212 		movw	r2, #2402
 2698 04fe 1A80     		strh	r2, [r3]	@ movhi
 2699 0500 20E0     		b	.L124
 2700              	.L123:
 586:bluetooth_rxtx.c **** 		}
 587:bluetooth_rxtx.c **** 		/* fixed channel mode, can be outside bluetooth band */
 588:bluetooth_rxtx.c **** 		else {
 589:bluetooth_rxtx.c **** 			hop_mode = HOP_NONE;
 2701              		.loc 1 589 0
 2702 0502 4C4B     		ldr	r3, .L153+32
 2703 0504 0022     		movs	r2, #0
 2704 0506 1A70     		strb	r2, [r3]
 590:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 2705              		.loc 1 590 0
 2706 0508 494B     		ldr	r3, .L153+28
 2707 050a 1B88     		ldrh	r3, [r3]	@ movhi
 2708 050c 9BB2     		uxth	r3, r3
 2709 050e 40F6DC02 		movw	r2, #2268
 2710 0512 9342     		cmp	r3, r2
 2711 0514 03D9     		bls	.L125
 2712              		.loc 1 590 0 is_stmt 0 discriminator 1
 2713 0516 464B     		ldr	r3, .L153+28
 2714 0518 1B88     		ldrh	r3, [r3]	@ movhi
 2715 051a 9BB2     		uxth	r3, r3
 2716 051c 01E0     		b	.L126
 2717              	.L125:
 2718              		.loc 1 590 0 discriminator 2
 2719 051e 40F6DC03 		movw	r3, #2268
 2720              	.L126:
 2721              		.loc 1 590 0 discriminator 4
 2722 0522 434A     		ldr	r2, .L153+28
 2723 0524 1380     		strh	r3, [r2]	@ movhi
 591:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 2724              		.loc 1 591 0 is_stmt 1 discriminator 4
 2725 0526 424B     		ldr	r3, .L153+28
 2726 0528 1B88     		ldrh	r3, [r3]	@ movhi
 2727 052a 9BB2     		uxth	r3, r3
 2728 052c 40F6E922 		movw	r2, #2793
 2729 0530 9342     		cmp	r3, r2
ARM GAS  /tmp/ccUeeWpa.s 			page 58


 2730 0532 03D8     		bhi	.L127
 2731              		.loc 1 591 0 is_stmt 0 discriminator 1
 2732 0534 3E4B     		ldr	r3, .L153+28
 2733 0536 1B88     		ldrh	r3, [r3]	@ movhi
 2734 0538 9BB2     		uxth	r3, r3
 2735 053a 01E0     		b	.L128
 2736              	.L127:
 2737              		.loc 1 591 0 discriminator 2
 2738 053c 40F6EA23 		movw	r3, #2794
 2739              	.L128:
 2740              		.loc 1 591 0 discriminator 4
 2741 0540 3B4A     		ldr	r2, .L153+28
 2742 0542 1380     		strh	r3, [r2]	@ movhi
 2743              	.L124:
 592:bluetooth_rxtx.c **** 		}
 593:bluetooth_rxtx.c **** 
 594:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 2744              		.loc 1 594 0 is_stmt 1
 2745 0544 3C4B     		ldr	r3, .L153+36
 2746 0546 1B78     		ldrb	r3, [r3]
 2747 0548 DBB2     		uxtb	r3, r3
 2748 054a 092B     		cmp	r3, #9
 2749 054c 0AD0     		beq	.L129
 595:bluetooth_rxtx.c **** 			channel = requested_channel;
 2750              		.loc 1 595 0
 2751 054e 384B     		ldr	r3, .L153+28
 2752 0550 1B88     		ldrh	r3, [r3]	@ movhi
 2753 0552 9AB2     		uxth	r2, r3
 2754 0554 354B     		ldr	r3, .L153+24
 2755 0556 1A80     		strh	r2, [r3]	@ movhi
 596:bluetooth_rxtx.c **** 			requested_channel = 0;
 2756              		.loc 1 596 0
 2757 0558 354B     		ldr	r3, .L153+28
 2758 055a 0022     		movs	r2, #0
 2759 055c 1A80     		strh	r2, [r3]	@ movhi
 597:bluetooth_rxtx.c **** 
 598:bluetooth_rxtx.c **** 			/* CS threshold is mode-dependent. Update it after
 599:bluetooth_rxtx.c **** 			 * possible mode change. TODO - kludgy. */
 600:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set();
 2760              		.loc 1 600 0
 2761 055e FFF7FEFF 		bl	cs_threshold_calc_and_set
 601:bluetooth_rxtx.c **** 		}
 602:bluetooth_rxtx.c **** 		break;
 2762              		.loc 1 602 0
 2763 0562 B0E2     		b	.L107
 2764              	.L129:
 2765 0564 AFE2     		b	.L107
 2766              	.L72:
 603:bluetooth_rxtx.c **** 
 604:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ISP:
 605:bluetooth_rxtx.c **** 		command[0] = 57;
 2767              		.loc 1 605 0
 2768 0566 3923     		movs	r3, #57
 2769 0568 7B62     		str	r3, [r7, #36]
 606:bluetooth_rxtx.c **** 		iap_entry(command, result);
 2770              		.loc 1 606 0
 2771 056a 344B     		ldr	r3, .L153+40
ARM GAS  /tmp/ccUeeWpa.s 			page 59


 2772 056c 1B68     		ldr	r3, [r3]
 2773 056e 07F12401 		add	r1, r7, #36
 2774 0572 07F11002 		add	r2, r7, #16
 2775 0576 0846     		mov	r0, r1
 2776 0578 1146     		mov	r1, r2
 2777 057a 9847     		blx	r3
 607:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 2778              		.loc 1 607 0
 2779 057c 3B68     		ldr	r3, [r7]
 2780 057e 0022     		movs	r2, #0
 2781 0580 1A60     		str	r2, [r3]
 608:bluetooth_rxtx.c **** 		break;
 2782              		.loc 1 608 0
 2783 0582 A0E2     		b	.L107
 2784              	.L73:
 609:bluetooth_rxtx.c **** 
 610:bluetooth_rxtx.c **** 	case UBERTOOTH_FLASH:
 611:bluetooth_rxtx.c **** 		bootloader_ctrl = DFU_MODE;
 2785              		.loc 1 611 0
 2786 0584 2E4B     		ldr	r3, .L153+44
 2787 0586 2F4A     		ldr	r2, .L153+48
 2788 0588 1A60     		str	r2, [r3]
 612:bluetooth_rxtx.c **** 		reset();
 2789              		.loc 1 612 0
 2790 058a FFF7FEFF 		bl	reset
 613:bluetooth_rxtx.c **** 		break;
 2791              		.loc 1 613 0
 2792 058e 9AE2     		b	.L107
 2793              	.L74:
 614:bluetooth_rxtx.c **** 
 615:bluetooth_rxtx.c **** 	case UBERTOOTH_SPECAN:
 616:bluetooth_rxtx.c **** 		if (request_params[0] < 2049 || request_params[0] > 3072 || 
 2794              		.loc 1 616 0
 2795 0590 BB68     		ldr	r3, [r7, #8]
 2796 0592 1B88     		ldrh	r3, [r3]
 2797 0594 B3F5006F 		cmp	r3, #2048
 2798 0598 17D9     		bls	.L130
 2799              		.loc 1 616 0 is_stmt 0 discriminator 1
 2800 059a BB68     		ldr	r3, [r7, #8]
 2801 059c 1B88     		ldrh	r3, [r3]
 2802 059e B3F5406F 		cmp	r3, #3072
 2803 05a2 12D8     		bhi	.L130
 617:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 2804              		.loc 1 617 0 is_stmt 1 discriminator 2
 2805 05a4 BB68     		ldr	r3, [r7, #8]
 2806 05a6 0233     		adds	r3, r3, #2
 2807 05a8 1B88     		ldrh	r3, [r3]
 616:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 2808              		.loc 1 616 0 discriminator 2
 2809 05aa B3F5006F 		cmp	r3, #2048
 2810 05ae 0CD9     		bls	.L130
 2811              		.loc 1 617 0
 2812 05b0 BB68     		ldr	r3, [r7, #8]
 2813 05b2 0233     		adds	r3, r3, #2
 2814 05b4 1B88     		ldrh	r3, [r3]
 2815 05b6 B3F5406F 		cmp	r3, #3072
 2816 05ba 06D8     		bhi	.L130
ARM GAS  /tmp/ccUeeWpa.s 			page 60


 618:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 2817              		.loc 1 618 0 discriminator 1
 2818 05bc BB68     		ldr	r3, [r7, #8]
 2819 05be 0233     		adds	r3, r3, #2
 2820 05c0 1A88     		ldrh	r2, [r3]
 2821 05c2 BB68     		ldr	r3, [r7, #8]
 2822 05c4 1B88     		ldrh	r3, [r3]
 617:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 2823              		.loc 1 617 0 discriminator 1
 2824 05c6 9A42     		cmp	r2, r3
 2825 05c8 01D2     		bcs	.L131
 2826              	.L130:
 619:bluetooth_rxtx.c **** 			return 0;
 2827              		.loc 1 619 0
 2828 05ca 0023     		movs	r3, #0
 2829 05cc 7CE2     		b	.L149
 2830              	.L131:
 620:bluetooth_rxtx.c **** 		low_freq = request_params[0];
 2831              		.loc 1 620 0
 2832 05ce BB68     		ldr	r3, [r7, #8]
 2833 05d0 1A88     		ldrh	r2, [r3]
 2834 05d2 1D4B     		ldr	r3, .L153+52
 2835 05d4 1A80     		strh	r2, [r3]	@ movhi
 621:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 2836              		.loc 1 621 0
 2837 05d6 BB68     		ldr	r3, [r7, #8]
 2838 05d8 5A88     		ldrh	r2, [r3, #2]
 2839 05da 1C4B     		ldr	r3, .L153+56
 2840 05dc 1A80     		strh	r2, [r3]	@ movhi
 622:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 2841              		.loc 1 622 0
 2842 05de 104B     		ldr	r3, .L153+12
 2843 05e0 0422     		movs	r2, #4
 2844 05e2 1A70     		strb	r2, [r3]
 623:bluetooth_rxtx.c **** 		*data_len = 0;
 2845              		.loc 1 623 0
 2846 05e4 3B68     		ldr	r3, [r7]
 2847 05e6 0022     		movs	r2, #0
 2848 05e8 1A60     		str	r2, [r3]
 624:bluetooth_rxtx.c **** 		break;
 2849              		.loc 1 624 0
 2850 05ea 6CE2     		b	.L107
 2851              	.L81:
 625:bluetooth_rxtx.c **** 
 626:bluetooth_rxtx.c **** 	case UBERTOOTH_LED_SPECAN:
 627:bluetooth_rxtx.c **** 		if (request_params[0] > 256)
 2852              		.loc 1 627 0
 2853 05ec BB68     		ldr	r3, [r7, #8]
 2854 05ee 1B88     		ldrh	r3, [r3]
 2855 05f0 B3F5807F 		cmp	r3, #256
 2856 05f4 01D9     		bls	.L132
 628:bluetooth_rxtx.c **** 			return 0;
 2857              		.loc 1 628 0
 2858 05f6 0023     		movs	r3, #0
 2859 05f8 66E2     		b	.L149
 2860              	.L132:
 629:bluetooth_rxtx.c **** 		rssi_threshold = (int8_t)request_params[0];
ARM GAS  /tmp/ccUeeWpa.s 			page 61


 2861              		.loc 1 629 0
 2862 05fa BB68     		ldr	r3, [r7, #8]
 2863 05fc 1B88     		ldrh	r3, [r3]
 2864 05fe DAB2     		uxtb	r2, r3
 2865 0600 134B     		ldr	r3, .L153+60
 2866 0602 1A70     		strb	r2, [r3]
 630:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 2867              		.loc 1 630 0
 2868 0604 064B     		ldr	r3, .L153+12
 2869 0606 0722     		movs	r2, #7
 2870 0608 1A70     		strb	r2, [r3]
 631:bluetooth_rxtx.c **** 		*data_len = 0;
 2871              		.loc 1 631 0
 2872 060a 3B68     		ldr	r3, [r7]
 2873 060c 0022     		movs	r2, #0
 2874 060e 1A60     		str	r2, [r3]
 632:bluetooth_rxtx.c **** 		break;
 2875              		.loc 1 632 0
 2876 0610 59E2     		b	.L107
 2877              	.L154:
 2878 0612 00BF     		.align	2
 2879              	.L153:
 2880 0614 54C00920 		.word	537509972
 2881 0618 58C00920 		.word	537509976
 2882 061c 5CC00920 		.word	537509980
 2883 0620 00000000 		.word	requested_mode
 2884 0624 00000000 		.word	rr
 2885 0628 00000000 		.word	modulation
 2886 062c 00000000 		.word	channel
 2887 0630 00000000 		.word	requested_channel
 2888 0634 00000000 		.word	hop_mode
 2889 0638 00000000 		.word	mode
 2890 063c 00000000 		.word	iap_entry
 2891 0640 00000000 		.word	bootloader_ctrl
 2892 0644 21BB0543 		.word	1124449057
 2893 0648 00000000 		.word	low_freq
 2894 064c 00000000 		.word	high_freq
 2895 0650 00000000 		.word	rssi_threshold
 2896              	.L80:
 633:bluetooth_rxtx.c **** 
 634:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_REV_NUM:
 635:bluetooth_rxtx.c **** 		data[0] = 0x00;
 2897              		.loc 1 635 0
 2898 0654 7B68     		ldr	r3, [r7, #4]
 2899 0656 0022     		movs	r2, #0
 2900 0658 1A70     		strb	r2, [r3]
 636:bluetooth_rxtx.c **** 		data[1] = 0x00;
 2901              		.loc 1 636 0
 2902 065a 7B68     		ldr	r3, [r7, #4]
 2903 065c 0133     		adds	r3, r3, #1
 2904 065e 0022     		movs	r2, #0
 2905 0660 1A70     		strb	r2, [r3]
 637:bluetooth_rxtx.c **** 
 638:bluetooth_rxtx.c **** 		length = (u8)strlen(GIT_REVISION);
 2906              		.loc 1 638 0
 2907 0662 A448     		ldr	r0, .L155
 2908 0664 FFF7FEFF 		bl	strlen
ARM GAS  /tmp/ccUeeWpa.s 			page 62


 2909 0668 0346     		mov	r3, r0
 2910 066a 87F84330 		strb	r3, [r7, #67]
 639:bluetooth_rxtx.c **** 		data[2] = length;
 2911              		.loc 1 639 0
 2912 066e 7B68     		ldr	r3, [r7, #4]
 2913 0670 0233     		adds	r3, r3, #2
 2914 0672 97F84320 		ldrb	r2, [r7, #67]
 2915 0676 1A70     		strb	r2, [r3]
 640:bluetooth_rxtx.c **** 
 641:bluetooth_rxtx.c **** 		memcpy(&data[3], GIT_REVISION, length);
 2916              		.loc 1 641 0
 2917 0678 7B68     		ldr	r3, [r7, #4]
 2918 067a DA1C     		adds	r2, r3, #3
 2919 067c 97F84330 		ldrb	r3, [r7, #67]	@ zero_extendqisi2
 2920 0680 1046     		mov	r0, r2
 2921 0682 9C49     		ldr	r1, .L155
 2922 0684 1A46     		mov	r2, r3
 2923 0686 FFF7FEFF 		bl	memcpy
 642:bluetooth_rxtx.c **** 
 643:bluetooth_rxtx.c **** 		*data_len = 2 + 1 + length;
 2924              		.loc 1 643 0
 2925 068a 97F84330 		ldrb	r3, [r7, #67]	@ zero_extendqisi2
 2926 068e DA1C     		adds	r2, r3, #3
 2927 0690 3B68     		ldr	r3, [r7]
 2928 0692 1A60     		str	r2, [r3]
 644:bluetooth_rxtx.c **** 		break;
 2929              		.loc 1 644 0
 2930 0694 17E2     		b	.L107
 2931              	.L102:
 645:bluetooth_rxtx.c **** 
 646:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_COMPILE_INFO:
 647:bluetooth_rxtx.c **** 		length = (u8)strlen(compile_info);
 2932              		.loc 1 647 0
 2933 0696 9848     		ldr	r0, .L155+4
 2934 0698 FFF7FEFF 		bl	strlen
 2935 069c 0346     		mov	r3, r0
 2936 069e 87F84330 		strb	r3, [r7, #67]
 648:bluetooth_rxtx.c **** 		data[0] = length;
 2937              		.loc 1 648 0
 2938 06a2 7B68     		ldr	r3, [r7, #4]
 2939 06a4 97F84320 		ldrb	r2, [r7, #67]
 2940 06a8 1A70     		strb	r2, [r3]
 649:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 2941              		.loc 1 649 0
 2942 06aa 7B68     		ldr	r3, [r7, #4]
 2943 06ac 5A1C     		adds	r2, r3, #1
 2944 06ae 97F84330 		ldrb	r3, [r7, #67]	@ zero_extendqisi2
 2945 06b2 1046     		mov	r0, r2
 2946 06b4 9049     		ldr	r1, .L155+4
 2947 06b6 1A46     		mov	r2, r3
 2948 06b8 FFF7FEFF 		bl	memcpy
 650:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 2949              		.loc 1 650 0
 2950 06bc 97F84330 		ldrb	r3, [r7, #67]	@ zero_extendqisi2
 2951 06c0 5A1C     		adds	r2, r3, #1
 2952 06c2 3B68     		ldr	r3, [r7]
 2953 06c4 1A60     		str	r2, [r3]
ARM GAS  /tmp/ccUeeWpa.s 			page 63


 651:bluetooth_rxtx.c **** 		break;
 2954              		.loc 1 651 0
 2955 06c6 FEE1     		b	.L107
 2956              	.L82:
 652:bluetooth_rxtx.c **** 
 653:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_BOARD_ID:
 654:bluetooth_rxtx.c **** 		data[0] = BOARD_ID;
 2957              		.loc 1 654 0
 2958 06c8 7B68     		ldr	r3, [r7, #4]
 2959 06ca 0122     		movs	r2, #1
 2960 06cc 1A70     		strb	r2, [r3]
 655:bluetooth_rxtx.c **** 		*data_len = 1;
 2961              		.loc 1 655 0
 2962 06ce 3B68     		ldr	r3, [r7]
 2963 06d0 0122     		movs	r2, #1
 2964 06d2 1A60     		str	r2, [r3]
 656:bluetooth_rxtx.c **** 		break;
 2965              		.loc 1 656 0
 2966 06d4 F7E1     		b	.L107
 2967              	.L83:
 657:bluetooth_rxtx.c **** 
 658:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_SQUELCH:
 659:bluetooth_rxtx.c **** 		cs_threshold_req = (int8_t)request_params[0];
 2968              		.loc 1 659 0
 2969 06d6 BB68     		ldr	r3, [r7, #8]
 2970 06d8 1B88     		ldrh	r3, [r3]
 2971 06da DAB2     		uxtb	r2, r3
 2972 06dc 874B     		ldr	r3, .L155+8
 2973 06de 1A70     		strb	r2, [r3]
 660:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set();
 2974              		.loc 1 660 0
 2975 06e0 FFF7FEFF 		bl	cs_threshold_calc_and_set
 661:bluetooth_rxtx.c **** 		break;
 2976              		.loc 1 661 0
 2977 06e4 EFE1     		b	.L107
 2978              	.L84:
 662:bluetooth_rxtx.c **** 
 663:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SQUELCH:
 664:bluetooth_rxtx.c **** 		data[0] = cs_threshold_req;
 2979              		.loc 1 664 0
 2980 06e6 854B     		ldr	r3, .L155+8
 2981 06e8 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2982 06ea DAB2     		uxtb	r2, r3
 2983 06ec 7B68     		ldr	r3, [r7, #4]
 2984 06ee 1A70     		strb	r2, [r3]
 665:bluetooth_rxtx.c **** 		*data_len = 1;
 2985              		.loc 1 665 0
 2986 06f0 3B68     		ldr	r3, [r7]
 2987 06f2 0122     		movs	r2, #1
 2988 06f4 1A60     		str	r2, [r3]
 666:bluetooth_rxtx.c **** 		break;
 2989              		.loc 1 666 0
 2990 06f6 E6E1     		b	.L107
 2991              	.L85:
 667:bluetooth_rxtx.c **** 
 668:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_BDADDR:
 669:bluetooth_rxtx.c **** 		target.address = 0;
ARM GAS  /tmp/ccUeeWpa.s 			page 64


 2992              		.loc 1 669 0
 2993 06f8 8149     		ldr	r1, .L155+12
 2994 06fa 4FF00002 		mov	r2, #0
 2995 06fe 4FF00003 		mov	r3, #0
 2996 0702 C1E90023 		strd	r2, [r1]
 670:bluetooth_rxtx.c **** 		target.access_code = 0;
 2997              		.loc 1 670 0
 2998 0706 7E49     		ldr	r1, .L155+12
 2999 0708 4FF00002 		mov	r2, #0
 3000 070c 4FF00003 		mov	r3, #0
 3001 0710 C1E90223 		strd	r2, [r1, #8]
 671:bluetooth_rxtx.c **** 		for(i=0; i < 8; i++) {
 3002              		.loc 1 671 0
 3003 0714 0023     		movs	r3, #0
 3004 0716 FB64     		str	r3, [r7, #76]
 3005 0718 25E0     		b	.L133
 3006              	.L134:
 672:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 3007              		.loc 1 672 0 discriminator 3
 3008 071a 794B     		ldr	r3, .L155+12
 3009 071c D3E900AB 		ldrd	r10, [r3]
 3010 0720 FB6C     		ldr	r3, [r7, #76]
 3011 0722 7A68     		ldr	r2, [r7, #4]
 3012 0724 1344     		add	r3, r3, r2
 3013 0726 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3014 0728 DAB2     		uxtb	r2, r3
 3015 072a 4FF00003 		mov	r3, #0
 3016 072e F96C     		ldr	r1, [r7, #76]
 3017 0730 C900     		lsls	r1, r1, #3
 3018 0732 A1F12006 		sub	r6, r1, #32
 3019 0736 C1F12000 		rsb	r0, r1, #32
 3020 073a 03FA01F9 		lsl	r9, r3, r1
 3021 073e 02FA06F6 		lsl	r6, r2, r6
 3022 0742 49EA0609 		orr	r9, r9, r6
 3023 0746 22FA00F0 		lsr	r0, r2, r0
 3024 074a 49EA0009 		orr	r9, r9, r0
 3025 074e 02FA01F8 		lsl	r8, r2, r1
 3026 0752 4AEA0802 		orr	r2, r10, r8
 3027 0756 4BEA0903 		orr	r3, fp, r9
 3028 075a 6949     		ldr	r1, .L155+12
 3029 075c C1E90023 		strd	r2, [r1]
 671:bluetooth_rxtx.c **** 		for(i=0; i < 8; i++) {
 3030              		.loc 1 671 0 discriminator 3
 3031 0760 FB6C     		ldr	r3, [r7, #76]
 3032 0762 0133     		adds	r3, r3, #1
 3033 0764 FB64     		str	r3, [r7, #76]
 3034              	.L133:
 671:bluetooth_rxtx.c **** 		for(i=0; i < 8; i++) {
 3035              		.loc 1 671 0 is_stmt 0 discriminator 1
 3036 0766 FB6C     		ldr	r3, [r7, #76]
 3037 0768 072B     		cmp	r3, #7
 3038 076a D6DD     		ble	.L134
 673:bluetooth_rxtx.c **** 		}
 674:bluetooth_rxtx.c **** 		for(i=0; i < 8; i++) {
 3039              		.loc 1 674 0 is_stmt 1
 3040 076c 0023     		movs	r3, #0
 3041 076e FB64     		str	r3, [r7, #76]
ARM GAS  /tmp/ccUeeWpa.s 			page 65


 3042 0770 24E0     		b	.L135
 3043              	.L136:
 675:bluetooth_rxtx.c **** 			target.access_code |= (uint64_t)data[i+8] << 8*i;
 3044              		.loc 1 675 0 discriminator 3
 3045 0772 634B     		ldr	r3, .L155+12
 3046 0774 D3E90289 		ldrd	r8, [r3, #8]
 3047 0778 FB6C     		ldr	r3, [r7, #76]
 3048 077a 0833     		adds	r3, r3, #8
 3049 077c 7A68     		ldr	r2, [r7, #4]
 3050 077e 1344     		add	r3, r3, r2
 3051 0780 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3052 0782 DAB2     		uxtb	r2, r3
 3053 0784 4FF00003 		mov	r3, #0
 3054 0788 F96C     		ldr	r1, [r7, #76]
 3055 078a C900     		lsls	r1, r1, #3
 3056 078c A1F12006 		sub	r6, r1, #32
 3057 0790 C1F12000 		rsb	r0, r1, #32
 3058 0794 03FA01F5 		lsl	r5, r3, r1
 3059 0798 02FA06F6 		lsl	r6, r2, r6
 3060 079c 3543     		orrs	r5, r5, r6
 3061 079e 22FA00F0 		lsr	r0, r2, r0
 3062 07a2 0543     		orrs	r5, r5, r0
 3063 07a4 02FA01F4 		lsl	r4, r2, r1
 3064 07a8 48EA0402 		orr	r2, r8, r4
 3065 07ac 49EA0503 		orr	r3, r9, r5
 3066 07b0 5349     		ldr	r1, .L155+12
 3067 07b2 C1E90223 		strd	r2, [r1, #8]
 674:bluetooth_rxtx.c **** 			target.access_code |= (uint64_t)data[i+8] << 8*i;
 3068              		.loc 1 674 0 discriminator 3
 3069 07b6 FB6C     		ldr	r3, [r7, #76]
 3070 07b8 0133     		adds	r3, r3, #1
 3071 07ba FB64     		str	r3, [r7, #76]
 3072              	.L135:
 674:bluetooth_rxtx.c **** 			target.access_code |= (uint64_t)data[i+8] << 8*i;
 3073              		.loc 1 674 0 is_stmt 0 discriminator 1
 3074 07bc FB6C     		ldr	r3, [r7, #76]
 3075 07be 072B     		cmp	r3, #7
 3076 07c0 D7DD     		ble	.L136
 676:bluetooth_rxtx.c **** 		}
 677:bluetooth_rxtx.c **** 		break;
 3077              		.loc 1 677 0 is_stmt 1
 3078 07c2 80E1     		b	.L107
 3079              	.L86:
 678:bluetooth_rxtx.c **** 
 679:bluetooth_rxtx.c **** 	case UBERTOOTH_START_HOPPING:
 680:bluetooth_rxtx.c **** 		clock_offset = 0;
 3080              		.loc 1 680 0
 3081 07c4 0023     		movs	r3, #0
 3082 07c6 BB64     		str	r3, [r7, #72]
 681:bluetooth_rxtx.c **** 		for(i=0; i < 4; i++) {
 3083              		.loc 1 681 0
 3084 07c8 0023     		movs	r3, #0
 3085 07ca FB64     		str	r3, [r7, #76]
 3086 07cc 0DE0     		b	.L137
 3087              	.L138:
 682:bluetooth_rxtx.c **** 			clock_offset <<= 8;
 3088              		.loc 1 682 0 discriminator 3
ARM GAS  /tmp/ccUeeWpa.s 			page 66


 3089 07ce BB6C     		ldr	r3, [r7, #72]
 3090 07d0 1B02     		lsls	r3, r3, #8
 3091 07d2 BB64     		str	r3, [r7, #72]
 683:bluetooth_rxtx.c **** 			clock_offset |= data[i];
 3092              		.loc 1 683 0 discriminator 3
 3093 07d4 FB6C     		ldr	r3, [r7, #76]
 3094 07d6 7A68     		ldr	r2, [r7, #4]
 3095 07d8 1344     		add	r3, r3, r2
 3096 07da 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3097 07dc 1A46     		mov	r2, r3
 3098 07de BB6C     		ldr	r3, [r7, #72]
 3099 07e0 1343     		orrs	r3, r3, r2
 3100 07e2 BB64     		str	r3, [r7, #72]
 681:bluetooth_rxtx.c **** 		for(i=0; i < 4; i++) {
 3101              		.loc 1 681 0 discriminator 3
 3102 07e4 FB6C     		ldr	r3, [r7, #76]
 3103 07e6 0133     		adds	r3, r3, #1
 3104 07e8 FB64     		str	r3, [r7, #76]
 3105              	.L137:
 681:bluetooth_rxtx.c **** 		for(i=0; i < 4; i++) {
 3106              		.loc 1 681 0 is_stmt 0 discriminator 1
 3107 07ea FB6C     		ldr	r3, [r7, #76]
 3108 07ec 032B     		cmp	r3, #3
 3109 07ee EEDD     		ble	.L138
 684:bluetooth_rxtx.c **** 		}
 685:bluetooth_rxtx.c **** 		clkn += clock_offset;
 3110              		.loc 1 685 0 is_stmt 1
 3111 07f0 444B     		ldr	r3, .L155+16
 3112 07f2 1A68     		ldr	r2, [r3]
 3113 07f4 BB6C     		ldr	r3, [r7, #72]
 3114 07f6 1344     		add	r3, r3, r2
 3115 07f8 424A     		ldr	r2, .L155+16
 3116 07fa 1360     		str	r3, [r2]
 686:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 3117              		.loc 1 686 0
 3118 07fc 424B     		ldr	r3, .L155+20
 3119 07fe 0222     		movs	r2, #2
 3120 0800 1A70     		strb	r2, [r3]
 687:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 3121              		.loc 1 687 0
 3122 0802 424B     		ldr	r3, .L155+24
 3123 0804 0822     		movs	r2, #8
 3124 0806 1A70     		strb	r2, [r3]
 688:bluetooth_rxtx.c **** 		break;
 3125              		.loc 1 688 0
 3126 0808 5DE1     		b	.L107
 3127              	.L87:
 689:bluetooth_rxtx.c **** 
 690:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CLOCK:
 691:bluetooth_rxtx.c **** 		clock = data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24;
 3128              		.loc 1 691 0
 3129 080a 7B68     		ldr	r3, [r7, #4]
 3130 080c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3131 080e 1A46     		mov	r2, r3
 3132 0810 7B68     		ldr	r3, [r7, #4]
 3133 0812 0133     		adds	r3, r3, #1
 3134 0814 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
ARM GAS  /tmp/ccUeeWpa.s 			page 67


 3135 0816 1B02     		lsls	r3, r3, #8
 3136 0818 1A43     		orrs	r2, r2, r3
 3137 081a 7B68     		ldr	r3, [r7, #4]
 3138 081c 0233     		adds	r3, r3, #2
 3139 081e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3140 0820 1B04     		lsls	r3, r3, #16
 3141 0822 1A43     		orrs	r2, r2, r3
 3142 0824 7B68     		ldr	r3, [r7, #4]
 3143 0826 0333     		adds	r3, r3, #3
 3144 0828 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3145 082a 1B06     		lsls	r3, r3, #24
 3146 082c 1343     		orrs	r3, r3, r2
 3147 082e FB63     		str	r3, [r7, #60]
 692:bluetooth_rxtx.c **** 		clkn = clock;
 3148              		.loc 1 692 0
 3149 0830 344A     		ldr	r2, .L155+16
 3150 0832 FB6B     		ldr	r3, [r7, #60]
 3151 0834 1360     		str	r3, [r2]
 693:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set();
 3152              		.loc 1 693 0
 3153 0836 FFF7FEFF 		bl	cs_threshold_calc_and_set
 694:bluetooth_rxtx.c **** 		break;
 3154              		.loc 1 694 0
 3155 083a 44E1     		b	.L107
 3156              	.L98:
 695:bluetooth_rxtx.c **** 
 696:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_AFHMAP:
 697:bluetooth_rxtx.c **** 		for(i=0; i < 10; i++) {
 3157              		.loc 1 697 0
 3158 083c 0023     		movs	r3, #0
 3159 083e FB64     		str	r3, [r7, #76]
 3160 0840 0BE0     		b	.L139
 3161              	.L140:
 698:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 3162              		.loc 1 698 0 discriminator 3
 3163 0842 FB6C     		ldr	r3, [r7, #76]
 3164 0844 7A68     		ldr	r2, [r7, #4]
 3165 0846 1344     		add	r3, r3, r2
 3166 0848 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3167 084a 314A     		ldr	r2, .L155+28
 3168 084c FB6C     		ldr	r3, [r7, #76]
 3169 084e 1344     		add	r3, r3, r2
 3170 0850 0A46     		mov	r2, r1
 3171 0852 1A70     		strb	r2, [r3]
 697:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 3172              		.loc 1 697 0 discriminator 3
 3173 0854 FB6C     		ldr	r3, [r7, #76]
 3174 0856 0133     		adds	r3, r3, #1
 3175 0858 FB64     		str	r3, [r7, #76]
 3176              	.L139:
 697:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 3177              		.loc 1 697 0 is_stmt 0 discriminator 1
 3178 085a FB6C     		ldr	r3, [r7, #76]
 3179 085c 092B     		cmp	r3, #9
 3180 085e F0DD     		ble	.L140
 699:bluetooth_rxtx.c **** 		}
 700:bluetooth_rxtx.c **** 		afh_enabled = 1;
ARM GAS  /tmp/ccUeeWpa.s 			page 68


 3181              		.loc 1 700 0 is_stmt 1
 3182 0860 2C4B     		ldr	r3, .L155+32
 3183 0862 0122     		movs	r2, #1
 3184 0864 1A70     		strb	r2, [r3]
 701:bluetooth_rxtx.c **** 		*data_len = 10;
 3185              		.loc 1 701 0
 3186 0866 3B68     		ldr	r3, [r7]
 3187 0868 0A22     		movs	r2, #10
 3188 086a 1A60     		str	r2, [r3]
 702:bluetooth_rxtx.c **** 		break;
 3189              		.loc 1 702 0
 3190 086c 2BE1     		b	.L107
 3191              	.L99:
 703:bluetooth_rxtx.c **** 
 704:bluetooth_rxtx.c **** 	case UBERTOOTH_CLEAR_AFHMAP:
 705:bluetooth_rxtx.c **** 		for(i=0; i < 10; i++) {
 3192              		.loc 1 705 0
 3193 086e 0023     		movs	r3, #0
 3194 0870 FB64     		str	r3, [r7, #76]
 3195 0872 07E0     		b	.L141
 3196              	.L142:
 706:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 3197              		.loc 1 706 0 discriminator 3
 3198 0874 264A     		ldr	r2, .L155+28
 3199 0876 FB6C     		ldr	r3, [r7, #76]
 3200 0878 1344     		add	r3, r3, r2
 3201 087a 0022     		movs	r2, #0
 3202 087c 1A70     		strb	r2, [r3]
 705:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 3203              		.loc 1 705 0 discriminator 3
 3204 087e FB6C     		ldr	r3, [r7, #76]
 3205 0880 0133     		adds	r3, r3, #1
 3206 0882 FB64     		str	r3, [r7, #76]
 3207              	.L141:
 705:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 3208              		.loc 1 705 0 is_stmt 0 discriminator 1
 3209 0884 FB6C     		ldr	r3, [r7, #76]
 3210 0886 092B     		cmp	r3, #9
 3211 0888 F4DD     		ble	.L142
 707:bluetooth_rxtx.c **** 		}
 708:bluetooth_rxtx.c **** 		afh_enabled = 0;
 3212              		.loc 1 708 0 is_stmt 1
 3213 088a 224B     		ldr	r3, .L155+32
 3214 088c 0022     		movs	r2, #0
 3215 088e 1A70     		strb	r2, [r3]
 709:bluetooth_rxtx.c **** 		*data_len = 10;
 3216              		.loc 1 709 0
 3217 0890 3B68     		ldr	r3, [r7]
 3218 0892 0A22     		movs	r2, #10
 3219 0894 1A60     		str	r2, [r3]
 710:bluetooth_rxtx.c **** 		break;
 3220              		.loc 1 710 0
 3221 0896 16E1     		b	.L107
 3222              	.L88:
 711:bluetooth_rxtx.c **** 
 712:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CLOCK:
 713:bluetooth_rxtx.c **** 		clock = clkn;
ARM GAS  /tmp/ccUeeWpa.s 			page 69


 3223              		.loc 1 713 0
 3224 0898 1A4B     		ldr	r3, .L155+16
 3225 089a 1B68     		ldr	r3, [r3]
 3226 089c FB63     		str	r3, [r7, #60]
 714:bluetooth_rxtx.c **** 		for(i=0; i < 4; i++) {
 3227              		.loc 1 714 0
 3228 089e 0023     		movs	r3, #0
 3229 08a0 FB64     		str	r3, [r7, #76]
 3230 08a2 0CE0     		b	.L143
 3231              	.L144:
 715:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 3232              		.loc 1 715 0 discriminator 3
 3233 08a4 FB6C     		ldr	r3, [r7, #76]
 3234 08a6 7A68     		ldr	r2, [r7, #4]
 3235 08a8 1344     		add	r3, r3, r2
 3236 08aa FA6C     		ldr	r2, [r7, #76]
 3237 08ac D200     		lsls	r2, r2, #3
 3238 08ae F96B     		ldr	r1, [r7, #60]
 3239 08b0 21FA02F2 		lsr	r2, r1, r2
 3240 08b4 D2B2     		uxtb	r2, r2
 3241 08b6 1A70     		strb	r2, [r3]
 714:bluetooth_rxtx.c **** 		for(i=0; i < 4; i++) {
 3242              		.loc 1 714 0 discriminator 3
 3243 08b8 FB6C     		ldr	r3, [r7, #76]
 3244 08ba 0133     		adds	r3, r3, #1
 3245 08bc FB64     		str	r3, [r7, #76]
 3246              	.L143:
 714:bluetooth_rxtx.c **** 		for(i=0; i < 4; i++) {
 3247              		.loc 1 714 0 is_stmt 0 discriminator 1
 3248 08be FB6C     		ldr	r3, [r7, #76]
 3249 08c0 032B     		cmp	r3, #3
 3250 08c2 EFDD     		ble	.L144
 716:bluetooth_rxtx.c **** 		}
 717:bluetooth_rxtx.c **** 		*data_len = 4;
 3251              		.loc 1 717 0 is_stmt 1
 3252 08c4 3B68     		ldr	r3, [r7]
 3253 08c6 0422     		movs	r2, #4
 3254 08c8 1A60     		str	r2, [r3]
 718:bluetooth_rxtx.c **** 		break;
 3255              		.loc 1 718 0
 3256 08ca FCE0     		b	.L107
 3257              	.L89:
 719:bluetooth_rxtx.c **** 
 720:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SNIFFING:
 721:bluetooth_rxtx.c **** 		*data_len = 0;
 3258              		.loc 1 721 0
 3259 08cc 3B68     		ldr	r3, [r7]
 3260 08ce 0022     		movs	r2, #0
 3261 08d0 1A60     		str	r2, [r3]
 722:bluetooth_rxtx.c **** 
 723:bluetooth_rxtx.c **** 		do_hop = 0;
 3262              		.loc 1 723 0
 3263 08d2 114B     		ldr	r3, .L155+36
 3264 08d4 0022     		movs	r2, #0
 3265 08d6 1A70     		strb	r2, [r3]
 724:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 3266              		.loc 1 724 0
ARM GAS  /tmp/ccUeeWpa.s 			page 70


 3267 08d8 0B4B     		ldr	r3, .L155+20
 3268 08da 0322     		movs	r2, #3
 3269 08dc 1A70     		strb	r2, [r3]
 725:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 3270              		.loc 1 725 0
 3271 08de 0B4B     		ldr	r3, .L155+24
 3272 08e0 0922     		movs	r2, #9
 3273 08e2 1A70     		strb	r2, [r3]
 726:bluetooth_rxtx.c **** 
 727:bluetooth_rxtx.c **** 		queue_init();
 3274              		.loc 1 727 0
 3275 08e4 FFF7FEFF 		bl	queue_init
 728:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set();
 3276              		.loc 1 728 0
 3277 08e8 FFF7FEFF 		bl	cs_threshold_calc_and_set
 729:bluetooth_rxtx.c **** 		break;
 3278              		.loc 1 729 0
 3279 08ec EBE0     		b	.L107
 3280              	.L90:
 730:bluetooth_rxtx.c **** 
 731:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_ACCESS_ADDRESS:
 732:bluetooth_rxtx.c **** 		for(i=0; i < 4; i++) {
 3281              		.loc 1 732 0
 3282 08ee 0023     		movs	r3, #0
 3283 08f0 FB64     		str	r3, [r7, #76]
 3284 08f2 21E0     		b	.L145
 3285              	.L156:
 3286              		.align	2
 3287              	.L155:
 3288 08f4 C0080000 		.word	.LC3
 3289 08f8 00000000 		.word	compile_info
 3290 08fc 00000000 		.word	cs_threshold_req
 3291 0900 00000000 		.word	target
 3292 0904 00000000 		.word	clkn
 3293 0908 00000000 		.word	hop_mode
 3294 090c 00000000 		.word	requested_mode
 3295 0910 00000000 		.word	afh_map
 3296 0914 00000000 		.word	afh_enabled
 3297 0918 00000000 		.word	do_hop
 3298              	.L146:
 733:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 3299              		.loc 1 733 0 discriminator 3
 3300 091c FB6C     		ldr	r3, [r7, #76]
 3301 091e 7A68     		ldr	r2, [r7, #4]
 3302 0920 1344     		add	r3, r3, r2
 3303 0922 6C4A     		ldr	r2, .L157
 3304 0924 1168     		ldr	r1, [r2]
 3305 0926 FA6C     		ldr	r2, [r7, #76]
 3306 0928 D200     		lsls	r2, r2, #3
 3307 092a 21FA02F2 		lsr	r2, r1, r2
 3308 092e D2B2     		uxtb	r2, r2
 3309 0930 1A70     		strb	r2, [r3]
 732:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 3310              		.loc 1 732 0 discriminator 3
 3311 0932 FB6C     		ldr	r3, [r7, #76]
 3312 0934 0133     		adds	r3, r3, #1
 3313 0936 FB64     		str	r3, [r7, #76]
ARM GAS  /tmp/ccUeeWpa.s 			page 71


 3314              	.L145:
 732:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 3315              		.loc 1 732 0 is_stmt 0 discriminator 1
 3316 0938 FB6C     		ldr	r3, [r7, #76]
 3317 093a 032B     		cmp	r3, #3
 3318 093c EEDD     		ble	.L146
 734:bluetooth_rxtx.c **** 		}
 735:bluetooth_rxtx.c **** 		*data_len = 4;
 3319              		.loc 1 735 0 is_stmt 1
 3320 093e 3B68     		ldr	r3, [r7]
 3321 0940 0422     		movs	r2, #4
 3322 0942 1A60     		str	r2, [r3]
 736:bluetooth_rxtx.c **** 		break;
 3323              		.loc 1 736 0
 3324 0944 BFE0     		b	.L107
 3325              	.L91:
 737:bluetooth_rxtx.c **** 
 738:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ACCESS_ADDRESS:
 739:bluetooth_rxtx.c **** 		le_set_access_address(data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24);
 3326              		.loc 1 739 0
 3327 0946 7B68     		ldr	r3, [r7, #4]
 3328 0948 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3329 094a 1A46     		mov	r2, r3
 3330 094c 7B68     		ldr	r3, [r7, #4]
 3331 094e 0133     		adds	r3, r3, #1
 3332 0950 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3333 0952 1B02     		lsls	r3, r3, #8
 3334 0954 1A43     		orrs	r2, r2, r3
 3335 0956 7B68     		ldr	r3, [r7, #4]
 3336 0958 0233     		adds	r3, r3, #2
 3337 095a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3338 095c 1B04     		lsls	r3, r3, #16
 3339 095e 1A43     		orrs	r2, r2, r3
 3340 0960 7B68     		ldr	r3, [r7, #4]
 3341 0962 0333     		adds	r3, r3, #3
 3342 0964 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3343 0966 1B06     		lsls	r3, r3, #24
 3344 0968 1343     		orrs	r3, r3, r2
 3345 096a 1846     		mov	r0, r3
 3346 096c FFF7FEFF 		bl	le_set_access_address
 740:bluetooth_rxtx.c **** 		le.target_set = 1;
 3347              		.loc 1 740 0
 3348 0970 584B     		ldr	r3, .L157
 3349 0972 0122     		movs	r2, #1
 3350 0974 DA63     		str	r2, [r3, #60]
 741:bluetooth_rxtx.c **** 		break;
 3351              		.loc 1 741 0
 3352 0976 A6E0     		b	.L107
 3353              	.L93:
 742:bluetooth_rxtx.c **** 
 743:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING:
 744:bluetooth_rxtx.c **** 		// do something! just don't commit anything here
 745:bluetooth_rxtx.c **** 		break;
 746:bluetooth_rxtx.c **** 
 747:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING_REPLY:
 748:bluetooth_rxtx.c **** 		// after you do something, tell me what you did!
 749:bluetooth_rxtx.c **** 		// don't commit here please
ARM GAS  /tmp/ccUeeWpa.s 			page 72


 750:bluetooth_rxtx.c **** 		data[0] = 0x13;
 3354              		.loc 1 750 0
 3355 0978 7B68     		ldr	r3, [r7, #4]
 3356 097a 1322     		movs	r2, #19
 3357 097c 1A70     		strb	r2, [r3]
 751:bluetooth_rxtx.c **** 		data[1] = 0x37;
 3358              		.loc 1 751 0
 3359 097e 7B68     		ldr	r3, [r7, #4]
 3360 0980 0133     		adds	r3, r3, #1
 3361 0982 3722     		movs	r2, #55
 3362 0984 1A70     		strb	r2, [r3]
 752:bluetooth_rxtx.c **** 		*data_len = 2;
 3363              		.loc 1 752 0
 3364 0986 3B68     		ldr	r3, [r7]
 3365 0988 0222     		movs	r2, #2
 3366 098a 1A60     		str	r2, [r3]
 753:bluetooth_rxtx.c **** 		break;
 3367              		.loc 1 753 0
 3368 098c 9BE0     		b	.L107
 3369              	.L94:
 754:bluetooth_rxtx.c **** 
 755:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CRC_VERIFY:
 756:bluetooth_rxtx.c **** 		data[0] = le.crc_verify ? 1 : 0;
 3370              		.loc 1 756 0
 3371 098e 514B     		ldr	r3, .L157
 3372 0990 1B69     		ldr	r3, [r3, #16]
 3373 0992 002B     		cmp	r3, #0
 3374 0994 14BF     		ite	ne
 3375 0996 0123     		movne	r3, #1
 3376 0998 0023     		moveq	r3, #0
 3377 099a DBB2     		uxtb	r3, r3
 3378 099c 1A46     		mov	r2, r3
 3379 099e 7B68     		ldr	r3, [r7, #4]
 3380 09a0 1A70     		strb	r2, [r3]
 757:bluetooth_rxtx.c **** 		*data_len = 1;
 3381              		.loc 1 757 0
 3382 09a2 3B68     		ldr	r3, [r7]
 3383 09a4 0122     		movs	r2, #1
 3384 09a6 1A60     		str	r2, [r3]
 758:bluetooth_rxtx.c **** 		break;
 3385              		.loc 1 758 0
 3386 09a8 8DE0     		b	.L107
 3387              	.L95:
 759:bluetooth_rxtx.c **** 
 760:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CRC_VERIFY:
 761:bluetooth_rxtx.c **** 		le.crc_verify = request_params[0] ? 1 : 0;
 3388              		.loc 1 761 0
 3389 09aa BB68     		ldr	r3, [r7, #8]
 3390 09ac 1B88     		ldrh	r3, [r3]
 3391 09ae 002B     		cmp	r3, #0
 3392 09b0 14BF     		ite	ne
 3393 09b2 0123     		movne	r3, #1
 3394 09b4 0023     		moveq	r3, #0
 3395 09b6 DBB2     		uxtb	r3, r3
 3396 09b8 1A46     		mov	r2, r3
 3397 09ba 464B     		ldr	r3, .L157
 3398 09bc 1A61     		str	r2, [r3, #16]
ARM GAS  /tmp/ccUeeWpa.s 			page 73


 762:bluetooth_rxtx.c **** 		break;
 3399              		.loc 1 762 0
 3400 09be 82E0     		b	.L107
 3401              	.L96:
 763:bluetooth_rxtx.c **** 
 764:bluetooth_rxtx.c **** 	case UBERTOOTH_POLL:
 765:bluetooth_rxtx.c **** 		p = dequeue();
 3402              		.loc 1 765 0
 3403 09c0 FFF7FEFF 		bl	dequeue
 3404 09c4 7864     		str	r0, [r7, #68]
 766:bluetooth_rxtx.c **** 		if (p != NULL) {
 3405              		.loc 1 766 0
 3406 09c6 7B6C     		ldr	r3, [r7, #68]
 3407 09c8 002B     		cmp	r3, #0
 3408 09ca 08D0     		beq	.L147
 767:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 3409              		.loc 1 767 0
 3410 09cc 7868     		ldr	r0, [r7, #4]
 3411 09ce 796C     		ldr	r1, [r7, #68]
 3412 09d0 4022     		movs	r2, #64
 3413 09d2 FFF7FEFF 		bl	memcpy
 768:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 3414              		.loc 1 768 0
 3415 09d6 3B68     		ldr	r3, [r7]
 3416 09d8 4022     		movs	r2, #64
 3417 09da 1A60     		str	r2, [r3]
 769:bluetooth_rxtx.c **** 		} else {
 770:bluetooth_rxtx.c **** 			data[0] = 0;
 771:bluetooth_rxtx.c **** 			*data_len = 1;
 772:bluetooth_rxtx.c **** 		}
 773:bluetooth_rxtx.c **** 		break;
 3418              		.loc 1 773 0
 3419 09dc 73E0     		b	.L107
 3420              	.L147:
 770:bluetooth_rxtx.c **** 			*data_len = 1;
 3421              		.loc 1 770 0
 3422 09de 7B68     		ldr	r3, [r7, #4]
 3423 09e0 0022     		movs	r2, #0
 3424 09e2 1A70     		strb	r2, [r3]
 771:bluetooth_rxtx.c **** 		}
 3425              		.loc 1 771 0
 3426 09e4 3B68     		ldr	r3, [r7]
 3427 09e6 0122     		movs	r2, #1
 3428 09e8 1A60     		str	r2, [r3]
 3429              		.loc 1 773 0
 3430 09ea 6CE0     		b	.L107
 3431              	.L97:
 774:bluetooth_rxtx.c **** 
 775:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_PROMISC:
 776:bluetooth_rxtx.c **** 		*data_len = 0;
 3432              		.loc 1 776 0
 3433 09ec 3B68     		ldr	r3, [r7]
 3434 09ee 0022     		movs	r2, #0
 3435 09f0 1A60     		str	r2, [r3]
 777:bluetooth_rxtx.c **** 
 778:bluetooth_rxtx.c **** 		hop_mode = HOP_NONE;
 3436              		.loc 1 778 0
ARM GAS  /tmp/ccUeeWpa.s 			page 74


 3437 09f2 394B     		ldr	r3, .L157+4
 3438 09f4 0022     		movs	r2, #0
 3439 09f6 1A70     		strb	r2, [r3]
 779:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 3440              		.loc 1 779 0
 3441 09f8 384B     		ldr	r3, .L157+8
 3442 09fa 0A22     		movs	r2, #10
 3443 09fc 1A70     		strb	r2, [r3]
 780:bluetooth_rxtx.c **** 
 781:bluetooth_rxtx.c **** 		queue_init();
 3444              		.loc 1 781 0
 3445 09fe FFF7FEFF 		bl	queue_init
 782:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set();
 3446              		.loc 1 782 0
 3447 0a02 FFF7FEFF 		bl	cs_threshold_calc_and_set
 783:bluetooth_rxtx.c **** 		break;
 3448              		.loc 1 783 0
 3449 0a06 5EE0     		b	.L107
 3450              	.L100:
 784:bluetooth_rxtx.c **** 
 785:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_REGISTER:
 786:bluetooth_rxtx.c **** 		reg_val = cc2400_get(request_params[0]);
 3451              		.loc 1 786 0
 3452 0a08 BB68     		ldr	r3, [r7, #8]
 3453 0a0a 1B88     		ldrh	r3, [r3]
 3454 0a0c DBB2     		uxtb	r3, r3
 3455 0a0e 1846     		mov	r0, r3
 3456 0a10 FFF7FEFF 		bl	cc2400_get
 3457 0a14 0346     		mov	r3, r0
 3458 0a16 7B87     		strh	r3, [r7, #58]	@ movhi
 787:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 3459              		.loc 1 787 0
 3460 0a18 7B8F     		ldrh	r3, [r7, #58]
 3461 0a1a 1B0A     		lsrs	r3, r3, #8
 3462 0a1c 9BB2     		uxth	r3, r3
 3463 0a1e DAB2     		uxtb	r2, r3
 3464 0a20 7B68     		ldr	r3, [r7, #4]
 3465 0a22 1A70     		strb	r2, [r3]
 788:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 3466              		.loc 1 788 0
 3467 0a24 7B68     		ldr	r3, [r7, #4]
 3468 0a26 0133     		adds	r3, r3, #1
 3469 0a28 7A8F     		ldrh	r2, [r7, #58]	@ movhi
 3470 0a2a D2B2     		uxtb	r2, r2
 3471 0a2c 1A70     		strb	r2, [r3]
 789:bluetooth_rxtx.c **** 		*data_len = 2;
 3472              		.loc 1 789 0
 3473 0a2e 3B68     		ldr	r3, [r7]
 3474 0a30 0222     		movs	r2, #2
 3475 0a32 1A60     		str	r2, [r3]
 790:bluetooth_rxtx.c **** 		break;
 3476              		.loc 1 790 0
 3477 0a34 47E0     		b	.L107
 3478              	.L104:
 791:bluetooth_rxtx.c **** 
 792:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTER:
 793:bluetooth_rxtx.c **** 		cc2400_set(request_params[0] & 0xff, request_params[1]);
ARM GAS  /tmp/ccUeeWpa.s 			page 75


 3479              		.loc 1 793 0
 3480 0a36 BB68     		ldr	r3, [r7, #8]
 3481 0a38 1B88     		ldrh	r3, [r3]
 3482 0a3a DAB2     		uxtb	r2, r3
 3483 0a3c BB68     		ldr	r3, [r7, #8]
 3484 0a3e 0233     		adds	r3, r3, #2
 3485 0a40 1B88     		ldrh	r3, [r3]
 3486 0a42 1046     		mov	r0, r2
 3487 0a44 1946     		mov	r1, r3
 3488 0a46 FFF7FEFF 		bl	cc2400_set
 794:bluetooth_rxtx.c **** 		break;
 3489              		.loc 1 794 0
 3490 0a4a 3CE0     		b	.L107
 3491              	.L101:
 795:bluetooth_rxtx.c **** 
 796:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE:
 797:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 3492              		.loc 1 797 0
 3493 0a4c 2448     		ldr	r0, .L157+12
 3494 0a4e 7968     		ldr	r1, [r7, #4]
 3495 0a50 0622     		movs	r2, #6
 3496 0a52 FFF7FEFF 		bl	memcpy
 798:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 3497              		.loc 1 798 0
 3498 0a56 214B     		ldr	r3, .L157+8
 3499 0a58 0C22     		movs	r2, #12
 3500 0a5a 1A70     		strb	r2, [r3]
 799:bluetooth_rxtx.c **** 		break;
 3501              		.loc 1 799 0
 3502 0a5c 33E0     		b	.L107
 3503              	.L103:
 800:bluetooth_rxtx.c **** 
 801:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SET_TARGET:
 802:bluetooth_rxtx.c **** 		// Addresses appear in packets in reverse-octet order.
 803:bluetooth_rxtx.c **** 		// Store the target address in reverse order so that we can do a simple memcmp later
 804:bluetooth_rxtx.c **** 		le.target[0] = data[5];
 3504              		.loc 1 804 0
 3505 0a5e 7B68     		ldr	r3, [r7, #4]
 3506 0a60 5A79     		ldrb	r2, [r3, #5]	@ zero_extendqisi2
 3507 0a62 1C4B     		ldr	r3, .L157
 3508 0a64 83F83420 		strb	r2, [r3, #52]
 805:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 3509              		.loc 1 805 0
 3510 0a68 7B68     		ldr	r3, [r7, #4]
 3511 0a6a 1A79     		ldrb	r2, [r3, #4]	@ zero_extendqisi2
 3512 0a6c 194B     		ldr	r3, .L157
 3513 0a6e 83F83520 		strb	r2, [r3, #53]
 806:bluetooth_rxtx.c **** 		le.target[2] = data[3];
 3514              		.loc 1 806 0
 3515 0a72 7B68     		ldr	r3, [r7, #4]
 3516 0a74 DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 3517 0a76 174B     		ldr	r3, .L157
 3518 0a78 83F83620 		strb	r2, [r3, #54]
 807:bluetooth_rxtx.c **** 		le.target[3] = data[2];
 3519              		.loc 1 807 0
 3520 0a7c 7B68     		ldr	r3, [r7, #4]
 3521 0a7e 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
ARM GAS  /tmp/ccUeeWpa.s 			page 76


 3522 0a80 144B     		ldr	r3, .L157
 3523 0a82 83F83720 		strb	r2, [r3, #55]
 808:bluetooth_rxtx.c **** 		le.target[4] = data[1];
 3524              		.loc 1 808 0
 3525 0a86 7B68     		ldr	r3, [r7, #4]
 3526 0a88 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 3527 0a8a 124B     		ldr	r3, .L157
 3528 0a8c 83F83820 		strb	r2, [r3, #56]
 809:bluetooth_rxtx.c **** 		le.target[5] = data[0];
 3529              		.loc 1 809 0
 3530 0a90 7B68     		ldr	r3, [r7, #4]
 3531 0a92 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 3532 0a94 0F4B     		ldr	r3, .L157
 3533 0a96 83F83920 		strb	r2, [r3, #57]
 810:bluetooth_rxtx.c **** 		le.target_set = 1;
 3534              		.loc 1 810 0
 3535 0a9a 0E4B     		ldr	r3, .L157
 3536 0a9c 0122     		movs	r2, #1
 3537 0a9e DA63     		str	r2, [r3, #60]
 811:bluetooth_rxtx.c **** 		break;
 3538              		.loc 1 811 0
 3539 0aa0 11E0     		b	.L107
 3540              	.L105:
 812:bluetooth_rxtx.c **** 
 813:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 814:bluetooth_rxtx.c **** 	case UBERTOOTH_JAM_MODE:
 815:bluetooth_rxtx.c **** 		jam_mode = request_params[0];
 3541              		.loc 1 815 0
 3542 0aa2 BB68     		ldr	r3, [r7, #8]
 3543 0aa4 1B88     		ldrh	r3, [r3]
 3544 0aa6 DAB2     		uxtb	r2, r3
 3545 0aa8 0E4B     		ldr	r3, .L157+16
 3546 0aaa 1A70     		strb	r2, [r3]
 816:bluetooth_rxtx.c **** 		break;
 3547              		.loc 1 816 0
 3548 0aac 0BE0     		b	.L107
 3549              	.L106:
 817:bluetooth_rxtx.c **** #endif
 818:bluetooth_rxtx.c **** 
 819:bluetooth_rxtx.c **** 	case UBERTOOTH_EGO:
 820:bluetooth_rxtx.c **** #ifndef TX_ENABLE
 821:bluetooth_rxtx.c **** 		if (ego_mode == EGO_JAM)
 822:bluetooth_rxtx.c **** 			return 0;
 823:bluetooth_rxtx.c **** #endif
 824:bluetooth_rxtx.c **** 		requested_mode = MODE_EGO;
 3550              		.loc 1 824 0
 3551 0aae 0B4B     		ldr	r3, .L157+8
 3552 0ab0 0D22     		movs	r2, #13
 3553 0ab2 1A70     		strb	r2, [r3]
 825:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 3554              		.loc 1 825 0
 3555 0ab4 BB68     		ldr	r3, [r7, #8]
 3556 0ab6 1B88     		ldrh	r3, [r3]
 3557 0ab8 DAB2     		uxtb	r2, r3
 3558 0aba 0B4B     		ldr	r3, .L157+20
 3559 0abc 1A70     		strb	r2, [r3]
 826:bluetooth_rxtx.c **** 		break;
ARM GAS  /tmp/ccUeeWpa.s 			page 77


 3560              		.loc 1 826 0
 3561 0abe 02E0     		b	.L107
 3562              	.L47:
 827:bluetooth_rxtx.c **** 
 828:bluetooth_rxtx.c **** 	default:
 829:bluetooth_rxtx.c **** 		return 0;
 3563              		.loc 1 829 0
 3564 0ac0 0023     		movs	r3, #0
 3565 0ac2 01E0     		b	.L149
 3566              	.L150:
 745:bluetooth_rxtx.c **** 
 3567              		.loc 1 745 0
 3568 0ac4 00BF     		nop
 3569              	.L107:
 830:bluetooth_rxtx.c **** 	}
 831:bluetooth_rxtx.c **** 	return 1;
 3570              		.loc 1 831 0
 3571 0ac6 0123     		movs	r3, #1
 3572              	.L149:
 832:bluetooth_rxtx.c **** }
 3573              		.loc 1 832 0 discriminator 1
 3574 0ac8 1846     		mov	r0, r3
 3575 0aca 5437     		adds	r7, r7, #84
 3576              		.cfi_def_cfa_offset 36
 3577 0acc BD46     		mov	sp, r7
 3578              		.cfi_def_cfa_register 13
 3579              		@ sp needed
 3580 0ace BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 3581              	.L158:
 3582 0ad2 00BF     		.align	2
 3583              	.L157:
 3584 0ad4 00000000 		.word	le
 3585 0ad8 00000000 		.word	hop_mode
 3586 0adc 00000000 		.word	requested_mode
 3587 0ae0 00000000 		.word	slave_mac_address
 3588 0ae4 00000000 		.word	jam_mode
 3589 0ae8 00000000 		.word	ego_mode
 3590              		.cfi_endproc
 3591              	.LFE9:
 3593              		.section	.text.clkn_init,"ax",%progbits
 3594              		.align	2
 3595              		.thumb
 3596              		.thumb_func
 3598              	clkn_init:
 3599              	.LFB10:
 833:bluetooth_rxtx.c **** 
 834:bluetooth_rxtx.c **** static void clkn_init()
 835:bluetooth_rxtx.c **** {
 3600              		.loc 1 835 0
 3601              		.cfi_startproc
 3602              		@ args = 0, pretend = 0, frame = 0
 3603              		@ frame_needed = 1, uses_anonymous_args = 0
 3604              		@ link register save eliminated.
 3605 0000 80B4     		push	{r7}
 3606              		.cfi_def_cfa_offset 4
 3607              		.cfi_offset 7, -4
 3608 0002 00AF     		add	r7, sp, #0
ARM GAS  /tmp/ccUeeWpa.s 			page 78


 3609              		.cfi_def_cfa_register 7
 836:bluetooth_rxtx.c **** 	/*
 837:bluetooth_rxtx.c **** 	 * Because these are reset defaults, we're assuming TIMER0 is powered on
 838:bluetooth_rxtx.c **** 	 * and in timer mode.  The TIMER0 peripheral clock should have been set by
 839:bluetooth_rxtx.c **** 	 * clock_start().
 840:bluetooth_rxtx.c **** 	 */
 841:bluetooth_rxtx.c **** 
 842:bluetooth_rxtx.c **** 	/* stop and reset the timer to zero */
 843:bluetooth_rxtx.c **** 	T0TCR = TCR_Counter_Reset;
 3610              		.loc 1 843 0
 3611 0004 0C4B     		ldr	r3, .L160
 3612 0006 0222     		movs	r2, #2
 3613 0008 1A60     		str	r2, [r3]
 844:bluetooth_rxtx.c **** 	clkn = 0;
 3614              		.loc 1 844 0
 3615 000a 0C4B     		ldr	r3, .L160+4
 3616 000c 0022     		movs	r2, #0
 3617 000e 1A60     		str	r2, [r3]
 845:bluetooth_rxtx.c **** 
 846:bluetooth_rxtx.c **** #ifdef TC13BADGE
 847:bluetooth_rxtx.c **** 	/*
 848:bluetooth_rxtx.c **** 	 * The peripheral clock has a period of 33.3ns.  3 pclk periods makes one
 849:bluetooth_rxtx.c **** 	 * CLK100NS period (100 ns).
 850:bluetooth_rxtx.c **** 	 */
 851:bluetooth_rxtx.c **** 	T0PR = 2;
 852:bluetooth_rxtx.c **** #else
 853:bluetooth_rxtx.c **** 	/*
 854:bluetooth_rxtx.c **** 	 * The peripheral clock has a period of 20ns.  5 pclk periods
 855:bluetooth_rxtx.c **** 	 * makes one CLK100NS period (100 ns).
 856:bluetooth_rxtx.c **** 	 */
 857:bluetooth_rxtx.c **** 	T0PR = 4;
 3618              		.loc 1 857 0
 3619 0010 0B4B     		ldr	r3, .L160+8
 3620 0012 0422     		movs	r2, #4
 3621 0014 1A60     		str	r2, [r3]
 858:bluetooth_rxtx.c **** #endif
 859:bluetooth_rxtx.c **** 	/* 3125 * 100 ns = 312.5 us, the Bluetooth clock (CLKN). */
 860:bluetooth_rxtx.c **** 	T0MR0 = 3124;
 3622              		.loc 1 860 0
 3623 0016 0B4B     		ldr	r3, .L160+12
 3624 0018 40F63442 		movw	r2, #3124
 3625 001c 1A60     		str	r2, [r3]
 861:bluetooth_rxtx.c **** 	T0MCR = TMCR_MR0R | TMCR_MR0I;
 3626              		.loc 1 861 0
 3627 001e 0A4B     		ldr	r3, .L160+16
 3628 0020 0322     		movs	r2, #3
 3629 0022 1A60     		str	r2, [r3]
 862:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_TIMER0;
 3630              		.loc 1 862 0
 3631 0024 094B     		ldr	r3, .L160+20
 3632 0026 0222     		movs	r2, #2
 3633 0028 1A60     		str	r2, [r3]
 863:bluetooth_rxtx.c **** 
 864:bluetooth_rxtx.c **** 	/* start timer */
 865:bluetooth_rxtx.c **** 	T0TCR = TCR_Counter_Enable;
 3634              		.loc 1 865 0
 3635 002a 034B     		ldr	r3, .L160
ARM GAS  /tmp/ccUeeWpa.s 			page 79


 3636 002c 0122     		movs	r2, #1
 3637 002e 1A60     		str	r2, [r3]
 866:bluetooth_rxtx.c **** }
 3638              		.loc 1 866 0
 3639 0030 BD46     		mov	sp, r7
 3640              		.cfi_def_cfa_register 13
 3641              		@ sp needed
 3642 0032 5DF8047B 		ldr	r7, [sp], #4
 3643              		.cfi_restore 7
 3644              		.cfi_def_cfa_offset 0
 3645 0036 7047     		bx	lr
 3646              	.L161:
 3647              		.align	2
 3648              	.L160:
 3649 0038 04400040 		.word	1073758212
 3650 003c 00000000 		.word	clkn
 3651 0040 0C400040 		.word	1073758220
 3652 0044 18400040 		.word	1073758232
 3653 0048 14400040 		.word	1073758228
 3654 004c 00E100E0 		.word	-536813312
 3655              		.cfi_endproc
 3656              	.LFE10:
 3658              		.section	.text.TIMER0_IRQHandler,"ax",%progbits
 3659              		.align	2
 3660              		.global	TIMER0_IRQHandler
 3661              		.thumb
 3662              		.thumb_func
 3664              	TIMER0_IRQHandler:
 3665              	.LFB11:
 867:bluetooth_rxtx.c **** 
 868:bluetooth_rxtx.c **** /* Update CLKN. */
 869:bluetooth_rxtx.c **** void TIMER0_IRQHandler()
 870:bluetooth_rxtx.c **** {
 3666              		.loc 1 870 0
 3667              		.cfi_startproc
 3668              		@ args = 0, pretend = 0, frame = 8
 3669              		@ frame_needed = 1, uses_anonymous_args = 0
 3670              		@ link register save eliminated.
 3671 0000 80B4     		push	{r7}
 3672              		.cfi_def_cfa_offset 4
 3673              		.cfi_offset 7, -4
 3674 0002 83B0     		sub	sp, sp, #12
 3675              		.cfi_def_cfa_offset 16
 3676 0004 00AF     		add	r7, sp, #0
 3677              		.cfi_def_cfa_register 7
 871:bluetooth_rxtx.c **** 	// Use non-volatile working register to shave off a couple instructions
 872:bluetooth_rxtx.c **** 	u32 next;
 873:bluetooth_rxtx.c **** 	u32 le_clk;
 874:bluetooth_rxtx.c **** 
 875:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 3678              		.loc 1 875 0
 3679 0006 4FF04023 		mov	r3, #1073758208
 3680 000a 1B68     		ldr	r3, [r3]
 3681 000c 03F00103 		and	r3, r3, #1
 3682 0010 002B     		cmp	r3, #0
 3683 0012 6DD0     		beq	.L162
 876:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccUeeWpa.s 			page 80


 877:bluetooth_rxtx.c **** 		clkn++;
 3684              		.loc 1 877 0
 3685 0014 394B     		ldr	r3, .L172
 3686 0016 1B68     		ldr	r3, [r3]
 3687 0018 0133     		adds	r3, r3, #1
 3688 001a 384A     		ldr	r2, .L172
 3689 001c 1360     		str	r3, [r2]
 878:bluetooth_rxtx.c **** 		next = clkn;
 3690              		.loc 1 878 0
 3691 001e 374B     		ldr	r3, .L172
 3692 0020 1B68     		ldr	r3, [r3]
 3693 0022 7B60     		str	r3, [r7, #4]
 879:bluetooth_rxtx.c **** 		le_clk = (next - le.conn_epoch) & 0x03;
 3694              		.loc 1 879 0
 3695 0024 364B     		ldr	r3, .L172+4
 3696 0026 9B69     		ldr	r3, [r3, #24]
 3697 0028 7A68     		ldr	r2, [r7, #4]
 3698 002a D31A     		subs	r3, r2, r3
 3699 002c 03F00303 		and	r3, r3, #3
 3700 0030 3B60     		str	r3, [r7]
 880:bluetooth_rxtx.c **** 
 881:bluetooth_rxtx.c **** 		/* Trigger hop based on mode */
 882:bluetooth_rxtx.c **** 
 883:bluetooth_rxtx.c **** 		/* NONE or SWEEP -> 25 Hz */
 884:bluetooth_rxtx.c **** 		if (hop_mode == HOP_NONE || hop_mode == HOP_SWEEP) {
 3701              		.loc 1 884 0
 3702 0032 344B     		ldr	r3, .L172+8
 3703 0034 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3704 0036 002B     		cmp	r3, #0
 3705 0038 03D0     		beq	.L164
 3706              		.loc 1 884 0 is_stmt 0 discriminator 1
 3707 003a 324B     		ldr	r3, .L172+8
 3708 003c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3709 003e 012B     		cmp	r3, #1
 3710 0040 09D1     		bne	.L165
 3711              	.L164:
 885:bluetooth_rxtx.c **** 			if ((next & 0x7f) == 0)
 3712              		.loc 1 885 0 is_stmt 1
 3713 0042 7B68     		ldr	r3, [r7, #4]
 3714 0044 03F07F03 		and	r3, r3, #127
 3715 0048 002B     		cmp	r3, #0
 3716 004a 03D1     		bne	.L166
 886:bluetooth_rxtx.c **** 				do_hop = 1;
 3717              		.loc 1 886 0
 3718 004c 2E4B     		ldr	r3, .L172+12
 3719 004e 0122     		movs	r2, #1
 3720 0050 1A70     		strb	r2, [r3]
 885:bluetooth_rxtx.c **** 			if ((next & 0x7f) == 0)
 3721              		.loc 1 885 0
 3722 0052 37E0     		b	.L167
 3723              	.L166:
 3724 0054 36E0     		b	.L167
 3725              	.L165:
 887:bluetooth_rxtx.c **** 		}
 888:bluetooth_rxtx.c **** 		/* BLUETOOTH -> 1600 Hz */
 889:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BLUETOOTH) {
 3726              		.loc 1 889 0
ARM GAS  /tmp/ccUeeWpa.s 			page 81


 3727 0056 2B4B     		ldr	r3, .L172+8
 3728 0058 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3729 005a 022B     		cmp	r3, #2
 3730 005c 08D1     		bne	.L168
 890:bluetooth_rxtx.c **** 			if ((next & 0x1) == 0)
 3731              		.loc 1 890 0
 3732 005e 7B68     		ldr	r3, [r7, #4]
 3733 0060 03F00103 		and	r3, r3, #1
 3734 0064 002B     		cmp	r3, #0
 3735 0066 2DD1     		bne	.L167
 891:bluetooth_rxtx.c **** 				do_hop = 1;
 3736              		.loc 1 891 0
 3737 0068 274B     		ldr	r3, .L172+12
 3738 006a 0122     		movs	r2, #1
 3739 006c 1A70     		strb	r2, [r3]
 3740 006e 29E0     		b	.L167
 3741              	.L168:
 892:bluetooth_rxtx.c **** 		}
 893:bluetooth_rxtx.c **** 		/* BLUETOOTH Low Energy -> 7.5ms - 4.0s in multiples of 1.25 ms */
 894:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BTLE) {
 3742              		.loc 1 894 0
 3743 0070 244B     		ldr	r3, .L172+8
 3744 0072 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3745 0074 032B     		cmp	r3, #3
 3746 0076 25D1     		bne	.L167
 895:bluetooth_rxtx.c **** 			// Only hop if connected
 896:bluetooth_rxtx.c **** 			if (le.link_state == LINK_CONNECTED && le_clk == 0) {
 3747              		.loc 1 896 0
 3748 0078 214B     		ldr	r3, .L172+4
 3749 007a 1B7D     		ldrb	r3, [r3, #20]	@ zero_extendqisi2
 3750 007c 032B     		cmp	r3, #3
 3751 007e 21D1     		bne	.L167
 3752              		.loc 1 896 0 is_stmt 0 discriminator 1
 3753 0080 3B68     		ldr	r3, [r7]
 3754 0082 002B     		cmp	r3, #0
 3755 0084 1ED1     		bne	.L167
 897:bluetooth_rxtx.c **** 				--le.interval_timer;
 3756              		.loc 1 897 0 is_stmt 1
 3757 0086 1E4B     		ldr	r3, .L172+4
 3758 0088 9B8B     		ldrh	r3, [r3, #28]	@ movhi
 3759 008a 9BB2     		uxth	r3, r3
 3760 008c 013B     		subs	r3, r3, #1
 3761 008e 9AB2     		uxth	r2, r3
 3762 0090 1B4B     		ldr	r3, .L172+4
 3763 0092 9A83     		strh	r2, [r3, #28]	@ movhi
 898:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 3764              		.loc 1 898 0
 3765 0094 1A4B     		ldr	r3, .L172+4
 3766 0096 9B8B     		ldrh	r3, [r3, #28]	@ movhi
 3767 0098 9BB2     		uxth	r3, r3
 3768 009a 002B     		cmp	r3, #0
 3769 009c 0ED1     		bne	.L170
 899:bluetooth_rxtx.c **** 					do_hop = 1;
 3770              		.loc 1 899 0
 3771 009e 1A4B     		ldr	r3, .L172+12
 3772 00a0 0122     		movs	r2, #1
 3773 00a2 1A70     		strb	r2, [r3]
ARM GAS  /tmp/ccUeeWpa.s 			page 82


 900:bluetooth_rxtx.c **** 					++le.conn_count;
 3774              		.loc 1 900 0
 3775 00a4 164B     		ldr	r3, .L172+4
 3776 00a6 1B8C     		ldrh	r3, [r3, #32]	@ movhi
 3777 00a8 9BB2     		uxth	r3, r3
 3778 00aa 0133     		adds	r3, r3, #1
 3779 00ac 9AB2     		uxth	r2, r3
 3780 00ae 144B     		ldr	r3, .L172+4
 3781 00b0 1A84     		strh	r2, [r3, #32]	@ movhi
 901:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 3782              		.loc 1 901 0
 3783 00b2 134B     		ldr	r3, .L172+4
 3784 00b4 DA8B     		ldrh	r2, [r3, #30]
 3785 00b6 124B     		ldr	r3, .L172+4
 3786 00b8 9A83     		strh	r2, [r3, #28]	@ movhi
 3787 00ba 03E0     		b	.L167
 3788              	.L170:
 902:bluetooth_rxtx.c **** 				} else {
 903:bluetooth_rxtx.c **** 					TXLED_CLR; // hack!
 3789              		.loc 1 903 0
 3790 00bc 134B     		ldr	r3, .L172+16
 3791 00be 4FF48072 		mov	r2, #256
 3792 00c2 1A60     		str	r2, [r3]
 3793              	.L167:
 904:bluetooth_rxtx.c **** 				}
 905:bluetooth_rxtx.c **** 			}
 906:bluetooth_rxtx.c **** 		}
 907:bluetooth_rxtx.c **** 
 908:bluetooth_rxtx.c **** 		/* Keepalive trigger fires at 3200/2^9 = 6.25 Hz */
 909:bluetooth_rxtx.c **** 		if ((next & 0x1ff) == 0)
 3794              		.loc 1 909 0
 3795 00c4 7B68     		ldr	r3, [r7, #4]
 3796 00c6 C3F30803 		ubfx	r3, r3, #0, #9
 3797 00ca 002B     		cmp	r3, #0
 3798 00cc 02D1     		bne	.L171
 910:bluetooth_rxtx.c **** 			keepalive_trigger = 1;
 3799              		.loc 1 910 0
 3800 00ce 104B     		ldr	r3, .L172+20
 3801 00d0 0122     		movs	r2, #1
 3802 00d2 1A70     		strb	r2, [r3]
 3803              	.L171:
 911:bluetooth_rxtx.c **** 
 912:bluetooth_rxtx.c **** 		/* Ack interrupt */
 913:bluetooth_rxtx.c **** 		T0MR0 = 3124 - clock_trim;
 3804              		.loc 1 913 0
 3805 00d4 0F4A     		ldr	r2, .L172+24
 3806 00d6 104B     		ldr	r3, .L172+28
 3807 00d8 1B68     		ldr	r3, [r3]
 3808 00da C3F54363 		rsb	r3, r3, #3120
 3809 00de 0433     		adds	r3, r3, #4
 3810 00e0 1360     		str	r3, [r2]
 914:bluetooth_rxtx.c **** 		clock_trim = 0;
 3811              		.loc 1 914 0
 3812 00e2 0D4B     		ldr	r3, .L172+28
 3813 00e4 0022     		movs	r2, #0
 3814 00e6 1A60     		str	r2, [r3]
 915:bluetooth_rxtx.c **** 		T0IR = TIR_MR0_Interrupt;
ARM GAS  /tmp/ccUeeWpa.s 			page 83


 3815              		.loc 1 915 0
 3816 00e8 4FF04023 		mov	r3, #1073758208
 3817 00ec 0122     		movs	r2, #1
 3818 00ee 1A60     		str	r2, [r3]
 3819              	.L162:
 916:bluetooth_rxtx.c **** 	}
 917:bluetooth_rxtx.c **** }
 3820              		.loc 1 917 0
 3821 00f0 0C37     		adds	r7, r7, #12
 3822              		.cfi_def_cfa_offset 4
 3823 00f2 BD46     		mov	sp, r7
 3824              		.cfi_def_cfa_register 13
 3825              		@ sp needed
 3826 00f4 5DF8047B 		ldr	r7, [sp], #4
 3827              		.cfi_restore 7
 3828              		.cfi_def_cfa_offset 0
 3829 00f8 7047     		bx	lr
 3830              	.L173:
 3831 00fa 00BF     		.align	2
 3832              	.L172:
 3833 00fc 00000000 		.word	clkn
 3834 0100 00000000 		.word	le
 3835 0104 00000000 		.word	hop_mode
 3836 0108 00000000 		.word	do_hop
 3837 010c 3CC00920 		.word	537509948
 3838 0110 00000000 		.word	keepalive_trigger
 3839 0114 18400040 		.word	1073758232
 3840 0118 00000000 		.word	clock_trim
 3841              		.cfi_endproc
 3842              	.LFE11:
 3844              		.section	.text.EINT3_IRQHandler,"ax",%progbits
 3845              		.align	2
 3846              		.global	EINT3_IRQHandler
 3847              		.thumb
 3848              		.thumb_func
 3850              	EINT3_IRQHandler:
 3851              	.LFB12:
 918:bluetooth_rxtx.c **** 
 919:bluetooth_rxtx.c **** /* EINT3 handler is also defined in ubertooth.c for TC13BADGE. */
 920:bluetooth_rxtx.c **** #ifndef TC13BADGE
 921:bluetooth_rxtx.c **** //static volatile u8 txledstate = 1;
 922:bluetooth_rxtx.c **** void EINT3_IRQHandler()
 923:bluetooth_rxtx.c **** {
 3852              		.loc 1 923 0
 3853              		.cfi_startproc
 3854              		@ args = 0, pretend = 0, frame = 0
 3855              		@ frame_needed = 1, uses_anonymous_args = 0
 3856              		@ link register save eliminated.
 3857 0000 80B4     		push	{r7}
 3858              		.cfi_def_cfa_offset 4
 3859              		.cfi_offset 7, -4
 3860 0002 00AF     		add	r7, sp, #0
 3861              		.cfi_def_cfa_register 7
 924:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 925:bluetooth_rxtx.c **** 	IO2IntClr = PIN_GIO6;            // clear interrupt
 3862              		.loc 1 925 0
 3863 0004 0B4B     		ldr	r3, .L175
ARM GAS  /tmp/ccUeeWpa.s 			page 84


 3864 0006 0422     		movs	r2, #4
 3865 0008 1A60     		str	r2, [r3]
 926:bluetooth_rxtx.c **** 	cs_trigger = 1;                  // signal trigger
 3866              		.loc 1 926 0
 3867 000a 0B4B     		ldr	r3, .L175+4
 3868 000c 0122     		movs	r2, #1
 3869 000e 1A70     		strb	r2, [r3]
 927:bluetooth_rxtx.c **** 	cs_timestamp = CLK100NS;         // time at trigger
 3870              		.loc 1 927 0
 3871 0010 0A4B     		ldr	r3, .L175+8
 3872 0012 1B68     		ldr	r3, [r3]
 3873 0014 C3F31303 		ubfx	r3, r3, #0, #20
 3874 0018 40F63542 		movw	r2, #3125
 3875 001c 02FB03F2 		mul	r2, r2, r3
 3876 0020 074B     		ldr	r3, .L175+12
 3877 0022 1B68     		ldr	r3, [r3]
 3878 0024 1344     		add	r3, r3, r2
 3879 0026 074A     		ldr	r2, .L175+16
 3880 0028 1360     		str	r3, [r2]
 928:bluetooth_rxtx.c **** }
 3881              		.loc 1 928 0
 3882 002a BD46     		mov	sp, r7
 3883              		.cfi_def_cfa_register 13
 3884              		@ sp needed
 3885 002c 5DF8047B 		ldr	r7, [sp], #4
 3886              		.cfi_restore 7
 3887              		.cfi_def_cfa_offset 0
 3888 0030 7047     		bx	lr
 3889              	.L176:
 3890 0032 00BF     		.align	2
 3891              	.L175:
 3892 0034 AC800240 		.word	1073905836
 3893 0038 00000000 		.word	cs_trigger
 3894 003c 00000000 		.word	clkn
 3895 0040 08400040 		.word	1073758216
 3896 0044 00000000 		.word	cs_timestamp
 3897              		.cfi_endproc
 3898              	.LFE12:
 3900              		.global	__aeabi_ui2d
 3901              		.global	__aeabi_ddiv
 3902              		.global	__aeabi_dadd
 3903              		.global	__aeabi_d2uiz
 3904              		.section	.text.msleep,"ax",%progbits
 3905              		.align	2
 3906              		.thumb
 3907              		.thumb_func
 3909              	msleep:
 3910              	.LFB13:
 929:bluetooth_rxtx.c **** #endif // TC13BADGE
 930:bluetooth_rxtx.c **** 
 931:bluetooth_rxtx.c **** /* Sleep (busy wait) for 'millis' milliseconds. The 'wait' routines in
 932:bluetooth_rxtx.c ****  * ubertooth.c are matched to the clock setup at boot time and can not
 933:bluetooth_rxtx.c ****  * be used while the board is running at 100MHz. */
 934:bluetooth_rxtx.c **** static void msleep(uint32_t millis)
 935:bluetooth_rxtx.c **** {
 3911              		.loc 1 935 0
 3912              		.cfi_startproc
ARM GAS  /tmp/ccUeeWpa.s 			page 85


 3913              		@ args = 0, pretend = 0, frame = 16
 3914              		@ frame_needed = 1, uses_anonymous_args = 0
 3915 0000 B0B5     		push	{r4, r5, r7, lr}
 3916              		.cfi_def_cfa_offset 16
 3917              		.cfi_offset 4, -16
 3918              		.cfi_offset 5, -12
 3919              		.cfi_offset 7, -8
 3920              		.cfi_offset 14, -4
 3921 0002 84B0     		sub	sp, sp, #16
 3922              		.cfi_def_cfa_offset 32
 3923 0004 00AF     		add	r7, sp, #0
 3924              		.cfi_def_cfa_register 7
 3925 0006 7860     		str	r0, [r7, #4]
 936:bluetooth_rxtx.c **** 	uint32_t stop_at = clkn + (millis * 1000 / 312.5);  // millis -> clkn ticks
 3926              		.loc 1 936 0
 3927 0008 194B     		ldr	r3, .L179+8
 3928 000a 1B68     		ldr	r3, [r3]
 3929 000c 1846     		mov	r0, r3
 3930 000e FFF7FEFF 		bl	__aeabi_ui2d
 3931 0012 0446     		mov	r4, r0
 3932 0014 0D46     		mov	r5, r1
 3933 0016 7B68     		ldr	r3, [r7, #4]
 3934 0018 4FF47A72 		mov	r2, #1000
 3935 001c 02FB03F3 		mul	r3, r2, r3
 3936 0020 1846     		mov	r0, r3
 3937 0022 FFF7FEFF 		bl	__aeabi_ui2d
 3938 0026 0246     		mov	r2, r0
 3939 0028 0B46     		mov	r3, r1
 3940 002a 1046     		mov	r0, r2
 3941 002c 1946     		mov	r1, r3
 3942 002e 0EA3     		adr	r3, .L179
 3943 0030 D3E90023 		ldrd	r2, [r3]
 3944 0034 FFF7FEFF 		bl	__aeabi_ddiv
 3945 0038 0246     		mov	r2, r0
 3946 003a 0B46     		mov	r3, r1
 3947 003c 2046     		mov	r0, r4
 3948 003e 2946     		mov	r1, r5
 3949 0040 FFF7FEFF 		bl	__aeabi_dadd
 3950 0044 0246     		mov	r2, r0
 3951 0046 0B46     		mov	r3, r1
 3952 0048 1046     		mov	r0, r2
 3953 004a 1946     		mov	r1, r3
 3954 004c FFF7FEFF 		bl	__aeabi_d2uiz
 3955 0050 0346     		mov	r3, r0
 3956 0052 FB60     		str	r3, [r7, #12]
 3957              	.L178:
 937:bluetooth_rxtx.c **** 	do { } while (clkn < stop_at);                   // TODO: handle wrapping
 3958              		.loc 1 937 0 discriminator 1
 3959 0054 064B     		ldr	r3, .L179+8
 3960 0056 1A68     		ldr	r2, [r3]
 3961 0058 FB68     		ldr	r3, [r7, #12]
 3962 005a 9A42     		cmp	r2, r3
 3963 005c FAD3     		bcc	.L178
 938:bluetooth_rxtx.c **** }
 3964              		.loc 1 938 0
 3965 005e 1037     		adds	r7, r7, #16
 3966              		.cfi_def_cfa_offset 16
ARM GAS  /tmp/ccUeeWpa.s 			page 86


 3967 0060 BD46     		mov	sp, r7
 3968              		.cfi_def_cfa_register 13
 3969              		@ sp needed
 3970 0062 B0BD     		pop	{r4, r5, r7, pc}
 3971              	.L180:
 3972 0064 AFF30080 		.align	3
 3973              	.L179:
 3974 0068 00000000 		.word	0
 3975 006c 00887340 		.word	1081313280
 3976 0070 00000000 		.word	clkn
 3977              		.cfi_endproc
 3978              	.LFE13:
 3980              		.section	.text.dma_init,"ax",%progbits
 3981              		.align	2
 3982              		.thumb
 3983              		.thumb_func
 3985              	dma_init:
 3986              	.LFB14:
 939:bluetooth_rxtx.c **** 
 940:bluetooth_rxtx.c **** static void dma_init()
 941:bluetooth_rxtx.c **** {
 3987              		.loc 1 941 0
 3988              		.cfi_startproc
 3989              		@ args = 0, pretend = 0, frame = 0
 3990              		@ frame_needed = 1, uses_anonymous_args = 0
 3991              		@ link register save eliminated.
 3992 0000 80B4     		push	{r7}
 3993              		.cfi_def_cfa_offset 4
 3994              		.cfi_offset 7, -4
 3995 0002 00AF     		add	r7, sp, #0
 3996              		.cfi_def_cfa_register 7
 942:bluetooth_rxtx.c **** 	/* power up GPDMA controller */
 943:bluetooth_rxtx.c **** 	PCONP |= PCONP_PCGPDMA;
 3997              		.loc 1 943 0
 3998 0004 3F4A     		ldr	r2, .L183
 3999 0006 3F4B     		ldr	r3, .L183
 4000 0008 1B68     		ldr	r3, [r3]
 4001 000a 43F00053 		orr	r3, r3, #536870912
 4002 000e 1360     		str	r3, [r2]
 944:bluetooth_rxtx.c **** 
 945:bluetooth_rxtx.c **** 	/* zero out channel configs and clear interrupts */
 946:bluetooth_rxtx.c **** 	DMACC0Config = 0;
 4003              		.loc 1 946 0
 4004 0010 3D4B     		ldr	r3, .L183+4
 4005 0012 0022     		movs	r2, #0
 4006 0014 1A60     		str	r2, [r3]
 947:bluetooth_rxtx.c **** 	DMACC1Config = 0;
 4007              		.loc 1 947 0
 4008 0016 3D4B     		ldr	r3, .L183+8
 4009 0018 0022     		movs	r2, #0
 4010 001a 1A60     		str	r2, [r3]
 948:bluetooth_rxtx.c **** 	DMACC2Config = 0;
 4011              		.loc 1 948 0
 4012 001c 3C4B     		ldr	r3, .L183+12
 4013 001e 0022     		movs	r2, #0
 4014 0020 1A60     		str	r2, [r3]
 949:bluetooth_rxtx.c **** 	DMACC3Config = 0;
ARM GAS  /tmp/ccUeeWpa.s 			page 87


 4015              		.loc 1 949 0
 4016 0022 3C4B     		ldr	r3, .L183+16
 4017 0024 0022     		movs	r2, #0
 4018 0026 1A60     		str	r2, [r3]
 950:bluetooth_rxtx.c **** 	DMACC4Config = 0;
 4019              		.loc 1 950 0
 4020 0028 3B4B     		ldr	r3, .L183+20
 4021 002a 0022     		movs	r2, #0
 4022 002c 1A60     		str	r2, [r3]
 951:bluetooth_rxtx.c **** 	DMACC5Config = 0;
 4023              		.loc 1 951 0
 4024 002e 3B4B     		ldr	r3, .L183+24
 4025 0030 0022     		movs	r2, #0
 4026 0032 1A60     		str	r2, [r3]
 952:bluetooth_rxtx.c **** 	DMACC6Config = 0;
 4027              		.loc 1 952 0
 4028 0034 3A4B     		ldr	r3, .L183+28
 4029 0036 0022     		movs	r2, #0
 4030 0038 1A60     		str	r2, [r3]
 953:bluetooth_rxtx.c **** 	DMACC7Config = 0;
 4031              		.loc 1 953 0
 4032 003a 3A4B     		ldr	r3, .L183+32
 4033 003c 0022     		movs	r2, #0
 4034 003e 1A60     		str	r2, [r3]
 954:bluetooth_rxtx.c **** 	DMACIntTCClear = 0xFF;
 4035              		.loc 1 954 0
 4036 0040 394B     		ldr	r3, .L183+36
 4037 0042 FF22     		movs	r2, #255
 4038 0044 1A60     		str	r2, [r3]
 955:bluetooth_rxtx.c **** 	DMACIntErrClr = 0xFF;
 4039              		.loc 1 955 0
 4040 0046 394B     		ldr	r3, .L183+40
 4041 0048 FF22     		movs	r2, #255
 4042 004a 1A60     		str	r2, [r3]
 956:bluetooth_rxtx.c **** 
 957:bluetooth_rxtx.c **** 	/* DMA linked lists */
 958:bluetooth_rxtx.c **** 	rx_dma_lli1.src = (u32)&(DIO_SSP_DR);
 4043              		.loc 1 958 0
 4044 004c 384B     		ldr	r3, .L183+44
 4045 004e 394A     		ldr	r2, .L183+48
 4046 0050 1A60     		str	r2, [r3]
 959:bluetooth_rxtx.c **** 	rx_dma_lli1.dest = (u32)&rxbuf1[0];
 4047              		.loc 1 959 0
 4048 0052 394A     		ldr	r2, .L183+52
 4049 0054 364B     		ldr	r3, .L183+44
 4050 0056 5A60     		str	r2, [r3, #4]
 960:bluetooth_rxtx.c **** 	rx_dma_lli1.next_lli = (u32)&rx_dma_lli2;
 4051              		.loc 1 960 0
 4052 0058 384A     		ldr	r2, .L183+56
 4053 005a 354B     		ldr	r3, .L183+44
 4054 005c 9A60     		str	r2, [r3, #8]
 961:bluetooth_rxtx.c **** 	rx_dma_lli1.control = (DMA_SIZE) |
 4055              		.loc 1 961 0
 4056 005e 344B     		ldr	r3, .L183+44
 4057 0060 374A     		ldr	r2, .L183+60
 4058 0062 DA60     		str	r2, [r3, #12]
 962:bluetooth_rxtx.c **** 			(1 << 12) |        /* source burst size = 4 */
ARM GAS  /tmp/ccUeeWpa.s 			page 88


 963:bluetooth_rxtx.c **** 			(1 << 15) |        /* destination burst size = 4 */
 964:bluetooth_rxtx.c **** 			(0 << 18) |        /* source width 8 bits */
 965:bluetooth_rxtx.c **** 			(0 << 21) |        /* destination width 8 bits */
 966:bluetooth_rxtx.c **** 			DMACCxControl_DI | /* destination increment */
 967:bluetooth_rxtx.c **** 			DMACCxControl_I;   /* terminal count interrupt enable */
 968:bluetooth_rxtx.c **** 
 969:bluetooth_rxtx.c **** 	rx_dma_lli2.src = (u32)&(DIO_SSP_DR);
 4059              		.loc 1 969 0
 4060 0064 354B     		ldr	r3, .L183+56
 4061 0066 334A     		ldr	r2, .L183+48
 4062 0068 1A60     		str	r2, [r3]
 970:bluetooth_rxtx.c **** 	rx_dma_lli2.dest = (u32)&rxbuf2[0];
 4063              		.loc 1 970 0
 4064 006a 364A     		ldr	r2, .L183+64
 4065 006c 334B     		ldr	r3, .L183+56
 4066 006e 5A60     		str	r2, [r3, #4]
 971:bluetooth_rxtx.c **** 	rx_dma_lli2.next_lli = (u32)&rx_dma_lli1;
 4067              		.loc 1 971 0
 4068 0070 2F4A     		ldr	r2, .L183+44
 4069 0072 324B     		ldr	r3, .L183+56
 4070 0074 9A60     		str	r2, [r3, #8]
 972:bluetooth_rxtx.c **** 	rx_dma_lli2.control = (DMA_SIZE) |
 4071              		.loc 1 972 0
 4072 0076 314B     		ldr	r3, .L183+56
 4073 0078 314A     		ldr	r2, .L183+60
 4074 007a DA60     		str	r2, [r3, #12]
 973:bluetooth_rxtx.c **** 			(1 << 12) |        /* source burst size = 4 */
 974:bluetooth_rxtx.c **** 			(1 << 15) |        /* destination burst size = 4 */
 975:bluetooth_rxtx.c **** 			(0 << 18) |        /* source width 8 bits */
 976:bluetooth_rxtx.c **** 			(0 << 21) |        /* destination width 8 bits */
 977:bluetooth_rxtx.c **** 			DMACCxControl_DI | /* destination increment */
 978:bluetooth_rxtx.c **** 			DMACCxControl_I;   /* terminal count interrupt enable */
 979:bluetooth_rxtx.c **** 
 980:bluetooth_rxtx.c **** 	/* disable DMA interrupts */
 981:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_DMA;
 4075              		.loc 1 981 0
 4076 007c 324B     		ldr	r3, .L183+68
 4077 007e 4FF08062 		mov	r2, #67108864
 4078 0082 1A60     		str	r2, [r3]
 982:bluetooth_rxtx.c **** 
 983:bluetooth_rxtx.c **** 	/* enable DMA globally */
 984:bluetooth_rxtx.c **** 	DMACConfig = DMACConfig_E;
 4079              		.loc 1 984 0
 4080 0084 314B     		ldr	r3, .L183+72
 4081 0086 0122     		movs	r2, #1
 4082 0088 1A60     		str	r2, [r3]
 985:bluetooth_rxtx.c **** 	while (!(DMACConfig & DMACConfig_E));
 4083              		.loc 1 985 0
 4084 008a 00BF     		nop
 4085              	.L182:
 4086              		.loc 1 985 0 is_stmt 0 discriminator 1
 4087 008c 2F4B     		ldr	r3, .L183+72
 4088 008e 1B68     		ldr	r3, [r3]
 4089 0090 03F00103 		and	r3, r3, #1
 4090 0094 002B     		cmp	r3, #0
 4091 0096 F9D0     		beq	.L182
 986:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccUeeWpa.s 			page 89


 987:bluetooth_rxtx.c **** 	/* configure DMA channel 1 */
 988:bluetooth_rxtx.c **** 	DMACC0SrcAddr = rx_dma_lli1.src;
 4092              		.loc 1 988 0 is_stmt 1
 4093 0098 2D4A     		ldr	r2, .L183+76
 4094 009a 254B     		ldr	r3, .L183+44
 4095 009c 1B68     		ldr	r3, [r3]
 4096 009e 1360     		str	r3, [r2]
 989:bluetooth_rxtx.c **** 	DMACC0DestAddr = rx_dma_lli1.dest;
 4097              		.loc 1 989 0
 4098 00a0 2C4A     		ldr	r2, .L183+80
 4099 00a2 234B     		ldr	r3, .L183+44
 4100 00a4 5B68     		ldr	r3, [r3, #4]
 4101 00a6 1360     		str	r3, [r2]
 990:bluetooth_rxtx.c **** 	DMACC0LLI = rx_dma_lli1.next_lli;
 4102              		.loc 1 990 0
 4103 00a8 2B4A     		ldr	r2, .L183+84
 4104 00aa 214B     		ldr	r3, .L183+44
 4105 00ac 9B68     		ldr	r3, [r3, #8]
 4106 00ae 1360     		str	r3, [r2]
 991:bluetooth_rxtx.c **** 	DMACC0Control = rx_dma_lli1.control;
 4107              		.loc 1 991 0
 4108 00b0 2A4A     		ldr	r2, .L183+88
 4109 00b2 1F4B     		ldr	r3, .L183+44
 4110 00b4 DB68     		ldr	r3, [r3, #12]
 4111 00b6 1360     		str	r3, [r2]
 992:bluetooth_rxtx.c **** 	DMACC0Config =
 4112              		.loc 1 992 0
 4113 00b8 134B     		ldr	r3, .L183+4
 4114 00ba 4DF20602 		movw	r2, #53254
 4115 00be 1A60     		str	r2, [r3]
 993:bluetooth_rxtx.c **** 			DIO_SSP_SRC |
 994:bluetooth_rxtx.c **** 			(0x2 << 11) |           /* peripheral to memory */
 995:bluetooth_rxtx.c **** 			DMACCxConfig_IE |       /* allow error interrupts */
 996:bluetooth_rxtx.c **** 			DMACCxConfig_ITC;       /* allow terminal count interrupts */
 997:bluetooth_rxtx.c **** 
 998:bluetooth_rxtx.c **** 	active_buf_clkn_high = (clkn >> 20) & 0xff;
 4116              		.loc 1 998 0
 4117 00c0 274B     		ldr	r3, .L183+92
 4118 00c2 1B68     		ldr	r3, [r3]
 4119 00c4 1B0D     		lsrs	r3, r3, #20
 4120 00c6 DBB2     		uxtb	r3, r3
 4121 00c8 264A     		ldr	r2, .L183+96
 4122 00ca 1360     		str	r3, [r2]
 999:bluetooth_rxtx.c **** 	active_buf_clk100ns = CLK100NS;
 4123              		.loc 1 999 0
 4124 00cc 244B     		ldr	r3, .L183+92
 4125 00ce 1B68     		ldr	r3, [r3]
 4126 00d0 C3F31303 		ubfx	r3, r3, #0, #20
 4127 00d4 40F63542 		movw	r2, #3125
 4128 00d8 02FB03F2 		mul	r2, r2, r3
 4129 00dc 224B     		ldr	r3, .L183+100
 4130 00de 1B68     		ldr	r3, [r3]
 4131 00e0 1344     		add	r3, r3, r2
 4132 00e2 224A     		ldr	r2, .L183+104
 4133 00e4 1360     		str	r3, [r2]
1000:bluetooth_rxtx.c **** 	active_buf_channel = channel;
 4134              		.loc 1 1000 0
ARM GAS  /tmp/ccUeeWpa.s 			page 90


 4135 00e6 224B     		ldr	r3, .L183+108
 4136 00e8 1B88     		ldrh	r3, [r3]	@ movhi
 4137 00ea 9AB2     		uxth	r2, r3
 4138 00ec 214B     		ldr	r3, .L183+112
 4139 00ee 1A80     		strh	r2, [r3]	@ movhi
1001:bluetooth_rxtx.c **** 
1002:bluetooth_rxtx.c **** 	/* reset interrupt counters */
1003:bluetooth_rxtx.c **** 	rx_tc = 0;
 4140              		.loc 1 1003 0
 4141 00f0 214B     		ldr	r3, .L183+116
 4142 00f2 0022     		movs	r2, #0
 4143 00f4 1A60     		str	r2, [r3]
1004:bluetooth_rxtx.c **** 	rx_err = 0;
 4144              		.loc 1 1004 0
 4145 00f6 214B     		ldr	r3, .L183+120
 4146 00f8 0022     		movs	r2, #0
 4147 00fa 1A60     		str	r2, [r3]
1005:bluetooth_rxtx.c **** }
 4148              		.loc 1 1005 0
 4149 00fc BD46     		mov	sp, r7
 4150              		.cfi_def_cfa_register 13
 4151              		@ sp needed
 4152 00fe 5DF8047B 		ldr	r7, [sp], #4
 4153              		.cfi_restore 7
 4154              		.cfi_def_cfa_offset 0
 4155 0102 7047     		bx	lr
 4156              	.L184:
 4157              		.align	2
 4158              	.L183:
 4159 0104 C4C00F40 		.word	1074774212
 4160 0108 10410050 		.word	1342193936
 4161 010c 30410050 		.word	1342193968
 4162 0110 50410050 		.word	1342194000
 4163 0114 70410050 		.word	1342194032
 4164 0118 90410050 		.word	1342194064
 4165 011c B0410050 		.word	1342194096
 4166 0120 D0410050 		.word	1342194128
 4167 0124 F0410050 		.word	1342194160
 4168 0128 08400050 		.word	1342193672
 4169 012c 10400050 		.word	1342193680
 4170 0130 00000000 		.word	rx_dma_lli1
 4171 0134 08000340 		.word	1073938440
 4172 0138 00000000 		.word	rxbuf1
 4173 013c 00000000 		.word	rx_dma_lli2
 4174 0140 32900088 		.word	-2013229006
 4175 0144 00000000 		.word	rxbuf2
 4176 0148 80E100E0 		.word	-536813184
 4177 014c 30400050 		.word	1342193712
 4178 0150 00410050 		.word	1342193920
 4179 0154 04410050 		.word	1342193924
 4180 0158 08410050 		.word	1342193928
 4181 015c 0C410050 		.word	1342193932
 4182 0160 00000000 		.word	clkn
 4183 0164 00000000 		.word	active_buf_clkn_high
 4184 0168 08400040 		.word	1073758216
 4185 016c 00000000 		.word	active_buf_clk100ns
 4186 0170 00000000 		.word	channel
ARM GAS  /tmp/ccUeeWpa.s 			page 91


 4187 0174 00000000 		.word	active_buf_channel
 4188 0178 00000000 		.word	rx_tc
 4189 017c 00000000 		.word	rx_err
 4190              		.cfi_endproc
 4191              	.LFE14:
 4193              		.section	.text.dma_init_le,"ax",%progbits
 4194              		.align	2
 4195              		.thumb
 4196              		.thumb_func
 4198              	dma_init_le:
 4199              	.LFB15:
1006:bluetooth_rxtx.c **** 
1007:bluetooth_rxtx.c **** static void dma_init_le()
1008:bluetooth_rxtx.c **** {
 4200              		.loc 1 1008 0
 4201              		.cfi_startproc
 4202              		@ args = 0, pretend = 0, frame = 8
 4203              		@ frame_needed = 1, uses_anonymous_args = 0
 4204              		@ link register save eliminated.
 4205 0000 80B4     		push	{r7}
 4206              		.cfi_def_cfa_offset 4
 4207              		.cfi_offset 7, -4
 4208 0002 83B0     		sub	sp, sp, #12
 4209              		.cfi_def_cfa_offset 16
 4210 0004 00AF     		add	r7, sp, #0
 4211              		.cfi_def_cfa_register 7
1009:bluetooth_rxtx.c **** 	int i;
1010:bluetooth_rxtx.c **** 
1011:bluetooth_rxtx.c **** 	/* power up GPDMA controller */
1012:bluetooth_rxtx.c **** 	PCONP |= PCONP_PCGPDMA;
 4212              		.loc 1 1012 0
 4213 0006 4B4A     		ldr	r2, .L191
 4214 0008 4A4B     		ldr	r3, .L191
 4215 000a 1B68     		ldr	r3, [r3]
 4216 000c 43F00053 		orr	r3, r3, #536870912
 4217 0010 1360     		str	r3, [r2]
1013:bluetooth_rxtx.c **** 
1014:bluetooth_rxtx.c **** 	/* zero out channel configs and clear interrupts */
1015:bluetooth_rxtx.c **** 	DMACC0Config = 0;
 4218              		.loc 1 1015 0
 4219 0012 494B     		ldr	r3, .L191+4
 4220 0014 0022     		movs	r2, #0
 4221 0016 1A60     		str	r2, [r3]
1016:bluetooth_rxtx.c **** 	DMACC1Config = 0;
 4222              		.loc 1 1016 0
 4223 0018 484B     		ldr	r3, .L191+8
 4224 001a 0022     		movs	r2, #0
 4225 001c 1A60     		str	r2, [r3]
1017:bluetooth_rxtx.c **** 	DMACC2Config = 0;
 4226              		.loc 1 1017 0
 4227 001e 484B     		ldr	r3, .L191+12
 4228 0020 0022     		movs	r2, #0
 4229 0022 1A60     		str	r2, [r3]
1018:bluetooth_rxtx.c **** 	DMACC3Config = 0;
 4230              		.loc 1 1018 0
 4231 0024 474B     		ldr	r3, .L191+16
 4232 0026 0022     		movs	r2, #0
ARM GAS  /tmp/ccUeeWpa.s 			page 92


 4233 0028 1A60     		str	r2, [r3]
1019:bluetooth_rxtx.c **** 	DMACC4Config = 0;
 4234              		.loc 1 1019 0
 4235 002a 474B     		ldr	r3, .L191+20
 4236 002c 0022     		movs	r2, #0
 4237 002e 1A60     		str	r2, [r3]
1020:bluetooth_rxtx.c **** 	DMACC5Config = 0;
 4238              		.loc 1 1020 0
 4239 0030 464B     		ldr	r3, .L191+24
 4240 0032 0022     		movs	r2, #0
 4241 0034 1A60     		str	r2, [r3]
1021:bluetooth_rxtx.c **** 	DMACC6Config = 0;
 4242              		.loc 1 1021 0
 4243 0036 464B     		ldr	r3, .L191+28
 4244 0038 0022     		movs	r2, #0
 4245 003a 1A60     		str	r2, [r3]
1022:bluetooth_rxtx.c **** 	DMACC7Config = 0;
 4246              		.loc 1 1022 0
 4247 003c 454B     		ldr	r3, .L191+32
 4248 003e 0022     		movs	r2, #0
 4249 0040 1A60     		str	r2, [r3]
1023:bluetooth_rxtx.c **** 	DMACIntTCClear = 0xFF;
 4250              		.loc 1 1023 0
 4251 0042 454B     		ldr	r3, .L191+36
 4252 0044 FF22     		movs	r2, #255
 4253 0046 1A60     		str	r2, [r3]
1024:bluetooth_rxtx.c **** 	DMACIntErrClr = 0xFF;
 4254              		.loc 1 1024 0
 4255 0048 444B     		ldr	r3, .L191+40
 4256 004a FF22     		movs	r2, #255
 4257 004c 1A60     		str	r2, [r3]
1025:bluetooth_rxtx.c **** 
1026:bluetooth_rxtx.c **** 	/* enable DMA globally */
1027:bluetooth_rxtx.c **** 	DMACConfig = DMACConfig_E;
 4258              		.loc 1 1027 0
 4259 004e 444B     		ldr	r3, .L191+44
 4260 0050 0122     		movs	r2, #1
 4261 0052 1A60     		str	r2, [r3]
1028:bluetooth_rxtx.c **** 	while (!(DMACConfig & DMACConfig_E));
 4262              		.loc 1 1028 0
 4263 0054 00BF     		nop
 4264              	.L186:
 4265              		.loc 1 1028 0 is_stmt 0 discriminator 1
 4266 0056 424B     		ldr	r3, .L191+44
 4267 0058 1B68     		ldr	r3, [r3]
 4268 005a 03F00103 		and	r3, r3, #1
 4269 005e 002B     		cmp	r3, #0
 4270 0060 F9D0     		beq	.L186
1029:bluetooth_rxtx.c **** 
1030:bluetooth_rxtx.c **** 	for (i = 0; i < 11; ++i) {
 4271              		.loc 1 1030 0 is_stmt 1
 4272 0062 0023     		movs	r3, #0
 4273 0064 7B60     		str	r3, [r7, #4]
 4274 0066 2AE0     		b	.L187
 4275              	.L190:
1031:bluetooth_rxtx.c **** 		le_dma_lli[i].src = (u32)&(DIO_SSP_DR);
 4276              		.loc 1 1031 0
ARM GAS  /tmp/ccUeeWpa.s 			page 93


 4277 0068 3E4A     		ldr	r2, .L191+48
 4278 006a 7B68     		ldr	r3, [r7, #4]
 4279 006c 1B01     		lsls	r3, r3, #4
 4280 006e 1344     		add	r3, r3, r2
 4281 0070 3D4A     		ldr	r2, .L191+52
 4282 0072 1A60     		str	r2, [r3]
1032:bluetooth_rxtx.c **** 		le_dma_lli[i].dest = (u32)&rxbuf1[4 * i];
 4283              		.loc 1 1032 0
 4284 0074 7B68     		ldr	r3, [r7, #4]
 4285 0076 9B00     		lsls	r3, r3, #2
 4286 0078 3C4A     		ldr	r2, .L191+56
 4287 007a 1344     		add	r3, r3, r2
 4288 007c 1946     		mov	r1, r3
 4289 007e 394A     		ldr	r2, .L191+48
 4290 0080 7B68     		ldr	r3, [r7, #4]
 4291 0082 1B01     		lsls	r3, r3, #4
 4292 0084 1344     		add	r3, r3, r2
 4293 0086 5960     		str	r1, [r3, #4]
1033:bluetooth_rxtx.c **** 		le_dma_lli[i].next_lli = i < 10 ? (u32)&le_dma_lli[i+1] : 0;
 4294              		.loc 1 1033 0
 4295 0088 7B68     		ldr	r3, [r7, #4]
 4296 008a 092B     		cmp	r3, #9
 4297 008c 06DC     		bgt	.L188
 4298              		.loc 1 1033 0 is_stmt 0 discriminator 1
 4299 008e 7B68     		ldr	r3, [r7, #4]
 4300 0090 0133     		adds	r3, r3, #1
 4301 0092 1B01     		lsls	r3, r3, #4
 4302 0094 334A     		ldr	r2, .L191+48
 4303 0096 1344     		add	r3, r3, r2
 4304 0098 1A46     		mov	r2, r3
 4305 009a 00E0     		b	.L189
 4306              	.L188:
 4307              		.loc 1 1033 0 discriminator 2
 4308 009c 0022     		movs	r2, #0
 4309              	.L189:
 4310              		.loc 1 1033 0 discriminator 4
 4311 009e 3149     		ldr	r1, .L191+48
 4312 00a0 7B68     		ldr	r3, [r7, #4]
 4313 00a2 1B01     		lsls	r3, r3, #4
 4314 00a4 0B44     		add	r3, r3, r1
 4315 00a6 0833     		adds	r3, r3, #8
 4316 00a8 1A60     		str	r2, [r3]
1034:bluetooth_rxtx.c **** 		le_dma_lli[i].control = 4 |
 4317              		.loc 1 1034 0 is_stmt 1 discriminator 4
 4318 00aa 2E4A     		ldr	r2, .L191+48
 4319 00ac 7B68     		ldr	r3, [r7, #4]
 4320 00ae 1B01     		lsls	r3, r3, #4
 4321 00b0 1344     		add	r3, r3, r2
 4322 00b2 0833     		adds	r3, r3, #8
 4323 00b4 2E4A     		ldr	r2, .L191+60
 4324 00b6 5A60     		str	r2, [r3, #4]
1030:bluetooth_rxtx.c **** 		le_dma_lli[i].src = (u32)&(DIO_SSP_DR);
 4325              		.loc 1 1030 0 discriminator 4
 4326 00b8 7B68     		ldr	r3, [r7, #4]
 4327 00ba 0133     		adds	r3, r3, #1
 4328 00bc 7B60     		str	r3, [r7, #4]
 4329              	.L187:
ARM GAS  /tmp/ccUeeWpa.s 			page 94


1030:bluetooth_rxtx.c **** 		le_dma_lli[i].src = (u32)&(DIO_SSP_DR);
 4330              		.loc 1 1030 0 is_stmt 0 discriminator 2
 4331 00be 7B68     		ldr	r3, [r7, #4]
 4332 00c0 0A2B     		cmp	r3, #10
 4333 00c2 D1DD     		ble	.L190
1035:bluetooth_rxtx.c **** 				(1 << 12) |        /* source burst size = 4 */
1036:bluetooth_rxtx.c **** 				(0 << 15) |        /* destination burst size = 1 */
1037:bluetooth_rxtx.c **** 				(0 << 18) |        /* source width 8 bits */
1038:bluetooth_rxtx.c **** 				(0 << 21) |        /* destination width 8 bits */
1039:bluetooth_rxtx.c **** 				DMACCxControl_DI | /* destination increment */
1040:bluetooth_rxtx.c **** 				DMACCxControl_I;   /* terminal count interrupt enable */
1041:bluetooth_rxtx.c **** 	}
1042:bluetooth_rxtx.c **** 
1043:bluetooth_rxtx.c **** 	/* configure DMA channel 0 */
1044:bluetooth_rxtx.c **** 	DMACC0SrcAddr = le_dma_lli[0].src;
 4334              		.loc 1 1044 0 is_stmt 1
 4335 00c4 2B4A     		ldr	r2, .L191+64
 4336 00c6 274B     		ldr	r3, .L191+48
 4337 00c8 1B68     		ldr	r3, [r3]
 4338 00ca 1360     		str	r3, [r2]
1045:bluetooth_rxtx.c **** 	DMACC0DestAddr = le_dma_lli[0].dest;
 4339              		.loc 1 1045 0
 4340 00cc 2A4A     		ldr	r2, .L191+68
 4341 00ce 254B     		ldr	r3, .L191+48
 4342 00d0 5B68     		ldr	r3, [r3, #4]
 4343 00d2 1360     		str	r3, [r2]
1046:bluetooth_rxtx.c **** 	DMACC0LLI = le_dma_lli[0].next_lli;
 4344              		.loc 1 1046 0
 4345 00d4 294A     		ldr	r2, .L191+72
 4346 00d6 234B     		ldr	r3, .L191+48
 4347 00d8 9B68     		ldr	r3, [r3, #8]
 4348 00da 1360     		str	r3, [r2]
1047:bluetooth_rxtx.c **** 	DMACC0Control = le_dma_lli[0].control;
 4349              		.loc 1 1047 0
 4350 00dc 284A     		ldr	r2, .L191+76
 4351 00de 214B     		ldr	r3, .L191+48
 4352 00e0 DB68     		ldr	r3, [r3, #12]
 4353 00e2 1360     		str	r3, [r2]
1048:bluetooth_rxtx.c **** 	DMACC0Config =
 4354              		.loc 1 1048 0
 4355 00e4 144B     		ldr	r3, .L191+4
 4356 00e6 4DF20602 		movw	r2, #53254
 4357 00ea 1A60     		str	r2, [r3]
1049:bluetooth_rxtx.c **** 			DIO_SSP_SRC |
1050:bluetooth_rxtx.c **** 			(0x2 << 11) |           /* peripheral to memory */
1051:bluetooth_rxtx.c **** 			DMACCxConfig_IE |       /* allow error interrupts */
1052:bluetooth_rxtx.c **** 			DMACCxConfig_ITC;       /* allow terminal count interrupts */
1053:bluetooth_rxtx.c **** 
1054:bluetooth_rxtx.c **** 	active_buf_clkn_high = (clkn >> 20) & 0xff;
 4358              		.loc 1 1054 0
 4359 00ec 254B     		ldr	r3, .L191+80
 4360 00ee 1B68     		ldr	r3, [r3]
 4361 00f0 1B0D     		lsrs	r3, r3, #20
 4362 00f2 DBB2     		uxtb	r3, r3
 4363 00f4 244A     		ldr	r2, .L191+84
 4364 00f6 1360     		str	r3, [r2]
1055:bluetooth_rxtx.c **** 	active_buf_clk100ns = CLK100NS;
ARM GAS  /tmp/ccUeeWpa.s 			page 95


 4365              		.loc 1 1055 0
 4366 00f8 224B     		ldr	r3, .L191+80
 4367 00fa 1B68     		ldr	r3, [r3]
 4368 00fc C3F31303 		ubfx	r3, r3, #0, #20
 4369 0100 40F63542 		movw	r2, #3125
 4370 0104 02FB03F2 		mul	r2, r2, r3
 4371 0108 204B     		ldr	r3, .L191+88
 4372 010a 1B68     		ldr	r3, [r3]
 4373 010c 1344     		add	r3, r3, r2
 4374 010e 204A     		ldr	r2, .L191+92
 4375 0110 1360     		str	r3, [r2]
1056:bluetooth_rxtx.c **** 	active_buf_channel = channel;
 4376              		.loc 1 1056 0
 4377 0112 204B     		ldr	r3, .L191+96
 4378 0114 1B88     		ldrh	r3, [r3]	@ movhi
 4379 0116 9AB2     		uxth	r2, r3
 4380 0118 1F4B     		ldr	r3, .L191+100
 4381 011a 1A80     		strh	r2, [r3]	@ movhi
1057:bluetooth_rxtx.c **** 
1058:bluetooth_rxtx.c **** 	/* reset interrupt counters */
1059:bluetooth_rxtx.c **** 	rx_tc = 0;
 4382              		.loc 1 1059 0
 4383 011c 1F4B     		ldr	r3, .L191+104
 4384 011e 0022     		movs	r2, #0
 4385 0120 1A60     		str	r2, [r3]
1060:bluetooth_rxtx.c **** 	rx_err = 0;
 4386              		.loc 1 1060 0
 4387 0122 1F4B     		ldr	r3, .L191+108
 4388 0124 0022     		movs	r2, #0
 4389 0126 1A60     		str	r2, [r3]
1061:bluetooth_rxtx.c **** }
 4390              		.loc 1 1061 0
 4391 0128 0C37     		adds	r7, r7, #12
 4392              		.cfi_def_cfa_offset 4
 4393 012a BD46     		mov	sp, r7
 4394              		.cfi_def_cfa_register 13
 4395              		@ sp needed
 4396 012c 5DF8047B 		ldr	r7, [sp], #4
 4397              		.cfi_restore 7
 4398              		.cfi_def_cfa_offset 0
 4399 0130 7047     		bx	lr
 4400              	.L192:
 4401 0132 00BF     		.align	2
 4402              	.L191:
 4403 0134 C4C00F40 		.word	1074774212
 4404 0138 10410050 		.word	1342193936
 4405 013c 30410050 		.word	1342193968
 4406 0140 50410050 		.word	1342194000
 4407 0144 70410050 		.word	1342194032
 4408 0148 90410050 		.word	1342194064
 4409 014c B0410050 		.word	1342194096
 4410 0150 D0410050 		.word	1342194128
 4411 0154 F0410050 		.word	1342194160
 4412 0158 08400050 		.word	1342193672
 4413 015c 10400050 		.word	1342193680
 4414 0160 30400050 		.word	1342193712
 4415 0164 00000000 		.word	le_dma_lli
ARM GAS  /tmp/ccUeeWpa.s 			page 96


 4416 0168 08000340 		.word	1073938440
 4417 016c 00000000 		.word	rxbuf1
 4418 0170 04100088 		.word	-2013261820
 4419 0174 00410050 		.word	1342193920
 4420 0178 04410050 		.word	1342193924
 4421 017c 08410050 		.word	1342193928
 4422 0180 0C410050 		.word	1342193932
 4423 0184 00000000 		.word	clkn
 4424 0188 00000000 		.word	active_buf_clkn_high
 4425 018c 08400040 		.word	1073758216
 4426 0190 00000000 		.word	active_buf_clk100ns
 4427 0194 00000000 		.word	channel
 4428 0198 00000000 		.word	active_buf_channel
 4429 019c 00000000 		.word	rx_tc
 4430 01a0 00000000 		.word	rx_err
 4431              		.cfi_endproc
 4432              	.LFE15:
 4434              		.section	.text.bt_stream_dma_handler,"ax",%progbits
 4435              		.align	2
 4436              		.global	bt_stream_dma_handler
 4437              		.thumb
 4438              		.thumb_func
 4440              	bt_stream_dma_handler:
 4441              	.LFB16:
1062:bluetooth_rxtx.c **** 
1063:bluetooth_rxtx.c **** void bt_stream_dma_handler(void) {
 4442              		.loc 1 1063 0
 4443              		.cfi_startproc
 4444              		@ args = 0, pretend = 0, frame = 0
 4445              		@ frame_needed = 1, uses_anonymous_args = 0
 4446              		@ link register save eliminated.
 4447 0000 80B4     		push	{r7}
 4448              		.cfi_def_cfa_offset 4
 4449              		.cfi_offset 7, -4
 4450 0002 00AF     		add	r7, sp, #0
 4451              		.cfi_def_cfa_register 7
1064:bluetooth_rxtx.c **** 	idle_buf_clkn_high = active_buf_clkn_high;
 4452              		.loc 1 1064 0
 4453 0004 254B     		ldr	r3, .L196
 4454 0006 1B68     		ldr	r3, [r3]
 4455 0008 254A     		ldr	r2, .L196+4
 4456 000a 1360     		str	r3, [r2]
1065:bluetooth_rxtx.c **** 	active_buf_clkn_high = (clkn >> 20) & 0xff;
 4457              		.loc 1 1065 0
 4458 000c 254B     		ldr	r3, .L196+8
 4459 000e 1B68     		ldr	r3, [r3]
 4460 0010 1B0D     		lsrs	r3, r3, #20
 4461 0012 DBB2     		uxtb	r3, r3
 4462 0014 214A     		ldr	r2, .L196
 4463 0016 1360     		str	r3, [r2]
1066:bluetooth_rxtx.c **** 
1067:bluetooth_rxtx.c **** 	idle_buf_clk100ns = active_buf_clk100ns;
 4464              		.loc 1 1067 0
 4465 0018 234B     		ldr	r3, .L196+12
 4466 001a 1B68     		ldr	r3, [r3]
 4467 001c 234A     		ldr	r2, .L196+16
 4468 001e 1360     		str	r3, [r2]
ARM GAS  /tmp/ccUeeWpa.s 			page 97


1068:bluetooth_rxtx.c **** 	active_buf_clk100ns = CLK100NS;
 4469              		.loc 1 1068 0
 4470 0020 204B     		ldr	r3, .L196+8
 4471 0022 1B68     		ldr	r3, [r3]
 4472 0024 C3F31303 		ubfx	r3, r3, #0, #20
 4473 0028 40F63542 		movw	r2, #3125
 4474 002c 02FB03F2 		mul	r2, r2, r3
 4475 0030 1F4B     		ldr	r3, .L196+20
 4476 0032 1B68     		ldr	r3, [r3]
 4477 0034 1344     		add	r3, r3, r2
 4478 0036 1C4A     		ldr	r2, .L196+12
 4479 0038 1360     		str	r3, [r2]
1069:bluetooth_rxtx.c **** 
1070:bluetooth_rxtx.c **** 	idle_buf_channel = active_buf_channel;
 4480              		.loc 1 1070 0
 4481 003a 1E4B     		ldr	r3, .L196+24
 4482 003c 1B88     		ldrh	r3, [r3]	@ movhi
 4483 003e 9AB2     		uxth	r2, r3
 4484 0040 1D4B     		ldr	r3, .L196+28
 4485 0042 1A80     		strh	r2, [r3]	@ movhi
1071:bluetooth_rxtx.c **** 	active_buf_channel = channel;
 4486              		.loc 1 1071 0
 4487 0044 1D4B     		ldr	r3, .L196+32
 4488 0046 1B88     		ldrh	r3, [r3]	@ movhi
 4489 0048 9AB2     		uxth	r2, r3
 4490 004a 1A4B     		ldr	r3, .L196+24
 4491 004c 1A80     		strh	r2, [r3]	@ movhi
1072:bluetooth_rxtx.c **** 
1073:bluetooth_rxtx.c **** 	/* interrupt on channel 0 */
1074:bluetooth_rxtx.c **** 	if (DMACIntStat & (1 << 0)) {
 4492              		.loc 1 1074 0
 4493 004e 1C4B     		ldr	r3, .L196+36
 4494 0050 1B68     		ldr	r3, [r3]
 4495 0052 03F00103 		and	r3, r3, #1
 4496 0056 002B     		cmp	r3, #0
 4497 0058 1BD0     		beq	.L193
1075:bluetooth_rxtx.c **** 		if (DMACIntTCStat & (1 << 0)) {
 4498              		.loc 1 1075 0
 4499 005a 1A4B     		ldr	r3, .L196+40
 4500 005c 1B68     		ldr	r3, [r3]
 4501 005e 03F00103 		and	r3, r3, #1
 4502 0062 002B     		cmp	r3, #0
 4503 0064 07D0     		beq	.L195
1076:bluetooth_rxtx.c **** 			DMACIntTCClear = (1 << 0);
 4504              		.loc 1 1076 0
 4505 0066 184B     		ldr	r3, .L196+44
 4506 0068 0122     		movs	r2, #1
 4507 006a 1A60     		str	r2, [r3]
1077:bluetooth_rxtx.c **** 			++rx_tc;
 4508              		.loc 1 1077 0
 4509 006c 174B     		ldr	r3, .L196+48
 4510 006e 1B68     		ldr	r3, [r3]
 4511 0070 0133     		adds	r3, r3, #1
 4512 0072 164A     		ldr	r2, .L196+48
 4513 0074 1360     		str	r3, [r2]
 4514              	.L195:
1078:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccUeeWpa.s 			page 98


1079:bluetooth_rxtx.c **** 		if (DMACIntErrStat & (1 << 0)) {
 4515              		.loc 1 1079 0
 4516 0076 164B     		ldr	r3, .L196+52
 4517 0078 1B68     		ldr	r3, [r3]
 4518 007a 03F00103 		and	r3, r3, #1
 4519 007e 002B     		cmp	r3, #0
 4520 0080 07D0     		beq	.L193
1080:bluetooth_rxtx.c **** 			DMACIntErrClr = (1 << 0);
 4521              		.loc 1 1080 0
 4522 0082 144B     		ldr	r3, .L196+56
 4523 0084 0122     		movs	r2, #1
 4524 0086 1A60     		str	r2, [r3]
1081:bluetooth_rxtx.c **** 			++rx_err;
 4525              		.loc 1 1081 0
 4526 0088 134B     		ldr	r3, .L196+60
 4527 008a 1B68     		ldr	r3, [r3]
 4528 008c 0133     		adds	r3, r3, #1
 4529 008e 124A     		ldr	r2, .L196+60
 4530 0090 1360     		str	r3, [r2]
 4531              	.L193:
1082:bluetooth_rxtx.c **** 		}
1083:bluetooth_rxtx.c **** 	}
1084:bluetooth_rxtx.c **** }
 4532              		.loc 1 1084 0
 4533 0092 BD46     		mov	sp, r7
 4534              		.cfi_def_cfa_register 13
 4535              		@ sp needed
 4536 0094 5DF8047B 		ldr	r7, [sp], #4
 4537              		.cfi_restore 7
 4538              		.cfi_def_cfa_offset 0
 4539 0098 7047     		bx	lr
 4540              	.L197:
 4541 009a 00BF     		.align	2
 4542              	.L196:
 4543 009c 00000000 		.word	active_buf_clkn_high
 4544 00a0 00000000 		.word	idle_buf_clkn_high
 4545 00a4 00000000 		.word	clkn
 4546 00a8 00000000 		.word	active_buf_clk100ns
 4547 00ac 00000000 		.word	idle_buf_clk100ns
 4548 00b0 08400040 		.word	1073758216
 4549 00b4 00000000 		.word	active_buf_channel
 4550 00b8 00000000 		.word	idle_buf_channel
 4551 00bc 00000000 		.word	channel
 4552 00c0 00400050 		.word	1342193664
 4553 00c4 04400050 		.word	1342193668
 4554 00c8 08400050 		.word	1342193672
 4555 00cc 00000000 		.word	rx_tc
 4556 00d0 0C400050 		.word	1342193676
 4557 00d4 10400050 		.word	1342193680
 4558 00d8 00000000 		.word	rx_err
 4559              		.cfi_endproc
 4560              	.LFE16:
 4562              		.section	.text.DMA_IRQHandler,"ax",%progbits
 4563              		.align	2
 4564              		.global	DMA_IRQHandler
 4565              		.thumb
 4566              		.thumb_func
ARM GAS  /tmp/ccUeeWpa.s 			page 99


 4568              	DMA_IRQHandler:
 4569              	.LFB17:
1085:bluetooth_rxtx.c **** 
1086:bluetooth_rxtx.c **** void DMA_IRQHandler()
1087:bluetooth_rxtx.c **** {
 4570              		.loc 1 1087 0
 4571              		.cfi_startproc
 4572              		@ args = 0, pretend = 0, frame = 0
 4573              		@ frame_needed = 1, uses_anonymous_args = 0
 4574 0000 80B5     		push	{r7, lr}
 4575              		.cfi_def_cfa_offset 8
 4576              		.cfi_offset 7, -8
 4577              		.cfi_offset 14, -4
 4578 0002 00AF     		add	r7, sp, #0
 4579              		.cfi_def_cfa_register 7
1088:bluetooth_rxtx.c **** 	switch (mode) {
 4580              		.loc 1 1088 0
 4581 0004 124B     		ldr	r3, .L202
 4582 0006 1B78     		ldrb	r3, [r3]
 4583 0008 DBB2     		uxtb	r3, r3
 4584 000a 013B     		subs	r3, r3, #1
 4585 000c 0B2B     		cmp	r3, #11
 4586 000e 1ED8     		bhi	.L198
 4587 0010 01A2     		adr	r2, .L201
 4588 0012 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 4589 0016 00BF     		.p2align 2
 4590              	.L201:
 4591 0018 49000000 		.word	.L200+1
 4592 001c 4F000000 		.word	.L198+1
 4593 0020 4F000000 		.word	.L198+1
 4594 0024 49000000 		.word	.L200+1
 4595 0028 4F000000 		.word	.L198+1
 4596 002c 4F000000 		.word	.L198+1
 4597 0030 4F000000 		.word	.L198+1
 4598 0034 49000000 		.word	.L200+1
 4599 0038 49000000 		.word	.L200+1
 4600 003c 49000000 		.word	.L200+1
 4601 0040 4F000000 		.word	.L198+1
 4602 0044 49000000 		.word	.L200+1
 4603              		.p2align 1
 4604              	.L200:
1089:bluetooth_rxtx.c **** 		case MODE_RX_SYMBOLS:
1090:bluetooth_rxtx.c **** 		case MODE_SPECAN:
1091:bluetooth_rxtx.c **** 		case MODE_BT_FOLLOW:
1092:bluetooth_rxtx.c **** 		case MODE_BT_FOLLOW_LE:
1093:bluetooth_rxtx.c **** 		case MODE_BT_PROMISC_LE:
1094:bluetooth_rxtx.c **** 		case MODE_BT_SLAVE_LE:
1095:bluetooth_rxtx.c **** 			bt_stream_dma_handler();
 4605              		.loc 1 1095 0
 4606 0048 FFF7FEFF 		bl	bt_stream_dma_handler
1096:bluetooth_rxtx.c **** 			break;
 4607              		.loc 1 1096 0
 4608 004c 00BF     		nop
 4609              	.L198:
1097:bluetooth_rxtx.c **** 	}
1098:bluetooth_rxtx.c **** }
 4610              		.loc 1 1098 0
ARM GAS  /tmp/ccUeeWpa.s 			page 100


 4611 004e 80BD     		pop	{r7, pc}
 4612              	.L203:
 4613              		.align	2
 4614              	.L202:
 4615 0050 00000000 		.word	mode
 4616              		.cfi_endproc
 4617              	.LFE17:
 4619              		.section	.text.dio_ssp_start,"ax",%progbits
 4620              		.align	2
 4621              		.thumb
 4622              		.thumb_func
 4624              	dio_ssp_start:
 4625              	.LFB18:
1099:bluetooth_rxtx.c **** 
1100:bluetooth_rxtx.c **** static void dio_ssp_start()
1101:bluetooth_rxtx.c **** {
 4626              		.loc 1 1101 0
 4627              		.cfi_startproc
 4628              		@ args = 0, pretend = 0, frame = 0
 4629              		@ frame_needed = 1, uses_anonymous_args = 0
 4630              		@ link register save eliminated.
 4631 0000 80B4     		push	{r7}
 4632              		.cfi_def_cfa_offset 4
 4633              		.cfi_offset 7, -4
 4634 0002 00AF     		add	r7, sp, #0
 4635              		.cfi_def_cfa_register 7
1102:bluetooth_rxtx.c **** 	/* make sure the (active low) slave select signal is not active */
1103:bluetooth_rxtx.c **** 	DIO_SSEL_SET;
 4636              		.loc 1 1103 0
 4637 0004 104B     		ldr	r3, .L205
 4638 0006 4FF08052 		mov	r2, #268435456
 4639 000a 1A60     		str	r2, [r3]
1104:bluetooth_rxtx.c **** 
1105:bluetooth_rxtx.c **** 	/* enable rx DMA on DIO_SSP */
1106:bluetooth_rxtx.c **** 	DIO_SSP_DMACR |= SSPDMACR_RXDMAE;
 4640              		.loc 1 1106 0
 4641 000c 0F4A     		ldr	r2, .L205+4
 4642 000e 0F4B     		ldr	r3, .L205+4
 4643 0010 1B68     		ldr	r3, [r3]
 4644 0012 43F00103 		orr	r3, r3, #1
 4645 0016 1360     		str	r3, [r2]
1107:bluetooth_rxtx.c **** 	DIO_SSP_CR1 |= SSPCR1_SSE;
 4646              		.loc 1 1107 0
 4647 0018 0D4A     		ldr	r2, .L205+8
 4648 001a 0D4B     		ldr	r3, .L205+8
 4649 001c 1B68     		ldr	r3, [r3]
 4650 001e 43F00203 		orr	r3, r3, #2
 4651 0022 1360     		str	r3, [r2]
1108:bluetooth_rxtx.c **** 	
1109:bluetooth_rxtx.c **** 	/* enable DMA */
1110:bluetooth_rxtx.c **** 	DMACC0Config |= DMACCxConfig_E;
 4652              		.loc 1 1110 0
 4653 0024 0B4A     		ldr	r2, .L205+12
 4654 0026 0B4B     		ldr	r3, .L205+12
 4655 0028 1B68     		ldr	r3, [r3]
 4656 002a 43F00103 		orr	r3, r3, #1
 4657 002e 1360     		str	r3, [r2]
ARM GAS  /tmp/ccUeeWpa.s 			page 101


1111:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_DMA;
 4658              		.loc 1 1111 0
 4659 0030 094B     		ldr	r3, .L205+16
 4660 0032 4FF08062 		mov	r2, #67108864
 4661 0036 1A60     		str	r2, [r3]
1112:bluetooth_rxtx.c **** 
1113:bluetooth_rxtx.c **** 	/* activate slave select pin */
1114:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;
 4662              		.loc 1 1114 0
 4663 0038 084B     		ldr	r3, .L205+20
 4664 003a 4FF08052 		mov	r2, #268435456
 4665 003e 1A60     		str	r2, [r3]
1115:bluetooth_rxtx.c **** }
 4666              		.loc 1 1115 0
 4667 0040 BD46     		mov	sp, r7
 4668              		.cfi_def_cfa_register 13
 4669              		@ sp needed
 4670 0042 5DF8047B 		ldr	r7, [sp], #4
 4671              		.cfi_restore 7
 4672              		.cfi_def_cfa_offset 0
 4673 0046 7047     		bx	lr
 4674              	.L206:
 4675              		.align	2
 4676              	.L205:
 4677 0048 98C00920 		.word	537510040
 4678 004c 24000340 		.word	1073938468
 4679 0050 04000340 		.word	1073938436
 4680 0054 10410050 		.word	1342193936
 4681 0058 00E100E0 		.word	-536813312
 4682 005c 9CC00920 		.word	537510044
 4683              		.cfi_endproc
 4684              	.LFE18:
 4686              		.section	.text.dio_ssp_stop,"ax",%progbits
 4687              		.align	2
 4688              		.thumb
 4689              		.thumb_func
 4691              	dio_ssp_stop:
 4692              	.LFB19:
1116:bluetooth_rxtx.c **** 
1117:bluetooth_rxtx.c **** static void dio_ssp_stop()
1118:bluetooth_rxtx.c **** {
 4693              		.loc 1 1118 0
 4694              		.cfi_startproc
 4695              		@ args = 0, pretend = 0, frame = 0
 4696              		@ frame_needed = 1, uses_anonymous_args = 0
 4697              		@ link register save eliminated.
 4698 0000 80B4     		push	{r7}
 4699              		.cfi_def_cfa_offset 4
 4700              		.cfi_offset 7, -4
 4701 0002 00AF     		add	r7, sp, #0
 4702              		.cfi_def_cfa_register 7
1119:bluetooth_rxtx.c **** 	// disable CC2400's output (active low)
1120:bluetooth_rxtx.c **** 	DIO_SSEL_SET;
 4703              		.loc 1 1120 0
 4704 0004 214B     		ldr	r3, .L209
 4705 0006 4FF08052 		mov	r2, #268435456
 4706 000a 1A60     		str	r2, [r3]
ARM GAS  /tmp/ccUeeWpa.s 			page 102


1121:bluetooth_rxtx.c **** 
1122:bluetooth_rxtx.c **** 	// disable DMA on SSP; disable SSP
1123:bluetooth_rxtx.c **** 	DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
 4707              		.loc 1 1123 0
 4708 000c 204A     		ldr	r2, .L209+4
 4709 000e 204B     		ldr	r3, .L209+4
 4710 0010 1B68     		ldr	r3, [r3]
 4711 0012 23F00103 		bic	r3, r3, #1
 4712 0016 1360     		str	r3, [r2]
1124:bluetooth_rxtx.c **** 	DIO_SSP_CR1 &= ~SSPCR1_SSE;
 4713              		.loc 1 1124 0
 4714 0018 1E4A     		ldr	r2, .L209+8
 4715 001a 1E4B     		ldr	r3, .L209+8
 4716 001c 1B68     		ldr	r3, [r3]
 4717 001e 23F00203 		bic	r3, r3, #2
 4718 0022 1360     		str	r3, [r2]
1125:bluetooth_rxtx.c **** 
1126:bluetooth_rxtx.c **** 
1127:bluetooth_rxtx.c **** 	// disable DMA engine:
1128:bluetooth_rxtx.c **** 	// refer to UM10360 LPC17xx User Manual Ch 31 Sec 31.6.1, PDF page 607
1129:bluetooth_rxtx.c **** 
1130:bluetooth_rxtx.c **** 	// disable DMA interrupts
1131:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_DMA;
 4719              		.loc 1 1131 0
 4720 0024 1C4B     		ldr	r3, .L209+12
 4721 0026 4FF08062 		mov	r2, #67108864
 4722 002a 1A60     		str	r2, [r3]
1132:bluetooth_rxtx.c **** 
1133:bluetooth_rxtx.c **** 	// disable active channels
1134:bluetooth_rxtx.c **** 	DMACC0Config = 0;
 4723              		.loc 1 1134 0
 4724 002c 1B4B     		ldr	r3, .L209+16
 4725 002e 0022     		movs	r2, #0
 4726 0030 1A60     		str	r2, [r3]
1135:bluetooth_rxtx.c **** 	DMACC1Config = 0;
 4727              		.loc 1 1135 0
 4728 0032 1B4B     		ldr	r3, .L209+20
 4729 0034 0022     		movs	r2, #0
 4730 0036 1A60     		str	r2, [r3]
1136:bluetooth_rxtx.c **** 	DMACC2Config = 0;
 4731              		.loc 1 1136 0
 4732 0038 1A4B     		ldr	r3, .L209+24
 4733 003a 0022     		movs	r2, #0
 4734 003c 1A60     		str	r2, [r3]
1137:bluetooth_rxtx.c **** 	DMACC3Config = 0;
 4735              		.loc 1 1137 0
 4736 003e 1A4B     		ldr	r3, .L209+28
 4737 0040 0022     		movs	r2, #0
 4738 0042 1A60     		str	r2, [r3]
1138:bluetooth_rxtx.c **** 	DMACC4Config = 0;
 4739              		.loc 1 1138 0
 4740 0044 194B     		ldr	r3, .L209+32
 4741 0046 0022     		movs	r2, #0
 4742 0048 1A60     		str	r2, [r3]
1139:bluetooth_rxtx.c **** 	DMACC5Config = 0;
 4743              		.loc 1 1139 0
 4744 004a 194B     		ldr	r3, .L209+36
ARM GAS  /tmp/ccUeeWpa.s 			page 103


 4745 004c 0022     		movs	r2, #0
 4746 004e 1A60     		str	r2, [r3]
1140:bluetooth_rxtx.c **** 	DMACC6Config = 0;
 4747              		.loc 1 1140 0
 4748 0050 184B     		ldr	r3, .L209+40
 4749 0052 0022     		movs	r2, #0
 4750 0054 1A60     		str	r2, [r3]
1141:bluetooth_rxtx.c **** 	DMACC7Config = 0;
 4751              		.loc 1 1141 0
 4752 0056 184B     		ldr	r3, .L209+44
 4753 0058 0022     		movs	r2, #0
 4754 005a 1A60     		str	r2, [r3]
1142:bluetooth_rxtx.c **** 	DMACIntTCClear = 0xFF;
 4755              		.loc 1 1142 0
 4756 005c 174B     		ldr	r3, .L209+48
 4757 005e FF22     		movs	r2, #255
 4758 0060 1A60     		str	r2, [r3]
1143:bluetooth_rxtx.c **** 	DMACIntErrClr = 0xFF;
 4759              		.loc 1 1143 0
 4760 0062 174B     		ldr	r3, .L209+52
 4761 0064 FF22     		movs	r2, #255
 4762 0066 1A60     		str	r2, [r3]
1144:bluetooth_rxtx.c **** 
1145:bluetooth_rxtx.c **** 	// Disable the DMA controller by writing 0 to the DMA Enable bit in the DMACConfig
1146:bluetooth_rxtx.c **** 	// register.
1147:bluetooth_rxtx.c **** 	DMACConfig &= ~DMACConfig_E;
 4763              		.loc 1 1147 0
 4764 0068 164A     		ldr	r2, .L209+56
 4765 006a 164B     		ldr	r3, .L209+56
 4766 006c 1B68     		ldr	r3, [r3]
 4767 006e 23F00103 		bic	r3, r3, #1
 4768 0072 1360     		str	r3, [r2]
1148:bluetooth_rxtx.c **** 	while (DMACConfig & DMACConfig_E);
 4769              		.loc 1 1148 0
 4770 0074 00BF     		nop
 4771              	.L208:
 4772              		.loc 1 1148 0 is_stmt 0 discriminator 1
 4773 0076 134B     		ldr	r3, .L209+56
 4774 0078 1B68     		ldr	r3, [r3]
 4775 007a 03F00103 		and	r3, r3, #1
 4776 007e 002B     		cmp	r3, #0
 4777 0080 F9D1     		bne	.L208
1149:bluetooth_rxtx.c **** }
 4778              		.loc 1 1149 0 is_stmt 1
 4779 0082 BD46     		mov	sp, r7
 4780              		.cfi_def_cfa_register 13
 4781              		@ sp needed
 4782 0084 5DF8047B 		ldr	r7, [sp], #4
 4783              		.cfi_restore 7
 4784              		.cfi_def_cfa_offset 0
 4785 0088 7047     		bx	lr
 4786              	.L210:
 4787 008a 00BF     		.align	2
 4788              	.L209:
 4789 008c 98C00920 		.word	537510040
 4790 0090 24000340 		.word	1073938468
 4791 0094 04000340 		.word	1073938436
ARM GAS  /tmp/ccUeeWpa.s 			page 104


 4792 0098 80E100E0 		.word	-536813184
 4793 009c 10410050 		.word	1342193936
 4794 00a0 30410050 		.word	1342193968
 4795 00a4 50410050 		.word	1342194000
 4796 00a8 70410050 		.word	1342194032
 4797 00ac 90410050 		.word	1342194064
 4798 00b0 B0410050 		.word	1342194096
 4799 00b4 D0410050 		.word	1342194128
 4800 00b8 F0410050 		.word	1342194160
 4801 00bc 08400050 		.word	1342193672
 4802 00c0 10400050 		.word	1342193680
 4803 00c4 30400050 		.word	1342193712
 4804              		.cfi_endproc
 4805              	.LFE19:
 4807              		.section	.text.cc2400_idle,"ax",%progbits
 4808              		.align	2
 4809              		.thumb
 4810              		.thumb_func
 4812              	cc2400_idle:
 4813              	.LFB20:
1150:bluetooth_rxtx.c **** 
1151:bluetooth_rxtx.c **** static void cc2400_idle()
1152:bluetooth_rxtx.c **** {
 4814              		.loc 1 1152 0
 4815              		.cfi_startproc
 4816              		@ args = 0, pretend = 0, frame = 0
 4817              		@ frame_needed = 1, uses_anonymous_args = 0
 4818 0000 80B5     		push	{r7, lr}
 4819              		.cfi_def_cfa_offset 8
 4820              		.cfi_offset 7, -8
 4821              		.cfi_offset 14, -4
 4822 0002 00AF     		add	r7, sp, #0
 4823              		.cfi_def_cfa_register 7
1153:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 4824              		.loc 1 1153 0
 4825 0004 6420     		movs	r0, #100
 4826 0006 FFF7FEFF 		bl	cc2400_strobe
1154:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4827              		.loc 1 1154 0
 4828 000a 00BF     		nop
 4829              	.L212:
 4830              		.loc 1 1154 0 is_stmt 0 discriminator 1
 4831 000c FFF7FEFF 		bl	cc2400_status
 4832 0010 0346     		mov	r3, r0
 4833 0012 03F00403 		and	r3, r3, #4
 4834 0016 002B     		cmp	r3, #0
 4835 0018 F8D1     		bne	.L212
1155:bluetooth_rxtx.c **** 
1156:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1157:bluetooth_rxtx.c **** 	PAEN_CLR;
 4836              		.loc 1 1157 0 is_stmt 1
 4837 001a 0A4B     		ldr	r3, .L213
 4838 001c 8022     		movs	r2, #128
 4839 001e 1A60     		str	r2, [r3]
1158:bluetooth_rxtx.c **** 	HGM_CLR;
 4840              		.loc 1 1158 0
 4841 0020 084B     		ldr	r3, .L213
ARM GAS  /tmp/ccUeeWpa.s 			page 105


 4842 0022 4FF48072 		mov	r2, #256
 4843 0026 1A60     		str	r2, [r3]
1159:bluetooth_rxtx.c **** #endif
1160:bluetooth_rxtx.c **** 
1161:bluetooth_rxtx.c **** 	RXLED_CLR;
 4844              		.loc 1 1161 0
 4845 0028 074B     		ldr	r3, .L213+4
 4846 002a 1022     		movs	r2, #16
 4847 002c 1A60     		str	r2, [r3]
1162:bluetooth_rxtx.c **** 	TXLED_CLR;
 4848              		.loc 1 1162 0
 4849 002e 064B     		ldr	r3, .L213+4
 4850 0030 4FF48072 		mov	r2, #256
 4851 0034 1A60     		str	r2, [r3]
1163:bluetooth_rxtx.c **** 	USRLED_CLR;
 4852              		.loc 1 1163 0
 4853 0036 044B     		ldr	r3, .L213+4
 4854 0038 0222     		movs	r2, #2
 4855 003a 1A60     		str	r2, [r3]
1164:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 4856              		.loc 1 1164 0
 4857 003c 034B     		ldr	r3, .L213+8
 4858 003e 0022     		movs	r2, #0
 4859 0040 1A70     		strb	r2, [r3]
1165:bluetooth_rxtx.c **** }
 4860              		.loc 1 1165 0
 4861 0042 80BD     		pop	{r7, pc}
 4862              	.L214:
 4863              		.align	2
 4864              	.L213:
 4865 0044 5CC00920 		.word	537509980
 4866 0048 3CC00920 		.word	537509948
 4867 004c 00000000 		.word	mode
 4868              		.cfi_endproc
 4869              	.LFE20:
 4871              		.section	.text.cc2400_rx,"ax",%progbits
 4872              		.align	2
 4873              		.thumb
 4874              		.thumb_func
 4876              	cc2400_rx:
 4877              	.LFB21:
1166:bluetooth_rxtx.c **** 
1167:bluetooth_rxtx.c **** /* start un-buffered rx */
1168:bluetooth_rxtx.c **** static void cc2400_rx()
1169:bluetooth_rxtx.c **** {
 4878              		.loc 1 1169 0
 4879              		.cfi_startproc
 4880              		@ args = 0, pretend = 0, frame = 8
 4881              		@ frame_needed = 1, uses_anonymous_args = 0
 4882 0000 80B5     		push	{r7, lr}
 4883              		.cfi_def_cfa_offset 8
 4884              		.cfi_offset 7, -8
 4885              		.cfi_offset 14, -4
 4886 0002 82B0     		sub	sp, sp, #8
 4887              		.cfi_def_cfa_offset 16
 4888 0004 00AF     		add	r7, sp, #0
 4889              		.cfi_def_cfa_register 7
ARM GAS  /tmp/ccUeeWpa.s 			page 106


1170:bluetooth_rxtx.c **** 	u16 mdmctrl;
1171:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
 4890              		.loc 1 1171 0
 4891 0006 2A4B     		ldr	r3, .L222
 4892 0008 1B78     		ldrb	r3, [r3]
 4893 000a DBB2     		uxtb	r3, r3
 4894 000c 002B     		cmp	r3, #0
 4895 000e 02D1     		bne	.L216
1172:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 4896              		.loc 1 1172 0
 4897 0010 2923     		movs	r3, #41
 4898 0012 FB80     		strh	r3, [r7, #6]	@ movhi
 4899 0014 08E0     		b	.L217
 4900              	.L216:
1173:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 4901              		.loc 1 1173 0
 4902 0016 264B     		ldr	r3, .L222
 4903 0018 1B78     		ldrb	r3, [r3]
 4904 001a DBB2     		uxtb	r3, r3
 4905 001c 012B     		cmp	r3, #1
 4906 001e 02D1     		bne	.L218
1174:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 4907              		.loc 1 1174 0
 4908 0020 4023     		movs	r3, #64
 4909 0022 FB80     		strh	r3, [r7, #6]	@ movhi
 4910 0024 00E0     		b	.L217
 4911              	.L218:
1175:bluetooth_rxtx.c **** 	} else {
1176:bluetooth_rxtx.c **** 		/* oops */
1177:bluetooth_rxtx.c **** 		return;
 4912              		.loc 1 1177 0
 4913 0026 40E0     		b	.L215
 4914              	.L217:
1178:bluetooth_rxtx.c **** 	}
1179:bluetooth_rxtx.c **** 
1180:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
 4915              		.loc 1 1180 0
 4916 0028 0D20     		movs	r0, #13
 4917 002a 47F6FF71 		movw	r1, #32767
 4918 002e FFF7FEFF 		bl	cc2400_set
1181:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 4919              		.loc 1 1181 0
 4920 0032 1220     		movs	r0, #18
 4921 0034 42F62231 		movw	r1, #11042
 4922 0038 FFF7FEFF 		bl	cc2400_set
1182:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 4923              		.loc 1 1182 0
 4924 003c 1420     		movs	r0, #20
 4925 003e 41F24B31 		movw	r1, #4939
 4926 0042 FFF7FEFF 		bl	cc2400_set
1183:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 4927              		.loc 1 1183 0
 4928 0046 2020     		movs	r0, #32
 4929 0048 40F20111 		movw	r1, #257
 4930 004c FFF7FEFF 		bl	cc2400_set
1184:bluetooth_rxtx.c **** 	// 0 00 00 0 010 00 0 00 0 1
1185:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
ARM GAS  /tmp/ccUeeWpa.s 			page 107


1186:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1187:bluetooth_rxtx.c **** 	//      |  | +---------------> 2 preamble bytes of 01010101
1188:bluetooth_rxtx.c **** 	//      |  +-----------------> not packet mode
1189:bluetooth_rxtx.c **** 	//      +--------------------> un-buffered mode
1190:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
 4931              		.loc 1 1190 0
 4932 0050 184B     		ldr	r3, .L222+4
 4933 0052 1B88     		ldrh	r3, [r3]	@ movhi
 4934 0054 9BB2     		uxth	r3, r3
 4935 0056 013B     		subs	r3, r3, #1
 4936 0058 9BB2     		uxth	r3, r3
 4937 005a 0220     		movs	r0, #2
 4938 005c 1946     		mov	r1, r3
 4939 005e FFF7FEFF 		bl	cc2400_set
1191:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 4940              		.loc 1 1191 0
 4941 0062 FB88     		ldrh	r3, [r7, #6]
 4942 0064 0320     		movs	r0, #3
 4943 0066 1946     		mov	r1, r3
 4944 0068 FFF7FEFF 		bl	cc2400_set
1192:bluetooth_rxtx.c **** 
1193:bluetooth_rxtx.c **** 	// Set up CS register
1194:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set();
 4945              		.loc 1 1194 0
 4946 006c FFF7FEFF 		bl	cs_threshold_calc_and_set
1195:bluetooth_rxtx.c **** 
1196:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 4947              		.loc 1 1196 0
 4948 0070 00BF     		nop
 4949              	.L220:
 4950              		.loc 1 1196 0 is_stmt 0 discriminator 1
 4951 0072 FFF7FEFF 		bl	cc2400_status
 4952 0076 0346     		mov	r3, r0
 4953 0078 03F04003 		and	r3, r3, #64
 4954 007c 002B     		cmp	r3, #0
 4955 007e F8D0     		beq	.L220
1197:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 4956              		.loc 1 1197 0 is_stmt 1
 4957 0080 6120     		movs	r0, #97
 4958 0082 FFF7FEFF 		bl	cc2400_strobe
1198:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 4959              		.loc 1 1198 0
 4960 0086 00BF     		nop
 4961              	.L221:
 4962              		.loc 1 1198 0 is_stmt 0 discriminator 1
 4963 0088 FFF7FEFF 		bl	cc2400_status
 4964 008c 0346     		mov	r3, r0
 4965 008e 03F00403 		and	r3, r3, #4
 4966 0092 002B     		cmp	r3, #0
 4967 0094 F8D0     		beq	.L221
1199:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 4968              		.loc 1 1199 0 is_stmt 1
 4969 0096 6220     		movs	r0, #98
 4970 0098 FFF7FEFF 		bl	cc2400_strobe
1200:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1201:bluetooth_rxtx.c **** 	PAEN_SET;
 4971              		.loc 1 1201 0
ARM GAS  /tmp/ccUeeWpa.s 			page 108


 4972 009c 064B     		ldr	r3, .L222+8
 4973 009e 8022     		movs	r2, #128
 4974 00a0 1A60     		str	r2, [r3]
1202:bluetooth_rxtx.c **** 	HGM_SET;
 4975              		.loc 1 1202 0
 4976 00a2 054B     		ldr	r3, .L222+8
 4977 00a4 4FF48072 		mov	r2, #256
 4978 00a8 1A60     		str	r2, [r3]
 4979              	.L215:
1203:bluetooth_rxtx.c **** #endif
1204:bluetooth_rxtx.c **** }
 4980              		.loc 1 1204 0
 4981 00aa 0837     		adds	r7, r7, #8
 4982              		.cfi_def_cfa_offset 8
 4983 00ac BD46     		mov	sp, r7
 4984              		.cfi_def_cfa_register 13
 4985              		@ sp needed
 4986 00ae 80BD     		pop	{r7, pc}
 4987              	.L223:
 4988              		.align	2
 4989              	.L222:
 4990 00b0 00000000 		.word	modulation
 4991 00b4 00000000 		.word	channel
 4992 00b8 58C00920 		.word	537509976
 4993              		.cfi_endproc
 4994              	.LFE21:
 4996              		.section	.text.cc2400_rx_sync,"ax",%progbits
 4997              		.align	2
 4998              		.thumb
 4999              		.thumb_func
 5001              	cc2400_rx_sync:
 5002              	.LFB22:
1205:bluetooth_rxtx.c **** 
1206:bluetooth_rxtx.c **** /* start un-buffered rx */
1207:bluetooth_rxtx.c **** static void cc2400_rx_sync(u32 sync)
1208:bluetooth_rxtx.c **** {
 5003              		.loc 1 1208 0
 5004              		.cfi_startproc
 5005              		@ args = 0, pretend = 0, frame = 16
 5006              		@ frame_needed = 1, uses_anonymous_args = 0
 5007 0000 80B5     		push	{r7, lr}
 5008              		.cfi_def_cfa_offset 8
 5009              		.cfi_offset 7, -8
 5010              		.cfi_offset 14, -4
 5011 0002 84B0     		sub	sp, sp, #16
 5012              		.cfi_def_cfa_offset 24
 5013 0004 00AF     		add	r7, sp, #0
 5014              		.cfi_def_cfa_register 7
 5015 0006 7860     		str	r0, [r7, #4]
1209:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
1210:bluetooth_rxtx.c **** 
1211:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
 5016              		.loc 1 1211 0
 5017 0008 334B     		ldr	r3, .L231
 5018 000a 1B78     		ldrb	r3, [r3]
 5019 000c DBB2     		uxtb	r3, r3
 5020 000e 002B     		cmp	r3, #0
ARM GAS  /tmp/ccUeeWpa.s 			page 109


 5021 0010 05D1     		bne	.L225
1212:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 5022              		.loc 1 1212 0
 5023 0012 2923     		movs	r3, #41
 5024 0014 BB81     		strh	r3, [r7, #12]	@ movhi
1213:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 5025              		.loc 1 1213 0
 5026 0016 40F26143 		movw	r3, #1121
 5027 001a FB81     		strh	r3, [r7, #14]	@ movhi
 5028 001c 0BE0     		b	.L226
 5029              	.L225:
1214:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
1215:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
1216:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
1217:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 0 preamble bytes of 01010101
1218:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
1219:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
1220:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
1221:bluetooth_rxtx.c **** 
1222:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 5030              		.loc 1 1222 0
 5031 001e 2E4B     		ldr	r3, .L231
 5032 0020 1B78     		ldrb	r3, [r3]
 5033 0022 DBB2     		uxtb	r3, r3
 5034 0024 012B     		cmp	r3, #1
 5035 0026 05D1     		bne	.L227
1223:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 5036              		.loc 1 1223 0
 5037 0028 4023     		movs	r3, #64
 5038 002a BB81     		strh	r3, [r7, #12]	@ movhi
1224:bluetooth_rxtx.c **** 		grmdm = 0x0561; // un-buffered mode, packet w/ sync word detection
 5039              		.loc 1 1224 0
 5040 002c 40F26153 		movw	r3, #1377
 5041 0030 FB81     		strh	r3, [r7, #14]	@ movhi
 5042 0032 00E0     		b	.L226
 5043              	.L227:
1225:bluetooth_rxtx.c **** 		// 0 00 00 1 010 11 0 00 0 1
1226:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
1227:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
1228:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 2 preamble bytes of 01010101
1229:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
1230:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
1231:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
1232:bluetooth_rxtx.c **** 
1233:bluetooth_rxtx.c **** 	} else {
1234:bluetooth_rxtx.c **** 		/* oops */
1235:bluetooth_rxtx.c **** 		return;
 5044              		.loc 1 1235 0
 5045 0034 4DE0     		b	.L224
 5046              	.L226:
1236:bluetooth_rxtx.c **** 	}
1237:bluetooth_rxtx.c **** 
1238:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
 5047              		.loc 1 1238 0
 5048 0036 0D20     		movs	r0, #13
 5049 0038 47F6FF71 		movw	r1, #32767
 5050 003c FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/ccUeeWpa.s 			page 110


1239:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 5051              		.loc 1 1239 0
 5052 0040 1220     		movs	r0, #18
 5053 0042 42F62231 		movw	r1, #11042
 5054 0046 FFF7FEFF 		bl	cc2400_set
1240:bluetooth_rxtx.c **** 
1241:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x124b);
 5055              		.loc 1 1241 0
 5056 004a 1420     		movs	r0, #20
 5057 004c 41F24B21 		movw	r1, #4683
 5058 0050 FFF7FEFF 		bl	cc2400_set
1242:bluetooth_rxtx.c **** 	// 1      2      4b
1243:bluetooth_rxtx.c **** 	// 00 0 1 0 0 10 01001011
1244:bluetooth_rxtx.c **** 	//    | | | | |  +---------> AFC_DELTA = ??
1245:bluetooth_rxtx.c **** 	//    | | | | +------------> AFC settling = 4 pairs (8 bit preamble)
1246:bluetooth_rxtx.c **** 	//    | | | +--------------> no AFC adjust on packet
1247:bluetooth_rxtx.c **** 	//    | | +----------------> do not invert data
1248:bluetooth_rxtx.c **** 	//    | +------------------> TX IF freq 1 0Hz
1249:bluetooth_rxtx.c **** 	//    +--------------------> PRNG off
1250:bluetooth_rxtx.c **** 	//
1251:bluetooth_rxtx.c **** 	// ref: CC2400 datasheet page 67
1252:bluetooth_rxtx.c **** 	// AFC settling explained page 41/42
1253:bluetooth_rxtx.c **** 
1254:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   grmdm);
 5059              		.loc 1 1254 0
 5060 0054 FB89     		ldrh	r3, [r7, #14]
 5061 0056 2020     		movs	r0, #32
 5062 0058 1946     		mov	r1, r3
 5063 005a FFF7FEFF 		bl	cc2400_set
1255:bluetooth_rxtx.c **** 
1256:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
 5064              		.loc 1 1256 0
 5065 005e 7B68     		ldr	r3, [r7, #4]
 5066 0060 9BB2     		uxth	r3, r3
 5067 0062 2C20     		movs	r0, #44
 5068 0064 1946     		mov	r1, r3
 5069 0066 FFF7FEFF 		bl	cc2400_set
1257:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 5070              		.loc 1 1257 0
 5071 006a 7B68     		ldr	r3, [r7, #4]
 5072 006c 1B0C     		lsrs	r3, r3, #16
 5073 006e 9BB2     		uxth	r3, r3
 5074 0070 2D20     		movs	r0, #45
 5075 0072 1946     		mov	r1, r3
 5076 0074 FFF7FEFF 		bl	cc2400_set
1258:bluetooth_rxtx.c **** 	
1259:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
 5077              		.loc 1 1259 0
 5078 0078 184B     		ldr	r3, .L231+4
 5079 007a 1B88     		ldrh	r3, [r3]	@ movhi
 5080 007c 9BB2     		uxth	r3, r3
 5081 007e 013B     		subs	r3, r3, #1
 5082 0080 9BB2     		uxth	r3, r3
 5083 0082 0220     		movs	r0, #2
 5084 0084 1946     		mov	r1, r3
 5085 0086 FFF7FEFF 		bl	cc2400_set
1260:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
ARM GAS  /tmp/ccUeeWpa.s 			page 111


 5086              		.loc 1 1260 0
 5087 008a BB89     		ldrh	r3, [r7, #12]
 5088 008c 0320     		movs	r0, #3
 5089 008e 1946     		mov	r1, r3
 5090 0090 FFF7FEFF 		bl	cc2400_set
1261:bluetooth_rxtx.c **** 
1262:bluetooth_rxtx.c **** 	// Set up CS register
1263:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set();
 5091              		.loc 1 1263 0
 5092 0094 FFF7FEFF 		bl	cs_threshold_calc_and_set
1264:bluetooth_rxtx.c **** 
1265:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 5093              		.loc 1 1265 0
 5094 0098 00BF     		nop
 5095              	.L229:
 5096              		.loc 1 1265 0 is_stmt 0 discriminator 1
 5097 009a FFF7FEFF 		bl	cc2400_status
 5098 009e 0346     		mov	r3, r0
 5099 00a0 03F04003 		and	r3, r3, #64
 5100 00a4 002B     		cmp	r3, #0
 5101 00a6 F8D0     		beq	.L229
1266:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 5102              		.loc 1 1266 0 is_stmt 1
 5103 00a8 6120     		movs	r0, #97
 5104 00aa FFF7FEFF 		bl	cc2400_strobe
1267:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 5105              		.loc 1 1267 0
 5106 00ae 00BF     		nop
 5107              	.L230:
 5108              		.loc 1 1267 0 is_stmt 0 discriminator 1
 5109 00b0 FFF7FEFF 		bl	cc2400_status
 5110 00b4 0346     		mov	r3, r0
 5111 00b6 03F00403 		and	r3, r3, #4
 5112 00ba 002B     		cmp	r3, #0
 5113 00bc F8D0     		beq	.L230
1268:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 5114              		.loc 1 1268 0 is_stmt 1
 5115 00be 6220     		movs	r0, #98
 5116 00c0 FFF7FEFF 		bl	cc2400_strobe
1269:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1270:bluetooth_rxtx.c **** 	PAEN_SET;
 5117              		.loc 1 1270 0
 5118 00c4 064B     		ldr	r3, .L231+8
 5119 00c6 8022     		movs	r2, #128
 5120 00c8 1A60     		str	r2, [r3]
1271:bluetooth_rxtx.c **** 	HGM_SET;
 5121              		.loc 1 1271 0
 5122 00ca 054B     		ldr	r3, .L231+8
 5123 00cc 4FF48072 		mov	r2, #256
 5124 00d0 1A60     		str	r2, [r3]
 5125              	.L224:
1272:bluetooth_rxtx.c **** #endif
1273:bluetooth_rxtx.c **** }
 5126              		.loc 1 1273 0
 5127 00d2 1037     		adds	r7, r7, #16
 5128              		.cfi_def_cfa_offset 8
 5129 00d4 BD46     		mov	sp, r7
ARM GAS  /tmp/ccUeeWpa.s 			page 112


 5130              		.cfi_def_cfa_register 13
 5131              		@ sp needed
 5132 00d6 80BD     		pop	{r7, pc}
 5133              	.L232:
 5134              		.align	2
 5135              	.L231:
 5136 00d8 00000000 		.word	modulation
 5137 00dc 00000000 		.word	channel
 5138 00e0 58C00920 		.word	537509976
 5139              		.cfi_endproc
 5140              	.LFE22:
 5142              		.section	.text.le_transmit,"ax",%progbits
 5143              		.align	2
 5144              		.global	le_transmit
 5145              		.thumb
 5146              		.thumb_func
 5148              	le_transmit:
 5149              	.LFB23:
1274:bluetooth_rxtx.c **** 
1275:bluetooth_rxtx.c **** /*
1276:bluetooth_rxtx.c ****  * Transmit a BTLE packet with the specified access address.
1277:bluetooth_rxtx.c ****  *
1278:bluetooth_rxtx.c ****  * All modulation parameters are set within this function. The data
1279:bluetooth_rxtx.c ****  * should not be pre-whitened, but the CRC should be calculated and
1280:bluetooth_rxtx.c ****  * included in the data length.
1281:bluetooth_rxtx.c ****  */
1282:bluetooth_rxtx.c **** void le_transmit(u32 aa, u8 len, u8 *data)
1283:bluetooth_rxtx.c **** {
 5150              		.loc 1 1283 0
 5151              		.cfi_startproc
 5152              		@ args = 0, pretend = 0, frame = 104
 5153              		@ frame_needed = 1, uses_anonymous_args = 0
 5154 0000 80B5     		push	{r7, lr}
 5155              		.cfi_def_cfa_offset 8
 5156              		.cfi_offset 7, -8
 5157              		.cfi_offset 14, -4
 5158 0002 9AB0     		sub	sp, sp, #104
 5159              		.cfi_def_cfa_offset 112
 5160 0004 00AF     		add	r7, sp, #0
 5161              		.cfi_def_cfa_register 7
 5162 0006 F860     		str	r0, [r7, #12]
 5163 0008 0B46     		mov	r3, r1
 5164 000a 7A60     		str	r2, [r7, #4]
 5165 000c FB72     		strb	r3, [r7, #11]
1284:bluetooth_rxtx.c **** 	unsigned i, j;
1285:bluetooth_rxtx.c **** 	int bit;
1286:bluetooth_rxtx.c **** 	u8 txbuf[64];
1287:bluetooth_rxtx.c **** 	u8 tx_len;
1288:bluetooth_rxtx.c **** 	u8 byte;
1289:bluetooth_rxtx.c **** 	u16 gio_save;
1290:bluetooth_rxtx.c **** 
1291:bluetooth_rxtx.c **** 	// first four bytes: AA
1292:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
 5166              		.loc 1 1292 0
 5167 000e 0023     		movs	r3, #0
 5168 0010 7B66     		str	r3, [r7, #100]
 5169 0012 35E0     		b	.L234
ARM GAS  /tmp/ccUeeWpa.s 			page 113


 5170              	.L237:
1293:bluetooth_rxtx.c **** 		byte = aa & 0xff;
 5171              		.loc 1 1293 0
 5172 0014 FB68     		ldr	r3, [r7, #12]
 5173 0016 87F85E30 		strb	r3, [r7, #94]
1294:bluetooth_rxtx.c **** 		aa >>= 8;
 5174              		.loc 1 1294 0
 5175 001a FB68     		ldr	r3, [r7, #12]
 5176 001c 1B0A     		lsrs	r3, r3, #8
 5177 001e FB60     		str	r3, [r7, #12]
1295:bluetooth_rxtx.c **** 		txbuf[i] = 0;
 5178              		.loc 1 1295 0
 5179 0020 07F11002 		add	r2, r7, #16
 5180 0024 7B6E     		ldr	r3, [r7, #100]
 5181 0026 1344     		add	r3, r3, r2
 5182 0028 0022     		movs	r2, #0
 5183 002a 1A70     		strb	r2, [r3]
1296:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 5184              		.loc 1 1296 0
 5185 002c 0023     		movs	r3, #0
 5186 002e 3B66     		str	r3, [r7, #96]
 5187 0030 20E0     		b	.L235
 5188              	.L236:
1297:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 5189              		.loc 1 1297 0 discriminator 3
 5190 0032 07F11002 		add	r2, r7, #16
 5191 0036 7B6E     		ldr	r3, [r7, #100]
 5192 0038 1344     		add	r3, r3, r2
 5193 003a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 5194 003c D9B2     		uxtb	r1, r3
 5195 003e 97F85E30 		ldrb	r3, [r7, #94]	@ zero_extendqisi2
 5196 0042 03F00103 		and	r3, r3, #1
 5197 0046 3A6E     		ldr	r2, [r7, #96]
 5198 0048 C2F10702 		rsb	r2, r2, #7
 5199 004c 9340     		lsls	r3, r3, r2
 5200 004e DBB2     		uxtb	r3, r3
 5201 0050 0A46     		mov	r2, r1
 5202 0052 1343     		orrs	r3, r3, r2
 5203 0054 DBB2     		uxtb	r3, r3
 5204 0056 D9B2     		uxtb	r1, r3
 5205 0058 07F11002 		add	r2, r7, #16
 5206 005c 7B6E     		ldr	r3, [r7, #100]
 5207 005e 1344     		add	r3, r3, r2
 5208 0060 0A46     		mov	r2, r1
 5209 0062 1A70     		strb	r2, [r3]
1298:bluetooth_rxtx.c **** 			byte >>= 1;
 5210              		.loc 1 1298 0 discriminator 3
 5211 0064 97F85E30 		ldrb	r3, [r7, #94]	@ zero_extendqisi2
 5212 0068 5B08     		lsrs	r3, r3, #1
 5213 006a 87F85E30 		strb	r3, [r7, #94]
1296:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 5214              		.loc 1 1296 0 discriminator 3
 5215 006e 3B6E     		ldr	r3, [r7, #96]
 5216 0070 0133     		adds	r3, r3, #1
 5217 0072 3B66     		str	r3, [r7, #96]
 5218              	.L235:
1296:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
ARM GAS  /tmp/ccUeeWpa.s 			page 114


 5219              		.loc 1 1296 0 is_stmt 0 discriminator 1
 5220 0074 3B6E     		ldr	r3, [r7, #96]
 5221 0076 072B     		cmp	r3, #7
 5222 0078 DBD9     		bls	.L236
1292:bluetooth_rxtx.c **** 		byte = aa & 0xff;
 5223              		.loc 1 1292 0 is_stmt 1 discriminator 2
 5224 007a 7B6E     		ldr	r3, [r7, #100]
 5225 007c 0133     		adds	r3, r3, #1
 5226 007e 7B66     		str	r3, [r7, #100]
 5227              	.L234:
1292:bluetooth_rxtx.c **** 		byte = aa & 0xff;
 5228              		.loc 1 1292 0 is_stmt 0 discriminator 1
 5229 0080 7B6E     		ldr	r3, [r7, #100]
 5230 0082 032B     		cmp	r3, #3
 5231 0084 C6D9     		bls	.L237
1299:bluetooth_rxtx.c **** 		}
1300:bluetooth_rxtx.c **** 	}
1301:bluetooth_rxtx.c **** 
1302:bluetooth_rxtx.c **** 	// whiten the data and copy it into the txbuf
1303:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel-2402)];
 5232              		.loc 1 1303 0 is_stmt 1
 5233 0086 934B     		ldr	r3, .L253
 5234 0088 1B88     		ldrh	r3, [r3]	@ movhi
 5235 008a 9BB2     		uxth	r3, r3
 5236 008c DBB2     		uxtb	r3, r3
 5237 008e 623B     		subs	r3, r3, #98
 5238 0090 DBB2     		uxtb	r3, r3
 5239 0092 1846     		mov	r0, r3
 5240 0094 FFF7FEFF 		bl	btle_channel_index
 5241 0098 0346     		mov	r3, r0
 5242 009a 1A46     		mov	r2, r3
 5243 009c 8E4B     		ldr	r3, .L253+4
 5244 009e 9B5C     		ldrb	r3, [r3, r2]	@ zero_extendqisi2
 5245 00a0 BB65     		str	r3, [r7, #88]
1304:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 5246              		.loc 1 1304 0
 5247 00a2 0023     		movs	r3, #0
 5248 00a4 7B66     		str	r3, [r7, #100]
 5249 00a6 50E0     		b	.L238
 5250              	.L241:
1305:bluetooth_rxtx.c **** 		byte = data[i];
 5251              		.loc 1 1305 0
 5252 00a8 7A68     		ldr	r2, [r7, #4]
 5253 00aa 7B6E     		ldr	r3, [r7, #100]
 5254 00ac 1344     		add	r3, r3, r2
 5255 00ae 1B78     		ldrb	r3, [r3]
 5256 00b0 87F85E30 		strb	r3, [r7, #94]
1306:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
 5257              		.loc 1 1306 0
 5258 00b4 7B6E     		ldr	r3, [r7, #100]
 5259 00b6 0433     		adds	r3, r3, #4
 5260 00b8 07F16802 		add	r2, r7, #104
 5261 00bc 1344     		add	r3, r3, r2
 5262 00be 0022     		movs	r2, #0
 5263 00c0 03F8582C 		strb	r2, [r3, #-88]
1307:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 5264              		.loc 1 1307 0
ARM GAS  /tmp/ccUeeWpa.s 			page 115


 5265 00c4 0023     		movs	r3, #0
 5266 00c6 3B66     		str	r3, [r7, #96]
 5267 00c8 39E0     		b	.L239
 5268              	.L240:
1308:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 5269              		.loc 1 1308 0 discriminator 3
 5270 00ca 97F85E30 		ldrb	r3, [r7, #94]	@ zero_extendqisi2
 5271 00ce 03F00103 		and	r3, r3, #1
 5272 00d2 8249     		ldr	r1, .L253+8
 5273 00d4 BA6D     		ldr	r2, [r7, #88]
 5274 00d6 0A44     		add	r2, r2, r1
 5275 00d8 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 5276 00da 5340     		eors	r3, r3, r2
 5277 00dc 7B65     		str	r3, [r7, #84]
1309:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 5278              		.loc 1 1309 0 discriminator 3
 5279 00de BB6D     		ldr	r3, [r7, #88]
 5280 00e0 0133     		adds	r3, r3, #1
 5281 00e2 1946     		mov	r1, r3
 5282 00e4 7E4B     		ldr	r3, .L253+12
 5283 00e6 A1FB0323 		umull	r2, r3, r1, r3
 5284 00ea C81A     		subs	r0, r1, r3
 5285 00ec 4008     		lsrs	r0, r0, #1
 5286 00ee 0344     		add	r3, r3, r0
 5287 00f0 9A09     		lsrs	r2, r3, #6
 5288 00f2 1346     		mov	r3, r2
 5289 00f4 DB01     		lsls	r3, r3, #7
 5290 00f6 9B1A     		subs	r3, r3, r2
 5291 00f8 CA1A     		subs	r2, r1, r3
 5292 00fa BA65     		str	r2, [r7, #88]
1310:bluetooth_rxtx.c **** 			byte >>= 1;
 5293              		.loc 1 1310 0 discriminator 3
 5294 00fc 97F85E30 		ldrb	r3, [r7, #94]	@ zero_extendqisi2
 5295 0100 5B08     		lsrs	r3, r3, #1
 5296 0102 87F85E30 		strb	r3, [r7, #94]
1311:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
 5297              		.loc 1 1311 0 discriminator 3
 5298 0106 7B6E     		ldr	r3, [r7, #100]
 5299 0108 0433     		adds	r3, r3, #4
 5300 010a 7A6E     		ldr	r2, [r7, #100]
 5301 010c 0432     		adds	r2, r2, #4
 5302 010e 07F16801 		add	r1, r7, #104
 5303 0112 0A44     		add	r2, r2, r1
 5304 0114 12F8582C 		ldrb	r2, [r2, #-88]	@ zero_extendqisi2
 5305 0118 D1B2     		uxtb	r1, r2
 5306 011a 3A6E     		ldr	r2, [r7, #96]
 5307 011c C2F10702 		rsb	r2, r2, #7
 5308 0120 1046     		mov	r0, r2
 5309 0122 7A6D     		ldr	r2, [r7, #84]
 5310 0124 8240     		lsls	r2, r2, r0
 5311 0126 D2B2     		uxtb	r2, r2
 5312 0128 0A43     		orrs	r2, r2, r1
 5313 012a D2B2     		uxtb	r2, r2
 5314 012c D2B2     		uxtb	r2, r2
 5315 012e 07F16801 		add	r1, r7, #104
 5316 0132 0B44     		add	r3, r3, r1
 5317 0134 03F8582C 		strb	r2, [r3, #-88]
ARM GAS  /tmp/ccUeeWpa.s 			page 116


1307:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 5318              		.loc 1 1307 0 discriminator 3
 5319 0138 3B6E     		ldr	r3, [r7, #96]
 5320 013a 0133     		adds	r3, r3, #1
 5321 013c 3B66     		str	r3, [r7, #96]
 5322              	.L239:
1307:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 5323              		.loc 1 1307 0 is_stmt 0 discriminator 1
 5324 013e 3B6E     		ldr	r3, [r7, #96]
 5325 0140 072B     		cmp	r3, #7
 5326 0142 C2D9     		bls	.L240
1304:bluetooth_rxtx.c **** 		byte = data[i];
 5327              		.loc 1 1304 0 is_stmt 1 discriminator 2
 5328 0144 7B6E     		ldr	r3, [r7, #100]
 5329 0146 0133     		adds	r3, r3, #1
 5330 0148 7B66     		str	r3, [r7, #100]
 5331              	.L238:
1304:bluetooth_rxtx.c **** 		byte = data[i];
 5332              		.loc 1 1304 0 is_stmt 0 discriminator 1
 5333 014a FA7A     		ldrb	r2, [r7, #11]	@ zero_extendqisi2
 5334 014c 7B6E     		ldr	r3, [r7, #100]
 5335 014e 9A42     		cmp	r2, r3
 5336 0150 AAD8     		bhi	.L241
1312:bluetooth_rxtx.c **** 		}
1313:bluetooth_rxtx.c **** 	}
1314:bluetooth_rxtx.c **** 
1315:bluetooth_rxtx.c **** 	len += 4; // include the AA in len
 5337              		.loc 1 1315 0 is_stmt 1
 5338 0152 FB7A     		ldrb	r3, [r7, #11]
 5339 0154 0433     		adds	r3, r3, #4
 5340 0156 FB72     		strb	r3, [r7, #11]
1316:bluetooth_rxtx.c **** 
1317:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1318:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
 5341              		.loc 1 1318 0
 5342 0158 0D20     		movs	r0, #13
 5343 015a 47F6FF71 		movw	r1, #32767
 5344 015e FFF7FEFF 		bl	cc2400_set
1319:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 5345              		.loc 1 1319 0
 5346 0162 1220     		movs	r0, #18
 5347 0164 42F62231 		movw	r1, #11042
 5348 0168 FFF7FEFF 		bl	cc2400_set
1320:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 5349              		.loc 1 1320 0
 5350 016c 1420     		movs	r0, #20
 5351 016e 41F24B31 		movw	r1, #4939
 5352 0172 FFF7FEFF 		bl	cc2400_set
1321:bluetooth_rxtx.c **** 
1322:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
 5353              		.loc 1 1322 0
 5354 0176 2020     		movs	r0, #32
 5355 0178 40F60141 		movw	r1, #3073
 5356 017c FFF7FEFF 		bl	cc2400_set
1323:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1324:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1325:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
ARM GAS  /tmp/ccUeeWpa.s 			page 117


1326:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1327:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1328:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1329:bluetooth_rxtx.c **** 
1330:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel);
 5357              		.loc 1 1330 0
 5358 0180 544B     		ldr	r3, .L253
 5359 0182 1B88     		ldrh	r3, [r3]	@ movhi
 5360 0184 9BB2     		uxth	r3, r3
 5361 0186 0220     		movs	r0, #2
 5362 0188 1946     		mov	r1, r3
 5363 018a FFF7FEFF 		bl	cc2400_set
1331:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 5364              		.loc 1 1331 0
 5365 018e 0520     		movs	r0, #5
 5366 0190 0B21     		movs	r1, #11
 5367 0192 FFF7FEFF 		bl	cc2400_set
1332:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 5368              		.loc 1 1332 0
 5369 0196 0320     		movs	r0, #3
 5370 0198 4021     		movs	r1, #64
 5371 019a FFF7FEFF 		bl	cc2400_set
1333:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);	// FIFO_THRESHOLD: 20 bytes
 5372              		.loc 1 1333 0
 5373 019e 2320     		movs	r0, #35
 5374 01a0 1421     		movs	r1, #20
 5375 01a2 FFF7FEFF 		bl	cc2400_set
1334:bluetooth_rxtx.c **** 
1335:bluetooth_rxtx.c **** 	// sync byte depends on the first transmitted bit of the AA
1336:bluetooth_rxtx.c **** 	if (aa & 1)
 5376              		.loc 1 1336 0
 5377 01a6 FB68     		ldr	r3, [r7, #12]
 5378 01a8 03F00103 		and	r3, r3, #1
 5379 01ac 002B     		cmp	r3, #0
 5380 01ae 05D0     		beq	.L242
1337:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
 5381              		.loc 1 1337 0
 5382 01b0 2D20     		movs	r0, #45
 5383 01b2 4AF6AA21 		movw	r1, #43690
 5384 01b6 FFF7FEFF 		bl	cc2400_set
 5385 01ba 04E0     		b	.L243
 5386              	.L242:
1338:bluetooth_rxtx.c **** 	else
1339:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0x5555);
 5387              		.loc 1 1339 0
 5388 01bc 2D20     		movs	r0, #45
 5389 01be 45F25551 		movw	r1, #21845
 5390 01c2 FFF7FEFF 		bl	cc2400_set
 5391              	.L243:
1340:bluetooth_rxtx.c **** 
1341:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1342:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
 5392              		.loc 1 1342 0
 5393 01c6 0820     		movs	r0, #8
 5394 01c8 FFF7FEFF 		bl	cc2400_get
 5395 01cc 0346     		mov	r3, r0
 5396 01ce A7F85230 		strh	r3, [r7, #82]	@ movhi
ARM GAS  /tmp/ccUeeWpa.s 			page 118


1343:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 5397              		.loc 1 1343 0
 5398 01d2 B7F85230 		ldrh	r3, [r7, #82]
 5399 01d6 C3F30803 		ubfx	r3, r3, #0, #9
 5400 01da 9BB2     		uxth	r3, r3
 5401 01dc 43F49C43 		orr	r3, r3, #19968
 5402 01e0 9BB2     		uxth	r3, r3
 5403 01e2 9BB2     		uxth	r3, r3
 5404 01e4 0820     		movs	r0, #8
 5405 01e6 1946     		mov	r1, r3
 5406 01e8 FFF7FEFF 		bl	cc2400_set
1344:bluetooth_rxtx.c **** 
1345:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 5407              		.loc 1 1345 0
 5408 01ec 00BF     		nop
 5409              	.L244:
 5410              		.loc 1 1345 0 is_stmt 0 discriminator 1
 5411 01ee FFF7FEFF 		bl	cc2400_status
 5412 01f2 0346     		mov	r3, r0
 5413 01f4 03F04003 		and	r3, r3, #64
 5414 01f8 002B     		cmp	r3, #0
 5415 01fa F8D0     		beq	.L244
1346:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 5416              		.loc 1 1346 0 is_stmt 1
 5417 01fc 6120     		movs	r0, #97
 5418 01fe FFF7FEFF 		bl	cc2400_strobe
1347:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 5419              		.loc 1 1347 0
 5420 0202 00BF     		nop
 5421              	.L245:
 5422              		.loc 1 1347 0 is_stmt 0 discriminator 1
 5423 0204 FFF7FEFF 		bl	cc2400_status
 5424 0208 0346     		mov	r3, r0
 5425 020a 03F00403 		and	r3, r3, #4
 5426 020e 002B     		cmp	r3, #0
 5427 0210 F8D0     		beq	.L245
1348:bluetooth_rxtx.c **** 	TXLED_SET;
 5428              		.loc 1 1348 0 is_stmt 1
 5429 0212 344B     		ldr	r3, .L253+16
 5430 0214 4FF48072 		mov	r2, #256
 5431 0218 1A60     		str	r2, [r3]
1349:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1350:bluetooth_rxtx.c **** 	PAEN_SET;
 5432              		.loc 1 1350 0
 5433 021a 334B     		ldr	r3, .L253+20
 5434 021c 8022     		movs	r2, #128
 5435 021e 1A60     		str	r2, [r3]
1351:bluetooth_rxtx.c **** #endif
1352:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 5436              		.loc 1 1352 0
 5437 0220 00BF     		nop
 5438              	.L246:
 5439              		.loc 1 1352 0 is_stmt 0 discriminator 1
 5440 0222 0E20     		movs	r0, #14
 5441 0224 FFF7FEFF 		bl	cc2400_get
 5442 0228 0346     		mov	r3, r0
 5443 022a 03F01F03 		and	r3, r3, #31
ARM GAS  /tmp/ccUeeWpa.s 			page 119


 5444 022e 0F2B     		cmp	r3, #15
 5445 0230 F7D1     		bne	.L246
1353:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 5446              		.loc 1 1353 0 is_stmt 1
 5447 0232 6320     		movs	r0, #99
 5448 0234 FFF7FEFF 		bl	cc2400_strobe
1354:bluetooth_rxtx.c **** 
1355:bluetooth_rxtx.c **** 	// put the packet into the FIFO
1356:bluetooth_rxtx.c **** 	for (i = 0; i < len; i += 16) {
 5449              		.loc 1 1356 0
 5450 0238 0023     		movs	r3, #0
 5451 023a 7B66     		str	r3, [r7, #100]
 5452 023c 21E0     		b	.L247
 5453              	.L250:
1357:bluetooth_rxtx.c **** 		while (GIO6) ; // wait for the FIFO to drain (FIFO_FULL false)
 5454              		.loc 1 1357 0
 5455 023e 00BF     		nop
 5456              	.L248:
 5457              		.loc 1 1357 0 is_stmt 0 discriminator 1
 5458 0240 2A4B     		ldr	r3, .L253+24
 5459 0242 1B68     		ldr	r3, [r3]
 5460 0244 03F00403 		and	r3, r3, #4
 5461 0248 002B     		cmp	r3, #0
 5462 024a F9D1     		bne	.L248
1358:bluetooth_rxtx.c **** 		tx_len = len - i;
 5463              		.loc 1 1358 0 is_stmt 1
 5464 024c 7B6E     		ldr	r3, [r7, #100]
 5465 024e DBB2     		uxtb	r3, r3
 5466 0250 FA7A     		ldrb	r2, [r7, #11]
 5467 0252 D31A     		subs	r3, r2, r3
 5468 0254 87F85F30 		strb	r3, [r7, #95]
1359:bluetooth_rxtx.c **** 		if (tx_len > 16)
 5469              		.loc 1 1359 0
 5470 0258 97F85F30 		ldrb	r3, [r7, #95]	@ zero_extendqisi2
 5471 025c 102B     		cmp	r3, #16
 5472 025e 02D9     		bls	.L249
1360:bluetooth_rxtx.c **** 			tx_len = 16;
 5473              		.loc 1 1360 0
 5474 0260 1023     		movs	r3, #16
 5475 0262 87F85F30 		strb	r3, [r7, #95]
 5476              	.L249:
1361:bluetooth_rxtx.c **** 		cc2400_spi_buf(FIFOREG, tx_len, txbuf + i);
 5477              		.loc 1 1361 0 discriminator 2
 5478 0266 07F11002 		add	r2, r7, #16
 5479 026a 7B6E     		ldr	r3, [r7, #100]
 5480 026c 1344     		add	r3, r3, r2
 5481 026e 97F85F20 		ldrb	r2, [r7, #95]	@ zero_extendqisi2
 5482 0272 7020     		movs	r0, #112
 5483 0274 1146     		mov	r1, r2
 5484 0276 1A46     		mov	r2, r3
 5485 0278 FFF7FEFF 		bl	cc2400_spi_buf
1356:bluetooth_rxtx.c **** 		while (GIO6) ; // wait for the FIFO to drain (FIFO_FULL false)
 5486              		.loc 1 1356 0 discriminator 2
 5487 027c 7B6E     		ldr	r3, [r7, #100]
 5488 027e 1033     		adds	r3, r3, #16
 5489 0280 7B66     		str	r3, [r7, #100]
 5490              	.L247:
ARM GAS  /tmp/ccUeeWpa.s 			page 120


1356:bluetooth_rxtx.c **** 		while (GIO6) ; // wait for the FIFO to drain (FIFO_FULL false)
 5491              		.loc 1 1356 0 is_stmt 0 discriminator 1
 5492 0282 FA7A     		ldrb	r2, [r7, #11]	@ zero_extendqisi2
 5493 0284 7B6E     		ldr	r3, [r7, #100]
 5494 0286 9A42     		cmp	r2, r3
 5495 0288 D9D8     		bhi	.L250
1362:bluetooth_rxtx.c **** 	}
1363:bluetooth_rxtx.c **** 
1364:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 5496              		.loc 1 1364 0 is_stmt 1
 5497 028a 00BF     		nop
 5498              	.L251:
 5499              		.loc 1 1364 0 is_stmt 0 discriminator 1
 5500 028c 0E20     		movs	r0, #14
 5501 028e FFF7FEFF 		bl	cc2400_get
 5502 0292 0346     		mov	r3, r0
 5503 0294 03F01F03 		and	r3, r3, #31
 5504 0298 0F2B     		cmp	r3, #15
 5505 029a F7D1     		bne	.L251
1365:bluetooth_rxtx.c **** 	TXLED_CLR;
 5506              		.loc 1 1365 0 is_stmt 1
 5507 029c 144B     		ldr	r3, .L253+28
 5508 029e 4FF48072 		mov	r2, #256
 5509 02a2 1A60     		str	r2, [r3]
1366:bluetooth_rxtx.c **** 
1367:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 5510              		.loc 1 1367 0
 5511 02a4 6420     		movs	r0, #100
 5512 02a6 FFF7FEFF 		bl	cc2400_strobe
1368:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 5513              		.loc 1 1368 0
 5514 02aa 00BF     		nop
 5515              	.L252:
 5516              		.loc 1 1368 0 is_stmt 0 discriminator 1
 5517 02ac FFF7FEFF 		bl	cc2400_status
 5518 02b0 0346     		mov	r3, r0
 5519 02b2 03F00403 		and	r3, r3, #4
 5520 02b6 002B     		cmp	r3, #0
 5521 02b8 F8D1     		bne	.L252
1369:bluetooth_rxtx.c **** 
1370:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1371:bluetooth_rxtx.c **** 	PAEN_CLR;
 5522              		.loc 1 1371 0 is_stmt 1
 5523 02ba 0E4B     		ldr	r3, .L253+32
 5524 02bc 8022     		movs	r2, #128
 5525 02be 1A60     		str	r2, [r3]
1372:bluetooth_rxtx.c **** #endif
1373:bluetooth_rxtx.c **** 
1374:bluetooth_rxtx.c **** 	// reset GIO
1375:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
 5526              		.loc 1 1375 0
 5527 02c0 B7F85230 		ldrh	r3, [r7, #82]
 5528 02c4 0820     		movs	r0, #8
 5529 02c6 1946     		mov	r1, r3
 5530 02c8 FFF7FEFF 		bl	cc2400_set
1376:bluetooth_rxtx.c **** }
 5531              		.loc 1 1376 0
ARM GAS  /tmp/ccUeeWpa.s 			page 121


 5532 02cc 6837     		adds	r7, r7, #104
 5533              		.cfi_def_cfa_offset 8
 5534 02ce BD46     		mov	sp, r7
 5535              		.cfi_def_cfa_register 13
 5536              		@ sp needed
 5537 02d0 80BD     		pop	{r7, pc}
 5538              	.L254:
 5539 02d2 00BF     		.align	2
 5540              	.L253:
 5541 02d4 00000000 		.word	channel
 5542 02d8 AC000000 		.word	whitening_index
 5543 02dc 2C000000 		.word	whitening
 5544 02e0 11080402 		.word	33818641
 5545 02e4 38C00920 		.word	537509944
 5546 02e8 58C00920 		.word	537509976
 5547 02ec 54C00920 		.word	537509972
 5548 02f0 3CC00920 		.word	537509948
 5549 02f4 5CC00920 		.word	537509980
 5550              		.cfi_endproc
 5551              	.LFE23:
 5553              		.section	.text.le_jam,"ax",%progbits
 5554              		.align	2
 5555              		.global	le_jam
 5556              		.thumb
 5557              		.thumb_func
 5559              	le_jam:
 5560              	.LFB24:
1377:bluetooth_rxtx.c **** 
1378:bluetooth_rxtx.c **** void le_jam(void) {
 5561              		.loc 1 1378 0
 5562              		.cfi_startproc
 5563              		@ args = 0, pretend = 0, frame = 0
 5564              		@ frame_needed = 1, uses_anonymous_args = 0
 5565 0000 80B5     		push	{r7, lr}
 5566              		.cfi_def_cfa_offset 8
 5567              		.cfi_offset 7, -8
 5568              		.cfi_offset 14, -4
 5569 0002 00AF     		add	r7, sp, #0
 5570              		.cfi_def_cfa_register 7
1379:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1380:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
 5571              		.loc 1 1380 0
 5572 0004 0D20     		movs	r0, #13
 5573 0006 47F6FF71 		movw	r1, #32767
 5574 000a FFF7FEFF 		bl	cc2400_set
1381:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 5575              		.loc 1 1381 0
 5576 000e 1220     		movs	r0, #18
 5577 0010 42F62231 		movw	r1, #11042
 5578 0014 FFF7FEFF 		bl	cc2400_set
1382:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
 5579              		.loc 1 1382 0
 5580 0018 1420     		movs	r0, #20
 5581 001a 42F24B31 		movw	r1, #9035
 5582 001e FFF7FEFF 		bl	cc2400_set
1383:bluetooth_rxtx.c **** 
1384:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
ARM GAS  /tmp/ccUeeWpa.s 			page 122


 5583              		.loc 1 1384 0
 5584 0022 2020     		movs	r0, #32
 5585 0024 40F60141 		movw	r1, #3073
 5586 0028 FFF7FEFF 		bl	cc2400_set
1385:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1386:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1387:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1388:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1389:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1390:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1391:bluetooth_rxtx.c **** 
1392:bluetooth_rxtx.c **** 	// cc2400_set(FSDIV,   channel);
1393:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 5587              		.loc 1 1393 0
 5588 002c 0520     		movs	r0, #5
 5589 002e 0B21     		movs	r1, #11
 5590 0030 FFF7FEFF 		bl	cc2400_set
1394:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 5591              		.loc 1 1394 0
 5592 0034 0320     		movs	r0, #3
 5593 0036 4021     		movs	r1, #64
 5594 0038 FFF7FEFF 		bl	cc2400_set
1395:bluetooth_rxtx.c **** 
1396:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 5595              		.loc 1 1396 0
 5596 003c 00BF     		nop
 5597              	.L256:
 5598              		.loc 1 1396 0 is_stmt 0 discriminator 1
 5599 003e FFF7FEFF 		bl	cc2400_status
 5600 0042 0346     		mov	r3, r0
 5601 0044 03F04003 		and	r3, r3, #64
 5602 0048 002B     		cmp	r3, #0
 5603 004a F8D0     		beq	.L256
1397:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 5604              		.loc 1 1397 0 is_stmt 1
 5605 004c 6120     		movs	r0, #97
 5606 004e FFF7FEFF 		bl	cc2400_strobe
1398:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 5607              		.loc 1 1398 0
 5608 0052 00BF     		nop
 5609              	.L257:
 5610              		.loc 1 1398 0 is_stmt 0 discriminator 1
 5611 0054 FFF7FEFF 		bl	cc2400_status
 5612 0058 0346     		mov	r3, r0
 5613 005a 03F00403 		and	r3, r3, #4
 5614 005e 002B     		cmp	r3, #0
 5615 0060 F8D0     		beq	.L257
1399:bluetooth_rxtx.c **** 	TXLED_SET;
 5616              		.loc 1 1399 0 is_stmt 1
 5617 0062 0A4B     		ldr	r3, .L259
 5618 0064 4FF48072 		mov	r2, #256
 5619 0068 1A60     		str	r2, [r3]
1400:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1401:bluetooth_rxtx.c **** 	PAEN_SET;
 5620              		.loc 1 1401 0
 5621 006a 094B     		ldr	r3, .L259+4
 5622 006c 8022     		movs	r2, #128
ARM GAS  /tmp/ccUeeWpa.s 			page 123


 5623 006e 1A60     		str	r2, [r3]
1402:bluetooth_rxtx.c **** #endif
1403:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 5624              		.loc 1 1403 0
 5625 0070 00BF     		nop
 5626              	.L258:
 5627              		.loc 1 1403 0 is_stmt 0 discriminator 1
 5628 0072 0E20     		movs	r0, #14
 5629 0074 FFF7FEFF 		bl	cc2400_get
 5630 0078 0346     		mov	r3, r0
 5631 007a 03F01F03 		and	r3, r3, #31
 5632 007e 0F2B     		cmp	r3, #15
 5633 0080 F7D1     		bne	.L258
1404:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 5634              		.loc 1 1404 0 is_stmt 1
 5635 0082 6320     		movs	r0, #99
 5636 0084 FFF7FEFF 		bl	cc2400_strobe
1405:bluetooth_rxtx.c **** #endif
1406:bluetooth_rxtx.c **** }
 5637              		.loc 1 1406 0
 5638 0088 80BD     		pop	{r7, pc}
 5639              	.L260:
 5640 008a 00BF     		.align	2
 5641              	.L259:
 5642 008c 38C00920 		.word	537509944
 5643 0090 58C00920 		.word	537509976
 5644              		.cfi_endproc
 5645              	.LFE24:
 5647              		.section	.text.hop,"ax",%progbits
 5648              		.align	2
 5649              		.global	hop
 5650              		.thumb
 5651              		.thumb_func
 5653              	hop:
 5654              	.LFB25:
1407:bluetooth_rxtx.c **** 
1408:bluetooth_rxtx.c **** /* TODO - return whether hop happened, or should caller have to keep
1409:bluetooth_rxtx.c ****  * track of this? */
1410:bluetooth_rxtx.c **** void hop(void)
1411:bluetooth_rxtx.c **** {
 5655              		.loc 1 1411 0
 5656              		.cfi_startproc
 5657              		@ args = 0, pretend = 0, frame = 0
 5658              		@ frame_needed = 1, uses_anonymous_args = 0
 5659 0000 80B5     		push	{r7, lr}
 5660              		.cfi_def_cfa_offset 8
 5661              		.cfi_offset 7, -8
 5662              		.cfi_offset 14, -4
 5663 0002 00AF     		add	r7, sp, #0
 5664              		.cfi_def_cfa_register 7
1412:bluetooth_rxtx.c **** 	do_hop = 0;
 5665              		.loc 1 1412 0
 5666 0004 414B     		ldr	r3, .L272
 5667 0006 0022     		movs	r2, #0
 5668 0008 1A70     		strb	r2, [r3]
1413:bluetooth_rxtx.c **** 
1414:bluetooth_rxtx.c **** 	// No hopping, if channel is set correctly, do nothing
ARM GAS  /tmp/ccUeeWpa.s 			page 124


1415:bluetooth_rxtx.c **** 	if (hop_mode == HOP_NONE) {
 5669              		.loc 1 1415 0
 5670 000a 414B     		ldr	r3, .L272+4
 5671 000c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 5672 000e 002B     		cmp	r3, #0
 5673 0010 0BD1     		bne	.L262
1416:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
 5674              		.loc 1 1416 0
 5675 0012 0220     		movs	r0, #2
 5676 0014 FFF7FEFF 		bl	cc2400_get
 5677 0018 0346     		mov	r3, r0
 5678 001a 1A46     		mov	r2, r3
 5679 001c 3D4B     		ldr	r3, .L272+8
 5680 001e 1B88     		ldrh	r3, [r3]	@ movhi
 5681 0020 9BB2     		uxth	r3, r3
 5682 0022 013B     		subs	r3, r3, #1
 5683 0024 9A42     		cmp	r2, r3
 5684 0026 47D1     		bne	.L263
1417:bluetooth_rxtx.c **** 			return;
 5685              		.loc 1 1417 0
 5686 0028 6EE0     		b	.L261
 5687              	.L262:
1418:bluetooth_rxtx.c **** 	}
1419:bluetooth_rxtx.c **** 
1420:bluetooth_rxtx.c **** 	// Slow sweep (100 hops/sec)
1421:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_SWEEP) {
 5688              		.loc 1 1421 0
 5689 002a 394B     		ldr	r3, .L272+4
 5690 002c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 5691 002e 012B     		cmp	r3, #1
 5692 0030 14D1     		bne	.L265
1422:bluetooth_rxtx.c **** 		channel += 32;
 5693              		.loc 1 1422 0
 5694 0032 384B     		ldr	r3, .L272+8
 5695 0034 1B88     		ldrh	r3, [r3]	@ movhi
 5696 0036 9BB2     		uxth	r3, r3
 5697 0038 2033     		adds	r3, r3, #32
 5698 003a 9AB2     		uxth	r2, r3
 5699 003c 354B     		ldr	r3, .L272+8
 5700 003e 1A80     		strh	r2, [r3]	@ movhi
1423:bluetooth_rxtx.c **** 		if (channel > 2480)
 5701              		.loc 1 1423 0
 5702 0040 344B     		ldr	r3, .L272+8
 5703 0042 1B88     		ldrh	r3, [r3]	@ movhi
 5704 0044 9BB2     		uxth	r3, r3
 5705 0046 B3F51B6F 		cmp	r3, #2480
 5706 004a 35D9     		bls	.L263
1424:bluetooth_rxtx.c **** 			channel -= 79;
 5707              		.loc 1 1424 0
 5708 004c 314B     		ldr	r3, .L272+8
 5709 004e 1B88     		ldrh	r3, [r3]	@ movhi
 5710 0050 9BB2     		uxth	r3, r3
 5711 0052 4F3B     		subs	r3, r3, #79
 5712 0054 9AB2     		uxth	r2, r3
 5713 0056 2F4B     		ldr	r3, .L272+8
 5714 0058 1A80     		strh	r2, [r3]	@ movhi
 5715 005a 2DE0     		b	.L263
ARM GAS  /tmp/ccUeeWpa.s 			page 125


 5716              	.L265:
1425:bluetooth_rxtx.c **** 	}
1426:bluetooth_rxtx.c **** 
1427:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BLUETOOTH) {
 5717              		.loc 1 1427 0
 5718 005c 2C4B     		ldr	r3, .L272+4
 5719 005e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 5720 0060 022B     		cmp	r3, #2
 5721 0062 0DD1     		bne	.L267
1428:bluetooth_rxtx.c **** 		TXLED_SET;
 5722              		.loc 1 1428 0
 5723 0064 2C4B     		ldr	r3, .L272+12
 5724 0066 4FF48072 		mov	r2, #256
 5725 006a 1A60     		str	r2, [r3]
1429:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
 5726              		.loc 1 1429 0
 5727 006c 2B4B     		ldr	r3, .L272+16
 5728 006e 1B68     		ldr	r3, [r3]
 5729 0070 1846     		mov	r0, r3
 5730 0072 FFF7FEFF 		bl	next_hop
 5731 0076 0346     		mov	r3, r0
 5732 0078 1A46     		mov	r2, r3
 5733 007a 264B     		ldr	r3, .L272+8
 5734 007c 1A80     		strh	r2, [r3]	@ movhi
 5735 007e 1BE0     		b	.L263
 5736              	.L267:
1430:bluetooth_rxtx.c **** 	}
1431:bluetooth_rxtx.c **** 
1432:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BTLE) {
 5737              		.loc 1 1432 0
 5738 0080 234B     		ldr	r3, .L272+4
 5739 0082 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 5740 0084 032B     		cmp	r3, #3
 5741 0086 0BD1     		bne	.L268
1433:bluetooth_rxtx.c **** 		TXLED_SET;
 5742              		.loc 1 1433 0
 5743 0088 234B     		ldr	r3, .L272+12
 5744 008a 4FF48072 		mov	r2, #256
 5745 008e 1A60     		str	r2, [r3]
1434:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
 5746              		.loc 1 1434 0
 5747 0090 2348     		ldr	r0, .L272+20
 5748 0092 FFF7FEFF 		bl	btle_next_hop
 5749 0096 0346     		mov	r3, r0
 5750 0098 1A46     		mov	r2, r3
 5751 009a 1E4B     		ldr	r3, .L272+8
 5752 009c 1A80     		strh	r2, [r3]	@ movhi
 5753 009e 0BE0     		b	.L263
 5754              	.L268:
1435:bluetooth_rxtx.c **** 	}
1436:bluetooth_rxtx.c **** 
1437:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_DIRECT) {
 5755              		.loc 1 1437 0
 5756 00a0 1B4B     		ldr	r3, .L272+4
 5757 00a2 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 5758 00a4 042B     		cmp	r3, #4
 5759 00a6 07D1     		bne	.L263
ARM GAS  /tmp/ccUeeWpa.s 			page 126


1438:bluetooth_rxtx.c **** 		TXLED_SET;
 5760              		.loc 1 1438 0
 5761 00a8 1B4B     		ldr	r3, .L272+12
 5762 00aa 4FF48072 		mov	r2, #256
 5763 00ae 1A60     		str	r2, [r3]
1439:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
 5764              		.loc 1 1439 0
 5765 00b0 1C4B     		ldr	r3, .L272+24
 5766 00b2 1A88     		ldrh	r2, [r3]
 5767 00b4 174B     		ldr	r3, .L272+8
 5768 00b6 1A80     		strh	r2, [r3]	@ movhi
 5769              	.L263:
1440:bluetooth_rxtx.c **** 	}
1441:bluetooth_rxtx.c **** 
1442:bluetooth_rxtx.c ****         /* IDLE mode, but leave amp on, so don't call cc2400_idle(). */
1443:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 5770              		.loc 1 1443 0
 5771 00b8 6420     		movs	r0, #100
 5772 00ba FFF7FEFF 		bl	cc2400_strobe
1444:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 5773              		.loc 1 1444 0
 5774 00be 00BF     		nop
 5775              	.L269:
 5776              		.loc 1 1444 0 is_stmt 0 discriminator 1
 5777 00c0 FFF7FEFF 		bl	cc2400_status
 5778 00c4 0346     		mov	r3, r0
 5779 00c6 03F00403 		and	r3, r3, #4
 5780 00ca 002B     		cmp	r3, #0
 5781 00cc F8D1     		bne	.L269
1445:bluetooth_rxtx.c **** 
1446:bluetooth_rxtx.c **** 	/* Retune */
1447:bluetooth_rxtx.c **** 	cc2400_set(FSDIV, channel - 1);
 5782              		.loc 1 1447 0 is_stmt 1
 5783 00ce 114B     		ldr	r3, .L272+8
 5784 00d0 1B88     		ldrh	r3, [r3]	@ movhi
 5785 00d2 9BB2     		uxth	r3, r3
 5786 00d4 013B     		subs	r3, r3, #1
 5787 00d6 9BB2     		uxth	r3, r3
 5788 00d8 0220     		movs	r0, #2
 5789 00da 1946     		mov	r1, r3
 5790 00dc FFF7FEFF 		bl	cc2400_set
1448:bluetooth_rxtx.c **** 	
1449:bluetooth_rxtx.c **** 	/* Update CS register if hopping.  */
1450:bluetooth_rxtx.c **** 	if (hop_mode > 0) {
 5791              		.loc 1 1450 0
 5792 00e0 0B4B     		ldr	r3, .L272+4
 5793 00e2 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 5794 00e4 002B     		cmp	r3, #0
 5795 00e6 01D0     		beq	.L270
1451:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set();
 5796              		.loc 1 1451 0
 5797 00e8 FFF7FEFF 		bl	cs_threshold_calc_and_set
 5798              	.L270:
1452:bluetooth_rxtx.c **** 	}
1453:bluetooth_rxtx.c **** 
1454:bluetooth_rxtx.c **** 	/* Wait for lock */
1455:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
ARM GAS  /tmp/ccUeeWpa.s 			page 127


 5799              		.loc 1 1455 0
 5800 00ec 6120     		movs	r0, #97
 5801 00ee FFF7FEFF 		bl	cc2400_strobe
1456:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 5802              		.loc 1 1456 0
 5803 00f2 00BF     		nop
 5804              	.L271:
 5805              		.loc 1 1456 0 is_stmt 0 discriminator 1
 5806 00f4 FFF7FEFF 		bl	cc2400_status
 5807 00f8 0346     		mov	r3, r0
 5808 00fa 03F00403 		and	r3, r3, #4
 5809 00fe 002B     		cmp	r3, #0
 5810 0100 F8D0     		beq	.L271
1457:bluetooth_rxtx.c **** 	
1458:bluetooth_rxtx.c **** 	/* RX mode */
1459:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 5811              		.loc 1 1459 0 is_stmt 1
 5812 0102 6220     		movs	r0, #98
 5813 0104 FFF7FEFF 		bl	cc2400_strobe
 5814              	.L261:
1460:bluetooth_rxtx.c **** 
1461:bluetooth_rxtx.c **** }
 5815              		.loc 1 1461 0
 5816 0108 80BD     		pop	{r7, pc}
 5817              	.L273:
 5818 010a 00BF     		.align	2
 5819              	.L272:
 5820 010c 00000000 		.word	do_hop
 5821 0110 00000000 		.word	hop_mode
 5822 0114 00000000 		.word	channel
 5823 0118 38C00920 		.word	537509944
 5824 011c 00000000 		.word	clkn
 5825 0120 00000000 		.word	le
 5826 0124 00000000 		.word	hop_direct_channel
 5827              		.cfi_endproc
 5828              	.LFE25:
 5830              		.section	.text.cc2400_spi_rev,"ax",%progbits
 5831              		.align	2
 5832              		.global	cc2400_spi_rev
 5833              		.thumb
 5834              		.thumb_func
 5836              	cc2400_spi_rev:
 5837              	.LFB26:
1462:bluetooth_rxtx.c **** 
1463:bluetooth_rxtx.c **** u32 cc2400_spi_rev(u8 len, u32 data)
1464:bluetooth_rxtx.c **** {
 5838              		.loc 1 1464 0
 5839              		.cfi_startproc
 5840              		@ args = 0, pretend = 0, frame = 16
 5841              		@ frame_needed = 1, uses_anonymous_args = 0
 5842              		@ link register save eliminated.
 5843 0000 80B4     		push	{r7}
 5844              		.cfi_def_cfa_offset 4
 5845              		.cfi_offset 7, -4
 5846 0002 85B0     		sub	sp, sp, #20
 5847              		.cfi_def_cfa_offset 24
 5848 0004 00AF     		add	r7, sp, #0
ARM GAS  /tmp/ccUeeWpa.s 			page 128


 5849              		.cfi_def_cfa_register 7
 5850 0006 0346     		mov	r3, r0
 5851 0008 3960     		str	r1, [r7]
 5852 000a FB71     		strb	r3, [r7, #7]
1465:bluetooth_rxtx.c ****     //    u32 first_ts, second_ts, diff;
1466:bluetooth_rxtx.c **** 
1467:bluetooth_rxtx.c **** 
1468:bluetooth_rxtx.c ****         u32 msb = 1 << (len - 1);
 5853              		.loc 1 1468 0
 5854 000c FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 5855 000e 013B     		subs	r3, r3, #1
 5856 0010 0122     		movs	r2, #1
 5857 0012 02FA03F3 		lsl	r3, r2, r3
 5858 0016 FB60     		str	r3, [r7, #12]
1469:bluetooth_rxtx.c **** 
1470:bluetooth_rxtx.c ****         /* start transaction by dropping CSN */
1471:bluetooth_rxtx.c ****         CSN_CLR;
 5859              		.loc 1 1471 0
 5860 0018 184B     		ldr	r3, .L281
 5861 001a 2022     		movs	r2, #32
 5862 001c 1A60     		str	r2, [r3]
1472:bluetooth_rxtx.c ****         
1473:bluetooth_rxtx.c **** //      first_ts = CLK100NS;
1474:bluetooth_rxtx.c ****         while (len--) {
 5863              		.loc 1 1474 0
 5864 001e 1EE0     		b	.L275
 5865              	.L279:
1475:bluetooth_rxtx.c ****                 if (data & msb)
 5866              		.loc 1 1475 0
 5867 0020 3A68     		ldr	r2, [r7]
 5868 0022 FB68     		ldr	r3, [r7, #12]
 5869 0024 1340     		ands	r3, r3, r2
 5870 0026 002B     		cmp	r3, #0
 5871 0028 03D0     		beq	.L276
1476:bluetooth_rxtx.c ****                         MOSI_SET;
 5872              		.loc 1 1476 0
 5873 002a 154B     		ldr	r3, .L281+4
 5874 002c 0122     		movs	r2, #1
 5875 002e 1A60     		str	r2, [r3]
 5876 0030 02E0     		b	.L277
 5877              	.L276:
1477:bluetooth_rxtx.c ****                 else
1478:bluetooth_rxtx.c ****                         MOSI_CLR;
 5878              		.loc 1 1478 0
 5879 0032 124B     		ldr	r3, .L281
 5880 0034 0122     		movs	r2, #1
 5881 0036 1A60     		str	r2, [r3]
 5882              	.L277:
1479:bluetooth_rxtx.c ****                 data <<= 1;
 5883              		.loc 1 1479 0
 5884 0038 3B68     		ldr	r3, [r7]
 5885 003a 5B00     		lsls	r3, r3, #1
 5886 003c 3B60     		str	r3, [r7]
1480:bluetooth_rxtx.c **** 
1481:bluetooth_rxtx.c ****                 SCLK_SET;
 5887              		.loc 1 1481 0
 5888 003e 104B     		ldr	r3, .L281+4
ARM GAS  /tmp/ccUeeWpa.s 			page 129


 5889 0040 1022     		movs	r2, #16
 5890 0042 1A60     		str	r2, [r3]
1482:bluetooth_rxtx.c ****                 if (MISO)
 5891              		.loc 1 1482 0
 5892 0044 0F4B     		ldr	r3, .L281+8
 5893 0046 1B68     		ldr	r3, [r3]
 5894 0048 03F00203 		and	r3, r3, #2
 5895 004c 002B     		cmp	r3, #0
 5896 004e 03D0     		beq	.L278
1483:bluetooth_rxtx.c ****                         data |= 1;
 5897              		.loc 1 1483 0
 5898 0050 3B68     		ldr	r3, [r7]
 5899 0052 43F00103 		orr	r3, r3, #1
 5900 0056 3B60     		str	r3, [r7]
 5901              	.L278:
1484:bluetooth_rxtx.c **** 
1485:bluetooth_rxtx.c ****                 SCLK_CLR;
 5902              		.loc 1 1485 0
 5903 0058 084B     		ldr	r3, .L281
 5904 005a 1022     		movs	r2, #16
 5905 005c 1A60     		str	r2, [r3]
 5906              	.L275:
1474:bluetooth_rxtx.c ****                 if (data & msb)
 5907              		.loc 1 1474 0
 5908 005e FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 5909 0060 5A1E     		subs	r2, r3, #1
 5910 0062 FA71     		strb	r2, [r7, #7]
 5911 0064 002B     		cmp	r3, #0
 5912 0066 DBD1     		bne	.L279
1486:bluetooth_rxtx.c ****         }
1487:bluetooth_rxtx.c **** //      second_ts = CLK100NS;
1488:bluetooth_rxtx.c **** //      diff_ts = second_ts - first_ts;
1489:bluetooth_rxtx.c **** 
1490:bluetooth_rxtx.c ****         CSN_SET;
 5913              		.loc 1 1490 0
 5914 0068 054B     		ldr	r3, .L281+4
 5915 006a 2022     		movs	r2, #32
 5916 006c 1A60     		str	r2, [r3]
1491:bluetooth_rxtx.c ****         return data;
 5917              		.loc 1 1491 0
 5918 006e 3B68     		ldr	r3, [r7]
1492:bluetooth_rxtx.c **** }
 5919              		.loc 1 1492 0
 5920 0070 1846     		mov	r0, r3
 5921 0072 1437     		adds	r7, r7, #20
 5922              		.cfi_def_cfa_offset 4
 5923 0074 BD46     		mov	sp, r7
 5924              		.cfi_def_cfa_register 13
 5925              		@ sp needed
 5926 0076 5DF8047B 		ldr	r7, [sp], #4
 5927              		.cfi_restore 7
 5928              		.cfi_def_cfa_offset 0
 5929 007a 7047     		bx	lr
 5930              	.L282:
 5931              		.align	2
 5932              	.L281:
 5933 007c 5CC00920 		.word	537509980
ARM GAS  /tmp/ccUeeWpa.s 			page 130


 5934 0080 58C00920 		.word	537509976
 5935 0084 54C00920 		.word	537509972
 5936              		.cfi_endproc
 5937              	.LFE26:
 5939              		.section	.text.cc2400_get_rev,"ax",%progbits
 5940              		.align	2
 5941              		.global	cc2400_get_rev
 5942              		.thumb
 5943              		.thumb_func
 5945              	cc2400_get_rev:
 5946              	.LFB27:
1493:bluetooth_rxtx.c **** 
1494:bluetooth_rxtx.c **** u8 cc2400_get_rev(u8 reg)
1495:bluetooth_rxtx.c **** {
 5947              		.loc 1 1495 0
 5948              		.cfi_startproc
 5949              		@ args = 0, pretend = 0, frame = 16
 5950              		@ frame_needed = 1, uses_anonymous_args = 0
 5951 0000 80B5     		push	{r7, lr}
 5952              		.cfi_def_cfa_offset 8
 5953              		.cfi_offset 7, -8
 5954              		.cfi_offset 14, -4
 5955 0002 84B0     		sub	sp, sp, #16
 5956              		.cfi_def_cfa_offset 24
 5957 0004 00AF     		add	r7, sp, #0
 5958              		.cfi_def_cfa_register 7
 5959 0006 0346     		mov	r3, r0
 5960 0008 FB71     		strb	r3, [r7, #7]
1496:bluetooth_rxtx.c ****         u32 in;
1497:bluetooth_rxtx.c **** 
1498:bluetooth_rxtx.c ****         u32 out = (reg | 0x80) << 8;
 5961              		.loc 1 1498 0
 5962 000a FB79     		ldrb	r3, [r7, #7]
 5963 000c 63F07F03 		orn	r3, r3, #127
 5964 0010 DBB2     		uxtb	r3, r3
 5965 0012 1B02     		lsls	r3, r3, #8
 5966 0014 FB60     		str	r3, [r7, #12]
1499:bluetooth_rxtx.c ****         in = cc2400_spi_rev(16, out);
 5967              		.loc 1 1499 0
 5968 0016 1020     		movs	r0, #16
 5969 0018 F968     		ldr	r1, [r7, #12]
 5970 001a FFF7FEFF 		bl	cc2400_spi_rev
 5971 001e B860     		str	r0, [r7, #8]
1500:bluetooth_rxtx.c ****         return in & 0xFF;
 5972              		.loc 1 1500 0
 5973 0020 BB68     		ldr	r3, [r7, #8]
 5974 0022 DBB2     		uxtb	r3, r3
1501:bluetooth_rxtx.c **** }
 5975              		.loc 1 1501 0
 5976 0024 1846     		mov	r0, r3
 5977 0026 1037     		adds	r7, r7, #16
 5978              		.cfi_def_cfa_offset 8
 5979 0028 BD46     		mov	sp, r7
 5980              		.cfi_def_cfa_register 13
 5981              		@ sp needed
 5982 002a 80BD     		pop	{r7, pc}
 5983              		.cfi_endproc
ARM GAS  /tmp/ccUeeWpa.s 			page 131


 5984              	.LFE27:
 5986              		.section	.text.bt_stream_rx,"ax",%progbits
 5987              		.align	2
 5988              		.global	bt_stream_rx
 5989              		.thumb
 5990              		.thumb_func
 5992              	bt_stream_rx:
 5993              	.LFB28:
1502:bluetooth_rxtx.c **** 
1503:bluetooth_rxtx.c **** 
1504:bluetooth_rxtx.c **** 
1505:bluetooth_rxtx.c **** 
1506:bluetooth_rxtx.c **** //wpson
1507:bluetooth_rxtx.c **** void bt_stream_rx()
1508:bluetooth_rxtx.c **** {
 5994              		.loc 1 1508 0
 5995              		.cfi_startproc
 5996              		@ args = 0, pretend = 0, frame = 64
 5997              		@ frame_needed = 1, uses_anonymous_args = 0
 5998 0000 80B5     		push	{r7, lr}
 5999              		.cfi_def_cfa_offset 8
 6000              		.cfi_offset 7, -8
 6001              		.cfi_offset 14, -4
 6002 0002 90B0     		sub	sp, sp, #64
 6003              		.cfi_def_cfa_offset 72
 6004 0004 00AF     		add	r7, sp, #0
 6005              		.cfi_def_cfa_register 7
1509:bluetooth_rxtx.c **** 	u8 epstat;
1510:bluetooth_rxtx.c **** 	u16 f;
1511:bluetooth_rxtx.c **** 	u8 i = 0;
 6006              		.loc 1 1511 0
 6007 0006 0023     		movs	r3, #0
 6008 0008 87F83B30 		strb	r3, [r7, #59]
1512:bluetooth_rxtx.c **** 	u8 buf[DMA_SIZE];
1513:bluetooth_rxtx.c **** 
1514:bluetooth_rxtx.c **** 
1515:bluetooth_rxtx.c **** //	TXLED_SET;
1516:bluetooth_rxtx.c **** 	queue_init();
 6009              		.loc 1 1516 0
 6010 000c FFF7FEFF 		bl	queue_init
1517:bluetooth_rxtx.c **** 
1518:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1519:bluetooth_rxtx.c **** 	PAEN_SET;
 6011              		.loc 1 1519 0
 6012 0010 624B     		ldr	r3, .L299
 6013 0012 8022     		movs	r2, #128
 6014 0014 1A60     		str	r2, [r3]
1520:bluetooth_rxtx.c **** //	HGM_SET;
1521:bluetooth_rxtx.c **** #endif
1522:bluetooth_rxtx.c **** 	cc2400_set (MANAND, 0x7fff);
 6015              		.loc 1 1522 0
 6016 0016 0D20     		movs	r0, #13
 6017 0018 47F6FF71 		movw	r1, #32767
 6018 001c FFF7FEFF 		bl	cc2400_set
1523:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 6019              		.loc 1 1523 0
 6020 0020 1220     		movs	r0, #18
ARM GAS  /tmp/ccUeeWpa.s 			page 132


 6021 0022 42F62231 		movw	r1, #11042
 6022 0026 FFF7FEFF 		bl	cc2400_set
1524:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x164b); // without PRNG
 6023              		.loc 1 1524 0
 6024 002a 1420     		movs	r0, #20
 6025 002c 41F24B61 		movw	r1, #5707
 6026 0030 FFF7FEFF 		bl	cc2400_set
1525:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0560); // un-buffered mode, GFSK
 6027              		.loc 1 1525 0
 6028 0034 2020     		movs	r0, #32
 6029 0036 4FF4AC61 		mov	r1, #1376
 6030 003a FFF7FEFF 		bl	cc2400_set
1526:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040); // 160 kHz frequency deviation
 6031              		.loc 1 1526 0
 6032 003e 0320     		movs	r0, #3
 6033 0040 4021     		movs	r1, #64
 6034 0042 FFF7FEFF 		bl	cc2400_set
1527:bluetooth_rxtx.c **** 	
1528:bluetooth_rxtx.c **** //	cc2400_set(SYNCH, 0xf9ae);
1529:bluetooth_rxtx.c **** //	cc2400_set(SYNCL, 0x1584);
1530:bluetooth_rxtx.c ****         cc2400_set(SYNCL,   rbit(0x8e89bed6) & 0xffff);
 6035              		.loc 1 1530 0
 6036 0046 5648     		ldr	r0, .L299+4
 6037 0048 FFF7FEFF 		bl	rbit
 6038 004c 0346     		mov	r3, r0
 6039 004e 9BB2     		uxth	r3, r3
 6040 0050 2C20     		movs	r0, #44
 6041 0052 1946     		mov	r1, r3
 6042 0054 FFF7FEFF 		bl	cc2400_set
1531:bluetooth_rxtx.c ****         cc2400_set(SYNCH,   (rbit(0x8e89bed6) >> 16) & 0xffff);
 6043              		.loc 1 1531 0
 6044 0058 5148     		ldr	r0, .L299+4
 6045 005a FFF7FEFF 		bl	rbit
 6046 005e 0346     		mov	r3, r0
 6047 0060 1B0C     		lsrs	r3, r3, #16
 6048 0062 9BB2     		uxth	r3, r3
 6049 0064 2D20     		movs	r0, #45
 6050 0066 1946     		mov	r1, r3
 6051 0068 FFF7FEFF 		bl	cc2400_set
1532:bluetooth_rxtx.c **** 
1533:bluetooth_rxtx.c **** 
1534:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 6052              		.loc 1 1534 0
 6053 006c 00BF     		nop
 6054              	.L286:
 6055              		.loc 1 1534 0 is_stmt 0 discriminator 1
 6056 006e FFF7FEFF 		bl	cc2400_status
 6057 0072 0346     		mov	r3, r0
 6058 0074 03F04003 		and	r3, r3, #64
 6059 0078 002B     		cmp	r3, #0
 6060 007a F8D0     		beq	.L286
1535:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 6061              		.loc 1 1535 0 is_stmt 1
 6062 007c 00BF     		nop
 6063              	.L287:
 6064              		.loc 1 1535 0 is_stmt 0 discriminator 1
 6065 007e FFF7FEFF 		bl	cc2400_status
ARM GAS  /tmp/ccUeeWpa.s 			page 133


 6066 0082 0346     		mov	r3, r0
 6067 0084 03F00403 		and	r3, r3, #4
 6068 0088 002B     		cmp	r3, #0
 6069 008a F8D1     		bne	.L287
1536:bluetooth_rxtx.c **** 
1537:bluetooth_rxtx.c **** 	cc2400_set(FSDIV, channel - 1);
 6070              		.loc 1 1537 0 is_stmt 1
 6071 008c 454B     		ldr	r3, .L299+8
 6072 008e 1B88     		ldrh	r3, [r3]	@ movhi
 6073 0090 9BB2     		uxth	r3, r3
 6074 0092 013B     		subs	r3, r3, #1
 6075 0094 9BB2     		uxth	r3, r3
 6076 0096 0220     		movs	r0, #2
 6077 0098 1946     		mov	r1, r3
 6078 009a FFF7FEFF 		bl	cc2400_set
1538:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 6079              		.loc 1 1538 0
 6080 009e 6120     		movs	r0, #97
 6081 00a0 FFF7FEFF 		bl	cc2400_strobe
1539:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 6082              		.loc 1 1539 0
 6083 00a4 00BF     		nop
 6084              	.L288:
 6085              		.loc 1 1539 0 is_stmt 0 discriminator 1
 6086 00a6 FFF7FEFF 		bl	cc2400_status
 6087 00aa 0346     		mov	r3, r0
 6088 00ac 03F00403 		and	r3, r3, #4
 6089 00b0 002B     		cmp	r3, #0
 6090 00b2 F8D0     		beq	.L288
1540:bluetooth_rxtx.c **** 
1541:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 6091              		.loc 1 1541 0 is_stmt 1
 6092 00b4 6220     		movs	r0, #98
 6093 00b6 FFF7FEFF 		bl	cc2400_strobe
1542:bluetooth_rxtx.c **** 
1543:bluetooth_rxtx.c **** //	u32 j = 250; while (--j);
1544:bluetooth_rxtx.c **** 
1545:bluetooth_rxtx.c **** 	while (requested_mode == MODE_RX_SYMBOLS) {
 6094              		.loc 1 1545 0
 6095 00ba 61E0     		b	.L289
 6096              	.L298:
 6097              	.LBB3:
1546:bluetooth_rxtx.c **** 
1547:bluetooth_rxtx.c **** 		while (!(cc2400_status() & SYNC_RECEIVED));
 6098              		.loc 1 1547 0
 6099 00bc 00BF     		nop
 6100              	.L290:
 6101              		.loc 1 1547 0 is_stmt 0 discriminator 1
 6102 00be FFF7FEFF 		bl	cc2400_status
 6103 00c2 0346     		mov	r3, r0
 6104 00c4 03F01003 		and	r3, r3, #16
 6105 00c8 002B     		cmp	r3, #0
 6106 00ca F8D0     		beq	.L290
1548:bluetooth_rxtx.c **** 		int out;
1549:bluetooth_rxtx.c **** 		u8 rssi = cc2400_get(RSSI) >> 8;
 6107              		.loc 1 1549 0 is_stmt 1
 6108 00cc 0620     		movs	r0, #6
ARM GAS  /tmp/ccUeeWpa.s 			page 134


 6109 00ce FFF7FEFF 		bl	cc2400_get
 6110 00d2 0346     		mov	r3, r0
 6111 00d4 1B0A     		lsrs	r3, r3, #8
 6112 00d6 9BB2     		uxth	r3, r3
 6113 00d8 87F83A30 		strb	r3, [r7, #58]
1550:bluetooth_rxtx.c **** 		if (rssi >= 128)
 6114              		.loc 1 1550 0
 6115 00dc 97F83A30 		ldrb	r3, [r7, #58]	@ zero_extendqisi2
 6116 00e0 5BB2     		sxtb	r3, r3
 6117 00e2 002B     		cmp	r3, #0
 6118 00e4 05DA     		bge	.L291
1551:bluetooth_rxtx.c **** 			out = rssi - 256;
 6119              		.loc 1 1551 0
 6120 00e6 97F83A30 		ldrb	r3, [r7, #58]	@ zero_extendqisi2
 6121 00ea A3F58073 		sub	r3, r3, #256
 6122 00ee 7B63     		str	r3, [r7, #52]
 6123 00f0 02E0     		b	.L292
 6124              	.L291:
1552:bluetooth_rxtx.c **** 		else
1553:bluetooth_rxtx.c **** 			out = rssi;
 6125              		.loc 1 1553 0
 6126 00f2 97F83A30 		ldrb	r3, [r7, #58]	@ zero_extendqisi2
 6127 00f6 7B63     		str	r3, [r7, #52]
 6128              	.L292:
1554:bluetooth_rxtx.c **** //		if (out > -15)
1555:bluetooth_rxtx.c **** 		{
1556:bluetooth_rxtx.c **** 			RXLED_SET;
 6129              		.loc 1 1556 0
 6130 00f8 2B4B     		ldr	r3, .L299+12
 6131 00fa 1022     		movs	r2, #16
 6132 00fc 1A60     		str	r2, [r3]
 6133              	.LBB4:
1557:bluetooth_rxtx.c **** 			for (int i = 0; i < 50; i++)
 6134              		.loc 1 1557 0
 6135 00fe 0023     		movs	r3, #0
 6136 0100 FB63     		str	r3, [r7, #60]
 6137 0102 0CE0     		b	.L293
 6138              	.L294:
1558:bluetooth_rxtx.c **** 			{
1559:bluetooth_rxtx.c **** 		/* give the CC2400 time to acquire RSSI reading */
1560:bluetooth_rxtx.c **** 	//		volatile u32 j = 500; while (--j); //FIXME crude delay
1561:bluetooth_rxtx.c **** 				buf[i] = cc2400_get_rev(RSSI);
 6139              		.loc 1 1561 0 discriminator 3
 6140 0104 0620     		movs	r0, #6
 6141 0106 FFF7FEFF 		bl	cc2400_get_rev
 6142 010a 0346     		mov	r3, r0
 6143 010c 1946     		mov	r1, r3
 6144 010e 3A46     		mov	r2, r7
 6145 0110 FB6B     		ldr	r3, [r7, #60]
 6146 0112 1344     		add	r3, r3, r2
 6147 0114 0A46     		mov	r2, r1
 6148 0116 1A70     		strb	r2, [r3]
1557:bluetooth_rxtx.c **** 			for (int i = 0; i < 50; i++)
 6149              		.loc 1 1557 0 discriminator 3
 6150 0118 FB6B     		ldr	r3, [r7, #60]
 6151 011a 0133     		adds	r3, r3, #1
 6152 011c FB63     		str	r3, [r7, #60]
ARM GAS  /tmp/ccUeeWpa.s 			page 135


 6153              	.L293:
1557:bluetooth_rxtx.c **** 			for (int i = 0; i < 50; i++)
 6154              		.loc 1 1557 0 is_stmt 0 discriminator 1
 6155 011e FB6B     		ldr	r3, [r7, #60]
 6156 0120 312B     		cmp	r3, #49
 6157 0122 EFDD     		ble	.L294
 6158              	.LBE4:
1562:bluetooth_rxtx.c **** 			}
1563:bluetooth_rxtx.c **** 
1564:bluetooth_rxtx.c **** 			enqueue (RSSI_PACKET, buf);
 6159              		.loc 1 1564 0 is_stmt 1
 6160 0124 3B46     		mov	r3, r7
 6161 0126 0820     		movs	r0, #8
 6162 0128 1946     		mov	r1, r3
 6163 012a FFF7FEFF 		bl	enqueue
1565:bluetooth_rxtx.c **** 
1566:bluetooth_rxtx.c **** 			handle_usb(clkn);
 6164              		.loc 1 1566 0
 6165 012e 1F4B     		ldr	r3, .L299+16
 6166 0130 1B68     		ldr	r3, [r3]
 6167 0132 1846     		mov	r0, r3
 6168 0134 FFF7FEFF 		bl	handle_usb
1567:bluetooth_rxtx.c **** //		msleep (500);
1568:bluetooth_rxtx.c **** 
1569:bluetooth_rxtx.c **** //		u32 j = 10000; while (j--);
1570:bluetooth_rxtx.c **** 
1571:bluetooth_rxtx.c **** 		
1572:bluetooth_rxtx.c **** 			RXLED_CLR;
 6169              		.loc 1 1572 0
 6170 0138 1D4B     		ldr	r3, .L299+20
 6171 013a 1022     		movs	r2, #16
 6172 013c 1A60     		str	r2, [r3]
1573:bluetooth_rxtx.c **** 		}
1574:bluetooth_rxtx.c **** 		cc2400_strobe (SRFOFF);
 6173              		.loc 1 1574 0
 6174 013e 6420     		movs	r0, #100
 6175 0140 FFF7FEFF 		bl	cc2400_strobe
1575:bluetooth_rxtx.c **** 		while ((cc2400_status () & FS_LOCK));
 6176              		.loc 1 1575 0
 6177 0144 00BF     		nop
 6178              	.L295:
 6179              		.loc 1 1575 0 is_stmt 0 discriminator 1
 6180 0146 FFF7FEFF 		bl	cc2400_status
 6181 014a 0346     		mov	r3, r0
 6182 014c 03F00403 		and	r3, r3, #4
 6183 0150 002B     		cmp	r3, #0
 6184 0152 F8D1     		bne	.L295
1576:bluetooth_rxtx.c **** 		
1577:bluetooth_rxtx.c **** //		cc2400_reset ();
1578:bluetooth_rxtx.c **** 	
1579:bluetooth_rxtx.c **** /*		cc2400_set (MANAND, 0x7fff);
1580:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
1581:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG
1582:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0761); // un-buffered mode, GFSK
1583:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040); // 160 kHz frequency deviation
1584:bluetooth_rxtx.c **** 	
1585:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, 0xf9ae);
ARM GAS  /tmp/ccUeeWpa.s 			page 136


1586:bluetooth_rxtx.c **** 		cc2400_set(SYNCL, 0x1584);
1587:bluetooth_rxtx.c **** */
1588:bluetooth_rxtx.c **** 
1589:bluetooth_rxtx.c **** 		while (!(cc2400_status () & XOSC16M_STABLE));
 6185              		.loc 1 1589 0 is_stmt 1
 6186 0154 00BF     		nop
 6187              	.L296:
 6188              		.loc 1 1589 0 is_stmt 0 discriminator 1
 6189 0156 FFF7FEFF 		bl	cc2400_status
 6190 015a 0346     		mov	r3, r0
 6191 015c 03F04003 		and	r3, r3, #64
 6192 0160 002B     		cmp	r3, #0
 6193 0162 F8D0     		beq	.L296
1590:bluetooth_rxtx.c **** 		cc2400_strobe (SFSON);
 6194              		.loc 1 1590 0 is_stmt 1
 6195 0164 6120     		movs	r0, #97
 6196 0166 FFF7FEFF 		bl	cc2400_strobe
1591:bluetooth_rxtx.c **** 		while (!(cc2400_status () & FS_LOCK));
 6197              		.loc 1 1591 0
 6198 016a 00BF     		nop
 6199              	.L297:
 6200              		.loc 1 1591 0 is_stmt 0 discriminator 1
 6201 016c FFF7FEFF 		bl	cc2400_status
 6202 0170 0346     		mov	r3, r0
 6203 0172 03F00403 		and	r3, r3, #4
 6204 0176 002B     		cmp	r3, #0
 6205 0178 F8D0     		beq	.L297
1592:bluetooth_rxtx.c **** 	
1593:bluetooth_rxtx.c **** 	//	PAEN_SET;
1594:bluetooth_rxtx.c **** 		
1595:bluetooth_rxtx.c **** //	 	u32 k = 100; while (k--);
1596:bluetooth_rxtx.c **** 		cc2400_strobe (SRX);
 6206              		.loc 1 1596 0 is_stmt 1
 6207 017a 6220     		movs	r0, #98
 6208 017c FFF7FEFF 		bl	cc2400_strobe
 6209              	.L289:
 6210              	.LBE3:
1545:bluetooth_rxtx.c **** 
 6211              		.loc 1 1545 0
 6212 0180 0C4B     		ldr	r3, .L299+24
 6213 0182 1B78     		ldrb	r3, [r3]
 6214 0184 DBB2     		uxtb	r3, r3
 6215 0186 012B     		cmp	r3, #1
 6216 0188 98D0     		beq	.L298
1597:bluetooth_rxtx.c **** //		HGM_SET;
1598:bluetooth_rxtx.c **** 		
1599:bluetooth_rxtx.c **** 
1600:bluetooth_rxtx.c **** 	}
1601:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 6217              		.loc 1 1601 0
 6218 018a 0B4B     		ldr	r3, .L299+28
 6219 018c 0022     		movs	r2, #0
 6220 018e 1A70     		strb	r2, [r3]
1602:bluetooth_rxtx.c **** 	RXLED_CLR;
 6221              		.loc 1 1602 0
 6222 0190 074B     		ldr	r3, .L299+20
 6223 0192 1022     		movs	r2, #16
ARM GAS  /tmp/ccUeeWpa.s 			page 137


 6224 0194 1A60     		str	r2, [r3]
1603:bluetooth_rxtx.c **** }
 6225              		.loc 1 1603 0
 6226 0196 4037     		adds	r7, r7, #64
 6227              		.cfi_def_cfa_offset 8
 6228 0198 BD46     		mov	sp, r7
 6229              		.cfi_def_cfa_register 13
 6230              		@ sp needed
 6231 019a 80BD     		pop	{r7, pc}
 6232              	.L300:
 6233              		.align	2
 6234              	.L299:
 6235 019c 58C00920 		.word	537509976
 6236 01a0 D6BE898E 		.word	-1903575338
 6237 01a4 00000000 		.word	channel
 6238 01a8 38C00920 		.word	537509944
 6239 01ac 00000000 		.word	clkn
 6240 01b0 3CC00920 		.word	537509948
 6241 01b4 00000000 		.word	requested_mode
 6242 01b8 00000000 		.word	mode
 6243              		.cfi_endproc
 6244              	.LFE28:
 6246              		.section	.text.le_set_access_address,"ax",%progbits
 6247              		.align	2
 6248              		.thumb
 6249              		.thumb_func
 6251              	le_set_access_address:
 6252              	.LFB29:
1604:bluetooth_rxtx.c **** 
1605:bluetooth_rxtx.c **** /* set LE access address */
1606:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa) {
 6253              		.loc 1 1606 0
 6254              		.cfi_startproc
 6255              		@ args = 0, pretend = 0, frame = 16
 6256              		@ frame_needed = 1, uses_anonymous_args = 0
 6257 0000 80B5     		push	{r7, lr}
 6258              		.cfi_def_cfa_offset 8
 6259              		.cfi_offset 7, -8
 6260              		.cfi_offset 14, -4
 6261 0002 84B0     		sub	sp, sp, #16
 6262              		.cfi_def_cfa_offset 24
 6263 0004 00AF     		add	r7, sp, #0
 6264              		.cfi_def_cfa_register 7
 6265 0006 7860     		str	r0, [r7, #4]
1607:bluetooth_rxtx.c **** 	u32 aa_rev;
1608:bluetooth_rxtx.c **** 
1609:bluetooth_rxtx.c **** 	le.access_address = aa;
 6266              		.loc 1 1609 0
 6267 0008 094A     		ldr	r2, .L302
 6268 000a 7B68     		ldr	r3, [r7, #4]
 6269 000c 1360     		str	r3, [r2]
1610:bluetooth_rxtx.c **** 	aa_rev = rbit(aa);
 6270              		.loc 1 1610 0
 6271 000e 7868     		ldr	r0, [r7, #4]
 6272 0010 FFF7FEFF 		bl	rbit
 6273 0014 F860     		str	r0, [r7, #12]
1611:bluetooth_rxtx.c **** 	le.syncl = aa_rev & 0xffff;
ARM GAS  /tmp/ccUeeWpa.s 			page 138


 6274              		.loc 1 1611 0
 6275 0016 FB68     		ldr	r3, [r7, #12]
 6276 0018 9AB2     		uxth	r2, r3
 6277 001a 054B     		ldr	r3, .L302
 6278 001c DA80     		strh	r2, [r3, #6]	@ movhi
1612:bluetooth_rxtx.c **** 	le.synch = aa_rev >> 16;
 6279              		.loc 1 1612 0
 6280 001e FB68     		ldr	r3, [r7, #12]
 6281 0020 1B0C     		lsrs	r3, r3, #16
 6282 0022 9AB2     		uxth	r2, r3
 6283 0024 024B     		ldr	r3, .L302
 6284 0026 9A80     		strh	r2, [r3, #4]	@ movhi
1613:bluetooth_rxtx.c **** }
 6285              		.loc 1 1613 0
 6286 0028 1037     		adds	r7, r7, #16
 6287              		.cfi_def_cfa_offset 8
 6288 002a BD46     		mov	sp, r7
 6289              		.cfi_def_cfa_register 13
 6290              		@ sp needed
 6291 002c 80BD     		pop	{r7, pc}
 6292              	.L303:
 6293 002e 00BF     		.align	2
 6294              	.L302:
 6295 0030 00000000 		.word	le
 6296              		.cfi_endproc
 6297              	.LFE29:
 6299              		.section	.text.reset_le,"ax",%progbits
 6300              		.align	2
 6301              		.global	reset_le
 6302              		.thumb
 6303              		.thumb_func
 6305              	reset_le:
 6306              	.LFB30:
1614:bluetooth_rxtx.c **** 
1615:bluetooth_rxtx.c **** /* reset le state, called by bt_generic_le and bt_follow_le() */
1616:bluetooth_rxtx.c **** void reset_le() {
 6307              		.loc 1 1616 0
 6308              		.cfi_startproc
 6309              		@ args = 0, pretend = 0, frame = 0
 6310              		@ frame_needed = 1, uses_anonymous_args = 0
 6311 0000 80B5     		push	{r7, lr}
 6312              		.cfi_def_cfa_offset 8
 6313              		.cfi_offset 7, -8
 6314              		.cfi_offset 14, -4
 6315 0002 00AF     		add	r7, sp, #0
 6316              		.cfi_def_cfa_register 7
1617:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
 6317              		.loc 1 1617 0
 6318 0004 1F48     		ldr	r0, .L305
 6319 0006 FFF7FEFF 		bl	le_set_access_address
1618:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;	       // advertising channel CRCInit
 6320              		.loc 1 1618 0
 6321 000a 1F4B     		ldr	r3, .L305+4
 6322 000c 1F4A     		ldr	r2, .L305+8
 6323 000e 9A60     		str	r2, [r3, #8]
1619:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
 6324              		.loc 1 1619 0
ARM GAS  /tmp/ccUeeWpa.s 			page 139


 6325 0010 1D4B     		ldr	r3, .L305+4
 6326 0012 1F4A     		ldr	r2, .L305+12
 6327 0014 DA60     		str	r2, [r3, #12]
1620:bluetooth_rxtx.c **** 	le.crc_verify = 1;
 6328              		.loc 1 1620 0
 6329 0016 1C4B     		ldr	r3, .L305+4
 6330 0018 0122     		movs	r2, #1
 6331 001a 1A61     		str	r2, [r3, #16]
1621:bluetooth_rxtx.c **** 	le.last_packet = 0;
 6332              		.loc 1 1621 0
 6333 001c 1A4B     		ldr	r3, .L305+4
 6334 001e 0022     		movs	r2, #0
 6335 0020 1A64     		str	r2, [r3, #64]
1622:bluetooth_rxtx.c **** 
1623:bluetooth_rxtx.c **** 	le.link_state = LINK_INACTIVE;
 6336              		.loc 1 1623 0
 6337 0022 194B     		ldr	r3, .L305+4
 6338 0024 0022     		movs	r2, #0
 6339 0026 1A75     		strb	r2, [r3, #20]
1624:bluetooth_rxtx.c **** 
1625:bluetooth_rxtx.c **** 	le.channel_idx = 0;
 6340              		.loc 1 1625 0
 6341 0028 174B     		ldr	r3, .L305+4
 6342 002a 0022     		movs	r2, #0
 6343 002c 5A75     		strb	r2, [r3, #21]
1626:bluetooth_rxtx.c **** 	le.channel_increment = 0;
 6344              		.loc 1 1626 0
 6345 002e 164B     		ldr	r3, .L305+4
 6346 0030 0022     		movs	r2, #0
 6347 0032 9A75     		strb	r2, [r3, #22]
1627:bluetooth_rxtx.c **** 
1628:bluetooth_rxtx.c **** 	le.conn_epoch = 0;
 6348              		.loc 1 1628 0
 6349 0034 144B     		ldr	r3, .L305+4
 6350 0036 0022     		movs	r2, #0
 6351 0038 9A61     		str	r2, [r3, #24]
1629:bluetooth_rxtx.c **** 	le.interval_timer = 0;
 6352              		.loc 1 1629 0
 6353 003a 134B     		ldr	r3, .L305+4
 6354 003c 0022     		movs	r2, #0
 6355 003e 9A83     		strh	r2, [r3, #28]	@ movhi
1630:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 6356              		.loc 1 1630 0
 6357 0040 114B     		ldr	r3, .L305+4
 6358 0042 0022     		movs	r2, #0
 6359 0044 DA83     		strh	r2, [r3, #30]	@ movhi
1631:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 6360              		.loc 1 1631 0
 6361 0046 104B     		ldr	r3, .L305+4
 6362 0048 0022     		movs	r2, #0
 6363 004a DA83     		strh	r2, [r3, #30]	@ movhi
1632:bluetooth_rxtx.c **** 	le.conn_count = 0;
 6364              		.loc 1 1632 0
 6365 004c 0E4B     		ldr	r3, .L305+4
 6366 004e 0022     		movs	r2, #0
 6367 0050 1A84     		strh	r2, [r3, #32]	@ movhi
1633:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccUeeWpa.s 			page 140


1634:bluetooth_rxtx.c **** 	le.win_size = 0;
 6368              		.loc 1 1634 0
 6369 0052 0D4B     		ldr	r3, .L305+4
 6370 0054 0022     		movs	r2, #0
 6371 0056 83F82220 		strb	r2, [r3, #34]
1635:bluetooth_rxtx.c **** 	le.win_offset = 0;
 6372              		.loc 1 1635 0
 6373 005a 0B4B     		ldr	r3, .L305+4
 6374 005c 0022     		movs	r2, #0
 6375 005e 9A84     		strh	r2, [r3, #36]	@ movhi
1636:bluetooth_rxtx.c **** 
1637:bluetooth_rxtx.c **** 	le.update_pending = 0;
 6376              		.loc 1 1637 0
 6377 0060 094B     		ldr	r3, .L305+4
 6378 0062 0022     		movs	r2, #0
 6379 0064 9A62     		str	r2, [r3, #40]
1638:bluetooth_rxtx.c **** 	le.update_instant = 0;
 6380              		.loc 1 1638 0
 6381 0066 084B     		ldr	r3, .L305+4
 6382 0068 0022     		movs	r2, #0
 6383 006a 9A85     		strh	r2, [r3, #44]	@ movhi
1639:bluetooth_rxtx.c **** 	le.interval_update = 0;
 6384              		.loc 1 1639 0
 6385 006c 064B     		ldr	r3, .L305+4
 6386 006e 0022     		movs	r2, #0
 6387 0070 DA85     		strh	r2, [r3, #46]	@ movhi
1640:bluetooth_rxtx.c **** 	le.win_size_update = 0;
 6388              		.loc 1 1640 0
 6389 0072 054B     		ldr	r3, .L305+4
 6390 0074 0022     		movs	r2, #0
 6391 0076 83F83020 		strb	r2, [r3, #48]
1641:bluetooth_rxtx.c **** 	le.win_offset_update;
1642:bluetooth_rxtx.c **** 
1643:bluetooth_rxtx.c **** 	do_hop = 0;
 6392              		.loc 1 1643 0
 6393 007a 064B     		ldr	r3, .L305+16
 6394 007c 0022     		movs	r2, #0
 6395 007e 1A70     		strb	r2, [r3]
1644:bluetooth_rxtx.c **** }
 6396              		.loc 1 1644 0
 6397 0080 80BD     		pop	{r7, pc}
 6398              	.L306:
 6399 0082 00BF     		.align	2
 6400              	.L305:
 6401 0084 D6BE898E 		.word	-1903575338
 6402 0088 00000000 		.word	le
 6403 008c 55555500 		.word	5592405
 6404 0090 AAAAAA00 		.word	11184810
 6405 0094 00000000 		.word	do_hop
 6406              		.cfi_endproc
 6407              	.LFE30:
 6409              		.section	.text.reset_le_promisc,"ax",%progbits
 6410              		.align	2
 6411              		.global	reset_le_promisc
 6412              		.thumb
 6413              		.thumb_func
 6415              	reset_le_promisc:
ARM GAS  /tmp/ccUeeWpa.s 			page 141


 6416              	.LFB31:
1645:bluetooth_rxtx.c **** 
1646:bluetooth_rxtx.c **** // reset LE Promisc state
1647:bluetooth_rxtx.c **** void reset_le_promisc(void) {
 6417              		.loc 1 1647 0
 6418              		.cfi_startproc
 6419              		@ args = 0, pretend = 0, frame = 0
 6420              		@ frame_needed = 1, uses_anonymous_args = 0
 6421 0000 80B5     		push	{r7, lr}
 6422              		.cfi_def_cfa_offset 8
 6423              		.cfi_offset 7, -8
 6424              		.cfi_offset 14, -4
 6425 0002 00AF     		add	r7, sp, #0
 6426              		.cfi_def_cfa_register 7
1648:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
 6427              		.loc 1 1648 0
 6428 0004 0548     		ldr	r0, .L308
 6429 0006 0021     		movs	r1, #0
 6430 0008 4FF48472 		mov	r2, #264
 6431 000c FFF7FEFF 		bl	memset
1649:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
 6432              		.loc 1 1649 0
 6433 0010 024B     		ldr	r3, .L308
 6434 0012 4FF0FF32 		mov	r2, #-1
 6435 0016 C3F80021 		str	r2, [r3, #256]
1650:bluetooth_rxtx.c **** }
 6436              		.loc 1 1650 0
 6437 001a 80BD     		pop	{r7, pc}
 6438              	.L309:
 6439              		.align	2
 6440              	.L308:
 6441 001c 00000000 		.word	le_promisc
 6442              		.cfi_endproc
 6443              	.LFE31:
 6445              		.section	.text.bt_generic_le,"ax",%progbits
 6446              		.align	2
 6447              		.global	bt_generic_le
 6448              		.thumb
 6449              		.thumb_func
 6451              	bt_generic_le:
 6452              	.LFB32:
1651:bluetooth_rxtx.c **** 
1652:bluetooth_rxtx.c **** /* generic le mode */
1653:bluetooth_rxtx.c **** void bt_generic_le(u8 active_mode)
1654:bluetooth_rxtx.c **** {
 6453              		.loc 1 1654 0
 6454              		.cfi_startproc
 6455              		@ args = 0, pretend = 0, frame = 32
 6456              		@ frame_needed = 1, uses_anonymous_args = 0
 6457 0000 80B5     		push	{r7, lr}
 6458              		.cfi_def_cfa_offset 8
 6459              		.cfi_offset 7, -8
 6460              		.cfi_offset 14, -4
 6461 0002 88B0     		sub	sp, sp, #32
 6462              		.cfi_def_cfa_offset 40
 6463 0004 00AF     		add	r7, sp, #0
 6464              		.cfi_def_cfa_register 7
ARM GAS  /tmp/ccUeeWpa.s 			page 142


 6465 0006 0346     		mov	r3, r0
 6466 0008 FB71     		strb	r3, [r7, #7]
1655:bluetooth_rxtx.c **** 	u8 *tmp = NULL;
 6467              		.loc 1 1655 0
 6468 000a 0023     		movs	r3, #0
 6469 000c FB60     		str	r3, [r7, #12]
1656:bluetooth_rxtx.c **** 	u8 hold;
1657:bluetooth_rxtx.c **** 	int i, j;
1658:bluetooth_rxtx.c **** 	int8_t rssi, rssi_at_trigger;
1659:bluetooth_rxtx.c **** 
1660:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
 6470              		.loc 1 1660 0
 6471 000e A44B     		ldr	r3, .L338
 6472 0010 0122     		movs	r2, #1
 6473 0012 1A70     		strb	r2, [r3]
1661:bluetooth_rxtx.c **** 	mode = active_mode;
 6474              		.loc 1 1661 0
 6475 0014 A34A     		ldr	r2, .L338+4
 6476 0016 FB79     		ldrb	r3, [r7, #7]
 6477 0018 1370     		strb	r3, [r2]
1662:bluetooth_rxtx.c **** 
1663:bluetooth_rxtx.c **** 	reset_le();
 6478              		.loc 1 1663 0
 6479 001a FFF7FEFF 		bl	reset_le
1664:bluetooth_rxtx.c **** 
1665:bluetooth_rxtx.c **** 	// enable USB interrupts
1666:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
 6480              		.loc 1 1666 0
 6481 001e A24B     		ldr	r3, .L338+8
 6482 0020 4FF08072 		mov	r2, #16777216
 6483 0024 1A60     		str	r2, [r3]
1667:bluetooth_rxtx.c **** 
1668:bluetooth_rxtx.c **** 	RXLED_CLR;
 6484              		.loc 1 1668 0
 6485 0026 A14B     		ldr	r3, .L338+12
 6486 0028 1022     		movs	r2, #16
 6487 002a 1A60     		str	r2, [r3]
1669:bluetooth_rxtx.c **** 
1670:bluetooth_rxtx.c **** 	queue_init();
 6488              		.loc 1 1670 0
 6489 002c FFF7FEFF 		bl	queue_init
1671:bluetooth_rxtx.c **** 	dio_ssp_init();
 6490              		.loc 1 1671 0
 6491 0030 FFF7FEFF 		bl	dio_ssp_init
1672:bluetooth_rxtx.c **** 	dma_init();
 6492              		.loc 1 1672 0
 6493 0034 FFF7FEFF 		bl	dma_init
1673:bluetooth_rxtx.c **** 	dio_ssp_start();
 6494              		.loc 1 1673 0
 6495 0038 FFF7FEFF 		bl	dio_ssp_start
1674:bluetooth_rxtx.c **** 	cc2400_rx();
 6496              		.loc 1 1674 0
 6497 003c FFF7FEFF 		bl	cc2400_rx
1675:bluetooth_rxtx.c **** 
1676:bluetooth_rxtx.c **** 	cs_trigger_enable();
 6498              		.loc 1 1676 0
 6499 0040 FFF7FEFF 		bl	cs_trigger_enable
ARM GAS  /tmp/ccUeeWpa.s 			page 143


1677:bluetooth_rxtx.c **** 
1678:bluetooth_rxtx.c **** 	hold = 0;
 6500              		.loc 1 1678 0
 6501 0044 0023     		movs	r3, #0
 6502 0046 FB77     		strb	r3, [r7, #31]
1679:bluetooth_rxtx.c **** 
1680:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
 6503              		.loc 1 1680 0
 6504 0048 15E1     		b	.L311
 6505              	.L337:
 6506              	.LBB5:
1681:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 6507              		.loc 1 1681 0
 6508 004a 994B     		ldr	r3, .L338+16
 6509 004c 1B88     		ldrh	r3, [r3]	@ movhi
 6510 004e 9BB2     		uxth	r3, r3
 6511 0050 002B     		cmp	r3, #0
 6512 0052 24D0     		beq	.L312
1682:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 6513              		.loc 1 1682 0
 6514 0054 6420     		movs	r0, #100
 6515 0056 FFF7FEFF 		bl	cc2400_strobe
1683:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 6516              		.loc 1 1683 0
 6517 005a 00BF     		nop
 6518              	.L313:
 6519              		.loc 1 1683 0 is_stmt 0 discriminator 1
 6520 005c FFF7FEFF 		bl	cc2400_status
 6521 0060 0346     		mov	r3, r0
 6522 0062 03F00403 		and	r3, r3, #4
 6523 0066 002B     		cmp	r3, #0
 6524 0068 F8D1     		bne	.L313
1684:bluetooth_rxtx.c **** 
1685:bluetooth_rxtx.c **** 			/* Retune */
1686:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
 6525              		.loc 1 1686 0 is_stmt 1
 6526 006a 924B     		ldr	r3, .L338+20
 6527 006c 1B88     		ldrh	r3, [r3]	@ movhi
 6528 006e 9BB2     		uxth	r3, r3
 6529 0070 013B     		subs	r3, r3, #1
 6530 0072 9BB2     		uxth	r3, r3
 6531 0074 0220     		movs	r0, #2
 6532 0076 1946     		mov	r1, r3
 6533 0078 FFF7FEFF 		bl	cc2400_set
1687:bluetooth_rxtx.c **** 
1688:bluetooth_rxtx.c **** 			/* Wait for lock */
1689:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 6534              		.loc 1 1689 0
 6535 007c 6120     		movs	r0, #97
 6536 007e FFF7FEFF 		bl	cc2400_strobe
1690:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 6537              		.loc 1 1690 0
 6538 0082 00BF     		nop
 6539              	.L314:
 6540              		.loc 1 1690 0 is_stmt 0 discriminator 1
 6541 0084 FFF7FEFF 		bl	cc2400_status
 6542 0088 0346     		mov	r3, r0
ARM GAS  /tmp/ccUeeWpa.s 			page 144


 6543 008a 03F00403 		and	r3, r3, #4
 6544 008e 002B     		cmp	r3, #0
 6545 0090 F8D0     		beq	.L314
1691:bluetooth_rxtx.c **** 
1692:bluetooth_rxtx.c **** 			/* RX mode */
1693:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 6546              		.loc 1 1693 0 is_stmt 1
 6547 0092 6220     		movs	r0, #98
 6548 0094 FFF7FEFF 		bl	cc2400_strobe
1694:bluetooth_rxtx.c **** 
1695:bluetooth_rxtx.c **** 			requested_channel = 0;
 6549              		.loc 1 1695 0
 6550 0098 854B     		ldr	r3, .L338+16
 6551 009a 0022     		movs	r2, #0
 6552 009c 1A80     		strh	r2, [r3]	@ movhi
 6553              	.L312:
1696:bluetooth_rxtx.c **** 		}
1697:bluetooth_rxtx.c **** 
1698:bluetooth_rxtx.c **** 		if (do_hop) {
 6554              		.loc 1 1698 0
 6555 009e 864B     		ldr	r3, .L338+24
 6556 00a0 1B78     		ldrb	r3, [r3]
 6557 00a2 DBB2     		uxtb	r3, r3
 6558 00a4 002B     		cmp	r3, #0
 6559 00a6 02D0     		beq	.L315
1699:bluetooth_rxtx.c **** 			hop();
 6560              		.loc 1 1699 0
 6561 00a8 FFF7FEFF 		bl	hop
 6562 00ac 03E0     		b	.L316
 6563              	.L315:
1700:bluetooth_rxtx.c **** 		} else {
1701:bluetooth_rxtx.c **** 			TXLED_CLR;
 6564              		.loc 1 1701 0
 6565 00ae 7F4B     		ldr	r3, .L338+12
 6566 00b0 4FF48072 		mov	r2, #256
 6567 00b4 1A60     		str	r2, [r3]
 6568              	.L316:
1702:bluetooth_rxtx.c **** 		}
1703:bluetooth_rxtx.c **** 
1704:bluetooth_rxtx.c **** 		RXLED_CLR;
 6569              		.loc 1 1704 0
 6570 00b6 7D4B     		ldr	r3, .L338+12
 6571 00b8 1022     		movs	r2, #16
 6572 00ba 1A60     		str	r2, [r3]
1705:bluetooth_rxtx.c **** 
1706:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1707:bluetooth_rxtx.c **** 		rssi_reset();
 6573              		.loc 1 1707 0
 6574 00bc FFF7FEFF 		bl	rssi_reset
1708:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 6575              		.loc 1 1708 0
 6576 00c0 8023     		movs	r3, #128
 6577 00c2 BB74     		strb	r3, [r7, #18]
1709:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
 6578              		.loc 1 1709 0
 6579 00c4 22E0     		b	.L317
 6580              	.L320:
ARM GAS  /tmp/ccUeeWpa.s 			page 145


1710:bluetooth_rxtx.c **** 		{
1711:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 6581              		.loc 1 1711 0
 6582 00c6 0620     		movs	r0, #6
 6583 00c8 FFF7FEFF 		bl	cc2400_get
 6584 00cc 0346     		mov	r3, r0
 6585 00ce 1B0A     		lsrs	r3, r3, #8
 6586 00d0 9BB2     		uxth	r3, r3
 6587 00d2 FB74     		strb	r3, [r7, #19]
1712:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 6588              		.loc 1 1712 0
 6589 00d4 794B     		ldr	r3, .L338+28
 6590 00d6 1B78     		ldrb	r3, [r3]
 6591 00d8 DBB2     		uxtb	r3, r3
 6592 00da 002B     		cmp	r3, #0
 6593 00dc 11D0     		beq	.L318
 6594              		.loc 1 1712 0 is_stmt 0 discriminator 1
 6595 00de 97F91230 		ldrsb	r3, [r7, #18]
 6596 00e2 13F1800F 		cmn	r3, #128
 6597 00e6 0CD1     		bne	.L318
1713:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 6598              		.loc 1 1713 0 is_stmt 1
 6599 00e8 754B     		ldr	r3, .L338+32
 6600 00ea 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 6601 00ec 5BB2     		sxtb	r3, r3
 6602 00ee 03F13602 		add	r2, r3, #54
 6603 00f2 97F91330 		ldrsb	r3, [r7, #19]
 6604 00f6 9342     		cmp	r3, r2
 6605 00f8 B8BF     		it	lt
 6606 00fa 1346     		movlt	r3, r2
 6607 00fc FB74     		strb	r3, [r7, #19]
1714:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 6608              		.loc 1 1714 0
 6609 00fe FB7C     		ldrb	r3, [r7, #19]
 6610 0100 BB74     		strb	r3, [r7, #18]
 6611              	.L318:
1715:bluetooth_rxtx.c **** 			}
1716:bluetooth_rxtx.c **** 			rssi_add(rssi);
 6612              		.loc 1 1716 0
 6613 0102 97F91330 		ldrsb	r3, [r7, #19]
 6614 0106 1846     		mov	r0, r3
 6615 0108 FFF7FEFF 		bl	rssi_add
 6616              	.L317:
1709:bluetooth_rxtx.c **** 		{
 6617              		.loc 1 1709 0
 6618 010c 6D4B     		ldr	r3, .L338+36
 6619 010e 1B68     		ldr	r3, [r3]
 6620 0110 002B     		cmp	r3, #0
 6621 0112 03D1     		bne	.L319
1709:bluetooth_rxtx.c **** 		{
 6622              		.loc 1 1709 0 is_stmt 0 discriminator 1
 6623 0114 6C4B     		ldr	r3, .L338+40
 6624 0116 1B68     		ldr	r3, [r3]
 6625 0118 002B     		cmp	r3, #0
 6626 011a D4D0     		beq	.L320
 6627              	.L319:
1717:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccUeeWpa.s 			page 146


1718:bluetooth_rxtx.c **** 
1719:bluetooth_rxtx.c **** 		/* Keep buffer swapping in sync with DMA. */
1720:bluetooth_rxtx.c **** 		if (rx_tc % 2) {
 6628              		.loc 1 1720 0 is_stmt 1
 6629 011c 694B     		ldr	r3, .L338+36
 6630 011e 1B68     		ldr	r3, [r3]
 6631 0120 03F00103 		and	r3, r3, #1
 6632 0124 002B     		cmp	r3, #0
 6633 0126 09D0     		beq	.L321
1721:bluetooth_rxtx.c **** 			tmp = active_rxbuf;
 6634              		.loc 1 1721 0
 6635 0128 684B     		ldr	r3, .L338+44
 6636 012a 1B68     		ldr	r3, [r3]
 6637 012c FB60     		str	r3, [r7, #12]
1722:bluetooth_rxtx.c **** 			active_rxbuf = idle_rxbuf;
 6638              		.loc 1 1722 0
 6639 012e 684B     		ldr	r3, .L338+48
 6640 0130 1B68     		ldr	r3, [r3]
 6641 0132 664A     		ldr	r2, .L338+44
 6642 0134 1360     		str	r3, [r2]
1723:bluetooth_rxtx.c **** 			idle_rxbuf = tmp;
 6643              		.loc 1 1723 0
 6644 0136 664A     		ldr	r2, .L338+48
 6645 0138 FB68     		ldr	r3, [r7, #12]
 6646 013a 1360     		str	r3, [r2]
 6647              	.L321:
1724:bluetooth_rxtx.c **** 		}
1725:bluetooth_rxtx.c **** 
1726:bluetooth_rxtx.c **** 		if (rx_err) {
 6648              		.loc 1 1726 0
 6649 013c 624B     		ldr	r3, .L338+40
 6650 013e 1B68     		ldr	r3, [r3]
 6651 0140 002B     		cmp	r3, #0
 6652 0142 07D0     		beq	.L322
1727:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 6653              		.loc 1 1727 0
 6654 0144 634B     		ldr	r3, .L338+52
 6655 0146 1B78     		ldrb	r3, [r3]
 6656 0148 DBB2     		uxtb	r3, r3
 6657 014a 43F00203 		orr	r3, r3, #2
 6658 014e DAB2     		uxtb	r2, r3
 6659 0150 604B     		ldr	r3, .L338+52
 6660 0152 1A70     		strb	r2, [r3]
 6661              	.L322:
1728:bluetooth_rxtx.c **** 		}
1729:bluetooth_rxtx.c **** 
1730:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1731:bluetooth_rxtx.c **** 		if (!rx_tc)
 6662              		.loc 1 1731 0
 6663 0154 5B4B     		ldr	r3, .L338+36
 6664 0156 1B68     		ldr	r3, [r3]
 6665 0158 002B     		cmp	r3, #0
 6666 015a 00D1     		bne	.L323
1732:bluetooth_rxtx.c **** 			goto rx_continue;
 6667              		.loc 1 1732 0
 6668 015c 85E0     		b	.L324
 6669              	.L323:
ARM GAS  /tmp/ccUeeWpa.s 			page 147


1733:bluetooth_rxtx.c **** 
1734:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1735:bluetooth_rxtx.c **** 		if (rx_tc > 1)
 6670              		.loc 1 1735 0
 6671 015e 594B     		ldr	r3, .L338+36
 6672 0160 1B68     		ldr	r3, [r3]
 6673 0162 012B     		cmp	r3, #1
 6674 0164 07D9     		bls	.L325
1736:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 6675              		.loc 1 1736 0
 6676 0166 5B4B     		ldr	r3, .L338+52
 6677 0168 1B78     		ldrb	r3, [r3]
 6678 016a DBB2     		uxtb	r3, r3
 6679 016c 43F00103 		orr	r3, r3, #1
 6680 0170 DAB2     		uxtb	r2, r3
 6681 0172 584B     		ldr	r3, .L338+52
 6682 0174 1A70     		strb	r2, [r3]
 6683              	.L325:
1737:bluetooth_rxtx.c **** 
1738:bluetooth_rxtx.c **** 		rssi_iir_update();
 6684              		.loc 1 1738 0
 6685 0176 FFF7FEFF 		bl	rssi_iir_update
1739:bluetooth_rxtx.c **** 
1740:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1741:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1742:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1743:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1744:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
 6686              		.loc 1 1744 0
 6687 017a 504B     		ldr	r3, .L338+28
 6688 017c 1B78     		ldrb	r3, [r3]
 6689 017e DBB2     		uxtb	r3, r3
 6690 0180 002B     		cmp	r3, #0
 6691 0182 03D1     		bne	.L326
 6692              		.loc 1 1744 0 is_stmt 0 discriminator 1
 6693 0184 544B     		ldr	r3, .L338+56
 6694 0186 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 6695 0188 002B     		cmp	r3, #0
 6696 018a 0CD0     		beq	.L327
 6697              	.L326:
1745:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 6698              		.loc 1 1745 0 is_stmt 1
 6699 018c 514B     		ldr	r3, .L338+52
 6700 018e 1B78     		ldrb	r3, [r3]
 6701 0190 DBB2     		uxtb	r3, r3
 6702 0192 43F00803 		orr	r3, r3, #8
 6703 0196 DAB2     		uxtb	r2, r3
 6704 0198 4E4B     		ldr	r3, .L338+52
 6705 019a 1A70     		strb	r2, [r3]
1746:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 6706              		.loc 1 1746 0
 6707 019c 0223     		movs	r3, #2
 6708 019e FB77     		strb	r3, [r7, #31]
1747:bluetooth_rxtx.c **** 			cs_trigger = 0;
 6709              		.loc 1 1747 0
 6710 01a0 464B     		ldr	r3, .L338+28
 6711 01a2 0022     		movs	r2, #0
ARM GAS  /tmp/ccUeeWpa.s 			page 148


 6712 01a4 1A70     		strb	r2, [r3]
 6713              	.L327:
1748:bluetooth_rxtx.c **** 		}
1749:bluetooth_rxtx.c **** 
1750:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
 6714              		.loc 1 1750 0
 6715 01a6 4D4B     		ldr	r3, .L338+60
 6716 01a8 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 6717 01aa 5AB2     		sxtb	r2, r3
 6718 01ac 444B     		ldr	r3, .L338+32
 6719 01ae 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 6720 01b0 5BB2     		sxtb	r3, r3
 6721 01b2 3633     		adds	r3, r3, #54
 6722 01b4 9A42     		cmp	r2, r3
 6723 01b6 09DB     		blt	.L328
1751:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 6724              		.loc 1 1751 0
 6725 01b8 464B     		ldr	r3, .L338+52
 6726 01ba 1B78     		ldrb	r3, [r3]
 6727 01bc DBB2     		uxtb	r3, r3
 6728 01be 43F01003 		orr	r3, r3, #16
 6729 01c2 DAB2     		uxtb	r2, r3
 6730 01c4 434B     		ldr	r3, .L338+52
 6731 01c6 1A70     		strb	r2, [r3]
1752:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 6732              		.loc 1 1752 0
 6733 01c8 0223     		movs	r3, #2
 6734 01ca FB77     		strb	r3, [r7, #31]
 6735              	.L328:
1753:bluetooth_rxtx.c **** 		}
1754:bluetooth_rxtx.c **** 
1755:bluetooth_rxtx.c **** 		/* Send a packet once in a while (6.25 Hz) to keep
1756:bluetooth_rxtx.c **** 		 * host USB reads from timing out. */
1757:bluetooth_rxtx.c **** 		if (keepalive_trigger) {
 6736              		.loc 1 1757 0
 6737 01cc 444B     		ldr	r3, .L338+64
 6738 01ce 1B78     		ldrb	r3, [r3]
 6739 01d0 DBB2     		uxtb	r3, r3
 6740 01d2 002B     		cmp	r3, #0
 6741 01d4 07D0     		beq	.L329
1758:bluetooth_rxtx.c **** 			if (hold == 0)
 6742              		.loc 1 1758 0
 6743 01d6 FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 6744 01d8 002B     		cmp	r3, #0
 6745 01da 01D1     		bne	.L330
1759:bluetooth_rxtx.c **** 				hold = 1;
 6746              		.loc 1 1759 0
 6747 01dc 0123     		movs	r3, #1
 6748 01de FB77     		strb	r3, [r7, #31]
 6749              	.L330:
1760:bluetooth_rxtx.c **** 			keepalive_trigger = 0;
 6750              		.loc 1 1760 0
 6751 01e0 3F4B     		ldr	r3, .L338+64
 6752 01e2 0022     		movs	r2, #0
 6753 01e4 1A70     		strb	r2, [r3]
 6754              	.L329:
1761:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccUeeWpa.s 			page 149


1762:bluetooth_rxtx.c **** 
1763:bluetooth_rxtx.c **** 		/* Hold expired? Ignore data. */
1764:bluetooth_rxtx.c **** 		if (hold == 0) {
 6755              		.loc 1 1764 0
 6756 01e6 FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 6757 01e8 002B     		cmp	r3, #0
 6758 01ea 00D1     		bne	.L331
1765:bluetooth_rxtx.c **** 			goto rx_continue;
 6759              		.loc 1 1765 0
 6760 01ec 3DE0     		b	.L324
 6761              	.L331:
1766:bluetooth_rxtx.c **** 		}
1767:bluetooth_rxtx.c **** 		hold--;
 6762              		.loc 1 1767 0
 6763 01ee FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 6764 01f0 013B     		subs	r3, r3, #1
 6765 01f2 FB77     		strb	r3, [r7, #31]
1768:bluetooth_rxtx.c **** 
1769:bluetooth_rxtx.c **** 		// copy the previously unpacked symbols to the front of the buffer
1770:bluetooth_rxtx.c **** 		memcpy(unpacked, unpacked + DMA_SIZE*8, DMA_SIZE*8);
 6766              		.loc 1 1770 0
 6767 01f4 3B48     		ldr	r0, .L338+68
 6768 01f6 3C49     		ldr	r1, .L338+72
 6769 01f8 4FF4C872 		mov	r2, #400
 6770 01fc FFF7FEFF 		bl	memcpy
1771:bluetooth_rxtx.c **** 
1772:bluetooth_rxtx.c **** 		// unpack the new packet to the end of the buffer
1773:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; ++i) {
 6771              		.loc 1 1773 0
 6772 0200 0023     		movs	r3, #0
 6773 0202 BB61     		str	r3, [r7, #24]
 6774 0204 25E0     		b	.L332
 6775              	.L335:
1774:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
1775:bluetooth_rxtx.c **** 			for (j = 0; j < 8; ++j) {
 6776              		.loc 1 1775 0
 6777 0206 0023     		movs	r3, #0
 6778 0208 7B61     		str	r3, [r7, #20]
 6779 020a 1CE0     		b	.L333
 6780              	.L334:
1776:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 6781              		.loc 1 1776 0 discriminator 3
 6782 020c BB69     		ldr	r3, [r7, #24]
 6783 020e 3233     		adds	r3, r3, #50
 6784 0210 DA00     		lsls	r2, r3, #3
 6785 0212 7B69     		ldr	r3, [r7, #20]
 6786 0214 1344     		add	r3, r3, r2
 6787 0216 2E4A     		ldr	r2, .L338+48
 6788 0218 1168     		ldr	r1, [r2]
 6789 021a BA69     		ldr	r2, [r7, #24]
 6790 021c 0A44     		add	r2, r2, r1
 6791 021e 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 6792 0220 D209     		lsrs	r2, r2, #7
 6793 0222 D1B2     		uxtb	r1, r2
 6794 0224 2F4A     		ldr	r2, .L338+68
 6795 0226 D154     		strb	r1, [r2, r3]
1777:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
ARM GAS  /tmp/ccUeeWpa.s 			page 150


 6796              		.loc 1 1777 0 discriminator 3
 6797 0228 294B     		ldr	r3, .L338+48
 6798 022a 1A68     		ldr	r2, [r3]
 6799 022c BB69     		ldr	r3, [r7, #24]
 6800 022e 1344     		add	r3, r3, r2
 6801 0230 274A     		ldr	r2, .L338+48
 6802 0232 1168     		ldr	r1, [r2]
 6803 0234 BA69     		ldr	r2, [r7, #24]
 6804 0236 0A44     		add	r2, r2, r1
 6805 0238 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 6806 023a 5200     		lsls	r2, r2, #1
 6807 023c D2B2     		uxtb	r2, r2
 6808 023e 1A70     		strb	r2, [r3]
1775:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 6809              		.loc 1 1775 0 discriminator 3
 6810 0240 7B69     		ldr	r3, [r7, #20]
 6811 0242 0133     		adds	r3, r3, #1
 6812 0244 7B61     		str	r3, [r7, #20]
 6813              	.L333:
1775:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 6814              		.loc 1 1775 0 is_stmt 0 discriminator 1
 6815 0246 7B69     		ldr	r3, [r7, #20]
 6816 0248 072B     		cmp	r3, #7
 6817 024a DFDD     		ble	.L334
1773:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 6818              		.loc 1 1773 0 is_stmt 1 discriminator 2
 6819 024c BB69     		ldr	r3, [r7, #24]
 6820 024e 0133     		adds	r3, r3, #1
 6821 0250 BB61     		str	r3, [r7, #24]
 6822              	.L332:
1773:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 6823              		.loc 1 1773 0 is_stmt 0 discriminator 1
 6824 0252 BB69     		ldr	r3, [r7, #24]
 6825 0254 312B     		cmp	r3, #49
 6826 0256 D6DD     		ble	.L335
1778:bluetooth_rxtx.c **** 			}
1779:bluetooth_rxtx.c **** 		}
1780:bluetooth_rxtx.c **** 
1781:bluetooth_rxtx.c **** 		int ret = data_cb(unpacked);
 6827              		.loc 1 1781 0 is_stmt 1
 6828 0258 244B     		ldr	r3, .L338+76
 6829 025a 1B68     		ldr	r3, [r3]
 6830 025c 2148     		ldr	r0, .L338+68
 6831 025e 9847     		blx	r3
 6832 0260 B860     		str	r0, [r7, #8]
1782:bluetooth_rxtx.c **** 		if (!ret) break;
 6833              		.loc 1 1782 0
 6834 0262 BB68     		ldr	r3, [r7, #8]
 6835 0264 002B     		cmp	r3, #0
 6836 0266 00D1     		bne	.L324
 6837 0268 0CE0     		b	.L336
 6838              	.L324:
1783:bluetooth_rxtx.c **** 
1784:bluetooth_rxtx.c **** 	rx_continue:
1785:bluetooth_rxtx.c **** 		rx_tc = 0;
 6839              		.loc 1 1785 0
 6840 026a 164B     		ldr	r3, .L338+36
ARM GAS  /tmp/ccUeeWpa.s 			page 151


 6841 026c 0022     		movs	r2, #0
 6842 026e 1A60     		str	r2, [r3]
1786:bluetooth_rxtx.c **** 		rx_err = 0;
 6843              		.loc 1 1786 0
 6844 0270 154B     		ldr	r3, .L338+40
 6845 0272 0022     		movs	r2, #0
 6846 0274 1A60     		str	r2, [r3]
 6847              	.L311:
 6848              	.LBE5:
1680:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 6849              		.loc 1 1680 0
 6850 0276 1E4B     		ldr	r3, .L338+80
 6851 0278 1B78     		ldrb	r3, [r3]
 6852 027a DBB2     		uxtb	r3, r3
 6853 027c FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 6854 027e 9A42     		cmp	r2, r3
 6855 0280 3FF4E3AE 		beq	.L337
 6856              	.L336:
1787:bluetooth_rxtx.c **** 	}
1788:bluetooth_rxtx.c **** 
1789:bluetooth_rxtx.c **** 	// disable USB interrupts
1790:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
 6857              		.loc 1 1790 0
 6858 0284 1B4B     		ldr	r3, .L338+84
 6859 0286 4FF08072 		mov	r2, #16777216
 6860 028a 1A60     		str	r2, [r3]
1791:bluetooth_rxtx.c **** 
1792:bluetooth_rxtx.c **** 	// reset the radio completely
1793:bluetooth_rxtx.c **** 	cc2400_idle();
 6861              		.loc 1 1793 0
 6862 028c FFF7FEFF 		bl	cc2400_idle
1794:bluetooth_rxtx.c **** 	dio_ssp_stop();
 6863              		.loc 1 1794 0
 6864 0290 FFF7FEFF 		bl	dio_ssp_stop
1795:bluetooth_rxtx.c **** 	cs_trigger_disable();
 6865              		.loc 1 1795 0
 6866 0294 FFF7FEFF 		bl	cs_trigger_disable
1796:bluetooth_rxtx.c **** }
 6867              		.loc 1 1796 0
 6868 0298 2037     		adds	r7, r7, #32
 6869              		.cfi_def_cfa_offset 8
 6870 029a BD46     		mov	sp, r7
 6871              		.cfi_def_cfa_register 13
 6872              		@ sp needed
 6873 029c 80BD     		pop	{r7, pc}
 6874              	.L339:
 6875 029e 00BF     		.align	2
 6876              	.L338:
 6877 02a0 00000000 		.word	modulation
 6878 02a4 00000000 		.word	mode
 6879 02a8 00E100E0 		.word	-536813312
 6880 02ac 3CC00920 		.word	537509948
 6881 02b0 00000000 		.word	requested_channel
 6882 02b4 00000000 		.word	channel
 6883 02b8 00000000 		.word	do_hop
 6884 02bc 00000000 		.word	cs_trigger
 6885 02c0 00000000 		.word	cs_threshold_cur
ARM GAS  /tmp/ccUeeWpa.s 			page 152


 6886 02c4 00000000 		.word	rx_tc
 6887 02c8 00000000 		.word	rx_err
 6888 02cc 00000000 		.word	active_rxbuf
 6889 02d0 00000000 		.word	idle_rxbuf
 6890 02d4 00000000 		.word	status
 6891 02d8 00000000 		.word	cs_no_squelch
 6892 02dc 00000000 		.word	rssi_max
 6893 02e0 00000000 		.word	keepalive_trigger
 6894 02e4 00000000 		.word	unpacked
 6895 02e8 90010000 		.word	unpacked+400
 6896 02ec 00000000 		.word	data_cb
 6897 02f0 00000000 		.word	requested_mode
 6898 02f4 80E100E0 		.word	-536813184
 6899              		.cfi_endproc
 6900              	.LFE32:
 6902              		.section	.text.bt_le_sync,"ax",%progbits
 6903              		.align	2
 6904              		.global	bt_le_sync
 6905              		.thumb
 6906              		.thumb_func
 6908              	bt_le_sync:
 6909              	.LFB33:
1797:bluetooth_rxtx.c **** 
1798:bluetooth_rxtx.c **** 
1799:bluetooth_rxtx.c **** void bt_le_sync(u8 active_mode)
1800:bluetooth_rxtx.c **** {
 6910              		.loc 1 1800 0
 6911              		.cfi_startproc
 6912              		@ args = 0, pretend = 0, frame = 104
 6913              		@ frame_needed = 1, uses_anonymous_args = 0
 6914 0000 90B5     		push	{r4, r7, lr}
 6915              		.cfi_def_cfa_offset 12
 6916              		.cfi_offset 4, -12
 6917              		.cfi_offset 7, -8
 6918              		.cfi_offset 14, -4
 6919 0002 9BB0     		sub	sp, sp, #108
 6920              		.cfi_def_cfa_offset 120
 6921 0004 00AF     		add	r7, sp, #0
 6922              		.cfi_def_cfa_register 7
 6923 0006 0346     		mov	r3, r0
 6924 0008 FB71     		strb	r3, [r7, #7]
1801:bluetooth_rxtx.c **** 	int i;
1802:bluetooth_rxtx.c **** 	int8_t rssi;
1803:bluetooth_rxtx.c **** 	static int restart_jamming = 0;
1804:bluetooth_rxtx.c **** 
1805:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
 6925              		.loc 1 1805 0
 6926 000a 874B     		ldr	r3, .L386
 6927 000c 0122     		movs	r2, #1
 6928 000e 1A70     		strb	r2, [r3]
1806:bluetooth_rxtx.c **** 	mode = active_mode;
 6929              		.loc 1 1806 0
 6930 0010 864A     		ldr	r2, .L386+4
 6931 0012 FB79     		ldrb	r3, [r7, #7]
 6932 0014 1370     		strb	r3, [r2]
1807:bluetooth_rxtx.c **** 
1808:bluetooth_rxtx.c **** 	le.link_state = LINK_LISTENING;
ARM GAS  /tmp/ccUeeWpa.s 			page 153


 6933              		.loc 1 1808 0
 6934 0016 864B     		ldr	r3, .L386+8
 6935 0018 0122     		movs	r2, #1
 6936 001a 1A75     		strb	r2, [r3, #20]
1809:bluetooth_rxtx.c **** 
1810:bluetooth_rxtx.c **** 	// enable USB interrupts
1811:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
 6937              		.loc 1 1811 0
 6938 001c 854B     		ldr	r3, .L386+12
 6939 001e 4FF08072 		mov	r2, #16777216
 6940 0022 1A60     		str	r2, [r3]
1812:bluetooth_rxtx.c **** 
1813:bluetooth_rxtx.c **** 	RXLED_CLR;
 6941              		.loc 1 1813 0
 6942 0024 844B     		ldr	r3, .L386+16
 6943 0026 1022     		movs	r2, #16
 6944 0028 1A60     		str	r2, [r3]
1814:bluetooth_rxtx.c **** 
1815:bluetooth_rxtx.c **** 	queue_init();
 6945              		.loc 1 1815 0
 6946 002a FFF7FEFF 		bl	queue_init
1816:bluetooth_rxtx.c **** 	dio_ssp_init();
 6947              		.loc 1 1816 0
 6948 002e FFF7FEFF 		bl	dio_ssp_init
1817:bluetooth_rxtx.c **** 	dma_init_le();
 6949              		.loc 1 1817 0
 6950 0032 FFF7FEFF 		bl	dma_init_le
1818:bluetooth_rxtx.c **** 	dio_ssp_start();
 6951              		.loc 1 1818 0
 6952 0036 FFF7FEFF 		bl	dio_ssp_start
1819:bluetooth_rxtx.c **** 
1820:bluetooth_rxtx.c **** 	cc2400_rx_sync(rbit(le.access_address)); // bit-reversed access address
 6953              		.loc 1 1820 0
 6954 003a 7D4B     		ldr	r3, .L386+8
 6955 003c 1B68     		ldr	r3, [r3]
 6956 003e 1846     		mov	r0, r3
 6957 0040 FFF7FEFF 		bl	rbit
 6958 0044 0346     		mov	r3, r0
 6959 0046 1846     		mov	r0, r3
 6960 0048 FFF7FEFF 		bl	cc2400_rx_sync
1821:bluetooth_rxtx.c **** 
1822:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
 6961              		.loc 1 1822 0
 6962 004c 47E2     		b	.L341
 6963              	.L385:
 6964              	.LBB6:
1823:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 6965              		.loc 1 1823 0
 6966 004e 7B4B     		ldr	r3, .L386+20
 6967 0050 1B88     		ldrh	r3, [r3]	@ movhi
 6968 0052 9BB2     		uxth	r3, r3
 6969 0054 002B     		cmp	r3, #0
 6970 0056 29D0     		beq	.L342
1824:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 6971              		.loc 1 1824 0
 6972 0058 6420     		movs	r0, #100
 6973 005a FFF7FEFF 		bl	cc2400_strobe
ARM GAS  /tmp/ccUeeWpa.s 			page 154


1825:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 6974              		.loc 1 1825 0
 6975 005e 00BF     		nop
 6976              	.L343:
 6977              		.loc 1 1825 0 is_stmt 0 discriminator 1
 6978 0060 FFF7FEFF 		bl	cc2400_status
 6979 0064 0346     		mov	r3, r0
 6980 0066 03F00403 		and	r3, r3, #4
 6981 006a 002B     		cmp	r3, #0
 6982 006c F8D1     		bne	.L343
1826:bluetooth_rxtx.c **** 
1827:bluetooth_rxtx.c **** 			/* Retune */
1828:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
 6983              		.loc 1 1828 0 is_stmt 1
 6984 006e 744B     		ldr	r3, .L386+24
 6985 0070 1B88     		ldrh	r3, [r3]	@ movhi
 6986 0072 9BB2     		uxth	r3, r3
 6987 0074 013B     		subs	r3, r3, #1
 6988 0076 9BB2     		uxth	r3, r3
 6989 0078 0220     		movs	r0, #2
 6990 007a 1946     		mov	r1, r3
 6991 007c FFF7FEFF 		bl	cc2400_set
1829:bluetooth_rxtx.c **** 
1830:bluetooth_rxtx.c **** 			/* Wait for lock */
1831:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 6992              		.loc 1 1831 0
 6993 0080 6120     		movs	r0, #97
 6994 0082 FFF7FEFF 		bl	cc2400_strobe
1832:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 6995              		.loc 1 1832 0
 6996 0086 00BF     		nop
 6997              	.L344:
 6998              		.loc 1 1832 0 is_stmt 0 discriminator 1
 6999 0088 FFF7FEFF 		bl	cc2400_status
 7000 008c 0346     		mov	r3, r0
 7001 008e 03F00403 		and	r3, r3, #4
 7002 0092 002B     		cmp	r3, #0
 7003 0094 F8D0     		beq	.L344
1833:bluetooth_rxtx.c **** 
1834:bluetooth_rxtx.c **** 			/* RX mode */
1835:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 7004              		.loc 1 1835 0 is_stmt 1
 7005 0096 6220     		movs	r0, #98
 7006 0098 FFF7FEFF 		bl	cc2400_strobe
1836:bluetooth_rxtx.c **** 
1837:bluetooth_rxtx.c **** 			saved_request = requested_channel;
 7007              		.loc 1 1837 0
 7008 009c 674B     		ldr	r3, .L386+20
 7009 009e 1B88     		ldrh	r3, [r3]	@ movhi
 7010 00a0 9AB2     		uxth	r2, r3
 7011 00a2 684B     		ldr	r3, .L386+28
 7012 00a4 1A80     		strh	r2, [r3]	@ movhi
1838:bluetooth_rxtx.c **** 			requested_channel = 0;
 7013              		.loc 1 1838 0
 7014 00a6 654B     		ldr	r3, .L386+20
 7015 00a8 0022     		movs	r2, #0
 7016 00aa 1A80     		strh	r2, [r3]	@ movhi
ARM GAS  /tmp/ccUeeWpa.s 			page 155


 7017              	.L342:
1839:bluetooth_rxtx.c **** 		}
1840:bluetooth_rxtx.c **** 
1841:bluetooth_rxtx.c **** 		RXLED_CLR;
 7018              		.loc 1 1841 0
 7019 00ac 624B     		ldr	r3, .L386+16
 7020 00ae 1022     		movs	r2, #16
 7021 00b0 1A60     		str	r2, [r3]
1842:bluetooth_rxtx.c **** 
1843:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1844:bluetooth_rxtx.c **** 		rssi_reset();
 7022              		.loc 1 1844 0
 7023 00b2 FFF7FEFF 		bl	rssi_reset
1845:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)
 7024              		.loc 1 1845 0
 7025 00b6 00BF     		nop
 7026              	.L346:
 7027              		.loc 1 1845 0 is_stmt 0 discriminator 4
 7028 00b8 634B     		ldr	r3, .L386+32
 7029 00ba 1B68     		ldr	r3, [r3]
 7030 00bc 002B     		cmp	r3, #0
 7031 00be 0ED1     		bne	.L345
 7032              		.loc 1 1845 0 discriminator 1
 7033 00c0 624B     		ldr	r3, .L386+36
 7034 00c2 1B68     		ldr	r3, [r3]
 7035 00c4 002B     		cmp	r3, #0
 7036 00c6 0AD1     		bne	.L345
 7037              		.loc 1 1845 0 discriminator 2
 7038 00c8 614B     		ldr	r3, .L386+40
 7039 00ca 1B78     		ldrb	r3, [r3]
 7040 00cc DBB2     		uxtb	r3, r3
 7041 00ce 002B     		cmp	r3, #0
 7042 00d0 05D1     		bne	.L345
 7043              		.loc 1 1845 0 discriminator 3
 7044 00d2 604B     		ldr	r3, .L386+44
 7045 00d4 1B78     		ldrb	r3, [r3]
 7046 00d6 DBB2     		uxtb	r3, r3
 7047 00d8 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 7048 00da 9A42     		cmp	r2, r3
 7049 00dc ECD0     		beq	.L346
 7050              	.L345:
1846:bluetooth_rxtx.c **** 			;
1847:bluetooth_rxtx.c **** 
1848:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
 7051              		.loc 1 1848 0 is_stmt 1
 7052 00de 5D4B     		ldr	r3, .L386+44
 7053 00e0 1B78     		ldrb	r3, [r3]
 7054 00e2 DBB2     		uxtb	r3, r3
 7055 00e4 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 7056 00e6 9A42     		cmp	r2, r3
 7057 00e8 00D0     		beq	.L347
1849:bluetooth_rxtx.c **** 			goto cleanup;
 7058              		.loc 1 1849 0
 7059 00ea FFE1     		b	.L384
 7060              	.L347:
1850:bluetooth_rxtx.c **** 		}
1851:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccUeeWpa.s 			page 156


1852:bluetooth_rxtx.c **** 		if (rx_err) {
 7061              		.loc 1 1852 0
 7062 00ec 574B     		ldr	r3, .L386+36
 7063 00ee 1B68     		ldr	r3, [r3]
 7064 00f0 002B     		cmp	r3, #0
 7065 00f2 07D0     		beq	.L349
1853:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 7066              		.loc 1 1853 0
 7067 00f4 584B     		ldr	r3, .L386+48
 7068 00f6 1B78     		ldrb	r3, [r3]
 7069 00f8 DBB2     		uxtb	r3, r3
 7070 00fa 43F00203 		orr	r3, r3, #2
 7071 00fe DAB2     		uxtb	r2, r3
 7072 0100 554B     		ldr	r3, .L386+48
 7073 0102 1A70     		strb	r2, [r3]
 7074              	.L349:
1854:bluetooth_rxtx.c **** 		}
1855:bluetooth_rxtx.c **** 
1856:bluetooth_rxtx.c **** 		if (do_hop)
 7075              		.loc 1 1856 0
 7076 0104 524B     		ldr	r3, .L386+40
 7077 0106 1B78     		ldrb	r3, [r3]
 7078 0108 DBB2     		uxtb	r3, r3
 7079 010a 002B     		cmp	r3, #0
 7080 010c 00D0     		beq	.L350
1857:bluetooth_rxtx.c **** 			goto rx_flush;
 7081              		.loc 1 1857 0
 7082 010e 2BE1     		b	.L351
 7083              	.L350:
1858:bluetooth_rxtx.c **** 
1859:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1860:bluetooth_rxtx.c **** 		if (!rx_tc)
 7084              		.loc 1 1860 0
 7085 0110 4D4B     		ldr	r3, .L386+32
 7086 0112 1B68     		ldr	r3, [r3]
 7087 0114 002B     		cmp	r3, #0
 7088 0116 00D1     		bne	.L352
 7089 0118 E1E1     		b	.L341
 7090              	.L352:
1861:bluetooth_rxtx.c **** 			continue;
1862:bluetooth_rxtx.c **** 
1863:bluetooth_rxtx.c **** 		/////////////////////
1864:bluetooth_rxtx.c **** 		// process the packet
1865:bluetooth_rxtx.c **** 
1866:bluetooth_rxtx.c **** 		uint32_t packet[48/4+1];
1867:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
 7091              		.loc 1 1867 0
 7092 011a 07F10803 		add	r3, r7, #8
 7093 011e FB65     		str	r3, [r7, #92]
1868:bluetooth_rxtx.c **** 		packet[0] = le.access_address;
 7094              		.loc 1 1868 0
 7095 0120 434B     		ldr	r3, .L386+8
 7096 0122 1B68     		ldr	r3, [r3]
 7097 0124 BB60     		str	r3, [r7, #8]
1869:bluetooth_rxtx.c **** 
1870:bluetooth_rxtx.c **** 		const uint32_t *whit = whitening_word[btle_channel_index(channel-2402)];
 7098              		.loc 1 1870 0
ARM GAS  /tmp/ccUeeWpa.s 			page 157


 7099 0126 464B     		ldr	r3, .L386+24
 7100 0128 1B88     		ldrh	r3, [r3]	@ movhi
 7101 012a 9BB2     		uxth	r3, r3
 7102 012c DBB2     		uxtb	r3, r3
 7103 012e 623B     		subs	r3, r3, #98
 7104 0130 DBB2     		uxtb	r3, r3
 7105 0132 1846     		mov	r0, r3
 7106 0134 FFF7FEFF 		bl	btle_channel_index
 7107 0138 0346     		mov	r3, r0
 7108 013a 1A46     		mov	r2, r3
 7109 013c 1346     		mov	r3, r2
 7110 013e 5B00     		lsls	r3, r3, #1
 7111 0140 1344     		add	r3, r3, r2
 7112 0142 1B01     		lsls	r3, r3, #4
 7113 0144 454A     		ldr	r2, .L386+52
 7114 0146 1344     		add	r3, r3, r2
 7115 0148 BB65     		str	r3, [r7, #88]
1871:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 7116              		.loc 1 1871 0
 7117 014a 0023     		movs	r3, #0
 7118 014c 7B66     		str	r3, [r7, #100]
 7119 014e 34E0     		b	.L353
 7120              	.L356:
 7121              	.LBB7:
1872:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 7122              		.loc 1 1872 0 discriminator 3
 7123 0150 434A     		ldr	r2, .L386+56
 7124 0152 7B6E     		ldr	r3, [r7, #100]
 7125 0154 1344     		add	r3, r3, r2
 7126 0156 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 7127 0158 1A06     		lsls	r2, r3, #24
1873:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 7128              		.loc 1 1873 0 discriminator 3
 7129 015a 7B6E     		ldr	r3, [r7, #100]
 7130 015c 0133     		adds	r3, r3, #1
 7131 015e 4049     		ldr	r1, .L386+56
 7132 0160 CB5C     		ldrb	r3, [r1, r3]	@ zero_extendqisi2
 7133 0162 1B04     		lsls	r3, r3, #16
 7134 0164 1A43     		orrs	r2, r2, r3
1874:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 7135              		.loc 1 1874 0 discriminator 3
 7136 0166 7B6E     		ldr	r3, [r7, #100]
 7137 0168 0233     		adds	r3, r3, #2
 7138 016a 3D49     		ldr	r1, .L386+56
 7139 016c CB5C     		ldrb	r3, [r1, r3]	@ zero_extendqisi2
 7140 016e 1B02     		lsls	r3, r3, #8
 7141 0170 1343     		orrs	r3, r3, r2
1875:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 7142              		.loc 1 1875 0 discriminator 3
 7143 0172 7A6E     		ldr	r2, [r7, #100]
 7144 0174 0332     		adds	r2, r2, #3
 7145 0176 3A49     		ldr	r1, .L386+56
 7146 0178 8A5C     		ldrb	r2, [r1, r2]	@ zero_extendqisi2
 7147 017a 1343     		orrs	r3, r3, r2
1872:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 7148              		.loc 1 1872 0 discriminator 3
 7149 017c 7B65     		str	r3, [r7, #84]
ARM GAS  /tmp/ccUeeWpa.s 			page 158


1876:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 7150              		.loc 1 1876 0 discriminator 3
 7151 017e 7B6E     		ldr	r3, [r7, #100]
 7152 0180 002B     		cmp	r3, #0
 7153 0182 00DA     		bge	.L354
 7154 0184 0333     		adds	r3, r3, #3
 7155              	.L354:
 7156 0186 9B10     		asrs	r3, r3, #2
 7157 0188 5C1C     		adds	r4, r3, #1
 7158 018a 786D     		ldr	r0, [r7, #84]
 7159 018c FFF7FEFF 		bl	rbit
 7160 0190 0146     		mov	r1, r0
 7161 0192 7B6E     		ldr	r3, [r7, #100]
 7162 0194 002B     		cmp	r3, #0
 7163 0196 00DA     		bge	.L355
 7164 0198 0333     		adds	r3, r3, #3
 7165              	.L355:
 7166 019a 9B10     		asrs	r3, r3, #2
 7167 019c 9B00     		lsls	r3, r3, #2
 7168 019e BA6D     		ldr	r2, [r7, #88]
 7169 01a0 1344     		add	r3, r3, r2
 7170 01a2 1B68     		ldr	r3, [r3]
 7171 01a4 81EA0302 		eor	r2, r1, r3
 7172 01a8 A300     		lsls	r3, r4, #2
 7173 01aa 07F16801 		add	r1, r7, #104
 7174 01ae 0B44     		add	r3, r3, r1
 7175 01b0 43F8602C 		str	r2, [r3, #-96]
 7176              	.LBE7:
1871:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 7177              		.loc 1 1871 0 discriminator 3
 7178 01b4 7B6E     		ldr	r3, [r7, #100]
 7179 01b6 0433     		adds	r3, r3, #4
 7180 01b8 7B66     		str	r3, [r7, #100]
 7181              	.L353:
1871:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 7182              		.loc 1 1871 0 is_stmt 0 discriminator 1
 7183 01ba 7B6E     		ldr	r3, [r7, #100]
 7184 01bc 032B     		cmp	r3, #3
 7185 01be C7DD     		ble	.L356
1877:bluetooth_rxtx.c **** 		}
1878:bluetooth_rxtx.c **** 
1879:bluetooth_rxtx.c **** 		unsigned len = (p[5] & 0x3f) + 2;
 7186              		.loc 1 1879 0 is_stmt 1
 7187 01c0 FB6D     		ldr	r3, [r7, #92]
 7188 01c2 0533     		adds	r3, r3, #5
 7189 01c4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 7190 01c6 03F03F03 		and	r3, r3, #63
 7191 01ca 0233     		adds	r3, r3, #2
 7192 01cc 3B65     		str	r3, [r7, #80]
1880:bluetooth_rxtx.c **** 		if (len > 39)
 7193              		.loc 1 1880 0
 7194 01ce 3B6D     		ldr	r3, [r7, #80]
 7195 01d0 272B     		cmp	r3, #39
 7196 01d2 00D9     		bls	.L357
1881:bluetooth_rxtx.c **** 			goto rx_flush;
 7197              		.loc 1 1881 0
 7198 01d4 C8E0     		b	.L351
ARM GAS  /tmp/ccUeeWpa.s 			page 159


 7199              	.L357:
1882:bluetooth_rxtx.c **** 
1883:bluetooth_rxtx.c **** 		// transfer the minimum number of bytes from the CC2400
1884:bluetooth_rxtx.c **** 		// this allows us enough time to resume RX for subsequent packets on the same channel
1885:bluetooth_rxtx.c **** 		unsigned total_transfers = ((len + 3) + 4 - 1) / 4;
 7200              		.loc 1 1885 0
 7201 01d6 3B6D     		ldr	r3, [r7, #80]
 7202 01d8 0633     		adds	r3, r3, #6
 7203 01da 9B08     		lsrs	r3, r3, #2
 7204 01dc FB64     		str	r3, [r7, #76]
1886:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
 7205              		.loc 1 1886 0
 7206 01de FB6C     		ldr	r3, [r7, #76]
 7207 01e0 0A2B     		cmp	r3, #10
 7208 01e2 0DD8     		bhi	.L358
1887:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
 7209              		.loc 1 1887 0
 7210 01e4 00BF     		nop
 7211              	.L360:
 7212              		.loc 1 1887 0 is_stmt 0 discriminator 2
 7213 01e6 1F4B     		ldr	r3, .L386+60
 7214 01e8 1A68     		ldr	r2, [r3]
 7215 01ea FB6C     		ldr	r3, [r7, #76]
 7216 01ec 9B00     		lsls	r3, r3, #2
 7217 01ee 1C49     		ldr	r1, .L386+56
 7218 01f0 0B44     		add	r3, r3, r1
 7219 01f2 9A42     		cmp	r2, r3
 7220 01f4 0FD2     		bcs	.L359
 7221              		.loc 1 1887 0 discriminator 1
 7222 01f6 154B     		ldr	r3, .L386+36
 7223 01f8 1B68     		ldr	r3, [r3]
 7224 01fa 002B     		cmp	r3, #0
 7225 01fc F3D0     		beq	.L360
 7226 01fe 0AE0     		b	.L359
 7227              	.L358:
1888:bluetooth_rxtx.c **** 				;
1889:bluetooth_rxtx.c **** 		} else { // max transfers? just wait till DMA's done
1890:bluetooth_rxtx.c **** 			while (DMACC0Config & DMACCxConfig_E && rx_err == 0)
 7228              		.loc 1 1890 0 is_stmt 1
 7229 0200 00BF     		nop
 7230              	.L361:
 7231              		.loc 1 1890 0 is_stmt 0 discriminator 2
 7232 0202 194B     		ldr	r3, .L386+64
 7233 0204 1B68     		ldr	r3, [r3]
 7234 0206 03F00103 		and	r3, r3, #1
 7235 020a 002B     		cmp	r3, #0
 7236 020c 03D0     		beq	.L359
 7237              		.loc 1 1890 0 discriminator 1
 7238 020e 0F4B     		ldr	r3, .L386+36
 7239 0210 1B68     		ldr	r3, [r3]
 7240 0212 002B     		cmp	r3, #0
 7241 0214 F5D0     		beq	.L361
 7242              	.L359:
1891:bluetooth_rxtx.c **** 				;
1892:bluetooth_rxtx.c **** 		}
1893:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
 7243              		.loc 1 1893 0 is_stmt 1
ARM GAS  /tmp/ccUeeWpa.s 			page 160


 7244 0216 154A     		ldr	r2, .L386+68
 7245 0218 144B     		ldr	r3, .L386+68
 7246 021a 1B68     		ldr	r3, [r3]
 7247 021c 23F00103 		bic	r3, r3, #1
 7248 0220 1360     		str	r3, [r2]
1894:bluetooth_rxtx.c **** 
1895:bluetooth_rxtx.c **** 		// unwhiten the rest of the packet
1896:bluetooth_rxtx.c **** 		for (i = 4; i < 44; i += 4) {
 7249              		.loc 1 1896 0
 7250 0222 0423     		movs	r3, #4
 7251 0224 7B66     		str	r3, [r7, #100]
 7252 0226 58E0     		b	.L362
 7253              	.L387:
 7254              		.align	2
 7255              	.L386:
 7256 0228 00000000 		.word	modulation
 7257 022c 00000000 		.word	mode
 7258 0230 00000000 		.word	le
 7259 0234 00E100E0 		.word	-536813312
 7260 0238 3CC00920 		.word	537509948
 7261 023c 00000000 		.word	requested_channel
 7262 0240 00000000 		.word	channel
 7263 0244 00000000 		.word	saved_request
 7264 0248 00000000 		.word	rx_tc
 7265 024c 00000000 		.word	rx_err
 7266 0250 00000000 		.word	do_hop
 7267 0254 00000000 		.word	requested_mode
 7268 0258 00000000 		.word	status
 7269 025c FC000000 		.word	whitening_word
 7270 0260 00000000 		.word	rxbuf1
 7271 0264 04410050 		.word	1342193924
 7272 0268 10410050 		.word	1342193936
 7273 026c 24000340 		.word	1073938468
 7274              	.L365:
 7275              	.LBB8:
1897:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 7276              		.loc 1 1897 0 discriminator 3
 7277 0270 A54A     		ldr	r2, .L388
 7278 0272 7B6E     		ldr	r3, [r7, #100]
 7279 0274 1344     		add	r3, r3, r2
 7280 0276 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 7281 0278 1A06     		lsls	r2, r3, #24
1898:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 7282              		.loc 1 1898 0 discriminator 3
 7283 027a 7B6E     		ldr	r3, [r7, #100]
 7284 027c 0133     		adds	r3, r3, #1
 7285 027e A249     		ldr	r1, .L388
 7286 0280 CB5C     		ldrb	r3, [r1, r3]	@ zero_extendqisi2
 7287 0282 1B04     		lsls	r3, r3, #16
 7288 0284 1A43     		orrs	r2, r2, r3
1899:bluetooth_rxtx.c **** 				       | rxbuf1[i+2] << 8
 7289              		.loc 1 1899 0 discriminator 3
 7290 0286 7B6E     		ldr	r3, [r7, #100]
 7291 0288 0233     		adds	r3, r3, #2
 7292 028a 9F49     		ldr	r1, .L388
 7293 028c CB5C     		ldrb	r3, [r1, r3]	@ zero_extendqisi2
 7294 028e 1B02     		lsls	r3, r3, #8
ARM GAS  /tmp/ccUeeWpa.s 			page 161


 7295 0290 1343     		orrs	r3, r3, r2
1900:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 7296              		.loc 1 1900 0 discriminator 3
 7297 0292 7A6E     		ldr	r2, [r7, #100]
 7298 0294 0332     		adds	r2, r2, #3
 7299 0296 9C49     		ldr	r1, .L388
 7300 0298 8A5C     		ldrb	r2, [r1, r2]	@ zero_extendqisi2
 7301 029a 1343     		orrs	r3, r3, r2
1897:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 7302              		.loc 1 1897 0 discriminator 3
 7303 029c BB64     		str	r3, [r7, #72]
1901:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 7304              		.loc 1 1901 0 discriminator 3
 7305 029e 7B6E     		ldr	r3, [r7, #100]
 7306 02a0 002B     		cmp	r3, #0
 7307 02a2 00DA     		bge	.L363
 7308 02a4 0333     		adds	r3, r3, #3
 7309              	.L363:
 7310 02a6 9B10     		asrs	r3, r3, #2
 7311 02a8 5C1C     		adds	r4, r3, #1
 7312 02aa B86C     		ldr	r0, [r7, #72]
 7313 02ac FFF7FEFF 		bl	rbit
 7314 02b0 0146     		mov	r1, r0
 7315 02b2 7B6E     		ldr	r3, [r7, #100]
 7316 02b4 002B     		cmp	r3, #0
 7317 02b6 00DA     		bge	.L364
 7318 02b8 0333     		adds	r3, r3, #3
 7319              	.L364:
 7320 02ba 9B10     		asrs	r3, r3, #2
 7321 02bc 9B00     		lsls	r3, r3, #2
 7322 02be BA6D     		ldr	r2, [r7, #88]
 7323 02c0 1344     		add	r3, r3, r2
 7324 02c2 1B68     		ldr	r3, [r3]
 7325 02c4 81EA0302 		eor	r2, r1, r3
 7326 02c8 A300     		lsls	r3, r4, #2
 7327 02ca 07F16801 		add	r1, r7, #104
 7328 02ce 0B44     		add	r3, r3, r1
 7329 02d0 43F8602C 		str	r2, [r3, #-96]
 7330              	.LBE8:
1896:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 7331              		.loc 1 1896 0 discriminator 3
 7332 02d4 7B6E     		ldr	r3, [r7, #100]
 7333 02d6 0433     		adds	r3, r3, #4
 7334 02d8 7B66     		str	r3, [r7, #100]
 7335              	.L362:
1896:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 7336              		.loc 1 1896 0 is_stmt 0 discriminator 1
 7337 02da 7B6E     		ldr	r3, [r7, #100]
 7338 02dc 2B2B     		cmp	r3, #43
 7339 02de C7DD     		ble	.L365
1902:bluetooth_rxtx.c **** 		}
1903:bluetooth_rxtx.c **** 
1904:bluetooth_rxtx.c **** 		if (le.crc_verify) {
 7340              		.loc 1 1904 0 is_stmt 1
 7341 02e0 8A4B     		ldr	r3, .L388+4
 7342 02e2 1B69     		ldr	r3, [r3, #16]
 7343 02e4 002B     		cmp	r3, #0
ARM GAS  /tmp/ccUeeWpa.s 			page 162


 7344 02e6 23D0     		beq	.L366
 7345              	.LBB9:
1905:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
 7346              		.loc 1 1905 0
 7347 02e8 884B     		ldr	r3, .L388+4
 7348 02ea D968     		ldr	r1, [r3, #12]
 7349 02ec FB6D     		ldr	r3, [r7, #92]
 7350 02ee 1A1D     		adds	r2, r3, #4
 7351 02f0 3B6D     		ldr	r3, [r7, #80]
 7352 02f2 0846     		mov	r0, r1
 7353 02f4 1146     		mov	r1, r2
 7354 02f6 1A46     		mov	r2, r3
 7355 02f8 FFF7FEFF 		bl	btle_crcgen_lut
 7356 02fc 7864     		str	r0, [r7, #68]
1906:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
 7357              		.loc 1 1906 0
 7358 02fe 3B6D     		ldr	r3, [r7, #80]
 7359 0300 0633     		adds	r3, r3, #6
 7360 0302 FA6D     		ldr	r2, [r7, #92]
 7361 0304 1344     		add	r3, r3, r2
 7362 0306 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 7363 0308 1A04     		lsls	r2, r3, #16
1907:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 7364              		.loc 1 1907 0
 7365 030a 3B6D     		ldr	r3, [r7, #80]
 7366 030c 0533     		adds	r3, r3, #5
 7367 030e F96D     		ldr	r1, [r7, #92]
 7368 0310 0B44     		add	r3, r3, r1
 7369 0312 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 7370 0314 1B02     		lsls	r3, r3, #8
 7371 0316 1343     		orrs	r3, r3, r2
1908:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 7372              		.loc 1 1908 0
 7373 0318 3A6D     		ldr	r2, [r7, #80]
 7374 031a 0432     		adds	r2, r2, #4
 7375 031c F96D     		ldr	r1, [r7, #92]
 7376 031e 0A44     		add	r2, r2, r1
 7377 0320 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 7378 0322 1343     		orrs	r3, r3, r2
1906:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
 7379              		.loc 1 1906 0
 7380 0324 3B64     		str	r3, [r7, #64]
1909:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
 7381              		.loc 1 1909 0
 7382 0326 7A6C     		ldr	r2, [r7, #68]
 7383 0328 3B6C     		ldr	r3, [r7, #64]
 7384 032a 9A42     		cmp	r2, r3
 7385 032c 00D0     		beq	.L366
1910:bluetooth_rxtx.c **** 				goto rx_flush;
 7386              		.loc 1 1910 0
 7387 032e 1BE0     		b	.L351
 7388              	.L366:
 7389              	.LBE9:
1911:bluetooth_rxtx.c **** 		}
1912:bluetooth_rxtx.c **** 
1913:bluetooth_rxtx.c **** 
1914:bluetooth_rxtx.c **** 		RXLED_SET;
ARM GAS  /tmp/ccUeeWpa.s 			page 163


 7390              		.loc 1 1914 0
 7391 0330 774B     		ldr	r3, .L388+8
 7392 0332 1022     		movs	r2, #16
 7393 0334 1A60     		str	r2, [r3]
1915:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
 7394              		.loc 1 1915 0
 7395 0336 774B     		ldr	r3, .L388+12
 7396 0338 1B68     		ldr	r3, [r3]
 7397 033a 07F10802 		add	r2, r7, #8
 7398 033e 1046     		mov	r0, r2
 7399 0340 9847     		blx	r3
1916:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
 7400              		.loc 1 1916 0
 7401 0342 07F10803 		add	r3, r7, #8
 7402 0346 0120     		movs	r0, #1
 7403 0348 1946     		mov	r1, r3
 7404 034a FFF7FEFF 		bl	enqueue
1917:bluetooth_rxtx.c **** 		le.last_packet = CLK100NS;
 7405              		.loc 1 1917 0
 7406 034e 724B     		ldr	r3, .L388+16
 7407 0350 1B68     		ldr	r3, [r3]
 7408 0352 C3F31303 		ubfx	r3, r3, #0, #20
 7409 0356 40F63542 		movw	r2, #3125
 7410 035a 02FB03F2 		mul	r2, r2, r3
 7411 035e 6F4B     		ldr	r3, .L388+20
 7412 0360 1B68     		ldr	r3, [r3]
 7413 0362 1344     		add	r3, r3, r2
 7414 0364 694A     		ldr	r2, .L388+4
 7415 0366 1364     		str	r3, [r2, #64]
 7416              	.L351:
1918:bluetooth_rxtx.c **** 
1919:bluetooth_rxtx.c **** 	rx_flush:
1920:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 7417              		.loc 1 1920 0
 7418 0368 6120     		movs	r0, #97
 7419 036a FFF7FEFF 		bl	cc2400_strobe
1921:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 7420              		.loc 1 1921 0
 7421 036e 00BF     		nop
 7422              	.L367:
 7423              		.loc 1 1921 0 is_stmt 0 discriminator 1
 7424 0370 FFF7FEFF 		bl	cc2400_status
 7425 0374 0346     		mov	r3, r0
 7426 0376 03F00403 		and	r3, r3, #4
 7427 037a 002B     		cmp	r3, #0
 7428 037c F8D0     		beq	.L367
1922:bluetooth_rxtx.c **** 
1923:bluetooth_rxtx.c **** 		// flush any excess bytes from the SSP's buffer
1924:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
 7429              		.loc 1 1924 0 is_stmt 1
 7430 037e 684A     		ldr	r2, .L388+24
 7431 0380 674B     		ldr	r3, .L388+24
 7432 0382 1B68     		ldr	r3, [r3]
 7433 0384 23F00103 		bic	r3, r3, #1
 7434 0388 1360     		str	r3, [r2]
1925:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 7435              		.loc 1 1925 0
ARM GAS  /tmp/ccUeeWpa.s 			page 164


 7436 038a 03E0     		b	.L368
 7437              	.L369:
 7438              	.LBB10:
1926:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
 7439              		.loc 1 1926 0
 7440 038c 654B     		ldr	r3, .L388+28
 7441 038e 1B68     		ldr	r3, [r3]
 7442 0390 87F83F30 		strb	r3, [r7, #63]
 7443              	.L368:
 7444              	.LBE10:
1925:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 7445              		.loc 1 1925 0
 7446 0394 644B     		ldr	r3, .L388+32
 7447 0396 1B68     		ldr	r3, [r3]
 7448 0398 03F00403 		and	r3, r3, #4
 7449 039c 002B     		cmp	r3, #0
 7450 039e F5D1     		bne	.L369
1927:bluetooth_rxtx.c **** 		}
1928:bluetooth_rxtx.c **** 
1929:bluetooth_rxtx.c **** 		// timeout - FIXME this is an ugly hack
1930:bluetooth_rxtx.c **** 		u32 now = CLK100NS;
 7451              		.loc 1 1930 0
 7452 03a0 5D4B     		ldr	r3, .L388+16
 7453 03a2 1B68     		ldr	r3, [r3]
 7454 03a4 C3F31303 		ubfx	r3, r3, #0, #20
 7455 03a8 40F63542 		movw	r2, #3125
 7456 03ac 02FB03F2 		mul	r2, r2, r3
 7457 03b0 5A4B     		ldr	r3, .L388+20
 7458 03b2 1B68     		ldr	r3, [r3]
 7459 03b4 1344     		add	r3, r3, r2
 7460 03b6 3B66     		str	r3, [r7, #96]
1931:bluetooth_rxtx.c **** 		if (now < le.last_packet)
 7461              		.loc 1 1931 0
 7462 03b8 544B     		ldr	r3, .L388+4
 7463 03ba 1A6C     		ldr	r2, [r3, #64]
 7464 03bc 3B6E     		ldr	r3, [r7, #96]
 7465 03be 9A42     		cmp	r2, r3
 7466 03c0 05D9     		bls	.L370
1932:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 7467              		.loc 1 1932 0
 7468 03c2 3B6E     		ldr	r3, [r7, #96]
 7469 03c4 03F14343 		add	r3, r3, #-1023410176
 7470 03c8 03F5A003 		add	r3, r3, #5242880
 7471 03cc 3B66     		str	r3, [r7, #96]
 7472              	.L370:
1933:bluetooth_rxtx.c **** 		if  ( // timeout
1934:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 7473              		.loc 1 1934 0
 7474 03ce 4F4B     		ldr	r3, .L388+4
 7475 03d0 1B7D     		ldrb	r3, [r3, #20]	@ zero_extendqisi2
1933:bluetooth_rxtx.c **** 		if  ( // timeout
 7476              		.loc 1 1933 0
 7477 03d2 032B     		cmp	r3, #3
 7478 03d4 03D0     		beq	.L371
 7479              		.loc 1 1934 0
 7480 03d6 4D4B     		ldr	r3, .L388+4
 7481 03d8 1B7D     		ldrb	r3, [r3, #20]	@ zero_extendqisi2
ARM GAS  /tmp/ccUeeWpa.s 			page 165


 7482 03da 022B     		cmp	r3, #2
 7483 03dc 06D1     		bne	.L372
 7484              	.L371:
1935:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 7485              		.loc 1 1935 0
 7486 03de 4B4B     		ldr	r3, .L388+4
 7487 03e0 1B6C     		ldr	r3, [r3, #64]
 7488 03e2 3A6E     		ldr	r2, [r7, #96]
 7489 03e4 D31A     		subs	r3, r2, r3
 7490 03e6 514A     		ldr	r2, .L388+36
 7491 03e8 9342     		cmp	r3, r2
 7492 03ea 03D8     		bhi	.L373
 7493              	.L372:
1936:bluetooth_rxtx.c **** 			// jam finished
1937:bluetooth_rxtx.c **** 			|| (le_jam_count == 1)
 7494              		.loc 1 1937 0
 7495 03ec 504B     		ldr	r3, .L388+40
 7496 03ee 1B68     		ldr	r3, [r3]
 7497 03f0 012B     		cmp	r3, #1
 7498 03f2 37D1     		bne	.L374
 7499              	.L373:
1938:bluetooth_rxtx.c **** 			)
1939:bluetooth_rxtx.c **** 		{
1940:bluetooth_rxtx.c **** 			reset_le();
 7500              		.loc 1 1940 0
 7501 03f4 FFF7FEFF 		bl	reset_le
1941:bluetooth_rxtx.c **** 			le_jam_count = 0;
 7502              		.loc 1 1941 0
 7503 03f8 4D4B     		ldr	r3, .L388+40
 7504 03fa 0022     		movs	r2, #0
 7505 03fc 1A60     		str	r2, [r3]
1942:bluetooth_rxtx.c **** 			TXLED_CLR;
 7506              		.loc 1 1942 0
 7507 03fe 4D4B     		ldr	r3, .L388+44
 7508 0400 4FF48072 		mov	r2, #256
 7509 0404 1A60     		str	r2, [r3]
1943:bluetooth_rxtx.c **** 
1944:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
 7510              		.loc 1 1944 0
 7511 0406 4C4B     		ldr	r3, .L388+48
 7512 0408 1B78     		ldrb	r3, [r3]
 7513 040a DBB2     		uxtb	r3, r3
 7514 040c 012B     		cmp	r3, #1
 7515 040e 06D1     		bne	.L375
1945:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 7516              		.loc 1 1945 0
 7517 0410 494B     		ldr	r3, .L388+48
 7518 0412 0022     		movs	r2, #0
 7519 0414 1A70     		strb	r2, [r3]
1946:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
 7520              		.loc 1 1946 0
 7521 0416 494B     		ldr	r3, .L388+52
 7522 0418 0022     		movs	r2, #0
 7523 041a 1A70     		strb	r2, [r3]
1947:bluetooth_rxtx.c **** 				goto cleanup;
 7524              		.loc 1 1947 0
 7525 041c 66E0     		b	.L384
ARM GAS  /tmp/ccUeeWpa.s 			page 166


 7526              	.L375:
1948:bluetooth_rxtx.c **** 			}
1949:bluetooth_rxtx.c **** 
1950:bluetooth_rxtx.c **** 			// go back to promisc if the connection dies
1951:bluetooth_rxtx.c **** 			if (active_mode == MODE_BT_PROMISC_LE)
 7527              		.loc 1 1951 0
 7528 041e FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 7529 0420 0A2B     		cmp	r3, #10
 7530 0422 01D1     		bne	.L376
1952:bluetooth_rxtx.c **** 				goto cleanup;
 7531              		.loc 1 1952 0
 7532 0424 00BF     		nop
 7533 0426 61E0     		b	.L384
 7534              	.L376:
1953:bluetooth_rxtx.c **** 
1954:bluetooth_rxtx.c **** 			le.link_state = LINK_LISTENING;
 7535              		.loc 1 1954 0
 7536 0428 384B     		ldr	r3, .L388+4
 7537 042a 0122     		movs	r2, #1
 7538 042c 1A75     		strb	r2, [r3, #20]
1955:bluetooth_rxtx.c **** 
1956:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 7539              		.loc 1 1956 0
 7540 042e 6420     		movs	r0, #100
 7541 0430 FFF7FEFF 		bl	cc2400_strobe
1957:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 7542              		.loc 1 1957 0
 7543 0434 00BF     		nop
 7544              	.L377:
 7545              		.loc 1 1957 0 is_stmt 0 discriminator 1
 7546 0436 FFF7FEFF 		bl	cc2400_status
 7547 043a 0346     		mov	r3, r0
 7548 043c 03F00403 		and	r3, r3, #4
 7549 0440 002B     		cmp	r3, #0
 7550 0442 F8D1     		bne	.L377
1958:bluetooth_rxtx.c **** 
1959:bluetooth_rxtx.c **** 			/* Retune */
1960:bluetooth_rxtx.c **** 			channel = saved_request != 0 ? saved_request : 2402;
 7551              		.loc 1 1960 0 is_stmt 1
 7552 0444 3E4B     		ldr	r3, .L388+56
 7553 0446 1B88     		ldrh	r3, [r3]	@ movhi
 7554 0448 9BB2     		uxth	r3, r3
 7555 044a 002B     		cmp	r3, #0
 7556 044c 03D0     		beq	.L378
 7557              		.loc 1 1960 0 is_stmt 0 discriminator 1
 7558 044e 3C4B     		ldr	r3, .L388+56
 7559 0450 1B88     		ldrh	r3, [r3]	@ movhi
 7560 0452 9BB2     		uxth	r3, r3
 7561 0454 01E0     		b	.L379
 7562              	.L378:
 7563              		.loc 1 1960 0 discriminator 2
 7564 0456 40F66213 		movw	r3, #2402
 7565              	.L379:
 7566              		.loc 1 1960 0 discriminator 4
 7567 045a 3A4A     		ldr	r2, .L388+60
 7568 045c 1380     		strh	r3, [r2]	@ movhi
1961:bluetooth_rxtx.c **** 			restart_jamming = 1;
ARM GAS  /tmp/ccUeeWpa.s 			page 167


 7569              		.loc 1 1961 0 is_stmt 1 discriminator 4
 7570 045e 3A4B     		ldr	r3, .L388+64
 7571 0460 0122     		movs	r2, #1
 7572 0462 1A60     		str	r2, [r3]
 7573              	.L374:
1962:bluetooth_rxtx.c **** 		}
1963:bluetooth_rxtx.c **** 
1964:bluetooth_rxtx.c **** 		cc2400_set(SYNCL, le.syncl);
 7574              		.loc 1 1964 0
 7575 0464 294B     		ldr	r3, .L388+4
 7576 0466 DB88     		ldrh	r3, [r3, #6]
 7577 0468 2C20     		movs	r0, #44
 7578 046a 1946     		mov	r1, r3
 7579 046c FFF7FEFF 		bl	cc2400_set
1965:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
 7580              		.loc 1 1965 0
 7581 0470 264B     		ldr	r3, .L388+4
 7582 0472 9B88     		ldrh	r3, [r3, #4]
 7583 0474 2D20     		movs	r0, #45
 7584 0476 1946     		mov	r1, r3
 7585 0478 FFF7FEFF 		bl	cc2400_set
1966:bluetooth_rxtx.c **** 
1967:bluetooth_rxtx.c **** 		if (do_hop)
 7586              		.loc 1 1967 0
 7587 047c 334B     		ldr	r3, .L388+68
 7588 047e 1B78     		ldrb	r3, [r3]
 7589 0480 DBB2     		uxtb	r3, r3
 7590 0482 002B     		cmp	r3, #0
 7591 0484 01D0     		beq	.L380
1968:bluetooth_rxtx.c **** 			hop();
 7592              		.loc 1 1968 0
 7593 0486 FFF7FEFF 		bl	hop
 7594              	.L380:
1969:bluetooth_rxtx.c **** 
1970:bluetooth_rxtx.c **** 		//  you can jam but you keep turning off the light 
1971:bluetooth_rxtx.c **** 		if (le_jam_count > 0) {
 7595              		.loc 1 1971 0
 7596 048a 294B     		ldr	r3, .L388+40
 7597 048c 1B68     		ldr	r3, [r3]
 7598 048e 002B     		cmp	r3, #0
 7599 0490 07DD     		ble	.L381
1972:bluetooth_rxtx.c **** 			le_jam();
 7600              		.loc 1 1972 0
 7601 0492 FFF7FEFF 		bl	le_jam
1973:bluetooth_rxtx.c **** 			--le_jam_count;
 7602              		.loc 1 1973 0
 7603 0496 264B     		ldr	r3, .L388+40
 7604 0498 1B68     		ldr	r3, [r3]
 7605 049a 013B     		subs	r3, r3, #1
 7606 049c 244A     		ldr	r2, .L388+40
 7607 049e 1360     		str	r3, [r2]
 7608 04a0 17E0     		b	.L382
 7609              	.L381:
1974:bluetooth_rxtx.c **** 		} else {
1975:bluetooth_rxtx.c **** 			/* RX mode */
1976:bluetooth_rxtx.c **** 			dma_init_le();
 7610              		.loc 1 1976 0
ARM GAS  /tmp/ccUeeWpa.s 			page 168


 7611 04a2 FFF7FEFF 		bl	dma_init_le
1977:bluetooth_rxtx.c **** 			dio_ssp_start();
 7612              		.loc 1 1977 0
 7613 04a6 FFF7FEFF 		bl	dio_ssp_start
1978:bluetooth_rxtx.c **** 
1979:bluetooth_rxtx.c **** 			if (restart_jamming) {
 7614              		.loc 1 1979 0
 7615 04aa 274B     		ldr	r3, .L388+64
 7616 04ac 1B68     		ldr	r3, [r3]
 7617 04ae 002B     		cmp	r3, #0
 7618 04b0 0CD0     		beq	.L383
1980:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
 7619              		.loc 1 1980 0
 7620 04b2 164B     		ldr	r3, .L388+4
 7621 04b4 1B68     		ldr	r3, [r3]
 7622 04b6 1846     		mov	r0, r3
 7623 04b8 FFF7FEFF 		bl	rbit
 7624 04bc 0346     		mov	r3, r0
 7625 04be 1846     		mov	r0, r3
 7626 04c0 FFF7FEFF 		bl	cc2400_rx_sync
1981:bluetooth_rxtx.c **** 				restart_jamming = 0;
 7627              		.loc 1 1981 0
 7628 04c4 204B     		ldr	r3, .L388+64
 7629 04c6 0022     		movs	r2, #0
 7630 04c8 1A60     		str	r2, [r3]
 7631 04ca 02E0     		b	.L382
 7632              	.L383:
1982:bluetooth_rxtx.c **** 			} else {
1983:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
 7633              		.loc 1 1983 0
 7634 04cc 6220     		movs	r0, #98
 7635 04ce FFF7FEFF 		bl	cc2400_strobe
 7636              	.L382:
1984:bluetooth_rxtx.c **** 			}
1985:bluetooth_rxtx.c **** 		}
1986:bluetooth_rxtx.c **** 
1987:bluetooth_rxtx.c **** 		rx_tc = 0;
 7637              		.loc 1 1987 0
 7638 04d2 1F4B     		ldr	r3, .L388+72
 7639 04d4 0022     		movs	r2, #0
 7640 04d6 1A60     		str	r2, [r3]
1988:bluetooth_rxtx.c **** 		rx_err = 0;
 7641              		.loc 1 1988 0
 7642 04d8 1E4B     		ldr	r3, .L388+76
 7643 04da 0022     		movs	r2, #0
 7644 04dc 1A60     		str	r2, [r3]
 7645              	.L341:
 7646              	.LBE6:
1822:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 7647              		.loc 1 1822 0
 7648 04de 174B     		ldr	r3, .L388+52
 7649 04e0 1B78     		ldrb	r3, [r3]
 7650 04e2 DBB2     		uxtb	r3, r3
 7651 04e4 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 7652 04e6 9A42     		cmp	r2, r3
 7653 04e8 3FF4B1AD 		beq	.L385
 7654              	.L384:
ARM GAS  /tmp/ccUeeWpa.s 			page 169


1989:bluetooth_rxtx.c **** 	}
1990:bluetooth_rxtx.c **** 
1991:bluetooth_rxtx.c **** cleanup:
1992:bluetooth_rxtx.c **** 
1993:bluetooth_rxtx.c **** 	// disable USB interrupts
1994:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
 7655              		.loc 1 1994 0
 7656 04ec 1A4B     		ldr	r3, .L388+80
 7657 04ee 4FF08072 		mov	r2, #16777216
 7658 04f2 1A60     		str	r2, [r3]
1995:bluetooth_rxtx.c **** 
1996:bluetooth_rxtx.c **** 	// reset the radio completely
1997:bluetooth_rxtx.c **** 	cc2400_idle();
 7659              		.loc 1 1997 0
 7660 04f4 FFF7FEFF 		bl	cc2400_idle
1998:bluetooth_rxtx.c **** 	dio_ssp_stop();
 7661              		.loc 1 1998 0
 7662 04f8 FFF7FEFF 		bl	dio_ssp_stop
1999:bluetooth_rxtx.c **** 	cs_trigger_disable();
 7663              		.loc 1 1999 0
 7664 04fc FFF7FEFF 		bl	cs_trigger_disable
2000:bluetooth_rxtx.c **** }
 7665              		.loc 1 2000 0
 7666 0500 6C37     		adds	r7, r7, #108
 7667              		.cfi_def_cfa_offset 12
 7668 0502 BD46     		mov	sp, r7
 7669              		.cfi_def_cfa_register 13
 7670              		@ sp needed
 7671 0504 90BD     		pop	{r4, r7, pc}
 7672              	.L389:
 7673 0506 00BF     		.align	2
 7674              	.L388:
 7675 0508 00000000 		.word	rxbuf1
 7676 050c 00000000 		.word	le
 7677 0510 38C00920 		.word	537509944
 7678 0514 00000000 		.word	packet_cb
 7679 0518 00000000 		.word	clkn
 7680 051c 08400040 		.word	1073758216
 7681 0520 24000340 		.word	1073938468
 7682 0524 08000340 		.word	1073938440
 7683 0528 0C000340 		.word	1073938444
 7684 052c 80F0FA02 		.word	50000000
 7685 0530 00000000 		.word	le_jam_count
 7686 0534 3CC00920 		.word	537509948
 7687 0538 00000000 		.word	jam_mode
 7688 053c 00000000 		.word	requested_mode
 7689 0540 00000000 		.word	saved_request
 7690 0544 00000000 		.word	channel
 7691 0548 D4000000 		.word	restart_jamming.4707
 7692 054c 00000000 		.word	do_hop
 7693 0550 00000000 		.word	rx_tc
 7694 0554 00000000 		.word	rx_err
 7695 0558 80E100E0 		.word	-536813184
 7696              		.cfi_endproc
 7697              	.LFE33:
 7699              		.section	.text.cb_follow_le,"ax",%progbits
 7700              		.align	2
ARM GAS  /tmp/ccUeeWpa.s 			page 170


 7701              		.global	cb_follow_le
 7702              		.thumb
 7703              		.thumb_func
 7705              	cb_follow_le:
 7706              	.LFB34:
2001:bluetooth_rxtx.c **** 
2002:bluetooth_rxtx.c **** 
2003:bluetooth_rxtx.c **** 
2004:bluetooth_rxtx.c **** /* low energy connection following
2005:bluetooth_rxtx.c ****  * follows a known AA around */
2006:bluetooth_rxtx.c **** int cb_follow_le() {
 7707              		.loc 1 2006 0
 7708              		.cfi_startproc
 7709              		@ args = 0, pretend = 0, frame = 48
 7710              		@ frame_needed = 1, uses_anonymous_args = 0
 7711 0000 80B5     		push	{r7, lr}
 7712              		.cfi_def_cfa_offset 8
 7713              		.cfi_offset 7, -8
 7714              		.cfi_offset 14, -4
 7715 0002 8CB0     		sub	sp, sp, #48
 7716              		.cfi_def_cfa_offset 56
 7717 0004 00AF     		add	r7, sp, #0
 7718              		.cfi_def_cfa_register 7
2007:bluetooth_rxtx.c **** 	int i, j, k;
2008:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel-2402)];
 7719              		.loc 1 2008 0
 7720 0006 6C4B     		ldr	r3, .L406
 7721 0008 1B88     		ldrh	r3, [r3]	@ movhi
 7722 000a 9BB2     		uxth	r3, r3
 7723 000c DBB2     		uxtb	r3, r3
 7724 000e 623B     		subs	r3, r3, #98
 7725 0010 DBB2     		uxtb	r3, r3
 7726 0012 1846     		mov	r0, r3
 7727 0014 FFF7FEFF 		bl	btle_channel_index
 7728 0018 0346     		mov	r3, r0
 7729 001a 1A46     		mov	r2, r3
 7730 001c 674B     		ldr	r3, .L406+4
 7731 001e 9B5C     		ldrb	r3, [r3, r2]	@ zero_extendqisi2
 7732 0020 3B62     		str	r3, [r7, #32]
2009:bluetooth_rxtx.c **** 
2010:bluetooth_rxtx.c **** 	u32 access_address = 0;
 7733              		.loc 1 2010 0
 7734 0022 0023     		movs	r3, #0
 7735 0024 FB61     		str	r3, [r7, #28]
2011:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 7736              		.loc 1 2011 0
 7737 0026 0023     		movs	r3, #0
 7738 0028 FB62     		str	r3, [r7, #44]
 7739 002a 0EE0     		b	.L391
 7740              	.L392:
2012:bluetooth_rxtx.c **** 		access_address >>= 1;
 7741              		.loc 1 2012 0 discriminator 3
 7742 002c FB69     		ldr	r3, [r7, #28]
 7743 002e 5B08     		lsrs	r3, r3, #1
 7744 0030 FB61     		str	r3, [r7, #28]
2013:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
 7745              		.loc 1 2013 0 discriminator 3
ARM GAS  /tmp/ccUeeWpa.s 			page 171


 7746 0032 634A     		ldr	r2, .L406+8
 7747 0034 FB6A     		ldr	r3, [r7, #44]
 7748 0036 1344     		add	r3, r3, r2
 7749 0038 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 7750 003a DB07     		lsls	r3, r3, #31
 7751 003c 1A46     		mov	r2, r3
 7752 003e FB69     		ldr	r3, [r7, #28]
 7753 0040 1343     		orrs	r3, r3, r2
 7754 0042 FB61     		str	r3, [r7, #28]
2011:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 7755              		.loc 1 2011 0 discriminator 3
 7756 0044 FB6A     		ldr	r3, [r7, #44]
 7757 0046 0133     		adds	r3, r3, #1
 7758 0048 FB62     		str	r3, [r7, #44]
 7759              	.L391:
2011:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 7760              		.loc 1 2011 0 is_stmt 0 discriminator 1
 7761 004a FB6A     		ldr	r3, [r7, #44]
 7762 004c 1E2B     		cmp	r3, #30
 7763 004e EDDD     		ble	.L392
2014:bluetooth_rxtx.c **** 	}
2015:bluetooth_rxtx.c **** 
2016:bluetooth_rxtx.c **** 	for (i = 31; i < DMA_SIZE * 8 + 32; i++) {
 7764              		.loc 1 2016 0 is_stmt 1
 7765 0050 1F23     		movs	r3, #31
 7766 0052 FB62     		str	r3, [r7, #44]
 7767 0054 A6E0     		b	.L393
 7768              	.L404:
2017:bluetooth_rxtx.c **** 		access_address >>= 1;
 7769              		.loc 1 2017 0
 7770 0056 FB69     		ldr	r3, [r7, #28]
 7771 0058 5B08     		lsrs	r3, r3, #1
 7772 005a FB61     		str	r3, [r7, #28]
2018:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
 7773              		.loc 1 2018 0
 7774 005c 584A     		ldr	r2, .L406+8
 7775 005e FB6A     		ldr	r3, [r7, #44]
 7776 0060 1344     		add	r3, r3, r2
 7777 0062 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 7778 0064 DB07     		lsls	r3, r3, #31
 7779 0066 1A46     		mov	r2, r3
 7780 0068 FB69     		ldr	r3, [r7, #28]
 7781 006a 1343     		orrs	r3, r3, r2
 7782 006c FB61     		str	r3, [r7, #28]
2019:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 7783              		.loc 1 2019 0
 7784 006e 554B     		ldr	r3, .L406+12
 7785 0070 1A68     		ldr	r2, [r3]
 7786 0072 FB69     		ldr	r3, [r7, #28]
 7787 0074 9A42     		cmp	r2, r3
 7788 0076 40F09280 		bne	.L394
2020:bluetooth_rxtx.c **** 			for (j = 0; j < 46; ++j) {
 7789              		.loc 1 2020 0
 7790 007a 0023     		movs	r3, #0
 7791 007c BB62     		str	r3, [r7, #40]
 7792 007e 48E0     		b	.L395
 7793              	.L401:
ARM GAS  /tmp/ccUeeWpa.s 			page 172


 7794              	.LBB11:
2021:bluetooth_rxtx.c **** 				u8 byte = 0;
 7795              		.loc 1 2021 0
 7796 0080 0023     		movs	r3, #0
 7797 0082 FB76     		strb	r3, [r7, #27]
2022:bluetooth_rxtx.c **** 				for (k = 0; k < 8; k++) {
 7798              		.loc 1 2022 0
 7799 0084 0023     		movs	r3, #0
 7800 0086 7B62     		str	r3, [r7, #36]
 7801 0088 37E0     		b	.L396
 7802              	.L400:
 7803              	.LBB12:
2023:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 7804              		.loc 1 2023 0
 7805 008a BB6A     		ldr	r3, [r7, #40]
 7806 008c DA00     		lsls	r2, r3, #3
 7807 008e 7B6A     		ldr	r3, [r7, #36]
 7808 0090 1A44     		add	r2, r2, r3
 7809 0092 FB6A     		ldr	r3, [r7, #44]
 7810 0094 1344     		add	r3, r3, r2
 7811 0096 1F3B     		subs	r3, r3, #31
 7812 0098 3B61     		str	r3, [r7, #16]
2024:bluetooth_rxtx.c **** 					if (offset >= DMA_SIZE*8*2) break;
 7813              		.loc 1 2024 0
 7814 009a 3B69     		ldr	r3, [r7, #16]
 7815 009c B3F5487F 		cmp	r3, #800
 7816 00a0 00DB     		blt	.L397
 7817 00a2 2DE0     		b	.L398
 7818              	.L397:
2025:bluetooth_rxtx.c **** 					int bit = unpacked[offset];
 7819              		.loc 1 2025 0
 7820 00a4 464A     		ldr	r2, .L406+8
 7821 00a6 3B69     		ldr	r3, [r7, #16]
 7822 00a8 1344     		add	r3, r3, r2
 7823 00aa 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 7824 00ac 7B61     		str	r3, [r7, #20]
2026:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 7825              		.loc 1 2026 0
 7826 00ae BB6A     		ldr	r3, [r7, #40]
 7827 00b0 032B     		cmp	r3, #3
 7828 00b2 16DD     		ble	.L399
2027:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 7829              		.loc 1 2027 0
 7830 00b4 444A     		ldr	r2, .L406+16
 7831 00b6 3B6A     		ldr	r3, [r7, #32]
 7832 00b8 1344     		add	r3, r3, r2
 7833 00ba 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 7834 00bc 1A46     		mov	r2, r3
 7835 00be 7B69     		ldr	r3, [r7, #20]
 7836 00c0 5340     		eors	r3, r3, r2
 7837 00c2 7B61     		str	r3, [r7, #20]
2028:bluetooth_rxtx.c **** 						idx = (idx + 1) % sizeof(whitening);
 7838              		.loc 1 2028 0
 7839 00c4 3B6A     		ldr	r3, [r7, #32]
 7840 00c6 0133     		adds	r3, r3, #1
 7841 00c8 1946     		mov	r1, r3
 7842 00ca 404B     		ldr	r3, .L406+20
ARM GAS  /tmp/ccUeeWpa.s 			page 173


 7843 00cc A1FB0323 		umull	r2, r3, r1, r3
 7844 00d0 C81A     		subs	r0, r1, r3
 7845 00d2 4008     		lsrs	r0, r0, #1
 7846 00d4 0344     		add	r3, r3, r0
 7847 00d6 9A09     		lsrs	r2, r3, #6
 7848 00d8 1346     		mov	r3, r2
 7849 00da DB01     		lsls	r3, r3, #7
 7850 00dc 9B1A     		subs	r3, r3, r2
 7851 00de CA1A     		subs	r2, r1, r3
 7852 00e0 3A62     		str	r2, [r7, #32]
 7853              	.L399:
2029:bluetooth_rxtx.c **** 					}
2030:bluetooth_rxtx.c **** 					byte |= bit << k;
 7854              		.loc 1 2030 0 discriminator 2
 7855 00e2 7A69     		ldr	r2, [r7, #20]
 7856 00e4 7B6A     		ldr	r3, [r7, #36]
 7857 00e6 02FA03F3 		lsl	r3, r2, r3
 7858 00ea DAB2     		uxtb	r2, r3
 7859 00ec FB7E     		ldrb	r3, [r7, #27]	@ zero_extendqisi2
 7860 00ee 1343     		orrs	r3, r3, r2
 7861 00f0 DBB2     		uxtb	r3, r3
 7862 00f2 FB76     		strb	r3, [r7, #27]
 7863              	.LBE12:
2022:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 7864              		.loc 1 2022 0 discriminator 2
 7865 00f4 7B6A     		ldr	r3, [r7, #36]
 7866 00f6 0133     		adds	r3, r3, #1
 7867 00f8 7B62     		str	r3, [r7, #36]
 7868              	.L396:
2022:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 7869              		.loc 1 2022 0 is_stmt 0 discriminator 1
 7870 00fa 7B6A     		ldr	r3, [r7, #36]
 7871 00fc 072B     		cmp	r3, #7
 7872 00fe C4DD     		ble	.L400
 7873              	.L398:
2031:bluetooth_rxtx.c **** 				}
2032:bluetooth_rxtx.c **** 				idle_rxbuf[j] = byte;
 7874              		.loc 1 2032 0 is_stmt 1 discriminator 2
 7875 0100 334B     		ldr	r3, .L406+24
 7876 0102 1A68     		ldr	r2, [r3]
 7877 0104 BB6A     		ldr	r3, [r7, #40]
 7878 0106 1344     		add	r3, r3, r2
 7879 0108 FA7E     		ldrb	r2, [r7, #27]
 7880 010a 1A70     		strb	r2, [r3]
 7881              	.LBE11:
2020:bluetooth_rxtx.c **** 				u8 byte = 0;
 7882              		.loc 1 2020 0 discriminator 2
 7883 010c BB6A     		ldr	r3, [r7, #40]
 7884 010e 0133     		adds	r3, r3, #1
 7885 0110 BB62     		str	r3, [r7, #40]
 7886              	.L395:
2020:bluetooth_rxtx.c **** 				u8 byte = 0;
 7887              		.loc 1 2020 0 is_stmt 0 discriminator 1
 7888 0112 BB6A     		ldr	r3, [r7, #40]
 7889 0114 2D2B     		cmp	r3, #45
 7890 0116 B3DD     		ble	.L401
2033:bluetooth_rxtx.c **** 			}
ARM GAS  /tmp/ccUeeWpa.s 			page 174


2034:bluetooth_rxtx.c **** 
2035:bluetooth_rxtx.c **** 			// verify CRC
2036:bluetooth_rxtx.c **** 			if (le.crc_verify) {
 7891              		.loc 1 2036 0 is_stmt 1
 7892 0118 2A4B     		ldr	r3, .L406+12
 7893 011a 1B69     		ldr	r3, [r3, #16]
 7894 011c 002B     		cmp	r3, #0
 7895 011e 2ED0     		beq	.L402
 7896              	.LBB13:
2037:bluetooth_rxtx.c **** 				int len		 = (idle_rxbuf[5] & 0x3f) + 2;
 7897              		.loc 1 2037 0
 7898 0120 2B4B     		ldr	r3, .L406+24
 7899 0122 1B68     		ldr	r3, [r3]
 7900 0124 0533     		adds	r3, r3, #5
 7901 0126 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 7902 0128 03F03F03 		and	r3, r3, #63
 7903 012c 0233     		adds	r3, r3, #2
 7904 012e FB60     		str	r3, [r7, #12]
2038:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, idle_rxbuf + 4, len);
 7905              		.loc 1 2038 0
 7906 0130 244B     		ldr	r3, .L406+12
 7907 0132 DA68     		ldr	r2, [r3, #12]
 7908 0134 264B     		ldr	r3, .L406+24
 7909 0136 1B68     		ldr	r3, [r3]
 7910 0138 0433     		adds	r3, r3, #4
 7911 013a 1046     		mov	r0, r2
 7912 013c 1946     		mov	r1, r3
 7913 013e FA68     		ldr	r2, [r7, #12]
 7914 0140 FFF7FEFF 		bl	btle_crcgen_lut
 7915 0144 B860     		str	r0, [r7, #8]
2039:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 7916              		.loc 1 2039 0
 7917 0146 224B     		ldr	r3, .L406+24
 7918 0148 1A68     		ldr	r2, [r3]
 7919 014a FB68     		ldr	r3, [r7, #12]
 7920 014c 0633     		adds	r3, r3, #6
 7921 014e 1344     		add	r3, r3, r2
 7922 0150 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 7923 0152 1A04     		lsls	r2, r3, #16
2040:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
 7924              		.loc 1 2040 0
 7925 0154 1E4B     		ldr	r3, .L406+24
 7926 0156 1968     		ldr	r1, [r3]
 7927 0158 FB68     		ldr	r3, [r7, #12]
 7928 015a 0533     		adds	r3, r3, #5
 7929 015c 0B44     		add	r3, r3, r1
 7930 015e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 7931 0160 1B02     		lsls	r3, r3, #8
 7932 0162 1343     		orrs	r3, r3, r2
2041:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 7933              		.loc 1 2041 0
 7934 0164 1A4A     		ldr	r2, .L406+24
 7935 0166 1268     		ldr	r2, [r2]
 7936 0168 F968     		ldr	r1, [r7, #12]
 7937 016a 0431     		adds	r1, r1, #4
 7938 016c 0A44     		add	r2, r2, r1
 7939 016e 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
ARM GAS  /tmp/ccUeeWpa.s 			page 175


 7940 0170 1343     		orrs	r3, r3, r2
2039:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 7941              		.loc 1 2039 0
 7942 0172 7B60     		str	r3, [r7, #4]
2042:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 7943              		.loc 1 2042 0
 7944 0174 BA68     		ldr	r2, [r7, #8]
 7945 0176 7B68     		ldr	r3, [r7, #4]
 7946 0178 9A42     		cmp	r2, r3
 7947 017a 00D0     		beq	.L402
2043:bluetooth_rxtx.c **** 					break;
 7948              		.loc 1 2043 0
 7949 017c 17E0     		b	.L403
 7950              	.L402:
 7951              	.LBE13:
2044:bluetooth_rxtx.c **** 			}
2045:bluetooth_rxtx.c **** 
2046:bluetooth_rxtx.c **** 			// send to PC
2047:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, idle_rxbuf);
 7952              		.loc 1 2047 0
 7953 017e 144B     		ldr	r3, .L406+24
 7954 0180 1B68     		ldr	r3, [r3]
 7955 0182 0120     		movs	r0, #1
 7956 0184 1946     		mov	r1, r3
 7957 0186 FFF7FEFF 		bl	enqueue
2048:bluetooth_rxtx.c **** 			RXLED_SET;
 7958              		.loc 1 2048 0
 7959 018a 124B     		ldr	r3, .L406+28
 7960 018c 1022     		movs	r2, #16
 7961 018e 1A60     		str	r2, [r3]
2049:bluetooth_rxtx.c **** 
2050:bluetooth_rxtx.c **** 			packet_cb(idle_rxbuf);
 7962              		.loc 1 2050 0
 7963 0190 114B     		ldr	r3, .L406+32
 7964 0192 1B68     		ldr	r3, [r3]
 7965 0194 0E4A     		ldr	r2, .L406+24
 7966 0196 1268     		ldr	r2, [r2]
 7967 0198 1046     		mov	r0, r2
 7968 019a 9847     		blx	r3
2051:bluetooth_rxtx.c **** 
2052:bluetooth_rxtx.c **** 			break;
 7969              		.loc 1 2052 0
 7970 019c 07E0     		b	.L403
 7971              	.L394:
2016:bluetooth_rxtx.c **** 		access_address >>= 1;
 7972              		.loc 1 2016 0 discriminator 2
 7973 019e FB6A     		ldr	r3, [r7, #44]
 7974 01a0 0133     		adds	r3, r3, #1
 7975 01a2 FB62     		str	r3, [r7, #44]
 7976              	.L393:
2016:bluetooth_rxtx.c **** 		access_address >>= 1;
 7977              		.loc 1 2016 0 is_stmt 0 discriminator 1
 7978 01a4 FB6A     		ldr	r3, [r7, #44]
 7979 01a6 B3F5D87F 		cmp	r3, #432
 7980 01aa FFF654AF 		blt	.L404
 7981              	.L403:
2053:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccUeeWpa.s 			page 176


2054:bluetooth_rxtx.c **** 	}
2055:bluetooth_rxtx.c **** 
2056:bluetooth_rxtx.c **** 	return 1;
 7982              		.loc 1 2056 0 is_stmt 1
 7983 01ae 0123     		movs	r3, #1
2057:bluetooth_rxtx.c **** }
 7984              		.loc 1 2057 0
 7985 01b0 1846     		mov	r0, r3
 7986 01b2 3037     		adds	r7, r7, #48
 7987              		.cfi_def_cfa_offset 8
 7988 01b4 BD46     		mov	sp, r7
 7989              		.cfi_def_cfa_register 13
 7990              		@ sp needed
 7991 01b6 80BD     		pop	{r7, pc}
 7992              	.L407:
 7993              		.align	2
 7994              	.L406:
 7995 01b8 00000000 		.word	channel
 7996 01bc AC000000 		.word	whitening_index
 7997 01c0 00000000 		.word	unpacked
 7998 01c4 00000000 		.word	le
 7999 01c8 2C000000 		.word	whitening
 8000 01cc 11080402 		.word	33818641
 8001 01d0 00000000 		.word	idle_rxbuf
 8002 01d4 38C00920 		.word	537509944
 8003 01d8 00000000 		.word	packet_cb
 8004              		.cfi_endproc
 8005              	.LFE34:
 8007              		.section	.text.connection_follow_cb,"ax",%progbits
 8008              		.align	2
 8009              		.global	connection_follow_cb
 8010              		.thumb
 8011              		.thumb_func
 8013              	connection_follow_cb:
 8014              	.LFB35:
2058:bluetooth_rxtx.c **** 
2059:bluetooth_rxtx.c **** /**
2060:bluetooth_rxtx.c ****  * Called when we receive a packet in connection following mode.
2061:bluetooth_rxtx.c ****  */
2062:bluetooth_rxtx.c **** void connection_follow_cb(u8 *packet) {
 8015              		.loc 1 2062 0
 8016              		.cfi_startproc
 8017              		@ args = 0, pretend = 0, frame = 40
 8018              		@ frame_needed = 1, uses_anonymous_args = 0
 8019 0000 80B5     		push	{r7, lr}
 8020              		.cfi_def_cfa_offset 8
 8021              		.cfi_offset 7, -8
 8022              		.cfi_offset 14, -4
 8023 0002 8AB0     		sub	sp, sp, #40
 8024              		.cfi_def_cfa_offset 48
 8025 0004 00AF     		add	r7, sp, #0
 8026              		.cfi_def_cfa_register 7
 8027 0006 7860     		str	r0, [r7, #4]
2063:bluetooth_rxtx.c **** 	int i;
2064:bluetooth_rxtx.c **** 	u32 aa = 0;
 8028              		.loc 1 2064 0
 8029 0008 0023     		movs	r3, #0
ARM GAS  /tmp/ccUeeWpa.s 			page 177


 8030 000a 3B62     		str	r3, [r7, #32]
2065:bluetooth_rxtx.c **** 
2066:bluetooth_rxtx.c **** #define ADV_ADDRESS_IDX 0
2067:bluetooth_rxtx.c **** #define HEADER_IDX 4
2068:bluetooth_rxtx.c **** #define DATA_LEN_IDX 5
2069:bluetooth_rxtx.c **** #define DATA_START_IDX 6
2070:bluetooth_rxtx.c **** 
2071:bluetooth_rxtx.c **** 	u8 *adv_addr = &packet[ADV_ADDRESS_IDX];
 8031              		.loc 1 2071 0
 8032 000c 7B68     		ldr	r3, [r7, #4]
 8033 000e FB61     		str	r3, [r7, #28]
2072:bluetooth_rxtx.c **** 	u8 header = packet[HEADER_IDX];
 8034              		.loc 1 2072 0
 8035 0010 7B68     		ldr	r3, [r7, #4]
 8036 0012 1B79     		ldrb	r3, [r3, #4]
 8037 0014 FB76     		strb	r3, [r7, #27]
2073:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
 8038              		.loc 1 2073 0
 8039 0016 7B68     		ldr	r3, [r7, #4]
 8040 0018 0533     		adds	r3, r3, #5
 8041 001a 7B61     		str	r3, [r7, #20]
2074:bluetooth_rxtx.c **** 	u8 *data = &packet[DATA_START_IDX];
 8042              		.loc 1 2074 0
 8043 001c 7B68     		ldr	r3, [r7, #4]
 8044 001e 0633     		adds	r3, r3, #6
 8045 0020 3B61     		str	r3, [r7, #16]
2075:bluetooth_rxtx.c **** 	u8 *crc = &packet[DATA_START_IDX + *data_len];
 8046              		.loc 1 2075 0
 8047 0022 7B69     		ldr	r3, [r7, #20]
 8048 0024 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8049 0026 0633     		adds	r3, r3, #6
 8050 0028 1A46     		mov	r2, r3
 8051 002a 7B68     		ldr	r3, [r7, #4]
 8052 002c 1344     		add	r3, r3, r2
 8053 002e FB60     		str	r3, [r7, #12]
2076:bluetooth_rxtx.c **** 
2077:bluetooth_rxtx.c **** 	if (le.link_state == LINK_CONN_PENDING) {
 8054              		.loc 1 2077 0
 8055 0030 8B4B     		ldr	r3, .L418
 8056 0032 1B7D     		ldrb	r3, [r3, #20]	@ zero_extendqisi2
 8057 0034 022B     		cmp	r3, #2
 8058 0036 1CD1     		bne	.L409
2078:bluetooth_rxtx.c **** 		// We received a packet in the connection pending state, so now the device *should* be connected
2079:bluetooth_rxtx.c **** 		le.link_state = LINK_CONNECTED;
 8059              		.loc 1 2079 0
 8060 0038 894B     		ldr	r3, .L418
 8061 003a 0322     		movs	r2, #3
 8062 003c 1A75     		strb	r2, [r3, #20]
2080:bluetooth_rxtx.c **** 		le.conn_epoch = clkn;
 8063              		.loc 1 2080 0
 8064 003e 894B     		ldr	r3, .L418+4
 8065 0040 1B68     		ldr	r3, [r3]
 8066 0042 874A     		ldr	r2, .L418
 8067 0044 9361     		str	r3, [r2, #24]
2081:bluetooth_rxtx.c **** 		le.interval_timer = le.conn_interval - 1;
 8068              		.loc 1 2081 0
 8069 0046 864B     		ldr	r3, .L418
ARM GAS  /tmp/ccUeeWpa.s 			page 178


 8070 0048 DB8B     		ldrh	r3, [r3, #30]
 8071 004a 013B     		subs	r3, r3, #1
 8072 004c 9AB2     		uxth	r2, r3
 8073 004e 844B     		ldr	r3, .L418
 8074 0050 9A83     		strh	r2, [r3, #28]	@ movhi
2082:bluetooth_rxtx.c **** 		le.conn_count = 0;
 8075              		.loc 1 2082 0
 8076 0052 834B     		ldr	r3, .L418
 8077 0054 0022     		movs	r2, #0
 8078 0056 1A84     		strh	r2, [r3, #32]	@ movhi
2083:bluetooth_rxtx.c **** 		le.update_pending = 0;
 8079              		.loc 1 2083 0
 8080 0058 814B     		ldr	r3, .L418
 8081 005a 0022     		movs	r2, #0
 8082 005c 9A62     		str	r2, [r3, #40]
2084:bluetooth_rxtx.c **** 
2085:bluetooth_rxtx.c **** 		// hue hue hue
2086:bluetooth_rxtx.c **** 		if (jam_mode != JAM_NONE)
 8083              		.loc 1 2086 0
 8084 005e 824B     		ldr	r3, .L418+8
 8085 0060 1B78     		ldrb	r3, [r3]
 8086 0062 DBB2     		uxtb	r3, r3
 8087 0064 002B     		cmp	r3, #0
 8088 0066 00F0F780 		beq	.L408
2087:bluetooth_rxtx.c **** 			le_jam_count = JAM_COUNT_DEFAULT;
 8089              		.loc 1 2087 0
 8090 006a 804B     		ldr	r3, .L418+12
 8091 006c 2822     		movs	r2, #40
 8092 006e 1A60     		str	r2, [r3]
 8093 0070 F2E0     		b	.L408
 8094              	.L409:
2088:bluetooth_rxtx.c **** 
2089:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_CONNECTED) {
 8095              		.loc 1 2089 0
 8096 0072 7B4B     		ldr	r3, .L418
 8097 0074 1B7D     		ldrb	r3, [r3, #20]	@ zero_extendqisi2
 8098 0076 032B     		cmp	r3, #3
 8099 0078 6FD1     		bne	.L412
 8100              	.LBB14:
2090:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
 8101              		.loc 1 2090 0
 8102 007a FB7E     		ldrb	r3, [r7, #27]
 8103 007c 03F00303 		and	r3, r3, #3
 8104 0080 FB72     		strb	r3, [r7, #11]
2091:bluetooth_rxtx.c **** 
2092:bluetooth_rxtx.c **** 		// Apply any connection parameter update if necessary
2093:bluetooth_rxtx.c **** 		if (le.update_pending && le.conn_count == le.update_instant) {
 8105              		.loc 1 2093 0
 8106 0082 774B     		ldr	r3, .L418
 8107 0084 9B6A     		ldr	r3, [r3, #40]
 8108 0086 002B     		cmp	r3, #0
 8109 0088 21D0     		beq	.L413
 8110              		.loc 1 2093 0 is_stmt 0 discriminator 1
 8111 008a 754B     		ldr	r3, .L418
 8112 008c 1B8C     		ldrh	r3, [r3, #32]	@ movhi
 8113 008e 9AB2     		uxth	r2, r3
 8114 0090 734B     		ldr	r3, .L418
ARM GAS  /tmp/ccUeeWpa.s 			page 179


 8115 0092 9B8D     		ldrh	r3, [r3, #44]
 8116 0094 9A42     		cmp	r2, r3
 8117 0096 1AD1     		bne	.L413
2094:bluetooth_rxtx.c **** 			// This is the first packet received in the connection interval for which the new parameters app
2095:bluetooth_rxtx.c **** 			le.conn_epoch = clkn;
 8118              		.loc 1 2095 0 is_stmt 1
 8119 0098 724B     		ldr	r3, .L418+4
 8120 009a 1B68     		ldr	r3, [r3]
 8121 009c 704A     		ldr	r2, .L418
 8122 009e 9361     		str	r3, [r2, #24]
2096:bluetooth_rxtx.c **** 			le.conn_interval = le.interval_update;
 8123              		.loc 1 2096 0
 8124 00a0 6F4B     		ldr	r3, .L418
 8125 00a2 DA8D     		ldrh	r2, [r3, #46]
 8126 00a4 6E4B     		ldr	r3, .L418
 8127 00a6 DA83     		strh	r2, [r3, #30]	@ movhi
2097:bluetooth_rxtx.c **** 			le.interval_timer = le.interval_update - 1;
 8128              		.loc 1 2097 0
 8129 00a8 6D4B     		ldr	r3, .L418
 8130 00aa DB8D     		ldrh	r3, [r3, #46]
 8131 00ac 013B     		subs	r3, r3, #1
 8132 00ae 9AB2     		uxth	r2, r3
 8133 00b0 6B4B     		ldr	r3, .L418
 8134 00b2 9A83     		strh	r2, [r3, #28]	@ movhi
2098:bluetooth_rxtx.c **** 			le.win_size = le.win_size_update;
 8135              		.loc 1 2098 0
 8136 00b4 6A4B     		ldr	r3, .L418
 8137 00b6 93F83020 		ldrb	r2, [r3, #48]	@ zero_extendqisi2
 8138 00ba 694B     		ldr	r3, .L418
 8139 00bc 83F82220 		strb	r2, [r3, #34]
2099:bluetooth_rxtx.c **** 			le.win_offset = le.win_offset_update;
 8140              		.loc 1 2099 0
 8141 00c0 674B     		ldr	r3, .L418
 8142 00c2 5A8E     		ldrh	r2, [r3, #50]
 8143 00c4 664B     		ldr	r3, .L418
 8144 00c6 9A84     		strh	r2, [r3, #36]	@ movhi
2100:bluetooth_rxtx.c **** 			le.update_pending = 0;
 8145              		.loc 1 2100 0
 8146 00c8 654B     		ldr	r3, .L418
 8147 00ca 0022     		movs	r2, #0
 8148 00cc 9A62     		str	r2, [r3, #40]
 8149              	.L413:
2101:bluetooth_rxtx.c **** 		}
2102:bluetooth_rxtx.c **** 
2103:bluetooth_rxtx.c **** 		if (llid == 0x03 && data[0] == 0x00) {
 8150              		.loc 1 2103 0
 8151 00ce FB7A     		ldrb	r3, [r7, #11]	@ zero_extendqisi2
 8152 00d0 032B     		cmp	r3, #3
 8153 00d2 41D1     		bne	.L414
 8154              		.loc 1 2103 0 is_stmt 0 discriminator 1
 8155 00d4 3B69     		ldr	r3, [r7, #16]
 8156 00d6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8157 00d8 002B     		cmp	r3, #0
 8158 00da 3DD1     		bne	.L414
2104:bluetooth_rxtx.c **** 			// This is a CONNECTION_UPDATE_REQ.
2105:bluetooth_rxtx.c **** 			// The host is changing the connection parameters.
2106:bluetooth_rxtx.c **** 			le.win_size_update = packet[7];
ARM GAS  /tmp/ccUeeWpa.s 			page 180


 8159              		.loc 1 2106 0 is_stmt 1
 8160 00dc 7B68     		ldr	r3, [r7, #4]
 8161 00de DA79     		ldrb	r2, [r3, #7]	@ zero_extendqisi2
 8162 00e0 5F4B     		ldr	r3, .L418
 8163 00e2 83F83020 		strb	r2, [r3, #48]
2107:bluetooth_rxtx.c **** 			le.win_offset_update = packet[8] + ((u16)packet[9] << 8);
 8164              		.loc 1 2107 0
 8165 00e6 7B68     		ldr	r3, [r7, #4]
 8166 00e8 0833     		adds	r3, r3, #8
 8167 00ea 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8168 00ec 9AB2     		uxth	r2, r3
 8169 00ee 7B68     		ldr	r3, [r7, #4]
 8170 00f0 0933     		adds	r3, r3, #9
 8171 00f2 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8172 00f4 9BB2     		uxth	r3, r3
 8173 00f6 1B02     		lsls	r3, r3, #8
 8174 00f8 9BB2     		uxth	r3, r3
 8175 00fa 1344     		add	r3, r3, r2
 8176 00fc 9AB2     		uxth	r2, r3
 8177 00fe 584B     		ldr	r3, .L418
 8178 0100 5A86     		strh	r2, [r3, #50]	@ movhi
2108:bluetooth_rxtx.c **** 			le.interval_update = packet[10] + ((u16)packet[11] << 8);
 8179              		.loc 1 2108 0
 8180 0102 7B68     		ldr	r3, [r7, #4]
 8181 0104 0A33     		adds	r3, r3, #10
 8182 0106 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8183 0108 9AB2     		uxth	r2, r3
 8184 010a 7B68     		ldr	r3, [r7, #4]
 8185 010c 0B33     		adds	r3, r3, #11
 8186 010e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8187 0110 9BB2     		uxth	r3, r3
 8188 0112 1B02     		lsls	r3, r3, #8
 8189 0114 9BB2     		uxth	r3, r3
 8190 0116 1344     		add	r3, r3, r2
 8191 0118 9AB2     		uxth	r2, r3
 8192 011a 514B     		ldr	r3, .L418
 8193 011c DA85     		strh	r2, [r3, #46]	@ movhi
2109:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 8194              		.loc 1 2109 0
 8195 011e 7B68     		ldr	r3, [r7, #4]
 8196 0120 1033     		adds	r3, r3, #16
 8197 0122 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8198 0124 9AB2     		uxth	r2, r3
 8199 0126 7B68     		ldr	r3, [r7, #4]
 8200 0128 1133     		adds	r3, r3, #17
 8201 012a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8202 012c 9BB2     		uxth	r3, r3
 8203 012e 1B02     		lsls	r3, r3, #8
 8204 0130 9BB2     		uxth	r3, r3
 8205 0132 1344     		add	r3, r3, r2
 8206 0134 9AB2     		uxth	r2, r3
 8207 0136 4A4B     		ldr	r3, .L418
 8208 0138 9A85     		strh	r2, [r3, #44]	@ movhi
2110:bluetooth_rxtx.c **** 			if (le.update_instant - le.conn_count < 32767)
 8209              		.loc 1 2110 0
 8210 013a 494B     		ldr	r3, .L418
 8211 013c 9B8D     		ldrh	r3, [r3, #44]
ARM GAS  /tmp/ccUeeWpa.s 			page 181


 8212 013e 1A46     		mov	r2, r3
 8213 0140 474B     		ldr	r3, .L418
 8214 0142 1B8C     		ldrh	r3, [r3, #32]	@ movhi
 8215 0144 9BB2     		uxth	r3, r3
 8216 0146 D31A     		subs	r3, r2, r3
 8217 0148 47F6FE72 		movw	r2, #32766
 8218 014c 9342     		cmp	r3, r2
 8219 014e 03DC     		bgt	.L414
2111:bluetooth_rxtx.c **** 				le.update_pending = 1;
 8220              		.loc 1 2111 0
 8221 0150 434B     		ldr	r3, .L418
 8222 0152 0122     		movs	r2, #1
 8223 0154 9A62     		str	r2, [r3, #40]
 8224              	.LBE14:
 8225 0156 7FE0     		b	.L408
 8226              	.L414:
 8227 0158 7EE0     		b	.L408
 8228              	.L412:
2112:bluetooth_rxtx.c **** 		}
2113:bluetooth_rxtx.c **** 
2114:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_LISTENING) {
 8229              		.loc 1 2114 0
 8230 015a 414B     		ldr	r3, .L418
 8231 015c 1B7D     		ldrb	r3, [r3, #20]	@ zero_extendqisi2
 8232 015e 012B     		cmp	r3, #1
 8233 0160 7AD1     		bne	.L408
 8234              	.LBB15:
2115:bluetooth_rxtx.c **** 		u8 pkt_type = packet[4] & 0x0F;
 8235              		.loc 1 2115 0
 8236 0162 7B68     		ldr	r3, [r7, #4]
 8237 0164 0433     		adds	r3, r3, #4
 8238 0166 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8239 0168 03F00F03 		and	r3, r3, #15
 8240 016c BB72     		strb	r3, [r7, #10]
2116:bluetooth_rxtx.c **** 		if (pkt_type == 0x05) {
 8241              		.loc 1 2116 0
 8242 016e BB7A     		ldrb	r3, [r7, #10]	@ zero_extendqisi2
 8243 0170 052B     		cmp	r3, #5
 8244 0172 71D1     		bne	.L408
2117:bluetooth_rxtx.c **** 			// This is a connect packet
2118:bluetooth_rxtx.c **** 			// if we have a target, see if InitA or AdvA matches
2119:bluetooth_rxtx.c **** 			if (le.target_set &&
 8245              		.loc 1 2119 0
 8246 0174 3A4B     		ldr	r3, .L418
 8247 0176 DB6B     		ldr	r3, [r3, #60]
 8248 0178 002B     		cmp	r3, #0
 8249 017a 14D0     		beq	.L415
2120:bluetooth_rxtx.c **** 			    memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
 8250              		.loc 1 2120 0 discriminator 1
 8251 017c 7B68     		ldr	r3, [r7, #4]
 8252 017e 0633     		adds	r3, r3, #6
 8253 0180 3B48     		ldr	r0, .L418+16
 8254 0182 1946     		mov	r1, r3
 8255 0184 0622     		movs	r2, #6
 8256 0186 FFF7FEFF 		bl	memcmp
 8257 018a 0346     		mov	r3, r0
2119:bluetooth_rxtx.c **** 			    memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
ARM GAS  /tmp/ccUeeWpa.s 			page 182


 8258              		.loc 1 2119 0 discriminator 1
 8259 018c 002B     		cmp	r3, #0
 8260 018e 0AD0     		beq	.L415
2121:bluetooth_rxtx.c **** 			    memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 8261              		.loc 1 2121 0
 8262 0190 7B68     		ldr	r3, [r7, #4]
 8263 0192 0C33     		adds	r3, r3, #12
 8264 0194 3648     		ldr	r0, .L418+16
 8265 0196 1946     		mov	r1, r3
 8266 0198 0622     		movs	r2, #6
 8267 019a FFF7FEFF 		bl	memcmp
 8268 019e 0346     		mov	r3, r0
2120:bluetooth_rxtx.c **** 			    memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
 8269              		.loc 1 2120 0
 8270 01a0 002B     		cmp	r3, #0
 8271 01a2 00D0     		beq	.L415
2122:bluetooth_rxtx.c **** 				return;
 8272              		.loc 1 2122 0
 8273 01a4 58E0     		b	.L408
 8274              	.L415:
2123:bluetooth_rxtx.c **** 			}
2124:bluetooth_rxtx.c **** 
2125:bluetooth_rxtx.c **** 			le.link_state = LINK_CONN_PENDING;
 8275              		.loc 1 2125 0
 8276 01a6 2E4B     		ldr	r3, .L418
 8277 01a8 0222     		movs	r2, #2
 8278 01aa 1A75     		strb	r2, [r3, #20]
2126:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 8279              		.loc 1 2126 0
 8280 01ac 2C4B     		ldr	r3, .L418
 8281 01ae 0022     		movs	r2, #0
 8282 01b0 1A61     		str	r2, [r3, #16]
2127:bluetooth_rxtx.c **** 
2128:bluetooth_rxtx.c **** 			for (i = 0; i < 4; ++i)
 8283              		.loc 1 2128 0
 8284 01b2 0023     		movs	r3, #0
 8285 01b4 7B62     		str	r3, [r7, #36]
 8286 01b6 11E0     		b	.L416
 8287              	.L417:
2129:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 8288              		.loc 1 2129 0 discriminator 3
 8289 01b8 7B6A     		ldr	r3, [r7, #36]
 8290 01ba 1233     		adds	r3, r3, #18
 8291 01bc 1A46     		mov	r2, r3
 8292 01be 7B68     		ldr	r3, [r7, #4]
 8293 01c0 1344     		add	r3, r3, r2
 8294 01c2 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8295 01c4 1A46     		mov	r2, r3
 8296 01c6 7B6A     		ldr	r3, [r7, #36]
 8297 01c8 DB00     		lsls	r3, r3, #3
 8298 01ca 02FA03F3 		lsl	r3, r2, r3
 8299 01ce 1A46     		mov	r2, r3
 8300 01d0 3B6A     		ldr	r3, [r7, #32]
 8301 01d2 1343     		orrs	r3, r3, r2
 8302 01d4 3B62     		str	r3, [r7, #32]
2128:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 8303              		.loc 1 2128 0 discriminator 3
ARM GAS  /tmp/ccUeeWpa.s 			page 183


 8304 01d6 7B6A     		ldr	r3, [r7, #36]
 8305 01d8 0133     		adds	r3, r3, #1
 8306 01da 7B62     		str	r3, [r7, #36]
 8307              	.L416:
2128:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 8308              		.loc 1 2128 0 is_stmt 0 discriminator 1
 8309 01dc 7B6A     		ldr	r3, [r7, #36]
 8310 01de 032B     		cmp	r3, #3
 8311 01e0 EADD     		ble	.L417
2130:bluetooth_rxtx.c **** 			le_set_access_address(aa);
 8312              		.loc 1 2130 0 is_stmt 1
 8313 01e2 386A     		ldr	r0, [r7, #32]
 8314 01e4 FFF7FEFF 		bl	le_set_access_address
2131:bluetooth_rxtx.c **** 
2132:bluetooth_rxtx.c **** #define CRC_INIT (2+4+6+6+4)
2133:bluetooth_rxtx.c **** 			le.crc_init = (packet[CRC_INIT+2] << 16)
 8315              		.loc 1 2133 0
 8316 01e8 7B68     		ldr	r3, [r7, #4]
 8317 01ea 1833     		adds	r3, r3, #24
 8318 01ec 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8319 01ee 1A04     		lsls	r2, r3, #16
2134:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 8320              		.loc 1 2134 0
 8321 01f0 7B68     		ldr	r3, [r7, #4]
 8322 01f2 1733     		adds	r3, r3, #23
 8323 01f4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8324 01f6 1B02     		lsls	r3, r3, #8
 8325 01f8 1343     		orrs	r3, r3, r2
2135:bluetooth_rxtx.c **** 						|  packet[CRC_INIT+0];
 8326              		.loc 1 2135 0
 8327 01fa 7A68     		ldr	r2, [r7, #4]
 8328 01fc 1632     		adds	r2, r2, #22
 8329 01fe 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 8330 0200 1343     		orrs	r3, r3, r2
2133:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 8331              		.loc 1 2133 0
 8332 0202 1A46     		mov	r2, r3
 8333 0204 164B     		ldr	r3, .L418
 8334 0206 9A60     		str	r2, [r3, #8]
2136:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 8335              		.loc 1 2136 0
 8336 0208 154B     		ldr	r3, .L418
 8337 020a 9B68     		ldr	r3, [r3, #8]
 8338 020c 1846     		mov	r0, r3
 8339 020e FFF7FEFF 		bl	rbit
 8340 0212 0246     		mov	r2, r0
 8341 0214 124B     		ldr	r3, .L418
 8342 0216 DA60     		str	r2, [r3, #12]
2137:bluetooth_rxtx.c **** 
2138:bluetooth_rxtx.c **** #define WIN_SIZE (2+4+6+6+4+3)
2139:bluetooth_rxtx.c **** 			le.win_size = packet[WIN_SIZE];
 8343              		.loc 1 2139 0
 8344 0218 7B68     		ldr	r3, [r7, #4]
 8345 021a 5A7E     		ldrb	r2, [r3, #25]	@ zero_extendqisi2
 8346 021c 104B     		ldr	r3, .L418
 8347 021e 83F82220 		strb	r2, [r3, #34]
2140:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccUeeWpa.s 			page 184


2141:bluetooth_rxtx.c **** #define WIN_OFFSET (2+4+6+6+4+3+1)
2142:bluetooth_rxtx.c **** 			le.win_offset = packet[WIN_OFFSET];
 8348              		.loc 1 2142 0
 8349 0222 7B68     		ldr	r3, [r7, #4]
 8350 0224 1A33     		adds	r3, r3, #26
 8351 0226 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8352 0228 9AB2     		uxth	r2, r3
 8353 022a 0D4B     		ldr	r3, .L418
 8354 022c 9A84     		strh	r2, [r3, #36]	@ movhi
2143:bluetooth_rxtx.c **** 
2144:bluetooth_rxtx.c **** #define CONN_INTERVAL (2+4+6+6+4+3+1+2)
2145:bluetooth_rxtx.c **** 			le.conn_interval = packet[CONN_INTERVAL];
 8355              		.loc 1 2145 0
 8356 022e 7B68     		ldr	r3, [r7, #4]
 8357 0230 1C33     		adds	r3, r3, #28
 8358 0232 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8359 0234 9AB2     		uxth	r2, r3
 8360 0236 0A4B     		ldr	r3, .L418
 8361 0238 DA83     		strh	r2, [r3, #30]	@ movhi
2146:bluetooth_rxtx.c **** 
2147:bluetooth_rxtx.c **** #define CHANNEL_INC (2+4+6+6+4+3+1+2+2+2+2+5)
2148:bluetooth_rxtx.c **** 			le.channel_increment = packet[CHANNEL_INC] & 0x1f;
 8362              		.loc 1 2148 0
 8363 023a 7B68     		ldr	r3, [r7, #4]
 8364 023c 2733     		adds	r3, r3, #39
 8365 023e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8366 0240 03F01F03 		and	r3, r3, #31
 8367 0244 DAB2     		uxtb	r2, r3
 8368 0246 064B     		ldr	r3, .L418
 8369 0248 9A75     		strb	r2, [r3, #22]
2149:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 8370              		.loc 1 2149 0
 8371 024a 054B     		ldr	r3, .L418
 8372 024c 9A7D     		ldrb	r2, [r3, #22]	@ zero_extendqisi2
 8373 024e 044B     		ldr	r3, .L418
 8374 0250 5A75     		strb	r2, [r3, #21]
2150:bluetooth_rxtx.c **** 
2151:bluetooth_rxtx.c **** 			// Hop to the initial channel immediately
2152:bluetooth_rxtx.c **** 			do_hop = 1;
 8375              		.loc 1 2152 0
 8376 0252 084B     		ldr	r3, .L418+20
 8377 0254 0122     		movs	r2, #1
 8378 0256 1A70     		strb	r2, [r3]
 8379              	.L408:
 8380              	.LBE15:
2153:bluetooth_rxtx.c **** 		}
2154:bluetooth_rxtx.c **** 	}
2155:bluetooth_rxtx.c **** }
 8381              		.loc 1 2155 0
 8382 0258 2837     		adds	r7, r7, #40
 8383              		.cfi_def_cfa_offset 8
 8384 025a BD46     		mov	sp, r7
 8385              		.cfi_def_cfa_register 13
 8386              		@ sp needed
 8387 025c 80BD     		pop	{r7, pc}
 8388              	.L419:
 8389 025e 00BF     		.align	2
ARM GAS  /tmp/ccUeeWpa.s 			page 185


 8390              	.L418:
 8391 0260 00000000 		.word	le
 8392 0264 00000000 		.word	clkn
 8393 0268 00000000 		.word	jam_mode
 8394 026c 00000000 		.word	le_jam_count
 8395 0270 34000000 		.word	le+52
 8396 0274 00000000 		.word	do_hop
 8397              		.cfi_endproc
 8398              	.LFE35:
 8400              		.section	.text.bt_follow_le,"ax",%progbits
 8401              		.align	2
 8402              		.global	bt_follow_le
 8403              		.thumb
 8404              		.thumb_func
 8406              	bt_follow_le:
 8407              	.LFB36:
2156:bluetooth_rxtx.c **** 
2157:bluetooth_rxtx.c **** void bt_follow_le() {
 8408              		.loc 1 2157 0
 8409              		.cfi_startproc
 8410              		@ args = 0, pretend = 0, frame = 0
 8411              		@ frame_needed = 1, uses_anonymous_args = 0
 8412 0000 80B5     		push	{r7, lr}
 8413              		.cfi_def_cfa_offset 8
 8414              		.cfi_offset 7, -8
 8415              		.cfi_offset 14, -4
 8416 0002 00AF     		add	r7, sp, #0
 8417              		.cfi_def_cfa_register 7
2158:bluetooth_rxtx.c **** 	reset_le();
 8418              		.loc 1 2158 0
 8419 0004 FFF7FEFF 		bl	reset_le
2159:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 8420              		.loc 1 2159 0
 8421 0008 044B     		ldr	r3, .L421
 8422 000a 054A     		ldr	r2, .L421+4
 8423 000c 1A60     		str	r2, [r3]
2160:bluetooth_rxtx.c **** 	bt_le_sync(MODE_BT_FOLLOW_LE);
 8424              		.loc 1 2160 0
 8425 000e 0920     		movs	r0, #9
 8426 0010 FFF7FEFF 		bl	bt_le_sync
2161:bluetooth_rxtx.c **** 
2162:bluetooth_rxtx.c **** 	/* old non-sync mode
2163:bluetooth_rxtx.c **** 	data_cb = cb_follow_le;
2164:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
2165:bluetooth_rxtx.c **** 	bt_generic_le(MODE_BT_FOLLOW_LE);
2166:bluetooth_rxtx.c **** 	*/
2167:bluetooth_rxtx.c **** 
2168:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 8427              		.loc 1 2168 0
 8428 0014 034B     		ldr	r3, .L421+8
 8429 0016 0022     		movs	r2, #0
 8430 0018 1A70     		strb	r2, [r3]
2169:bluetooth_rxtx.c **** }
 8431              		.loc 1 2169 0
 8432 001a 80BD     		pop	{r7, pc}
 8433              	.L422:
 8434              		.align	2
ARM GAS  /tmp/ccUeeWpa.s 			page 186


 8435              	.L421:
 8436 001c 00000000 		.word	packet_cb
 8437 0020 00000000 		.word	connection_follow_cb
 8438 0024 00000000 		.word	mode
 8439              		.cfi_endproc
 8440              	.LFE36:
 8442              		.section	.text.le_promisc_state,"ax",%progbits
 8443              		.align	2
 8444              		.global	le_promisc_state
 8445              		.thumb
 8446              		.thumb_func
 8448              	le_promisc_state:
 8449              	.LFB37:
2170:bluetooth_rxtx.c **** 
2171:bluetooth_rxtx.c **** // issue state change message
2172:bluetooth_rxtx.c **** void le_promisc_state(u8 type, void *data, unsigned len) {
 8450              		.loc 1 2172 0
 8451              		.cfi_startproc
 8452              		@ args = 0, pretend = 0, frame = 72
 8453              		@ frame_needed = 1, uses_anonymous_args = 0
 8454 0000 80B5     		push	{r7, lr}
 8455              		.cfi_def_cfa_offset 8
 8456              		.cfi_offset 7, -8
 8457              		.cfi_offset 14, -4
 8458 0002 92B0     		sub	sp, sp, #72
 8459              		.cfi_def_cfa_offset 80
 8460 0004 00AF     		add	r7, sp, #0
 8461              		.cfi_def_cfa_register 7
 8462 0006 0346     		mov	r3, r0
 8463 0008 B960     		str	r1, [r7, #8]
 8464 000a 7A60     		str	r2, [r7, #4]
 8465 000c FB73     		strb	r3, [r7, #15]
2173:bluetooth_rxtx.c **** 	u8 buf[50] = { 0, };
 8466              		.loc 1 2173 0
 8467 000e 07F11403 		add	r3, r7, #20
 8468 0012 0022     		movs	r2, #0
 8469 0014 1A60     		str	r2, [r3]
 8470 0016 0433     		adds	r3, r3, #4
 8471 0018 0022     		movs	r2, #0
 8472 001a 1A60     		str	r2, [r3]
 8473 001c 0433     		adds	r3, r3, #4
 8474 001e 0022     		movs	r2, #0
 8475 0020 1A60     		str	r2, [r3]
 8476 0022 0433     		adds	r3, r3, #4
 8477 0024 0022     		movs	r2, #0
 8478 0026 1A60     		str	r2, [r3]
 8479 0028 0433     		adds	r3, r3, #4
 8480 002a 0022     		movs	r2, #0
 8481 002c 1A60     		str	r2, [r3]
 8482 002e 0433     		adds	r3, r3, #4
 8483 0030 0022     		movs	r2, #0
 8484 0032 1A60     		str	r2, [r3]
 8485 0034 0433     		adds	r3, r3, #4
 8486 0036 0022     		movs	r2, #0
 8487 0038 1A60     		str	r2, [r3]
 8488 003a 0433     		adds	r3, r3, #4
 8489 003c 0022     		movs	r2, #0
ARM GAS  /tmp/ccUeeWpa.s 			page 187


 8490 003e 1A60     		str	r2, [r3]
 8491 0040 0433     		adds	r3, r3, #4
 8492 0042 0022     		movs	r2, #0
 8493 0044 1A60     		str	r2, [r3]
 8494 0046 0433     		adds	r3, r3, #4
 8495 0048 0022     		movs	r2, #0
 8496 004a 1A60     		str	r2, [r3]
 8497 004c 0433     		adds	r3, r3, #4
 8498 004e 0022     		movs	r2, #0
 8499 0050 1A60     		str	r2, [r3]
 8500 0052 0433     		adds	r3, r3, #4
 8501 0054 0022     		movs	r2, #0
 8502 0056 1A60     		str	r2, [r3]
 8503 0058 0433     		adds	r3, r3, #4
 8504 005a 0022     		movs	r2, #0
 8505 005c 1A80     		strh	r2, [r3]	@ movhi
 8506 005e 0233     		adds	r3, r3, #2
2174:bluetooth_rxtx.c **** 	if (len > 49)
 8507              		.loc 1 2174 0
 8508 0060 7B68     		ldr	r3, [r7, #4]
 8509 0062 312B     		cmp	r3, #49
 8510 0064 01D9     		bls	.L424
2175:bluetooth_rxtx.c **** 		len = 49;
 8511              		.loc 1 2175 0
 8512 0066 3123     		movs	r3, #49
 8513 0068 7B60     		str	r3, [r7, #4]
 8514              	.L424:
2176:bluetooth_rxtx.c **** 
2177:bluetooth_rxtx.c **** 	buf[0] = type;
 8515              		.loc 1 2177 0
 8516 006a FB7B     		ldrb	r3, [r7, #15]
 8517 006c 3B75     		strb	r3, [r7, #20]
2178:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 8518              		.loc 1 2178 0
 8519 006e 07F11403 		add	r3, r7, #20
 8520 0072 0133     		adds	r3, r3, #1
 8521 0074 1846     		mov	r0, r3
 8522 0076 B968     		ldr	r1, [r7, #8]
 8523 0078 7A68     		ldr	r2, [r7, #4]
 8524 007a FFF7FEFF 		bl	memcpy
2179:bluetooth_rxtx.c **** 	enqueue(LE_PROMISC, buf);
 8525              		.loc 1 2179 0
 8526 007e 07F11403 		add	r3, r7, #20
 8527 0082 0520     		movs	r0, #5
 8528 0084 1946     		mov	r1, r3
 8529 0086 FFF7FEFF 		bl	enqueue
2180:bluetooth_rxtx.c **** }
 8530              		.loc 1 2180 0
 8531 008a 4837     		adds	r7, r7, #72
 8532              		.cfi_def_cfa_offset 8
 8533 008c BD46     		mov	sp, r7
 8534              		.cfi_def_cfa_register 13
 8535              		@ sp needed
 8536 008e 80BD     		pop	{r7, pc}
 8537              		.cfi_endproc
 8538              	.LFE37:
 8540              		.section	.text.promisc_recover_hop_increment,"ax",%progbits
ARM GAS  /tmp/ccUeeWpa.s 			page 188


 8541              		.align	2
 8542              		.global	promisc_recover_hop_increment
 8543              		.thumb
 8544              		.thumb_func
 8546              	promisc_recover_hop_increment:
 8547              	.LFB38:
2181:bluetooth_rxtx.c **** 
2182:bluetooth_rxtx.c **** // divide, rounding to the nearest integer: round up at 0.5.
2183:bluetooth_rxtx.c **** #define DIVIDE_ROUND(N, D) ((N) + (D)/2) / (D)
2184:bluetooth_rxtx.c **** 
2185:bluetooth_rxtx.c **** void promisc_recover_hop_increment(u8 *packet) {
 8548              		.loc 1 2185 0
 8549              		.cfi_startproc
 8550              		@ args = 0, pretend = 0, frame = 16
 8551              		@ frame_needed = 1, uses_anonymous_args = 0
 8552 0000 80B5     		push	{r7, lr}
 8553              		.cfi_def_cfa_offset 8
 8554              		.cfi_offset 7, -8
 8555              		.cfi_offset 14, -4
 8556 0002 84B0     		sub	sp, sp, #16
 8557              		.cfi_def_cfa_offset 24
 8558 0004 00AF     		add	r7, sp, #0
 8559              		.cfi_def_cfa_register 7
 8560 0006 7860     		str	r0, [r7, #4]
2186:bluetooth_rxtx.c **** 	static u32 first_ts = 0;
2187:bluetooth_rxtx.c **** 	if (channel == 2404) {
 8561              		.loc 1 2187 0
 8562 0008 554B     		ldr	r3, .L432
 8563 000a 1B88     		ldrh	r3, [r3]	@ movhi
 8564 000c 9BB2     		uxth	r3, r3
 8565 000e 40F66412 		movw	r2, #2404
 8566 0012 9342     		cmp	r3, r2
 8567 0014 14D1     		bne	.L426
2188:bluetooth_rxtx.c **** 		first_ts = CLK100NS;
 8568              		.loc 1 2188 0
 8569 0016 534B     		ldr	r3, .L432+4
 8570 0018 1B68     		ldr	r3, [r3]
 8571 001a C3F31303 		ubfx	r3, r3, #0, #20
 8572 001e 40F63542 		movw	r2, #3125
 8573 0022 02FB03F2 		mul	r2, r2, r3
 8574 0026 504B     		ldr	r3, .L432+8
 8575 0028 1B68     		ldr	r3, [r3]
 8576 002a 1344     		add	r3, r3, r2
 8577 002c 4F4A     		ldr	r2, .L432+12
 8578 002e 1360     		str	r3, [r2]
2189:bluetooth_rxtx.c **** 		hop_direct_channel = 2406;
 8579              		.loc 1 2189 0
 8580 0030 4F4B     		ldr	r3, .L432+16
 8581 0032 40F66612 		movw	r2, #2406
 8582 0036 1A80     		strh	r2, [r3]	@ movhi
2190:bluetooth_rxtx.c **** 		do_hop = 1;
 8583              		.loc 1 2190 0
 8584 0038 4E4B     		ldr	r3, .L432+20
 8585 003a 0122     		movs	r2, #1
 8586 003c 1A70     		strb	r2, [r3]
 8587 003e 8BE0     		b	.L425
 8588              	.L426:
ARM GAS  /tmp/ccUeeWpa.s 			page 189


2191:bluetooth_rxtx.c **** 	} else if (channel == 2406) {
 8589              		.loc 1 2191 0
 8590 0040 474B     		ldr	r3, .L432
 8591 0042 1B88     		ldrh	r3, [r3]	@ movhi
 8592 0044 9BB2     		uxth	r3, r3
 8593 0046 40F66612 		movw	r2, #2406
 8594 004a 9342     		cmp	r3, r2
 8595 004c 7DD1     		bne	.L428
 8596              	.LBB16:
2192:bluetooth_rxtx.c **** 		u32 second_ts = CLK100NS;
 8597              		.loc 1 2192 0
 8598 004e 454B     		ldr	r3, .L432+4
 8599 0050 1B68     		ldr	r3, [r3]
 8600 0052 C3F31303 		ubfx	r3, r3, #0, #20
 8601 0056 40F63542 		movw	r2, #3125
 8602 005a 02FB03F2 		mul	r2, r2, r3
 8603 005e 424B     		ldr	r3, .L432+8
 8604 0060 1B68     		ldr	r3, [r3]
 8605 0062 1344     		add	r3, r3, r2
 8606 0064 FB60     		str	r3, [r7, #12]
2193:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 8607              		.loc 1 2193 0
 8608 0066 414B     		ldr	r3, .L432+12
 8609 0068 1B68     		ldr	r3, [r3]
 8610 006a FA68     		ldr	r2, [r7, #12]
 8611 006c 9A42     		cmp	r2, r3
 8612 006e 05D2     		bcs	.L429
2194:bluetooth_rxtx.c **** 			second_ts += 3276800000; // handle rollover
 8613              		.loc 1 2194 0
 8614 0070 FB68     		ldr	r3, [r7, #12]
 8615 0072 03F14343 		add	r3, r3, #-1023410176
 8616 0076 03F5A003 		add	r3, r3, #5242880
 8617 007a FB60     		str	r3, [r7, #12]
 8618              	.L429:
2195:bluetooth_rxtx.c **** 		// Number of channels hopped between previous and current timestamp.
2196:bluetooth_rxtx.c **** 		u32 channels_hopped = DIVIDE_ROUND(second_ts - first_ts,
 8619              		.loc 1 2196 0
 8620 007c 3B4B     		ldr	r3, .L432+12
 8621 007e 1B68     		ldr	r3, [r3]
 8622 0080 FA68     		ldr	r2, [r7, #12]
 8623 0082 D21A     		subs	r2, r2, r3
 8624 0084 3C4B     		ldr	r3, .L432+24
 8625 0086 DB8B     		ldrh	r3, [r3, #30]
 8626 0088 1946     		mov	r1, r3
 8627 008a 43F2D403 		movw	r3, #12500
 8628 008e 03FB01F3 		mul	r3, r3, r1
 8629 0092 D90F     		lsrs	r1, r3, #31
 8630 0094 0B44     		add	r3, r3, r1
 8631 0096 5B10     		asrs	r3, r3, #1
 8632 0098 1344     		add	r3, r3, r2
 8633 009a 374A     		ldr	r2, .L432+24
 8634 009c D28B     		ldrh	r2, [r2, #30]
 8635 009e 1146     		mov	r1, r2
 8636 00a0 43F2D402 		movw	r2, #12500
 8637 00a4 02FB01F2 		mul	r2, r2, r1
 8638 00a8 B3FBF2F3 		udiv	r3, r3, r2
 8639 00ac BB60     		str	r3, [r7, #8]
ARM GAS  /tmp/ccUeeWpa.s 			page 190


2197:bluetooth_rxtx.c **** 										   le.conn_interval * LE_BASECLK);
2198:bluetooth_rxtx.c **** 		if (channels_hopped < 37) {
 8640              		.loc 1 2198 0
 8641 00ae BB68     		ldr	r3, [r7, #8]
 8642 00b0 242B     		cmp	r3, #36
 8643 00b2 42D8     		bhi	.L430
2199:bluetooth_rxtx.c **** 			// Get the hop increment based on the number of channels hopped.
2200:bluetooth_rxtx.c **** 			le.channel_increment = hop_interval_lut[channels_hopped];
 8644              		.loc 1 2200 0
 8645 00b4 314A     		ldr	r2, .L432+28
 8646 00b6 BB68     		ldr	r3, [r7, #8]
 8647 00b8 1344     		add	r3, r3, r2
 8648 00ba 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 8649 00bc 2E4B     		ldr	r3, .L432+24
 8650 00be 9A75     		strb	r2, [r3, #22]
2201:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 8651              		.loc 1 2201 0
 8652 00c0 2D4B     		ldr	r3, .L432+24
 8653 00c2 DB8B     		ldrh	r3, [r3, #30]
 8654 00c4 5B08     		lsrs	r3, r3, #1
 8655 00c6 9AB2     		uxth	r2, r3
 8656 00c8 2B4B     		ldr	r3, .L432+24
 8657 00ca 9A83     		strh	r2, [r3, #28]	@ movhi
2202:bluetooth_rxtx.c **** 			le.conn_count = 0;
 8658              		.loc 1 2202 0
 8659 00cc 2A4B     		ldr	r3, .L432+24
 8660 00ce 0022     		movs	r2, #0
 8661 00d0 1A84     		strh	r2, [r3, #32]	@ movhi
2203:bluetooth_rxtx.c **** 			le.conn_epoch = 0;
 8662              		.loc 1 2203 0
 8663 00d2 294B     		ldr	r3, .L432+24
 8664 00d4 0022     		movs	r2, #0
 8665 00d6 9A61     		str	r2, [r3, #24]
2204:bluetooth_rxtx.c **** 			do_hop = 0;
 8666              		.loc 1 2204 0
 8667 00d8 264B     		ldr	r3, .L432+20
 8668 00da 0022     		movs	r2, #0
 8669 00dc 1A70     		strb	r2, [r3]
2205:bluetooth_rxtx.c **** 			// Move on to regular connection following.
2206:bluetooth_rxtx.c **** 			le.channel_idx = (1 + le.channel_increment) % 37;
 8670              		.loc 1 2206 0
 8671 00de 264B     		ldr	r3, .L432+24
 8672 00e0 9B7D     		ldrb	r3, [r3, #22]	@ zero_extendqisi2
 8673 00e2 5A1C     		adds	r2, r3, #1
 8674 00e4 264B     		ldr	r3, .L432+32
 8675 00e6 82FB0301 		smull	r0, r1, r2, r3
 8676 00ea 5318     		adds	r3, r2, r1
 8677 00ec 5911     		asrs	r1, r3, #5
 8678 00ee D317     		asrs	r3, r2, #31
 8679 00f0 C91A     		subs	r1, r1, r3
 8680 00f2 0B46     		mov	r3, r1
 8681 00f4 DB00     		lsls	r3, r3, #3
 8682 00f6 0B44     		add	r3, r3, r1
 8683 00f8 9B00     		lsls	r3, r3, #2
 8684 00fa 0B44     		add	r3, r3, r1
 8685 00fc D11A     		subs	r1, r2, r3
 8686 00fe CAB2     		uxtb	r2, r1
ARM GAS  /tmp/ccUeeWpa.s 			page 191


 8687 0100 1D4B     		ldr	r3, .L432+24
 8688 0102 5A75     		strb	r2, [r3, #21]
2207:bluetooth_rxtx.c **** 			le.link_state = LINK_CONNECTED;
 8689              		.loc 1 2207 0
 8690 0104 1C4B     		ldr	r3, .L432+24
 8691 0106 0322     		movs	r2, #3
 8692 0108 1A75     		strb	r2, [r3, #20]
2208:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 8693              		.loc 1 2208 0
 8694 010a 1B4B     		ldr	r3, .L432+24
 8695 010c 0022     		movs	r2, #0
 8696 010e 1A61     		str	r2, [r3, #16]
2209:bluetooth_rxtx.c **** 			hop_mode = HOP_BTLE;
 8697              		.loc 1 2209 0
 8698 0110 1C4B     		ldr	r3, .L432+36
 8699 0112 0322     		movs	r2, #3
 8700 0114 1A70     		strb	r2, [r3]
2210:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 8701              		.loc 1 2210 0
 8702 0116 1C4B     		ldr	r3, .L432+40
 8703 0118 1C4A     		ldr	r2, .L432+44
 8704 011a 1A60     		str	r2, [r3]
2211:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 8705              		.loc 1 2211 0
 8706 011c 0320     		movs	r0, #3
 8707 011e 1C49     		ldr	r1, .L432+48
 8708 0120 0122     		movs	r2, #1
 8709 0122 FFF7FEFF 		bl	le_promisc_state
2212:bluetooth_rxtx.c **** 
2213:bluetooth_rxtx.c **** 			if (jam_mode != JAM_NONE)
 8710              		.loc 1 2213 0
 8711 0126 1B4B     		ldr	r3, .L432+52
 8712 0128 1B78     		ldrb	r3, [r3]
 8713 012a DBB2     		uxtb	r3, r3
 8714 012c 002B     		cmp	r3, #0
 8715 012e 03D0     		beq	.L431
2214:bluetooth_rxtx.c **** 				le_jam_count = JAM_COUNT_DEFAULT;
 8716              		.loc 1 2214 0
 8717 0130 194B     		ldr	r3, .L432+56
 8718 0132 2822     		movs	r2, #40
 8719 0134 1A60     		str	r2, [r3]
2215:bluetooth_rxtx.c **** 
2216:bluetooth_rxtx.c **** 			return;
 8720              		.loc 1 2216 0
 8721 0136 0FE0     		b	.L425
 8722              	.L431:
 8723 0138 0EE0     		b	.L425
 8724              	.L430:
2217:bluetooth_rxtx.c **** 		}
2218:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 8725              		.loc 1 2218 0
 8726 013a 0D4B     		ldr	r3, .L432+16
 8727 013c 40F66412 		movw	r2, #2404
 8728 0140 1A80     		strh	r2, [r3]	@ movhi
2219:bluetooth_rxtx.c **** 		do_hop = 1;
 8729              		.loc 1 2219 0
 8730 0142 0C4B     		ldr	r3, .L432+20
ARM GAS  /tmp/ccUeeWpa.s 			page 192


 8731 0144 0122     		movs	r2, #1
 8732 0146 1A70     		strb	r2, [r3]
 8733              	.LBE16:
 8734 0148 06E0     		b	.L425
 8735              	.L428:
2220:bluetooth_rxtx.c **** 	}
2221:bluetooth_rxtx.c **** 	else {
2222:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 8736              		.loc 1 2222 0
 8737 014a 094B     		ldr	r3, .L432+16
 8738 014c 40F66412 		movw	r2, #2404
 8739 0150 1A80     		strh	r2, [r3]	@ movhi
2223:bluetooth_rxtx.c **** 		do_hop = 1;
 8740              		.loc 1 2223 0
 8741 0152 084B     		ldr	r3, .L432+20
 8742 0154 0122     		movs	r2, #1
 8743 0156 1A70     		strb	r2, [r3]
 8744              	.L425:
2224:bluetooth_rxtx.c **** 	}
2225:bluetooth_rxtx.c **** }
 8745              		.loc 1 2225 0
 8746 0158 1037     		adds	r7, r7, #16
 8747              		.cfi_def_cfa_offset 8
 8748 015a BD46     		mov	sp, r7
 8749              		.cfi_def_cfa_register 13
 8750              		@ sp needed
 8751 015c 80BD     		pop	{r7, pc}
 8752              	.L433:
 8753 015e 00BF     		.align	2
 8754              	.L432:
 8755 0160 00000000 		.word	channel
 8756 0164 00000000 		.word	clkn
 8757 0168 08400040 		.word	1073758216
 8758 016c D8000000 		.word	first_ts.4805
 8759 0170 00000000 		.word	hop_direct_channel
 8760 0174 00000000 		.word	do_hop
 8761 0178 00000000 		.word	le
 8762 017c D4000000 		.word	hop_interval_lut
 8763 0180 A7C867DD 		.word	-580400985
 8764 0184 00000000 		.word	hop_mode
 8765 0188 00000000 		.word	packet_cb
 8766 018c 00000000 		.word	connection_follow_cb
 8767 0190 16000000 		.word	le+22
 8768 0194 00000000 		.word	jam_mode
 8769 0198 00000000 		.word	le_jam_count
 8770              		.cfi_endproc
 8771              	.LFE38:
 8773              		.section	.text.promisc_recover_hop_interval,"ax",%progbits
 8774              		.align	2
 8775              		.global	promisc_recover_hop_interval
 8776              		.thumb
 8777              		.thumb_func
 8779              	promisc_recover_hop_interval:
 8780              	.LFB39:
2226:bluetooth_rxtx.c **** 
2227:bluetooth_rxtx.c **** void promisc_recover_hop_interval(u8 *packet) {
 8781              		.loc 1 2227 0
ARM GAS  /tmp/ccUeeWpa.s 			page 193


 8782              		.cfi_startproc
 8783              		@ args = 0, pretend = 0, frame = 24
 8784              		@ frame_needed = 1, uses_anonymous_args = 0
 8785 0000 80B5     		push	{r7, lr}
 8786              		.cfi_def_cfa_offset 8
 8787              		.cfi_offset 7, -8
 8788              		.cfi_offset 14, -4
 8789 0002 86B0     		sub	sp, sp, #24
 8790              		.cfi_def_cfa_offset 32
 8791 0004 00AF     		add	r7, sp, #0
 8792              		.cfi_def_cfa_register 7
 8793 0006 7860     		str	r0, [r7, #4]
2228:bluetooth_rxtx.c **** 	static u32 prev_clk = 0;
2229:bluetooth_rxtx.c **** 
2230:bluetooth_rxtx.c **** 	u32 cur_clk = CLK100NS;
 8794              		.loc 1 2230 0
 8795 0008 334B     		ldr	r3, .L442
 8796 000a 1B68     		ldr	r3, [r3]
 8797 000c C3F31303 		ubfx	r3, r3, #0, #20
 8798 0010 40F63542 		movw	r2, #3125
 8799 0014 02FB03F2 		mul	r2, r2, r3
 8800 0018 304B     		ldr	r3, .L442+4
 8801 001a 1B68     		ldr	r3, [r3]
 8802 001c 1344     		add	r3, r3, r2
 8803 001e 7B61     		str	r3, [r7, #20]
2231:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 8804              		.loc 1 2231 0
 8805 0020 2F4B     		ldr	r3, .L442+8
 8806 0022 1B68     		ldr	r3, [r3]
 8807 0024 7A69     		ldr	r2, [r7, #20]
 8808 0026 9A42     		cmp	r2, r3
 8809 0028 03D2     		bcs	.L435
2232:bluetooth_rxtx.c **** 		cur_clk += 3267800000; // handle rollover
 8810              		.loc 1 2232 0
 8811 002a 7A69     		ldr	r2, [r7, #20]
 8812 002c 2D4B     		ldr	r3, .L442+12
 8813 002e 1344     		add	r3, r3, r2
 8814 0030 7B61     		str	r3, [r7, #20]
 8815              	.L435:
2233:bluetooth_rxtx.c **** 	u32 clk_diff = cur_clk - prev_clk;
 8816              		.loc 1 2233 0
 8817 0032 2B4B     		ldr	r3, .L442+8
 8818 0034 1B68     		ldr	r3, [r3]
 8819 0036 7A69     		ldr	r2, [r7, #20]
 8820 0038 D31A     		subs	r3, r2, r3
 8821 003a 3B61     		str	r3, [r7, #16]
2234:bluetooth_rxtx.c **** 	u16 obsv_hop_interval; // observed hop interval
2235:bluetooth_rxtx.c **** 
2236:bluetooth_rxtx.c **** 	// probably consecutive data packets on the same channel
2237:bluetooth_rxtx.c **** 	if (clk_diff < 2 * LE_BASECLK)
 8822              		.loc 1 2237 0
 8823 003c 3B69     		ldr	r3, [r7, #16]
 8824 003e 46F2A712 		movw	r2, #24999
 8825 0042 9342     		cmp	r3, r2
 8826 0044 00D8     		bhi	.L436
2238:bluetooth_rxtx.c **** 		return;
 8827              		.loc 1 2238 0
ARM GAS  /tmp/ccUeeWpa.s 			page 194


 8828 0046 43E0     		b	.L434
 8829              	.L436:
2239:bluetooth_rxtx.c **** 
2240:bluetooth_rxtx.c **** 	if (clk_diff < le_promisc.smallest_hop_interval)
 8830              		.loc 1 2240 0
 8831 0048 274B     		ldr	r3, .L442+16
 8832 004a D3F80021 		ldr	r2, [r3, #256]
 8833 004e 3B69     		ldr	r3, [r7, #16]
 8834 0050 9A42     		cmp	r2, r3
 8835 0052 03D9     		bls	.L438
2241:bluetooth_rxtx.c **** 		le_promisc.smallest_hop_interval = clk_diff;
 8836              		.loc 1 2241 0
 8837 0054 244A     		ldr	r2, .L442+16
 8838 0056 3B69     		ldr	r3, [r7, #16]
 8839 0058 C2F80031 		str	r3, [r2, #256]
 8840              	.L438:
2242:bluetooth_rxtx.c **** 
2243:bluetooth_rxtx.c **** 	obsv_hop_interval = DIVIDE_ROUND(le_promisc.smallest_hop_interval, 37 * LE_BASECLK);
 8841              		.loc 1 2243 0
 8842 005c 224B     		ldr	r3, .L442+16
 8843 005e D3F80031 		ldr	r3, [r3, #256]
 8844 0062 03F56133 		add	r3, r3, #230400
 8845 0066 03F25233 		addw	r3, r3, #850
 8846 006a 204A     		ldr	r2, .L442+20
 8847 006c A2FB0323 		umull	r2, r3, r2, r3
 8848 0070 9B0C     		lsrs	r3, r3, #18
 8849 0072 FB81     		strh	r3, [r7, #14]	@ movhi
2244:bluetooth_rxtx.c **** 
2245:bluetooth_rxtx.c **** 	if (le.conn_interval == obsv_hop_interval) {
 8850              		.loc 1 2245 0
 8851 0074 1E4B     		ldr	r3, .L442+24
 8852 0076 DB8B     		ldrh	r3, [r3, #30]
 8853 0078 FA89     		ldrh	r2, [r7, #14]
 8854 007a 9A42     		cmp	r2, r3
 8855 007c 1ED1     		bne	.L439
2246:bluetooth_rxtx.c **** 		// 5 consecutive hop intervals: consider it legit and move on
2247:bluetooth_rxtx.c **** 		++le_promisc.consec_intervals;
 8856              		.loc 1 2247 0
 8857 007e 1A4B     		ldr	r3, .L442+16
 8858 0080 D3F80431 		ldr	r3, [r3, #260]
 8859 0084 0133     		adds	r3, r3, #1
 8860 0086 184A     		ldr	r2, .L442+16
 8861 0088 C2F80431 		str	r3, [r2, #260]
2248:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 8862              		.loc 1 2248 0
 8863 008c 164B     		ldr	r3, .L442+16
 8864 008e D3F80431 		ldr	r3, [r3, #260]
 8865 0092 052B     		cmp	r3, #5
 8866 0094 19D1     		bne	.L441
2249:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 8867              		.loc 1 2249 0
 8868 0096 174B     		ldr	r3, .L442+28
 8869 0098 174A     		ldr	r2, .L442+32
 8870 009a 1A60     		str	r2, [r3]
2250:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
 8871              		.loc 1 2250 0
 8872 009c 174B     		ldr	r3, .L442+36
ARM GAS  /tmp/ccUeeWpa.s 			page 195


 8873 009e 40F66412 		movw	r2, #2404
 8874 00a2 1A80     		strh	r2, [r3]	@ movhi
2251:bluetooth_rxtx.c **** 			hop_mode = HOP_DIRECT;
 8875              		.loc 1 2251 0
 8876 00a4 164B     		ldr	r3, .L442+40
 8877 00a6 0422     		movs	r2, #4
 8878 00a8 1A70     		strb	r2, [r3]
2252:bluetooth_rxtx.c **** 			do_hop = 1;
 8879              		.loc 1 2252 0
 8880 00aa 164B     		ldr	r3, .L442+44
 8881 00ac 0122     		movs	r2, #1
 8882 00ae 1A70     		strb	r2, [r3]
2253:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 8883              		.loc 1 2253 0
 8884 00b0 0220     		movs	r0, #2
 8885 00b2 1549     		ldr	r1, .L442+48
 8886 00b4 0222     		movs	r2, #2
 8887 00b6 FFF7FEFF 		bl	le_promisc_state
 8888 00ba 06E0     		b	.L441
 8889              	.L439:
2254:bluetooth_rxtx.c **** 		}
2255:bluetooth_rxtx.c **** 	} else {
2256:bluetooth_rxtx.c **** 		le.conn_interval = obsv_hop_interval;
 8890              		.loc 1 2256 0
 8891 00bc 0C4A     		ldr	r2, .L442+24
 8892 00be FB89     		ldrh	r3, [r7, #14]	@ movhi
 8893 00c0 D383     		strh	r3, [r2, #30]	@ movhi
2257:bluetooth_rxtx.c **** 		le_promisc.consec_intervals = 0;
 8894              		.loc 1 2257 0
 8895 00c2 094B     		ldr	r3, .L442+16
 8896 00c4 0022     		movs	r2, #0
 8897 00c6 C3F80421 		str	r2, [r3, #260]
 8898              	.L441:
2258:bluetooth_rxtx.c **** 	}
2259:bluetooth_rxtx.c **** 
2260:bluetooth_rxtx.c **** 	prev_clk = cur_clk;
 8899              		.loc 1 2260 0
 8900 00ca 054A     		ldr	r2, .L442+8
 8901 00cc 7B69     		ldr	r3, [r7, #20]
 8902 00ce 1360     		str	r3, [r2]
 8903              	.L434:
2261:bluetooth_rxtx.c **** }
 8904              		.loc 1 2261 0
 8905 00d0 1837     		adds	r7, r7, #24
 8906              		.cfi_def_cfa_offset 8
 8907 00d2 BD46     		mov	sp, r7
 8908              		.cfi_def_cfa_register 13
 8909              		@ sp needed
 8910 00d4 80BD     		pop	{r7, pc}
 8911              	.L443:
 8912 00d6 00BF     		.align	2
 8913              	.L442:
 8914 00d8 00000000 		.word	clkn
 8915 00dc 08400040 		.word	1073758216
 8916 00e0 DC000000 		.word	prev_clk.4811
 8917 00e4 C0ABC6C2 		.word	-1027167296
 8918 00e8 00000000 		.word	le_promisc
ARM GAS  /tmp/ccUeeWpa.s 			page 196


 8919 00ec C1A91991 		.word	-1860589119
 8920 00f0 00000000 		.word	le
 8921 00f4 00000000 		.word	packet_cb
 8922 00f8 00000000 		.word	promisc_recover_hop_increment
 8923 00fc 00000000 		.word	hop_direct_channel
 8924 0100 00000000 		.word	hop_mode
 8925 0104 00000000 		.word	do_hop
 8926 0108 1E000000 		.word	le+30
 8927              		.cfi_endproc
 8928              	.LFE39:
 8930              		.section	.text.promisc_follow_cb,"ax",%progbits
 8931              		.align	2
 8932              		.global	promisc_follow_cb
 8933              		.thumb
 8934              		.thumb_func
 8936              	promisc_follow_cb:
 8937              	.LFB40:
2262:bluetooth_rxtx.c **** 
2263:bluetooth_rxtx.c **** void promisc_follow_cb(u8 *packet) {
 8938              		.loc 1 2263 0
 8939              		.cfi_startproc
 8940              		@ args = 0, pretend = 0, frame = 16
 8941              		@ frame_needed = 1, uses_anonymous_args = 0
 8942 0000 80B5     		push	{r7, lr}
 8943              		.cfi_def_cfa_offset 8
 8944              		.cfi_offset 7, -8
 8945              		.cfi_offset 14, -4
 8946 0002 84B0     		sub	sp, sp, #16
 8947              		.cfi_def_cfa_offset 24
 8948 0004 00AF     		add	r7, sp, #0
 8949              		.cfi_def_cfa_register 7
 8950 0006 7860     		str	r0, [r7, #4]
2264:bluetooth_rxtx.c **** 	int i;
2265:bluetooth_rxtx.c **** 
2266:bluetooth_rxtx.c **** 	// get the CRCInit
2267:bluetooth_rxtx.c **** 	if (!le.crc_verify && packet[4] == 0x01 && packet[5] == 0x00) {
 8951              		.loc 1 2267 0
 8952 0008 284B     		ldr	r3, .L448
 8953 000a 1B69     		ldr	r3, [r3, #16]
 8954 000c 002B     		cmp	r3, #0
 8955 000e 49D1     		bne	.L444
 8956              		.loc 1 2267 0 is_stmt 0 discriminator 1
 8957 0010 7B68     		ldr	r3, [r7, #4]
 8958 0012 0433     		adds	r3, r3, #4
 8959 0014 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8960 0016 012B     		cmp	r3, #1
 8961 0018 44D1     		bne	.L444
 8962              		.loc 1 2267 0 discriminator 2
 8963 001a 7B68     		ldr	r3, [r7, #4]
 8964 001c 0533     		adds	r3, r3, #5
 8965 001e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8966 0020 002B     		cmp	r3, #0
 8967 0022 3FD1     		bne	.L444
 8968              	.LBB17:
2268:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 8969              		.loc 1 2268 0 is_stmt 1
 8970 0024 7B68     		ldr	r3, [r7, #4]
ARM GAS  /tmp/ccUeeWpa.s 			page 197


 8971 0026 0833     		adds	r3, r3, #8
 8972 0028 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8973 002a 1A04     		lsls	r2, r3, #16
 8974 002c 7B68     		ldr	r3, [r7, #4]
 8975 002e 0733     		adds	r3, r3, #7
 8976 0030 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 8977 0032 1B02     		lsls	r3, r3, #8
 8978 0034 1343     		orrs	r3, r3, r2
 8979 0036 7A68     		ldr	r2, [r7, #4]
 8980 0038 0632     		adds	r2, r2, #6
 8981 003a 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 8982 003c 1343     		orrs	r3, r3, r2
 8983 003e BB60     		str	r3, [r7, #8]
2269:bluetooth_rxtx.c **** 
2270:bluetooth_rxtx.c **** 		le.crc_init = btle_reverse_crc(crc, packet + 4, 2);
 8984              		.loc 1 2270 0
 8985 0040 7B68     		ldr	r3, [r7, #4]
 8986 0042 0433     		adds	r3, r3, #4
 8987 0044 B868     		ldr	r0, [r7, #8]
 8988 0046 1946     		mov	r1, r3
 8989 0048 0222     		movs	r2, #2
 8990 004a FFF7FEFF 		bl	btle_reverse_crc
 8991 004e 0246     		mov	r2, r0
 8992 0050 164B     		ldr	r3, .L448
 8993 0052 9A60     		str	r2, [r3, #8]
2271:bluetooth_rxtx.c **** 		le.crc_init_reversed = 0;
 8994              		.loc 1 2271 0
 8995 0054 154B     		ldr	r3, .L448
 8996 0056 0022     		movs	r2, #0
 8997 0058 DA60     		str	r2, [r3, #12]
2272:bluetooth_rxtx.c **** 		for (i = 0; i < 24; ++i)
 8998              		.loc 1 2272 0
 8999 005a 0023     		movs	r3, #0
 9000 005c FB60     		str	r3, [r7, #12]
 9001 005e 13E0     		b	.L446
 9002              	.L447:
2273:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 9003              		.loc 1 2273 0 discriminator 3
 9004 0060 124B     		ldr	r3, .L448
 9005 0062 DA68     		ldr	r2, [r3, #12]
 9006 0064 114B     		ldr	r3, .L448
 9007 0066 9968     		ldr	r1, [r3, #8]
 9008 0068 FB68     		ldr	r3, [r7, #12]
 9009 006a 21FA03F3 		lsr	r3, r1, r3
 9010 006e 03F00101 		and	r1, r3, #1
 9011 0072 FB68     		ldr	r3, [r7, #12]
 9012 0074 C3F11703 		rsb	r3, r3, #23
 9013 0078 01FA03F3 		lsl	r3, r1, r3
 9014 007c 1343     		orrs	r3, r3, r2
 9015 007e 0B4A     		ldr	r2, .L448
 9016 0080 D360     		str	r3, [r2, #12]
2272:bluetooth_rxtx.c **** 		for (i = 0; i < 24; ++i)
 9017              		.loc 1 2272 0 discriminator 3
 9018 0082 FB68     		ldr	r3, [r7, #12]
 9019 0084 0133     		adds	r3, r3, #1
 9020 0086 FB60     		str	r3, [r7, #12]
 9021              	.L446:
ARM GAS  /tmp/ccUeeWpa.s 			page 198


2272:bluetooth_rxtx.c **** 		for (i = 0; i < 24; ++i)
 9022              		.loc 1 2272 0 is_stmt 0 discriminator 1
 9023 0088 FB68     		ldr	r3, [r7, #12]
 9024 008a 172B     		cmp	r3, #23
 9025 008c E8DD     		ble	.L447
2274:bluetooth_rxtx.c **** 
2275:bluetooth_rxtx.c **** 		le.crc_verify = 1;
 9026              		.loc 1 2275 0 is_stmt 1
 9027 008e 074B     		ldr	r3, .L448
 9028 0090 0122     		movs	r2, #1
 9029 0092 1A61     		str	r2, [r3, #16]
2276:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 9030              		.loc 1 2276 0
 9031 0094 064B     		ldr	r3, .L448+4
 9032 0096 074A     		ldr	r2, .L448+8
 9033 0098 1A60     		str	r2, [r3]
2277:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 9034              		.loc 1 2277 0
 9035 009a 0120     		movs	r0, #1
 9036 009c 0649     		ldr	r1, .L448+12
 9037 009e 0322     		movs	r2, #3
 9038 00a0 FFF7FEFF 		bl	le_promisc_state
 9039              	.L444:
 9040              	.LBE17:
2278:bluetooth_rxtx.c **** 	}
2279:bluetooth_rxtx.c **** }
 9041              		.loc 1 2279 0
 9042 00a4 1037     		adds	r7, r7, #16
 9043              		.cfi_def_cfa_offset 8
 9044 00a6 BD46     		mov	sp, r7
 9045              		.cfi_def_cfa_register 13
 9046              		@ sp needed
 9047 00a8 80BD     		pop	{r7, pc}
 9048              	.L449:
 9049 00aa 00BF     		.align	2
 9050              	.L448:
 9051 00ac 00000000 		.word	le
 9052 00b0 00000000 		.word	packet_cb
 9053 00b4 00000000 		.word	promisc_recover_hop_interval
 9054 00b8 08000000 		.word	le+8
 9055              		.cfi_endproc
 9056              	.LFE40:
 9058              		.section	.text.see_aa,"ax",%progbits
 9059              		.align	2
 9060              		.global	see_aa
 9061              		.thumb
 9062              		.thumb_func
 9064              	see_aa:
 9065              	.LFB41:
2280:bluetooth_rxtx.c **** 
2281:bluetooth_rxtx.c **** // called when we see an AA, add it to the list
2282:bluetooth_rxtx.c **** void see_aa(u32 aa) {
 9066              		.loc 1 2282 0
 9067              		.cfi_startproc
 9068              		@ args = 0, pretend = 0, frame = 24
 9069              		@ frame_needed = 1, uses_anonymous_args = 0
 9070              		@ link register save eliminated.
ARM GAS  /tmp/ccUeeWpa.s 			page 199


 9071 0000 80B4     		push	{r7}
 9072              		.cfi_def_cfa_offset 4
 9073              		.cfi_offset 7, -4
 9074 0002 87B0     		sub	sp, sp, #28
 9075              		.cfi_def_cfa_offset 32
 9076 0004 00AF     		add	r7, sp, #0
 9077              		.cfi_def_cfa_register 7
 9078 0006 7860     		str	r0, [r7, #4]
2283:bluetooth_rxtx.c **** 	int i, max = -1, killme = -1;
 9079              		.loc 1 2283 0
 9080 0008 4FF0FF33 		mov	r3, #-1
 9081 000c 3B61     		str	r3, [r7, #16]
 9082 000e 4FF0FF33 		mov	r3, #-1
 9083 0012 FB60     		str	r3, [r7, #12]
2284:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
 9084              		.loc 1 2284 0
 9085 0014 0023     		movs	r3, #0
 9086 0016 7B61     		str	r3, [r7, #20]
 9087 0018 15E0     		b	.L451
 9088              	.L454:
2285:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 9089              		.loc 1 2285 0
 9090 001a 224A     		ldr	r2, .L459
 9091 001c 7B69     		ldr	r3, [r7, #20]
 9092 001e 52F83320 		ldr	r2, [r2, r3, lsl #3]
 9093 0022 7B68     		ldr	r3, [r7, #4]
 9094 0024 9A42     		cmp	r2, r3
 9095 0026 0BD1     		bne	.L452
2286:bluetooth_rxtx.c **** 			++le_promisc.active_aa[i].count;
 9096              		.loc 1 2286 0
 9097 0028 1E4A     		ldr	r2, .L459
 9098 002a 7B69     		ldr	r3, [r7, #20]
 9099 002c DB00     		lsls	r3, r3, #3
 9100 002e 1344     		add	r3, r3, r2
 9101 0030 5B68     		ldr	r3, [r3, #4]
 9102 0032 5A1C     		adds	r2, r3, #1
 9103 0034 1B49     		ldr	r1, .L459
 9104 0036 7B69     		ldr	r3, [r7, #20]
 9105 0038 DB00     		lsls	r3, r3, #3
 9106 003a 0B44     		add	r3, r3, r1
 9107 003c 5A60     		str	r2, [r3, #4]
2287:bluetooth_rxtx.c **** 			return;
 9108              		.loc 1 2287 0
 9109 003e 2CE0     		b	.L450
 9110              	.L452:
2284:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 9111              		.loc 1 2284 0 discriminator 2
 9112 0040 7B69     		ldr	r3, [r7, #20]
 9113 0042 0133     		adds	r3, r3, #1
 9114 0044 7B61     		str	r3, [r7, #20]
 9115              	.L451:
2284:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 9116              		.loc 1 2284 0 is_stmt 0 discriminator 1
 9117 0046 7B69     		ldr	r3, [r7, #20]
 9118 0048 1F2B     		cmp	r3, #31
 9119 004a E6DD     		ble	.L454
2288:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccUeeWpa.s 			page 200


2289:bluetooth_rxtx.c **** 
2290:bluetooth_rxtx.c **** 	// evict someone
2291:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
 9120              		.loc 1 2291 0 is_stmt 1
 9121 004c 0023     		movs	r3, #0
 9122 004e 7B61     		str	r3, [r7, #20]
 9123 0050 15E0     		b	.L455
 9124              	.L458:
2292:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 9125              		.loc 1 2292 0
 9126 0052 144A     		ldr	r2, .L459
 9127 0054 7B69     		ldr	r3, [r7, #20]
 9128 0056 DB00     		lsls	r3, r3, #3
 9129 0058 1344     		add	r3, r3, r2
 9130 005a 5A68     		ldr	r2, [r3, #4]
 9131 005c 3B69     		ldr	r3, [r7, #16]
 9132 005e 9A42     		cmp	r2, r3
 9133 0060 02DB     		blt	.L456
 9134              		.loc 1 2292 0 is_stmt 0 discriminator 1
 9135 0062 3B69     		ldr	r3, [r7, #16]
 9136 0064 002B     		cmp	r3, #0
 9137 0066 07DA     		bge	.L457
 9138              	.L456:
2293:bluetooth_rxtx.c **** 			killme = i;
 9139              		.loc 1 2293 0 is_stmt 1
 9140 0068 7B69     		ldr	r3, [r7, #20]
 9141 006a FB60     		str	r3, [r7, #12]
2294:bluetooth_rxtx.c **** 			max = le_promisc.active_aa[i].count;
 9142              		.loc 1 2294 0
 9143 006c 0D4A     		ldr	r2, .L459
 9144 006e 7B69     		ldr	r3, [r7, #20]
 9145 0070 DB00     		lsls	r3, r3, #3
 9146 0072 1344     		add	r3, r3, r2
 9147 0074 5B68     		ldr	r3, [r3, #4]
 9148 0076 3B61     		str	r3, [r7, #16]
 9149              	.L457:
2291:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 9150              		.loc 1 2291 0 discriminator 2
 9151 0078 7B69     		ldr	r3, [r7, #20]
 9152 007a 0133     		adds	r3, r3, #1
 9153 007c 7B61     		str	r3, [r7, #20]
 9154              	.L455:
2291:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 9155              		.loc 1 2291 0 is_stmt 0 discriminator 1
 9156 007e 7B69     		ldr	r3, [r7, #20]
 9157 0080 1F2B     		cmp	r3, #31
 9158 0082 E6DD     		ble	.L458
2295:bluetooth_rxtx.c **** 		}
2296:bluetooth_rxtx.c **** 
2297:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].aa = aa;
 9159              		.loc 1 2297 0 is_stmt 1
 9160 0084 0749     		ldr	r1, .L459
 9161 0086 FB68     		ldr	r3, [r7, #12]
 9162 0088 7A68     		ldr	r2, [r7, #4]
 9163 008a 41F83320 		str	r2, [r1, r3, lsl #3]
2298:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].count = 1;
 9164              		.loc 1 2298 0
ARM GAS  /tmp/ccUeeWpa.s 			page 201


 9165 008e 054A     		ldr	r2, .L459
 9166 0090 FB68     		ldr	r3, [r7, #12]
 9167 0092 DB00     		lsls	r3, r3, #3
 9168 0094 1344     		add	r3, r3, r2
 9169 0096 0122     		movs	r2, #1
 9170 0098 5A60     		str	r2, [r3, #4]
 9171              	.L450:
2299:bluetooth_rxtx.c **** }
 9172              		.loc 1 2299 0
 9173 009a 1C37     		adds	r7, r7, #28
 9174              		.cfi_def_cfa_offset 4
 9175 009c BD46     		mov	sp, r7
 9176              		.cfi_def_cfa_register 13
 9177              		@ sp needed
 9178 009e 5DF8047B 		ldr	r7, [sp], #4
 9179              		.cfi_restore 7
 9180              		.cfi_def_cfa_offset 0
 9181 00a2 7047     		bx	lr
 9182              	.L460:
 9183              		.align	2
 9184              	.L459:
 9185 00a4 00000000 		.word	le_promisc
 9186              		.cfi_endproc
 9187              	.LFE41:
 9189              		.section	.rodata
 9190 08cb 00       		.align	2
 9191              	.LC0:
 9192 08cc 01000000 		.word	1
 9193 08d0 01000000 		.word	1
 9194 08d4 01000000 		.word	1
 9195 08d8 01000000 		.word	1
 9196              		.section	.text.cb_le_promisc,"ax",%progbits
 9197              		.align	2
 9198              		.global	cb_le_promisc
 9199              		.thumb
 9200              		.thumb_func
 9202              	cb_le_promisc:
 9203              	.LFB42:
2300:bluetooth_rxtx.c **** 
2301:bluetooth_rxtx.c **** /* le promiscuous mode */
2302:bluetooth_rxtx.c **** int cb_le_promisc(char *unpacked) {
 9204              		.loc 1 2302 0
 9205              		.cfi_startproc
 9206              		@ args = 0, pretend = 0, frame = 128
 9207              		@ frame_needed = 1, uses_anonymous_args = 0
 9208 0000 90B5     		push	{r4, r7, lr}
 9209              		.cfi_def_cfa_offset 12
 9210              		.cfi_offset 4, -12
 9211              		.cfi_offset 7, -8
 9212              		.cfi_offset 14, -4
 9213 0002 A1B0     		sub	sp, sp, #132
 9214              		.cfi_def_cfa_offset 144
 9215 0004 00AF     		add	r7, sp, #0
 9216              		.cfi_def_cfa_register 7
 9217 0006 7860     		str	r0, [r7, #4]
2303:bluetooth_rxtx.c **** 	int i, j, k;
2304:bluetooth_rxtx.c **** 	int idx;
ARM GAS  /tmp/ccUeeWpa.s 			page 202


2305:bluetooth_rxtx.c **** 
2306:bluetooth_rxtx.c **** 	// empty data PDU: 01 00
2307:bluetooth_rxtx.c **** 	char desired[4][16] = {
 9218              		.loc 1 2307 0
 9219 0008 07F11C03 		add	r3, r7, #28
 9220 000c 4022     		movs	r2, #64
 9221 000e 1846     		mov	r0, r3
 9222 0010 0021     		movs	r1, #0
 9223 0012 FFF7FEFF 		bl	memset
 9224 0016 0123     		movs	r3, #1
 9225 0018 3B77     		strb	r3, [r7, #28]
 9226 001a 0123     		movs	r3, #1
 9227 001c 87F82C30 		strb	r3, [r7, #44]
 9228 0020 0123     		movs	r3, #1
 9229 0022 87F82F30 		strb	r3, [r7, #47]
 9230 0026 0123     		movs	r3, #1
 9231 0028 87F83C30 		strb	r3, [r7, #60]
 9232 002c 0123     		movs	r3, #1
 9233 002e 87F83E30 		strb	r3, [r7, #62]
 9234 0032 0123     		movs	r3, #1
 9235 0034 87F84C30 		strb	r3, [r7, #76]
 9236 0038 0123     		movs	r3, #1
 9237 003a 87F84E30 		strb	r3, [r7, #78]
 9238 003e 0123     		movs	r3, #1
 9239 0040 87F84F30 		strb	r3, [r7, #79]
2308:bluetooth_rxtx.c **** 		{ 1, 0, 0, 0, 0, 0, 0, 0,
2309:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2310:bluetooth_rxtx.c **** 		{ 1, 0, 0, 1, 0, 0, 0, 0,
2311:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2312:bluetooth_rxtx.c **** 		{ 1, 0, 1, 0, 0, 0, 0, 0,
2313:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2314:bluetooth_rxtx.c **** 		{ 1, 0, 1, 1, 0, 0, 0, 0,
2315:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2316:bluetooth_rxtx.c **** 	};
2317:bluetooth_rxtx.c **** 
2318:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
 9240              		.loc 1 2318 0
 9241 0044 0023     		movs	r3, #0
 9242 0046 FB67     		str	r3, [r7, #124]
 9243 0048 41E0     		b	.L462
 9244              	.L465:
2319:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 9245              		.loc 1 2319 0
 9246 004a A54B     		ldr	r3, .L492
 9247 004c 1B88     		ldrh	r3, [r3]	@ movhi
 9248 004e 9BB2     		uxth	r3, r3
 9249 0050 DBB2     		uxtb	r3, r3
 9250 0052 623B     		subs	r3, r3, #98
 9251 0054 DBB2     		uxtb	r3, r3
 9252 0056 1846     		mov	r0, r3
 9253 0058 FFF7FEFF 		bl	btle_channel_index
 9254 005c 0346     		mov	r3, r0
 9255 005e 1A46     		mov	r2, r3
 9256 0060 A04B     		ldr	r3, .L492+4
 9257 0062 9B5C     		ldrb	r3, [r3, r2]	@ zero_extendqisi2
 9258 0064 3B67     		str	r3, [r7, #112]
2320:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccUeeWpa.s 			page 203


2321:bluetooth_rxtx.c **** 		// whiten the desired data
2322:bluetooth_rxtx.c **** 		for (j = 0; j < (int)sizeof(desired[i]); ++j) {
 9259              		.loc 1 2322 0
 9260 0066 0023     		movs	r3, #0
 9261 0068 BB67     		str	r3, [r7, #120]
 9262 006a 2AE0     		b	.L463
 9263              	.L464:
2323:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 9264              		.loc 1 2323 0 discriminator 3
 9265 006c FB6F     		ldr	r3, [r7, #124]
 9266 006e 1B01     		lsls	r3, r3, #4
 9267 0070 07F18002 		add	r2, r7, #128
 9268 0074 1A44     		add	r2, r2, r3
 9269 0076 BB6F     		ldr	r3, [r7, #120]
 9270 0078 1344     		add	r3, r3, r2
 9271 007a 643B     		subs	r3, r3, #100
 9272 007c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 9273 007e 9A49     		ldr	r1, .L492+8
 9274 0080 3B6F     		ldr	r3, [r7, #112]
 9275 0082 0B44     		add	r3, r3, r1
 9276 0084 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 9277 0086 5340     		eors	r3, r3, r2
 9278 0088 D9B2     		uxtb	r1, r3
 9279 008a FB6F     		ldr	r3, [r7, #124]
 9280 008c 1B01     		lsls	r3, r3, #4
 9281 008e 07F18002 		add	r2, r7, #128
 9282 0092 1A44     		add	r2, r2, r3
 9283 0094 BB6F     		ldr	r3, [r7, #120]
 9284 0096 1344     		add	r3, r3, r2
 9285 0098 643B     		subs	r3, r3, #100
 9286 009a 0A46     		mov	r2, r1
 9287 009c 1A70     		strb	r2, [r3]
2324:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 9288              		.loc 1 2324 0 discriminator 3
 9289 009e 3B6F     		ldr	r3, [r7, #112]
 9290 00a0 0133     		adds	r3, r3, #1
 9291 00a2 1946     		mov	r1, r3
 9292 00a4 914B     		ldr	r3, .L492+12
 9293 00a6 A1FB0323 		umull	r2, r3, r1, r3
 9294 00aa C81A     		subs	r0, r1, r3
 9295 00ac 4008     		lsrs	r0, r0, #1
 9296 00ae 0344     		add	r3, r3, r0
 9297 00b0 9A09     		lsrs	r2, r3, #6
 9298 00b2 1346     		mov	r3, r2
 9299 00b4 DB01     		lsls	r3, r3, #7
 9300 00b6 9B1A     		subs	r3, r3, r2
 9301 00b8 CA1A     		subs	r2, r1, r3
 9302 00ba 3A67     		str	r2, [r7, #112]
2322:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 9303              		.loc 1 2322 0 discriminator 3
 9304 00bc BB6F     		ldr	r3, [r7, #120]
 9305 00be 0133     		adds	r3, r3, #1
 9306 00c0 BB67     		str	r3, [r7, #120]
 9307              	.L463:
2322:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 9308              		.loc 1 2322 0 is_stmt 0 discriminator 1
 9309 00c2 BB6F     		ldr	r3, [r7, #120]
ARM GAS  /tmp/ccUeeWpa.s 			page 204


 9310 00c4 0F2B     		cmp	r3, #15
 9311 00c6 D1DD     		ble	.L464
2318:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 9312              		.loc 1 2318 0 is_stmt 1 discriminator 2
 9313 00c8 FB6F     		ldr	r3, [r7, #124]
 9314 00ca 0133     		adds	r3, r3, #1
 9315 00cc FB67     		str	r3, [r7, #124]
 9316              	.L462:
2318:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 9317              		.loc 1 2318 0 is_stmt 0 discriminator 1
 9318 00ce FB6F     		ldr	r3, [r7, #124]
 9319 00d0 032B     		cmp	r3, #3
 9320 00d2 BADD     		ble	.L465
2325:bluetooth_rxtx.c **** 		}
2326:bluetooth_rxtx.c **** 	}
2327:bluetooth_rxtx.c **** 
2328:bluetooth_rxtx.c **** 	// then look for that bitsream in our receive buffer
2329:bluetooth_rxtx.c **** 	for (i = 32; i < (DMA_SIZE*8*2 - 32 - 16); i++) {
 9321              		.loc 1 2329 0 is_stmt 1
 9322 00d4 2023     		movs	r3, #32
 9323 00d6 FB67     		str	r3, [r7, #124]
 9324 00d8 D0E0     		b	.L466
 9325              	.L486:
 9326              	.LBB18:
2330:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 9327              		.loc 1 2330 0
 9328 00da 854B     		ldr	r3, .L492+16
 9329 00dc 07F10C04 		add	r4, r7, #12
 9330 00e0 0FCB     		ldmia	r3, {r0, r1, r2, r3}
 9331 00e2 84E80F00 		stmia	r4, {r0, r1, r2, r3}
2331:bluetooth_rxtx.c **** 		int matching = -1;
 9332              		.loc 1 2331 0
 9333 00e6 4FF0FF33 		mov	r3, #-1
 9334 00ea FB66     		str	r3, [r7, #108]
2332:bluetooth_rxtx.c **** 
2333:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
 9335              		.loc 1 2333 0
 9336 00ec 0023     		movs	r3, #0
 9337 00ee BB67     		str	r3, [r7, #120]
 9338 00f0 26E0     		b	.L467
 9339              	.L472:
2334:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 9340              		.loc 1 2334 0
 9341 00f2 0023     		movs	r3, #0
 9342 00f4 7B67     		str	r3, [r7, #116]
 9343 00f6 1DE0     		b	.L468
 9344              	.L471:
2335:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 9345              		.loc 1 2335 0
 9346 00f8 FA6F     		ldr	r2, [r7, #124]
 9347 00fa 7B6F     		ldr	r3, [r7, #116]
 9348 00fc 1344     		add	r3, r3, r2
 9349 00fe 1A46     		mov	r2, r3
 9350 0100 7B68     		ldr	r3, [r7, #4]
 9351 0102 1344     		add	r3, r3, r2
 9352 0104 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 9353 0106 BB6F     		ldr	r3, [r7, #120]
ARM GAS  /tmp/ccUeeWpa.s 			page 205


 9354 0108 1B01     		lsls	r3, r3, #4
 9355 010a 07F18001 		add	r1, r7, #128
 9356 010e 1944     		add	r1, r1, r3
 9357 0110 7B6F     		ldr	r3, [r7, #116]
 9358 0112 0B44     		add	r3, r3, r1
 9359 0114 643B     		subs	r3, r3, #100
 9360 0116 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 9361 0118 9A42     		cmp	r2, r3
 9362 011a 08D0     		beq	.L469
2336:bluetooth_rxtx.c **** 					ok[j] = 0;
 9363              		.loc 1 2336 0
 9364 011c BB6F     		ldr	r3, [r7, #120]
 9365 011e 9B00     		lsls	r3, r3, #2
 9366 0120 07F18002 		add	r2, r7, #128
 9367 0124 1344     		add	r3, r3, r2
 9368 0126 0022     		movs	r2, #0
 9369 0128 43F8742C 		str	r2, [r3, #-116]
2337:bluetooth_rxtx.c **** 					break;
 9370              		.loc 1 2337 0
 9371 012c 05E0     		b	.L470
 9372              	.L469:
2334:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 9373              		.loc 1 2334 0 discriminator 2
 9374 012e 7B6F     		ldr	r3, [r7, #116]
 9375 0130 0133     		adds	r3, r3, #1
 9376 0132 7B67     		str	r3, [r7, #116]
 9377              	.L468:
2334:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 9378              		.loc 1 2334 0 is_stmt 0 discriminator 1
 9379 0134 7B6F     		ldr	r3, [r7, #116]
 9380 0136 0F2B     		cmp	r3, #15
 9381 0138 DEDD     		ble	.L471
 9382              	.L470:
2333:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 9383              		.loc 1 2333 0 is_stmt 1 discriminator 2
 9384 013a BB6F     		ldr	r3, [r7, #120]
 9385 013c 0133     		adds	r3, r3, #1
 9386 013e BB67     		str	r3, [r7, #120]
 9387              	.L467:
2333:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 9388              		.loc 1 2333 0 is_stmt 0 discriminator 1
 9389 0140 BB6F     		ldr	r3, [r7, #120]
 9390 0142 032B     		cmp	r3, #3
 9391 0144 D5DD     		ble	.L472
2338:bluetooth_rxtx.c **** 				}
2339:bluetooth_rxtx.c **** 			}
2340:bluetooth_rxtx.c **** 		}
2341:bluetooth_rxtx.c **** 
2342:bluetooth_rxtx.c **** 		// see if any match
2343:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
 9392              		.loc 1 2343 0 is_stmt 1
 9393 0146 0023     		movs	r3, #0
 9394 0148 BB67     		str	r3, [r7, #120]
 9395 014a 0EE0     		b	.L473
 9396              	.L476:
2344:bluetooth_rxtx.c **** 			if (ok[j]) {
 9397              		.loc 1 2344 0
ARM GAS  /tmp/ccUeeWpa.s 			page 206


 9398 014c BB6F     		ldr	r3, [r7, #120]
 9399 014e 9B00     		lsls	r3, r3, #2
 9400 0150 07F18002 		add	r2, r7, #128
 9401 0154 1344     		add	r3, r3, r2
 9402 0156 53F8743C 		ldr	r3, [r3, #-116]
 9403 015a 002B     		cmp	r3, #0
 9404 015c 02D0     		beq	.L474
2345:bluetooth_rxtx.c **** 				matching = j;
 9405              		.loc 1 2345 0
 9406 015e BB6F     		ldr	r3, [r7, #120]
 9407 0160 FB66     		str	r3, [r7, #108]
2346:bluetooth_rxtx.c **** 				break;
 9408              		.loc 1 2346 0
 9409 0162 05E0     		b	.L475
 9410              	.L474:
2343:bluetooth_rxtx.c **** 			if (ok[j]) {
 9411              		.loc 1 2343 0 discriminator 2
 9412 0164 BB6F     		ldr	r3, [r7, #120]
 9413 0166 0133     		adds	r3, r3, #1
 9414 0168 BB67     		str	r3, [r7, #120]
 9415              	.L473:
2343:bluetooth_rxtx.c **** 			if (ok[j]) {
 9416              		.loc 1 2343 0 is_stmt 0 discriminator 1
 9417 016a BB6F     		ldr	r3, [r7, #120]
 9418 016c 032B     		cmp	r3, #3
 9419 016e EDDD     		ble	.L476
 9420              	.L475:
2347:bluetooth_rxtx.c **** 			}
2348:bluetooth_rxtx.c **** 		}
2349:bluetooth_rxtx.c **** 
2350:bluetooth_rxtx.c **** 		// skip if no match
2351:bluetooth_rxtx.c **** 		if (matching < 0)
 9421              		.loc 1 2351 0 is_stmt 1
 9422 0170 FB6E     		ldr	r3, [r7, #108]
 9423 0172 002B     		cmp	r3, #0
 9424 0174 7FDB     		blt	.L478
2352:bluetooth_rxtx.c **** 			continue;
2353:bluetooth_rxtx.c **** 
2354:bluetooth_rxtx.c **** 		// found a match! unwhiten it and send it home
2355:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 9425              		.loc 1 2355 0
 9426 0176 5A4B     		ldr	r3, .L492
 9427 0178 1B88     		ldrh	r3, [r3]	@ movhi
 9428 017a 9BB2     		uxth	r3, r3
 9429 017c DBB2     		uxtb	r3, r3
 9430 017e 623B     		subs	r3, r3, #98
 9431 0180 DBB2     		uxtb	r3, r3
 9432 0182 1846     		mov	r0, r3
 9433 0184 FFF7FEFF 		bl	btle_channel_index
 9434 0188 0346     		mov	r3, r0
 9435 018a 1A46     		mov	r2, r3
 9436 018c 554B     		ldr	r3, .L492+4
 9437 018e 9B5C     		ldrb	r3, [r3, r2]	@ zero_extendqisi2
 9438 0190 3B67     		str	r3, [r7, #112]
2356:bluetooth_rxtx.c **** 		for (j = 0; j < 4+3+3; ++j) {
 9439              		.loc 1 2356 0
 9440 0192 0023     		movs	r3, #0
ARM GAS  /tmp/ccUeeWpa.s 			page 207


 9441 0194 BB67     		str	r3, [r7, #120]
 9442 0196 4CE0     		b	.L479
 9443              	.L485:
 9444              	.LBB19:
2357:bluetooth_rxtx.c **** 			u8 byte = 0;
 9445              		.loc 1 2357 0
 9446 0198 0023     		movs	r3, #0
 9447 019a 87F86B30 		strb	r3, [r7, #107]
2358:bluetooth_rxtx.c **** 			for (k = 0; k < 8; k++) {
 9448              		.loc 1 2358 0
 9449 019e 0023     		movs	r3, #0
 9450 01a0 7B67     		str	r3, [r7, #116]
 9451 01a2 39E0     		b	.L480
 9452              	.L484:
 9453              	.LBB20:
2359:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 9454              		.loc 1 2359 0
 9455 01a4 BB6F     		ldr	r3, [r7, #120]
 9456 01a6 DA00     		lsls	r2, r3, #3
 9457 01a8 7B6F     		ldr	r3, [r7, #116]
 9458 01aa 1A44     		add	r2, r2, r3
 9459 01ac FB6F     		ldr	r3, [r7, #124]
 9460 01ae 1344     		add	r3, r3, r2
 9461 01b0 203B     		subs	r3, r3, #32
 9462 01b2 3B66     		str	r3, [r7, #96]
2360:bluetooth_rxtx.c **** 				if (offset >= DMA_SIZE*8*2) break;
 9463              		.loc 1 2360 0
 9464 01b4 3B6E     		ldr	r3, [r7, #96]
 9465 01b6 B3F5487F 		cmp	r3, #800
 9466 01ba 00DB     		blt	.L481
 9467 01bc 2FE0     		b	.L482
 9468              	.L481:
2361:bluetooth_rxtx.c **** 				int bit = unpacked[offset];
 9469              		.loc 1 2361 0
 9470 01be 3B6E     		ldr	r3, [r7, #96]
 9471 01c0 7A68     		ldr	r2, [r7, #4]
 9472 01c2 1344     		add	r3, r3, r2
 9473 01c4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 9474 01c6 7B66     		str	r3, [r7, #100]
2362:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 9475              		.loc 1 2362 0
 9476 01c8 BB6F     		ldr	r3, [r7, #120]
 9477 01ca 032B     		cmp	r3, #3
 9478 01cc 16DD     		ble	.L483
2363:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 9479              		.loc 1 2363 0
 9480 01ce 464A     		ldr	r2, .L492+8
 9481 01d0 3B6F     		ldr	r3, [r7, #112]
 9482 01d2 1344     		add	r3, r3, r2
 9483 01d4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 9484 01d6 1A46     		mov	r2, r3
 9485 01d8 7B6E     		ldr	r3, [r7, #100]
 9486 01da 5340     		eors	r3, r3, r2
 9487 01dc 7B66     		str	r3, [r7, #100]
2364:bluetooth_rxtx.c **** 					idx = (idx + 1) % sizeof(whitening);
 9488              		.loc 1 2364 0
 9489 01de 3B6F     		ldr	r3, [r7, #112]
ARM GAS  /tmp/ccUeeWpa.s 			page 208


 9490 01e0 0133     		adds	r3, r3, #1
 9491 01e2 1946     		mov	r1, r3
 9492 01e4 414B     		ldr	r3, .L492+12
 9493 01e6 A1FB0323 		umull	r2, r3, r1, r3
 9494 01ea C81A     		subs	r0, r1, r3
 9495 01ec 4008     		lsrs	r0, r0, #1
 9496 01ee 0344     		add	r3, r3, r0
 9497 01f0 9A09     		lsrs	r2, r3, #6
 9498 01f2 1346     		mov	r3, r2
 9499 01f4 DB01     		lsls	r3, r3, #7
 9500 01f6 9B1A     		subs	r3, r3, r2
 9501 01f8 CA1A     		subs	r2, r1, r3
 9502 01fa 3A67     		str	r2, [r7, #112]
 9503              	.L483:
2365:bluetooth_rxtx.c **** 				}
2366:bluetooth_rxtx.c **** 				byte |= bit << k;
 9504              		.loc 1 2366 0 discriminator 2
 9505 01fc 7A6E     		ldr	r2, [r7, #100]
 9506 01fe 7B6F     		ldr	r3, [r7, #116]
 9507 0200 02FA03F3 		lsl	r3, r2, r3
 9508 0204 DAB2     		uxtb	r2, r3
 9509 0206 97F86B30 		ldrb	r3, [r7, #107]	@ zero_extendqisi2
 9510 020a 1343     		orrs	r3, r3, r2
 9511 020c DBB2     		uxtb	r3, r3
 9512 020e 87F86B30 		strb	r3, [r7, #107]
 9513              	.LBE20:
2358:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 9514              		.loc 1 2358 0 discriminator 2
 9515 0212 7B6F     		ldr	r3, [r7, #116]
 9516 0214 0133     		adds	r3, r3, #1
 9517 0216 7B67     		str	r3, [r7, #116]
 9518              	.L480:
2358:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 9519              		.loc 1 2358 0 is_stmt 0 discriminator 1
 9520 0218 7B6F     		ldr	r3, [r7, #116]
 9521 021a 072B     		cmp	r3, #7
 9522 021c C2DD     		ble	.L484
 9523              	.L482:
2367:bluetooth_rxtx.c **** 			}
2368:bluetooth_rxtx.c **** 			idle_rxbuf[j] = byte;
 9524              		.loc 1 2368 0 is_stmt 1 discriminator 2
 9525 021e 354B     		ldr	r3, .L492+20
 9526 0220 1A68     		ldr	r2, [r3]
 9527 0222 BB6F     		ldr	r3, [r7, #120]
 9528 0224 1344     		add	r3, r3, r2
 9529 0226 97F86B20 		ldrb	r2, [r7, #107]
 9530 022a 1A70     		strb	r2, [r3]
 9531              	.LBE19:
2356:bluetooth_rxtx.c **** 			u8 byte = 0;
 9532              		.loc 1 2356 0 discriminator 2
 9533 022c BB6F     		ldr	r3, [r7, #120]
 9534 022e 0133     		adds	r3, r3, #1
 9535 0230 BB67     		str	r3, [r7, #120]
 9536              	.L479:
2356:bluetooth_rxtx.c **** 			u8 byte = 0;
 9537              		.loc 1 2356 0 is_stmt 0 discriminator 1
 9538 0232 BB6F     		ldr	r3, [r7, #120]
ARM GAS  /tmp/ccUeeWpa.s 			page 209


 9539 0234 092B     		cmp	r3, #9
 9540 0236 AFDD     		ble	.L485
2369:bluetooth_rxtx.c **** 		}
2370:bluetooth_rxtx.c **** 
2371:bluetooth_rxtx.c **** 		u32 aa = (idle_rxbuf[3] << 24) |
 9541              		.loc 1 2371 0 is_stmt 1
 9542 0238 2E4B     		ldr	r3, .L492+20
 9543 023a 1B68     		ldr	r3, [r3]
 9544 023c 0333     		adds	r3, r3, #3
 9545 023e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 9546 0240 1A06     		lsls	r2, r3, #24
2372:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 9547              		.loc 1 2372 0
 9548 0242 2C4B     		ldr	r3, .L492+20
 9549 0244 1B68     		ldr	r3, [r3]
 9550 0246 0233     		adds	r3, r3, #2
 9551 0248 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 9552 024a 1B04     		lsls	r3, r3, #16
2371:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 9553              		.loc 1 2371 0
 9554 024c 1A43     		orrs	r2, r2, r3
2373:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 9555              		.loc 1 2373 0
 9556 024e 294B     		ldr	r3, .L492+20
 9557 0250 1B68     		ldr	r3, [r3]
 9558 0252 0133     		adds	r3, r3, #1
 9559 0254 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 9560 0256 1B02     		lsls	r3, r3, #8
2372:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 9561              		.loc 1 2372 0
 9562 0258 1343     		orrs	r3, r3, r2
2374:bluetooth_rxtx.c **** 				 (idle_rxbuf[0]);
 9563              		.loc 1 2374 0
 9564 025a 264A     		ldr	r2, .L492+20
 9565 025c 1268     		ldr	r2, [r2]
 9566 025e 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
2373:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 9567              		.loc 1 2373 0
 9568 0260 1343     		orrs	r3, r3, r2
2371:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 9569              		.loc 1 2371 0
 9570 0262 FB65     		str	r3, [r7, #92]
2375:bluetooth_rxtx.c **** 		see_aa(aa);
 9571              		.loc 1 2375 0
 9572 0264 F86D     		ldr	r0, [r7, #92]
 9573 0266 FFF7FEFF 		bl	see_aa
2376:bluetooth_rxtx.c **** 
2377:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, idle_rxbuf);
 9574              		.loc 1 2377 0
 9575 026a 224B     		ldr	r3, .L492+20
 9576 026c 1B68     		ldr	r3, [r3]
 9577 026e 0120     		movs	r0, #1
 9578 0270 1946     		mov	r1, r3
 9579 0272 FFF7FEFF 		bl	enqueue
 9580              	.L478:
 9581              	.LBE18:
2329:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
ARM GAS  /tmp/ccUeeWpa.s 			page 210


 9582              		.loc 1 2329 0 discriminator 2
 9583 0276 FB6F     		ldr	r3, [r7, #124]
 9584 0278 0133     		adds	r3, r3, #1
 9585 027a FB67     		str	r3, [r7, #124]
 9586              	.L466:
2329:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 9587              		.loc 1 2329 0 is_stmt 0 discriminator 1
 9588 027c FB6F     		ldr	r3, [r7, #124]
 9589 027e B3F53C7F 		cmp	r3, #752
 9590 0282 FFF62AAF 		blt	.L486
2378:bluetooth_rxtx.c **** 
2379:bluetooth_rxtx.c **** 	}
2380:bluetooth_rxtx.c **** 
2381:bluetooth_rxtx.c **** 	// once we see an AA 5 times, start following it
2382:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i) {
 9591              		.loc 1 2382 0 is_stmt 1
 9592 0286 0023     		movs	r3, #0
 9593 0288 FB67     		str	r3, [r7, #124]
 9594 028a 20E0     		b	.L487
 9595              	.L490:
2383:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 9596              		.loc 1 2383 0
 9597 028c 1A4A     		ldr	r2, .L492+24
 9598 028e FB6F     		ldr	r3, [r7, #124]
 9599 0290 DB00     		lsls	r3, r3, #3
 9600 0292 1344     		add	r3, r3, r2
 9601 0294 5B68     		ldr	r3, [r3, #4]
 9602 0296 032B     		cmp	r3, #3
 9603 0298 16DD     		ble	.L488
2384:bluetooth_rxtx.c **** 			le_set_access_address(le_promisc.active_aa[i].aa);
 9604              		.loc 1 2384 0
 9605 029a 174A     		ldr	r2, .L492+24
 9606 029c FB6F     		ldr	r3, [r7, #124]
 9607 029e 52F83330 		ldr	r3, [r2, r3, lsl #3]
 9608 02a2 1846     		mov	r0, r3
 9609 02a4 FFF7FEFF 		bl	le_set_access_address
2385:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 9610              		.loc 1 2385 0
 9611 02a8 144B     		ldr	r3, .L492+28
 9612 02aa 154A     		ldr	r2, .L492+32
 9613 02ac 1A60     		str	r2, [r3]
2386:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 9614              		.loc 1 2386 0
 9615 02ae 154B     		ldr	r3, .L492+36
 9616 02b0 154A     		ldr	r2, .L492+40
 9617 02b2 1A60     		str	r2, [r3]
2387:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 9618              		.loc 1 2387 0
 9619 02b4 154B     		ldr	r3, .L492+44
 9620 02b6 0022     		movs	r2, #0
 9621 02b8 1A61     		str	r2, [r3, #16]
2388:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 9622              		.loc 1 2388 0
 9623 02ba 0020     		movs	r0, #0
 9624 02bc 1349     		ldr	r1, .L492+44
 9625 02be 0422     		movs	r2, #4
 9626 02c0 FFF7FEFF 		bl	le_promisc_state
ARM GAS  /tmp/ccUeeWpa.s 			page 211


2389:bluetooth_rxtx.c **** 			// quit using the old stuff and switch to sync mode
2390:bluetooth_rxtx.c **** 			return 0;
 9627              		.loc 1 2390 0
 9628 02c4 0023     		movs	r3, #0
 9629 02c6 06E0     		b	.L491
 9630              	.L488:
2382:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 9631              		.loc 1 2382 0 discriminator 2
 9632 02c8 FB6F     		ldr	r3, [r7, #124]
 9633 02ca 0133     		adds	r3, r3, #1
 9634 02cc FB67     		str	r3, [r7, #124]
 9635              	.L487:
2382:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 9636              		.loc 1 2382 0 is_stmt 0 discriminator 1
 9637 02ce FB6F     		ldr	r3, [r7, #124]
 9638 02d0 1F2B     		cmp	r3, #31
 9639 02d2 DBDD     		ble	.L490
2391:bluetooth_rxtx.c **** 		}
2392:bluetooth_rxtx.c **** 	}
2393:bluetooth_rxtx.c **** 
2394:bluetooth_rxtx.c **** 	return 1;
 9640              		.loc 1 2394 0 is_stmt 1
 9641 02d4 0123     		movs	r3, #1
 9642              	.L491:
2395:bluetooth_rxtx.c **** }
 9643              		.loc 1 2395 0 discriminator 1
 9644 02d6 1846     		mov	r0, r3
 9645 02d8 8437     		adds	r7, r7, #132
 9646              		.cfi_def_cfa_offset 12
 9647 02da BD46     		mov	sp, r7
 9648              		.cfi_def_cfa_register 13
 9649              		@ sp needed
 9650 02dc 90BD     		pop	{r4, r7, pc}
 9651              	.L493:
 9652 02de 00BF     		.align	2
 9653              	.L492:
 9654 02e0 00000000 		.word	channel
 9655 02e4 AC000000 		.word	whitening_index
 9656 02e8 2C000000 		.word	whitening
 9657 02ec 11080402 		.word	33818641
 9658 02f0 CC080000 		.word	.LC0
 9659 02f4 00000000 		.word	idle_rxbuf
 9660 02f8 00000000 		.word	le_promisc
 9661 02fc 00000000 		.word	data_cb
 9662 0300 00000000 		.word	cb_follow_le
 9663 0304 00000000 		.word	packet_cb
 9664 0308 00000000 		.word	promisc_follow_cb
 9665 030c 00000000 		.word	le
 9666              		.cfi_endproc
 9667              	.LFE42:
 9669              		.section	.text.bt_promisc_le,"ax",%progbits
 9670              		.align	2
 9671              		.global	bt_promisc_le
 9672              		.thumb
 9673              		.thumb_func
 9675              	bt_promisc_le:
 9676              	.LFB43:
ARM GAS  /tmp/ccUeeWpa.s 			page 212


2396:bluetooth_rxtx.c **** 
2397:bluetooth_rxtx.c **** void bt_promisc_le() {
 9677              		.loc 1 2397 0
 9678              		.cfi_startproc
 9679              		@ args = 0, pretend = 0, frame = 0
 9680              		@ frame_needed = 1, uses_anonymous_args = 0
 9681 0000 80B5     		push	{r7, lr}
 9682              		.cfi_def_cfa_offset 8
 9683              		.cfi_offset 7, -8
 9684              		.cfi_offset 14, -4
 9685 0002 00AF     		add	r7, sp, #0
 9686              		.cfi_def_cfa_register 7
2398:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_PROMISC_LE) {
 9687              		.loc 1 2398 0
 9688 0004 2CE0     		b	.L495
 9689              	.L500:
2399:bluetooth_rxtx.c **** 		reset_le_promisc();
 9690              		.loc 1 2399 0
 9691 0006 FFF7FEFF 		bl	reset_le_promisc
2400:bluetooth_rxtx.c **** 
2401:bluetooth_rxtx.c **** 		// jump to a random data channel and turn up the squelch
2402:bluetooth_rxtx.c **** 		if ((channel & 1) == 1)
 9692              		.loc 1 2402 0
 9693 000a 184B     		ldr	r3, .L501
 9694 000c 1B88     		ldrh	r3, [r3]	@ movhi
 9695 000e 9BB2     		uxth	r3, r3
 9696 0010 03F00103 		and	r3, r3, #1
 9697 0014 002B     		cmp	r3, #0
 9698 0016 03D0     		beq	.L496
2403:bluetooth_rxtx.c **** 			channel = 2440;
 9699              		.loc 1 2403 0
 9700 0018 144B     		ldr	r3, .L501
 9701 001a 40F68812 		movw	r2, #2440
 9702 001e 1A80     		strh	r2, [r3]	@ movhi
 9703              	.L496:
2404:bluetooth_rxtx.c **** 
2405:bluetooth_rxtx.c **** 		// if the PC hasn't given us AA, determine by listening
2406:bluetooth_rxtx.c **** 		if (!le.target_set) {
 9704              		.loc 1 2406 0
 9705 0020 134B     		ldr	r3, .L501+4
 9706 0022 DB6B     		ldr	r3, [r3, #60]
 9707 0024 002B     		cmp	r3, #0
 9708 0026 07D1     		bne	.L497
2407:bluetooth_rxtx.c **** 			// cs_threshold_req = -80;
2408:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set();
 9709              		.loc 1 2408 0
 9710 0028 FFF7FEFF 		bl	cs_threshold_calc_and_set
2409:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 9711              		.loc 1 2409 0
 9712 002c 114B     		ldr	r3, .L501+8
 9713 002e 124A     		ldr	r2, .L501+12
 9714 0030 1A60     		str	r2, [r3]
2410:bluetooth_rxtx.c **** 			bt_generic_le(MODE_BT_PROMISC_LE);
 9715              		.loc 1 2410 0
 9716 0032 0A20     		movs	r0, #10
 9717 0034 FFF7FEFF 		bl	bt_generic_le
 9718              	.L497:
ARM GAS  /tmp/ccUeeWpa.s 			page 213


2411:bluetooth_rxtx.c **** 		}
2412:bluetooth_rxtx.c **** 
2413:bluetooth_rxtx.c **** 		// could have got mode change in middle of above
2414:bluetooth_rxtx.c **** 		if (requested_mode != MODE_BT_PROMISC_LE)
 9719              		.loc 1 2414 0
 9720 0038 104B     		ldr	r3, .L501+16
 9721 003a 1B78     		ldrb	r3, [r3]
 9722 003c DBB2     		uxtb	r3, r3
 9723 003e 0A2B     		cmp	r3, #10
 9724 0040 00D0     		beq	.L498
2415:bluetooth_rxtx.c **** 			break;
 9725              		.loc 1 2415 0
 9726 0042 12E0     		b	.L494
 9727              	.L498:
2416:bluetooth_rxtx.c **** 
2417:bluetooth_rxtx.c **** 		le_promisc_state(0, &le.access_address, 4);
 9728              		.loc 1 2417 0
 9729 0044 0020     		movs	r0, #0
 9730 0046 0A49     		ldr	r1, .L501+4
 9731 0048 0422     		movs	r2, #4
 9732 004a FFF7FEFF 		bl	le_promisc_state
2418:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 9733              		.loc 1 2418 0
 9734 004e 0C4B     		ldr	r3, .L501+20
 9735 0050 0C4A     		ldr	r2, .L501+24
 9736 0052 1A60     		str	r2, [r3]
2419:bluetooth_rxtx.c **** 		le.crc_verify = 0;
 9737              		.loc 1 2419 0
 9738 0054 064B     		ldr	r3, .L501+4
 9739 0056 0022     		movs	r2, #0
 9740 0058 1A61     		str	r2, [r3, #16]
2420:bluetooth_rxtx.c **** 		bt_le_sync(MODE_BT_PROMISC_LE);
 9741              		.loc 1 2420 0
 9742 005a 0A20     		movs	r0, #10
 9743 005c FFF7FEFF 		bl	bt_le_sync
 9744              	.L495:
2398:bluetooth_rxtx.c **** 		reset_le_promisc();
 9745              		.loc 1 2398 0
 9746 0060 064B     		ldr	r3, .L501+16
 9747 0062 1B78     		ldrb	r3, [r3]
 9748 0064 DBB2     		uxtb	r3, r3
 9749 0066 0A2B     		cmp	r3, #10
 9750 0068 CDD0     		beq	.L500
 9751              	.L494:
2421:bluetooth_rxtx.c **** 	}
2422:bluetooth_rxtx.c **** }
 9752              		.loc 1 2422 0
 9753 006a 80BD     		pop	{r7, pc}
 9754              	.L502:
 9755              		.align	2
 9756              	.L501:
 9757 006c 00000000 		.word	channel
 9758 0070 00000000 		.word	le
 9759 0074 00000000 		.word	data_cb
 9760 0078 00000000 		.word	cb_le_promisc
 9761 007c 00000000 		.word	requested_mode
 9762 0080 00000000 		.word	packet_cb
ARM GAS  /tmp/ccUeeWpa.s 			page 214


 9763 0084 00000000 		.word	promisc_follow_cb
 9764              		.cfi_endproc
 9765              	.LFE43:
 9767              		.section	.rodata
 9768              		.align	2
 9769              	.LC1:
 9770 08dc 00       		.byte	0
 9771 08dd 09       		.byte	9
 9772 08de FF       		.byte	-1
 9773 08df FF       		.byte	-1
 9774 08e0 FF       		.byte	-1
 9775 08e1 FF       		.byte	-1
 9776 08e2 FF       		.byte	-1
 9777 08e3 FF       		.byte	-1
 9778 08e4 02       		.byte	2
 9779 08e5 01       		.byte	1
 9780 08e6 05       		.byte	5
 9781 08e7 FF       		.byte	-1
 9782 08e8 FF       		.byte	-1
 9783 08e9 FF       		.byte	-1
 9784              		.section	.text.bt_slave_le,"ax",%progbits
 9785              		.align	2
 9786              		.global	bt_slave_le
 9787              		.thumb
 9788              		.thumb_func
 9790              	bt_slave_le:
 9791              	.LFB44:
2423:bluetooth_rxtx.c **** 
2424:bluetooth_rxtx.c **** void bt_slave_le() {
 9792              		.loc 1 2424 0
 9793              		.cfi_startproc
 9794              		@ args = 0, pretend = 0, frame = 32
 9795              		@ frame_needed = 1, uses_anonymous_args = 0
 9796 0000 90B5     		push	{r4, r7, lr}
 9797              		.cfi_def_cfa_offset 12
 9798              		.cfi_offset 4, -12
 9799              		.cfi_offset 7, -8
 9800              		.cfi_offset 14, -4
 9801 0002 89B0     		sub	sp, sp, #36
 9802              		.cfi_def_cfa_offset 48
 9803 0004 00AF     		add	r7, sp, #0
 9804              		.cfi_def_cfa_register 7
2425:bluetooth_rxtx.c **** 	u32 calc_crc;
2426:bluetooth_rxtx.c **** 	int i;
2427:bluetooth_rxtx.c **** 
2428:bluetooth_rxtx.c **** 	u8 adv_ind[] = {
 9805              		.loc 1 2428 0
 9806 0006 354A     		ldr	r2, .L508
 9807 0008 3B1D     		adds	r3, r7, #4
 9808 000a 1446     		mov	r4, r2
 9809 000c 2068     		ldr	r0, [r4]	@ unaligned
 9810 000e 6168     		ldr	r1, [r4, #4]	@ unaligned
 9811 0010 A268     		ldr	r2, [r4, #8]	@ unaligned
 9812 0012 07C3     		stmia	r3!, {r0, r1, r2}
 9813 0014 A289     		ldrh	r2, [r4, #12]	@ unaligned
 9814 0016 1A80     		strh	r2, [r3]	@ unaligned
2429:bluetooth_rxtx.c **** 		// LL header
ARM GAS  /tmp/ccUeeWpa.s 			page 215


2430:bluetooth_rxtx.c **** 		0x00, 0x09,
2431:bluetooth_rxtx.c **** 
2432:bluetooth_rxtx.c **** 		// advertising address
2433:bluetooth_rxtx.c **** 		0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
2434:bluetooth_rxtx.c **** 
2435:bluetooth_rxtx.c **** 		// advertising data
2436:bluetooth_rxtx.c **** 		0x02, 0x01, 0x05,
2437:bluetooth_rxtx.c **** 
2438:bluetooth_rxtx.c **** 		// CRC (calc)
2439:bluetooth_rxtx.c **** 		0xff, 0xff, 0xff,
2440:bluetooth_rxtx.c **** 	};
2441:bluetooth_rxtx.c **** 
2442:bluetooth_rxtx.c **** 	u8 adv_ind_len = sizeof(adv_ind) - 3;
 9815              		.loc 1 2442 0
 9816 0018 0B23     		movs	r3, #11
 9817 001a FB76     		strb	r3, [r7, #27]
2443:bluetooth_rxtx.c **** 
2444:bluetooth_rxtx.c **** 	// copy the user-specified mac address
2445:bluetooth_rxtx.c **** 	for (i = 0; i < 6; ++i)
 9818              		.loc 1 2445 0
 9819 001c 0023     		movs	r3, #0
 9820 001e FB61     		str	r3, [r7, #28]
 9821 0020 0EE0     		b	.L504
 9822              	.L505:
2446:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 9823              		.loc 1 2446 0 discriminator 3
 9824 0022 FB69     		ldr	r3, [r7, #28]
 9825 0024 0233     		adds	r3, r3, #2
 9826 0026 FA69     		ldr	r2, [r7, #28]
 9827 0028 C2F10502 		rsb	r2, r2, #5
 9828 002c 2C49     		ldr	r1, .L508+4
 9829 002e 8A5C     		ldrb	r2, [r1, r2]	@ zero_extendqisi2
 9830 0030 07F12001 		add	r1, r7, #32
 9831 0034 0B44     		add	r3, r3, r1
 9832 0036 03F81C2C 		strb	r2, [r3, #-28]
2445:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 9833              		.loc 1 2445 0 discriminator 3
 9834 003a FB69     		ldr	r3, [r7, #28]
 9835 003c 0133     		adds	r3, r3, #1
 9836 003e FB61     		str	r3, [r7, #28]
 9837              	.L504:
2445:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 9838              		.loc 1 2445 0 is_stmt 0 discriminator 1
 9839 0040 FB69     		ldr	r3, [r7, #28]
 9840 0042 052B     		cmp	r3, #5
 9841 0044 EDDD     		ble	.L505
2447:bluetooth_rxtx.c **** 
2448:bluetooth_rxtx.c **** 	calc_crc = btle_calc_crc(le.crc_init_reversed, adv_ind, adv_ind_len);
 9842              		.loc 1 2448 0 is_stmt 1
 9843 0046 274B     		ldr	r3, .L508+8
 9844 0048 D968     		ldr	r1, [r3, #12]
 9845 004a FB7E     		ldrb	r3, [r7, #27]	@ zero_extendqisi2
 9846 004c 3A1D     		adds	r2, r7, #4
 9847 004e 0846     		mov	r0, r1
 9848 0050 1146     		mov	r1, r2
 9849 0052 1A46     		mov	r2, r3
 9850 0054 FFF7FEFF 		bl	btle_calc_crc
ARM GAS  /tmp/ccUeeWpa.s 			page 216


 9851 0058 7861     		str	r0, [r7, #20]
2449:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+0] = (calc_crc >>  0) & 0xff;
 9852              		.loc 1 2449 0
 9853 005a FB7E     		ldrb	r3, [r7, #27]	@ zero_extendqisi2
 9854 005c 7A69     		ldr	r2, [r7, #20]
 9855 005e D2B2     		uxtb	r2, r2
 9856 0060 07F12001 		add	r1, r7, #32
 9857 0064 0B44     		add	r3, r3, r1
 9858 0066 03F81C2C 		strb	r2, [r3, #-28]
2450:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+1] = (calc_crc >>  8) & 0xff;
 9859              		.loc 1 2450 0
 9860 006a FB7E     		ldrb	r3, [r7, #27]	@ zero_extendqisi2
 9861 006c 0133     		adds	r3, r3, #1
 9862 006e 7A69     		ldr	r2, [r7, #20]
 9863 0070 120A     		lsrs	r2, r2, #8
 9864 0072 D2B2     		uxtb	r2, r2
 9865 0074 07F12001 		add	r1, r7, #32
 9866 0078 0B44     		add	r3, r3, r1
 9867 007a 03F81C2C 		strb	r2, [r3, #-28]
2451:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+2] = (calc_crc >> 16) & 0xff;
 9868              		.loc 1 2451 0
 9869 007e FB7E     		ldrb	r3, [r7, #27]	@ zero_extendqisi2
 9870 0080 0233     		adds	r3, r3, #2
 9871 0082 7A69     		ldr	r2, [r7, #20]
 9872 0084 120C     		lsrs	r2, r2, #16
 9873 0086 D2B2     		uxtb	r2, r2
 9874 0088 07F12001 		add	r1, r7, #32
 9875 008c 0B44     		add	r3, r3, r1
 9876 008e 03F81C2C 		strb	r2, [r3, #-28]
2452:bluetooth_rxtx.c **** 
2453:bluetooth_rxtx.c **** 	// spam advertising packets
2454:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_SLAVE_LE) {
 9877              		.loc 1 2454 0
 9878 0092 1BE0     		b	.L506
 9879              	.L507:
2455:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
 9880              		.loc 1 2455 0
 9881 0094 144B     		ldr	r3, .L508+12
 9882 0096 4FF08072 		mov	r2, #16777216
 9883 009a 1A60     		str	r2, [r3]
2456:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_DMA;
 9884              		.loc 1 2456 0
 9885 009c 124B     		ldr	r3, .L508+12
 9886 009e 4FF08062 		mov	r2, #67108864
 9887 00a2 1A60     		str	r2, [r3]
2457:bluetooth_rxtx.c **** 		le_transmit(0x8e89bed6, adv_ind_len+3, adv_ind);
 9888              		.loc 1 2457 0
 9889 00a4 FB7E     		ldrb	r3, [r7, #27]
 9890 00a6 0333     		adds	r3, r3, #3
 9891 00a8 DAB2     		uxtb	r2, r3
 9892 00aa 3B1D     		adds	r3, r7, #4
 9893 00ac 0F48     		ldr	r0, .L508+16
 9894 00ae 1146     		mov	r1, r2
 9895 00b0 1A46     		mov	r2, r3
 9896 00b2 FFF7FEFF 		bl	le_transmit
2458:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 9897              		.loc 1 2458 0
ARM GAS  /tmp/ccUeeWpa.s 			page 217


 9898 00b6 0E4B     		ldr	r3, .L508+20
 9899 00b8 4FF08072 		mov	r2, #16777216
 9900 00bc 1A60     		str	r2, [r3]
2459:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_DMA;
 9901              		.loc 1 2459 0
 9902 00be 0C4B     		ldr	r3, .L508+20
 9903 00c0 4FF08062 		mov	r2, #67108864
 9904 00c4 1A60     		str	r2, [r3]
2460:bluetooth_rxtx.c **** 		msleep(100);
 9905              		.loc 1 2460 0
 9906 00c6 6420     		movs	r0, #100
 9907 00c8 FFF7FEFF 		bl	msleep
 9908              	.L506:
2454:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
 9909              		.loc 1 2454 0
 9910 00cc 094B     		ldr	r3, .L508+24
 9911 00ce 1B78     		ldrb	r3, [r3]
 9912 00d0 DBB2     		uxtb	r3, r3
 9913 00d2 0C2B     		cmp	r3, #12
 9914 00d4 DED0     		beq	.L507
2461:bluetooth_rxtx.c **** 	}
2462:bluetooth_rxtx.c **** }
 9915              		.loc 1 2462 0
 9916 00d6 2437     		adds	r7, r7, #36
 9917              		.cfi_def_cfa_offset 12
 9918 00d8 BD46     		mov	sp, r7
 9919              		.cfi_def_cfa_register 13
 9920              		@ sp needed
 9921 00da 90BD     		pop	{r4, r7, pc}
 9922              	.L509:
 9923              		.align	2
 9924              	.L508:
 9925 00dc DC080000 		.word	.LC1
 9926 00e0 00000000 		.word	slave_mac_address
 9927 00e4 00000000 		.word	le
 9928 00e8 80E100E0 		.word	-536813184
 9929 00ec D6BE898E 		.word	-1903575338
 9930 00f0 00E100E0 		.word	-536813312
 9931 00f4 00000000 		.word	requested_mode
 9932              		.cfi_endproc
 9933              	.LFE44:
 9935              		.section	.text.specan,"ax",%progbits
 9936              		.align	2
 9937              		.global	specan
 9938              		.thumb
 9939              		.thumb_func
 9941              	specan:
 9942              	.LFB45:
2463:bluetooth_rxtx.c **** 
2464:bluetooth_rxtx.c **** /* spectrum analysis */
2465:bluetooth_rxtx.c **** void specan()
2466:bluetooth_rxtx.c **** {
 9943              		.loc 1 2466 0
 9944              		.cfi_startproc
 9945              		@ args = 0, pretend = 0, frame = 64
 9946              		@ frame_needed = 1, uses_anonymous_args = 0
 9947 0000 90B5     		push	{r4, r7, lr}
ARM GAS  /tmp/ccUeeWpa.s 			page 218


 9948              		.cfi_def_cfa_offset 12
 9949              		.cfi_offset 4, -12
 9950              		.cfi_offset 7, -8
 9951              		.cfi_offset 14, -4
 9952 0002 91B0     		sub	sp, sp, #68
 9953              		.cfi_def_cfa_offset 80
 9954 0004 00AF     		add	r7, sp, #0
 9955              		.cfi_def_cfa_register 7
2467:bluetooth_rxtx.c **** 	u8 epstat;
2468:bluetooth_rxtx.c **** 	u16 f;
2469:bluetooth_rxtx.c **** 	u8 i = 0;
 9956              		.loc 1 2469 0
 9957 0006 0023     		movs	r3, #0
 9958 0008 87F83D30 		strb	r3, [r7, #61]
2470:bluetooth_rxtx.c **** 	u8 buf[DMA_SIZE];
2471:bluetooth_rxtx.c **** 
2472:bluetooth_rxtx.c **** 	RXLED_SET;
 9959              		.loc 1 2472 0
 9960 000c 5A4B     		ldr	r3, .L521
 9961 000e 1022     		movs	r2, #16
 9962 0010 1A60     		str	r2, [r3]
2473:bluetooth_rxtx.c **** 
2474:bluetooth_rxtx.c **** 	queue_init();
 9963              		.loc 1 2474 0
 9964 0012 FFF7FEFF 		bl	queue_init
2475:bluetooth_rxtx.c **** 
2476:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2477:bluetooth_rxtx.c **** 	PAEN_SET;
 9965              		.loc 1 2477 0
 9966 0016 594B     		ldr	r3, .L521+4
 9967 0018 8022     		movs	r2, #128
 9968 001a 1A60     		str	r2, [r3]
2478:bluetooth_rxtx.c **** 	//HGM_SET;
2479:bluetooth_rxtx.c **** #endif
2480:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 9969              		.loc 1 2480 0
 9970 001c 1220     		movs	r0, #18
 9971 001e 42F62231 		movw	r1, #11042
 9972 0022 FFF7FEFF 		bl	cc2400_set
2481:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 9973              		.loc 1 2481 0
 9974 0026 1420     		movs	r0, #20
 9975 0028 41F24B31 		movw	r1, #4939
 9976 002c FFF7FEFF 		bl	cc2400_set
2482:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 9977              		.loc 1 2482 0
 9978 0030 2020     		movs	r0, #32
 9979 0032 40F20111 		movw	r1, #257
 9980 0036 FFF7FEFF 		bl	cc2400_set
2483:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 9981              		.loc 1 2483 0
 9982 003a 0320     		movs	r0, #3
 9983 003c 2921     		movs	r1, #41
 9984 003e FFF7FEFF 		bl	cc2400_set
2484:bluetooth_rxtx.c **** 	//FIXME maybe set RSSI.RSSI_FILT
2485:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 9985              		.loc 1 2485 0
ARM GAS  /tmp/ccUeeWpa.s 			page 219


 9986 0042 00BF     		nop
 9987              	.L511:
 9988              		.loc 1 2485 0 is_stmt 0 discriminator 1
 9989 0044 FFF7FEFF 		bl	cc2400_status
 9990 0048 0346     		mov	r3, r0
 9991 004a 03F04003 		and	r3, r3, #64
 9992 004e 002B     		cmp	r3, #0
 9993 0050 F8D0     		beq	.L511
2486:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 9994              		.loc 1 2486 0 is_stmt 1
 9995 0052 00BF     		nop
 9996              	.L512:
 9997              		.loc 1 2486 0 is_stmt 0 discriminator 1
 9998 0054 FFF7FEFF 		bl	cc2400_status
 9999 0058 0346     		mov	r3, r0
 10000 005a 03F00403 		and	r3, r3, #4
 10001 005e 002B     		cmp	r3, #0
 10002 0060 F8D1     		bne	.L512
2487:bluetooth_rxtx.c **** 
2488:bluetooth_rxtx.c **** 	while (requested_mode == MODE_SPECAN) {
 10003              		.loc 1 2488 0 is_stmt 1
 10004 0062 7AE0     		b	.L513
 10005              	.L520:
2489:bluetooth_rxtx.c **** 		for (f = low_freq; f < high_freq + 1; f++) {
 10006              		.loc 1 2489 0
 10007 0064 464B     		ldr	r3, .L521+8
 10008 0066 1B88     		ldrh	r3, [r3]	@ movhi
 10009 0068 FB87     		strh	r3, [r7, #62]	@ movhi
 10010 006a 6FE0     		b	.L514
 10011              	.L519:
 10012              	.LBB21:
2490:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 10013              		.loc 1 2490 0
 10014 006c FB8F     		ldrh	r3, [r7, #62]	@ movhi
 10015 006e 013B     		subs	r3, r3, #1
 10016 0070 9BB2     		uxth	r3, r3
 10017 0072 0220     		movs	r0, #2
 10018 0074 1946     		mov	r1, r3
 10019 0076 FFF7FEFF 		bl	cc2400_set
2491:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 10020              		.loc 1 2491 0
 10021 007a 6120     		movs	r0, #97
 10022 007c FFF7FEFF 		bl	cc2400_strobe
2492:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 10023              		.loc 1 2492 0
 10024 0080 00BF     		nop
 10025              	.L515:
 10026              		.loc 1 2492 0 is_stmt 0 discriminator 1
 10027 0082 FFF7FEFF 		bl	cc2400_status
 10028 0086 0346     		mov	r3, r0
 10029 0088 03F00403 		and	r3, r3, #4
 10030 008c 002B     		cmp	r3, #0
 10031 008e F8D0     		beq	.L515
2493:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 10032              		.loc 1 2493 0 is_stmt 1
 10033 0090 6220     		movs	r0, #98
 10034 0092 FFF7FEFF 		bl	cc2400_strobe
ARM GAS  /tmp/ccUeeWpa.s 			page 220


2494:bluetooth_rxtx.c **** 
2495:bluetooth_rxtx.c **** 			/* give the CC2400 time to acquire RSSI reading */
2496:bluetooth_rxtx.c **** 			volatile u32 j = 500; while (--j); //FIXME crude delay
 10035              		.loc 1 2496 0
 10036 0096 4FF4FA73 		mov	r3, #500
 10037 009a 7B60     		str	r3, [r7, #4]
 10038 009c 00BF     		nop
 10039              	.L516:
 10040              		.loc 1 2496 0 is_stmt 0 discriminator 2
 10041 009e 7B68     		ldr	r3, [r7, #4]
 10042 00a0 013B     		subs	r3, r3, #1
 10043 00a2 7B60     		str	r3, [r7, #4]
 10044 00a4 002B     		cmp	r3, #0
 10045 00a6 FAD1     		bne	.L516
2497:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 10046              		.loc 1 2497 0 is_stmt 1
 10047 00a8 97F83D20 		ldrb	r2, [r7, #61]	@ zero_extendqisi2
 10048 00ac 1346     		mov	r3, r2
 10049 00ae 5B00     		lsls	r3, r3, #1
 10050 00b0 1344     		add	r3, r3, r2
 10051 00b2 FA8F     		ldrh	r2, [r7, #62]
 10052 00b4 120A     		lsrs	r2, r2, #8
 10053 00b6 92B2     		uxth	r2, r2
 10054 00b8 D2B2     		uxtb	r2, r2
 10055 00ba 07F14001 		add	r1, r7, #64
 10056 00be 0B44     		add	r3, r3, r1
 10057 00c0 03F8382C 		strb	r2, [r3, #-56]
2498:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
 10058              		.loc 1 2498 0
 10059 00c4 97F83D20 		ldrb	r2, [r7, #61]	@ zero_extendqisi2
 10060 00c8 1346     		mov	r3, r2
 10061 00ca 5B00     		lsls	r3, r3, #1
 10062 00cc 1344     		add	r3, r3, r2
 10063 00ce 0133     		adds	r3, r3, #1
 10064 00d0 FA8F     		ldrh	r2, [r7, #62]	@ movhi
 10065 00d2 D2B2     		uxtb	r2, r2
 10066 00d4 07F14001 		add	r1, r7, #64
 10067 00d8 0B44     		add	r3, r3, r1
 10068 00da 03F8382C 		strb	r2, [r3, #-56]
2499:bluetooth_rxtx.c **** 			buf[(3 * i) + 2] = cc2400_get(RSSI) >> 8;
 10069              		.loc 1 2499 0
 10070 00de 97F83D20 		ldrb	r2, [r7, #61]	@ zero_extendqisi2
 10071 00e2 1346     		mov	r3, r2
 10072 00e4 5B00     		lsls	r3, r3, #1
 10073 00e6 1344     		add	r3, r3, r2
 10074 00e8 9C1C     		adds	r4, r3, #2
 10075 00ea 0620     		movs	r0, #6
 10076 00ec FFF7FEFF 		bl	cc2400_get
 10077 00f0 0346     		mov	r3, r0
 10078 00f2 1B0A     		lsrs	r3, r3, #8
 10079 00f4 9BB2     		uxth	r3, r3
 10080 00f6 DAB2     		uxtb	r2, r3
 10081 00f8 07F14003 		add	r3, r7, #64
 10082 00fc 2344     		add	r3, r3, r4
 10083 00fe 03F8382C 		strb	r2, [r3, #-56]
2500:bluetooth_rxtx.c **** 			i++;
 10084              		.loc 1 2500 0
ARM GAS  /tmp/ccUeeWpa.s 			page 221


 10085 0102 97F83D30 		ldrb	r3, [r7, #61]	@ zero_extendqisi2
 10086 0106 0133     		adds	r3, r3, #1
 10087 0108 87F83D30 		strb	r3, [r7, #61]
2501:bluetooth_rxtx.c **** 			if (i == 16) {
 10088              		.loc 1 2501 0
 10089 010c 97F83D30 		ldrb	r3, [r7, #61]	@ zero_extendqisi2
 10090 0110 102B     		cmp	r3, #16
 10091 0112 0DD1     		bne	.L517
2502:bluetooth_rxtx.c **** 				enqueue(SPECAN, buf);
 10092              		.loc 1 2502 0
 10093 0114 07F10803 		add	r3, r7, #8
 10094 0118 0420     		movs	r0, #4
 10095 011a 1946     		mov	r1, r3
 10096 011c FFF7FEFF 		bl	enqueue
2503:bluetooth_rxtx.c **** 				i = 0;
 10097              		.loc 1 2503 0
 10098 0120 0023     		movs	r3, #0
 10099 0122 87F83D30 		strb	r3, [r7, #61]
2504:bluetooth_rxtx.c **** 
2505:bluetooth_rxtx.c **** 				handle_usb(clkn);
 10100              		.loc 1 2505 0
 10101 0126 174B     		ldr	r3, .L521+12
 10102 0128 1B68     		ldr	r3, [r3]
 10103 012a 1846     		mov	r0, r3
 10104 012c FFF7FEFF 		bl	handle_usb
 10105              	.L517:
2506:bluetooth_rxtx.c **** 			}
2507:bluetooth_rxtx.c **** 
2508:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 10106              		.loc 1 2508 0
 10107 0130 6420     		movs	r0, #100
 10108 0132 FFF7FEFF 		bl	cc2400_strobe
2509:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 10109              		.loc 1 2509 0
 10110 0136 00BF     		nop
 10111              	.L518:
 10112              		.loc 1 2509 0 is_stmt 0 discriminator 1
 10113 0138 FFF7FEFF 		bl	cc2400_status
 10114 013c 0346     		mov	r3, r0
 10115 013e 03F00403 		and	r3, r3, #4
 10116 0142 002B     		cmp	r3, #0
 10117 0144 F8D1     		bne	.L518
 10118              	.LBE21:
2489:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 10119              		.loc 1 2489 0 is_stmt 1 discriminator 2
 10120 0146 FB8F     		ldrh	r3, [r7, #62]
 10121 0148 0133     		adds	r3, r3, #1
 10122 014a FB87     		strh	r3, [r7, #62]	@ movhi
 10123              	.L514:
2489:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 10124              		.loc 1 2489 0 is_stmt 0 discriminator 1
 10125 014c FA8F     		ldrh	r2, [r7, #62]
 10126 014e 0E4B     		ldr	r3, .L521+16
 10127 0150 1B88     		ldrh	r3, [r3]	@ movhi
 10128 0152 9BB2     		uxth	r3, r3
 10129 0154 0133     		adds	r3, r3, #1
 10130 0156 9A42     		cmp	r2, r3
ARM GAS  /tmp/ccUeeWpa.s 			page 222


 10131 0158 88DB     		blt	.L519
 10132              	.L513:
2488:bluetooth_rxtx.c **** 		for (f = low_freq; f < high_freq + 1; f++) {
 10133              		.loc 1 2488 0 is_stmt 1
 10134 015a 0C4B     		ldr	r3, .L521+20
 10135 015c 1B78     		ldrb	r3, [r3]
 10136 015e DBB2     		uxtb	r3, r3
 10137 0160 042B     		cmp	r3, #4
 10138 0162 3FF47FAF 		beq	.L520
2510:bluetooth_rxtx.c **** 		}
2511:bluetooth_rxtx.c **** 	}
2512:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 10139              		.loc 1 2512 0
 10140 0166 0A4B     		ldr	r3, .L521+24
 10141 0168 0022     		movs	r2, #0
 10142 016a 1A70     		strb	r2, [r3]
2513:bluetooth_rxtx.c **** 	RXLED_CLR;
 10143              		.loc 1 2513 0
 10144 016c 094B     		ldr	r3, .L521+28
 10145 016e 1022     		movs	r2, #16
 10146 0170 1A60     		str	r2, [r3]
2514:bluetooth_rxtx.c **** }
 10147              		.loc 1 2514 0
 10148 0172 4437     		adds	r7, r7, #68
 10149              		.cfi_def_cfa_offset 12
 10150 0174 BD46     		mov	sp, r7
 10151              		.cfi_def_cfa_register 13
 10152              		@ sp needed
 10153 0176 90BD     		pop	{r4, r7, pc}
 10154              	.L522:
 10155              		.align	2
 10156              	.L521:
 10157 0178 38C00920 		.word	537509944
 10158 017c 58C00920 		.word	537509976
 10159 0180 00000000 		.word	low_freq
 10160 0184 00000000 		.word	clkn
 10161 0188 00000000 		.word	high_freq
 10162 018c 00000000 		.word	requested_mode
 10163 0190 00000000 		.word	mode
 10164 0194 3CC00920 		.word	537509948
 10165              		.cfi_endproc
 10166              	.LFE45:
 10168              		.section	.rodata
 10169 08ea 0000     		.align	2
 10170              	.LC2:
 10171 08ec 6C09     		.short	2412
 10172 08ee 8509     		.short	2437
 10173 08f0 9E09     		.short	2462
 10174              		.section	.text.led_specan,"ax",%progbits
 10175              		.align	2
 10176              		.global	led_specan
 10177              		.thumb
 10178              		.thumb_func
 10180              	led_specan:
 10181              	.LFB46:
2515:bluetooth_rxtx.c **** 
2516:bluetooth_rxtx.c **** /* LED based spectrum analysis */
ARM GAS  /tmp/ccUeeWpa.s 			page 223


2517:bluetooth_rxtx.c **** void led_specan()
2518:bluetooth_rxtx.c **** {
 10182              		.loc 1 2518 0
 10183              		.cfi_startproc
 10184              		@ args = 0, pretend = 0, frame = 16
 10185              		@ frame_needed = 1, uses_anonymous_args = 0
 10186 0000 80B5     		push	{r7, lr}
 10187              		.cfi_def_cfa_offset 8
 10188              		.cfi_offset 7, -8
 10189              		.cfi_offset 14, -4
 10190 0002 84B0     		sub	sp, sp, #16
 10191              		.cfi_def_cfa_offset 24
 10192 0004 00AF     		add	r7, sp, #0
 10193              		.cfi_def_cfa_register 7
2519:bluetooth_rxtx.c **** 	int8_t lvl;
2520:bluetooth_rxtx.c **** 	u8 i = 0;
 10194              		.loc 1 2520 0
 10195 0006 0023     		movs	r3, #0
 10196 0008 FB73     		strb	r3, [r7, #15]
2521:bluetooth_rxtx.c **** 	u16 channels[3] = {2412, 2437, 2462};
 10197              		.loc 1 2521 0
 10198 000a 5B4A     		ldr	r2, .L540
 10199 000c 07F10803 		add	r3, r7, #8
 10200 0010 1068     		ldr	r0, [r2]	@ unaligned
 10201 0012 1860     		str	r0, [r3]	@ unaligned
 10202 0014 9288     		ldrh	r2, [r2, #4]	@ unaligned
 10203 0016 9A80     		strh	r2, [r3, #4]	@ unaligned
2522:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
2523:bluetooth_rxtx.c **** 	//void (*clr[3]) = {TXLED_CLR, RXLED_CLR, USRLED_CLR};
2524:bluetooth_rxtx.c **** 
2525:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2526:bluetooth_rxtx.c **** 	PAEN_SET;
 10204              		.loc 1 2526 0
 10205 0018 584B     		ldr	r3, .L540+4
 10206 001a 8022     		movs	r2, #128
 10207 001c 1A60     		str	r2, [r3]
2527:bluetooth_rxtx.c **** 	//HGM_SET;
2528:bluetooth_rxtx.c **** #endif
2529:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 10208              		.loc 1 2529 0
 10209 001e 1220     		movs	r0, #18
 10210 0020 42F62231 		movw	r1, #11042
 10211 0024 FFF7FEFF 		bl	cc2400_set
2530:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 10212              		.loc 1 2530 0
 10213 0028 1420     		movs	r0, #20
 10214 002a 41F24B31 		movw	r1, #4939
 10215 002e FFF7FEFF 		bl	cc2400_set
2531:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 10216              		.loc 1 2531 0
 10217 0032 2020     		movs	r0, #32
 10218 0034 40F20111 		movw	r1, #257
 10219 0038 FFF7FEFF 		bl	cc2400_set
2532:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 10220              		.loc 1 2532 0
 10221 003c 0320     		movs	r0, #3
 10222 003e 2921     		movs	r1, #41
ARM GAS  /tmp/ccUeeWpa.s 			page 224


 10223 0040 FFF7FEFF 		bl	cc2400_set
2533:bluetooth_rxtx.c **** 	cc2400_set(RSSI,    0x00F1); // RSSI Sample over 2 symbols
 10224              		.loc 1 2533 0
 10225 0044 0620     		movs	r0, #6
 10226 0046 F121     		movs	r1, #241
 10227 0048 FFF7FEFF 		bl	cc2400_set
2534:bluetooth_rxtx.c **** 
2535:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 10228              		.loc 1 2535 0
 10229 004c 00BF     		nop
 10230              	.L524:
 10231              		.loc 1 2535 0 is_stmt 0 discriminator 1
 10232 004e FFF7FEFF 		bl	cc2400_status
 10233 0052 0346     		mov	r3, r0
 10234 0054 03F04003 		and	r3, r3, #64
 10235 0058 002B     		cmp	r3, #0
 10236 005a F8D0     		beq	.L524
2536:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 10237              		.loc 1 2536 0 is_stmt 1
 10238 005c 00BF     		nop
 10239              	.L525:
 10240              		.loc 1 2536 0 is_stmt 0 discriminator 1
 10241 005e FFF7FEFF 		bl	cc2400_status
 10242 0062 0346     		mov	r3, r0
 10243 0064 03F00403 		and	r3, r3, #4
 10244 0068 002B     		cmp	r3, #0
 10245 006a F8D1     		bne	.L525
2537:bluetooth_rxtx.c **** 
2538:bluetooth_rxtx.c **** 	while (requested_mode == MODE_LED_SPECAN) {
 10246              		.loc 1 2538 0 is_stmt 1
 10247 006c 79E0     		b	.L526
 10248              	.L539:
 10249              	.LBB22:
2539:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channels[i] - 1);
 10250              		.loc 1 2539 0
 10251 006e FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 10252 0070 5B00     		lsls	r3, r3, #1
 10253 0072 07F11002 		add	r2, r7, #16
 10254 0076 1344     		add	r3, r3, r2
 10255 0078 33F8083C 		ldrh	r3, [r3, #-8]
 10256 007c 013B     		subs	r3, r3, #1
 10257 007e 9BB2     		uxth	r3, r3
 10258 0080 0220     		movs	r0, #2
 10259 0082 1946     		mov	r1, r3
 10260 0084 FFF7FEFF 		bl	cc2400_set
2540:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 10261              		.loc 1 2540 0
 10262 0088 6120     		movs	r0, #97
 10263 008a FFF7FEFF 		bl	cc2400_strobe
2541:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 10264              		.loc 1 2541 0
 10265 008e 00BF     		nop
 10266              	.L527:
 10267              		.loc 1 2541 0 is_stmt 0 discriminator 1
 10268 0090 FFF7FEFF 		bl	cc2400_status
 10269 0094 0346     		mov	r3, r0
 10270 0096 03F00403 		and	r3, r3, #4
ARM GAS  /tmp/ccUeeWpa.s 			page 225


 10271 009a 002B     		cmp	r3, #0
 10272 009c F8D0     		beq	.L527
2542:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 10273              		.loc 1 2542 0 is_stmt 1
 10274 009e 6220     		movs	r0, #98
 10275 00a0 FFF7FEFF 		bl	cc2400_strobe
2543:bluetooth_rxtx.c **** 
2544:bluetooth_rxtx.c **** 		/* give the CC2400 time to acquire RSSI reading */
2545:bluetooth_rxtx.c **** 		volatile u32 j = 500; while (--j); //FIXME crude delay
 10276              		.loc 1 2545 0
 10277 00a4 4FF4FA73 		mov	r3, #500
 10278 00a8 7B60     		str	r3, [r7, #4]
 10279 00aa 00BF     		nop
 10280              	.L528:
 10281              		.loc 1 2545 0 is_stmt 0 discriminator 2
 10282 00ac 7B68     		ldr	r3, [r7, #4]
 10283 00ae 013B     		subs	r3, r3, #1
 10284 00b0 7B60     		str	r3, [r7, #4]
 10285 00b2 002B     		cmp	r3, #0
 10286 00b4 FAD1     		bne	.L528
2546:bluetooth_rxtx.c **** 		lvl = cc2400_get(RSSI) >> 8;
 10287              		.loc 1 2546 0 is_stmt 1
 10288 00b6 0620     		movs	r0, #6
 10289 00b8 FFF7FEFF 		bl	cc2400_get
 10290 00bc 0346     		mov	r3, r0
 10291 00be 1B0A     		lsrs	r3, r3, #8
 10292 00c0 9BB2     		uxth	r3, r3
 10293 00c2 BB73     		strb	r3, [r7, #14]
2547:bluetooth_rxtx.c ****         if (lvl > rssi_threshold) {
 10294              		.loc 1 2547 0
 10295 00c4 2E4B     		ldr	r3, .L540+8
 10296 00c6 1B78     		ldrb	r3, [r3]
 10297 00c8 DBB2     		uxtb	r3, r3
 10298 00ca 97F90E20 		ldrsb	r2, [r7, #14]
 10299 00ce 5BB2     		sxtb	r3, r3
 10300 00d0 9A42     		cmp	r2, r3
 10301 00d2 15DD     		ble	.L529
2548:bluetooth_rxtx.c ****             switch (i) {
 10302              		.loc 1 2548 0
 10303 00d4 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 10304 00d6 012B     		cmp	r3, #1
 10305 00d8 09D0     		beq	.L531
 10306 00da 022B     		cmp	r3, #2
 10307 00dc 0BD0     		beq	.L532
 10308 00de 002B     		cmp	r3, #0
 10309 00e0 00D0     		beq	.L533
 10310 00e2 21E0     		b	.L534
 10311              	.L533:
2549:bluetooth_rxtx.c ****                 case 0:
2550:bluetooth_rxtx.c ****                     TXLED_SET;
 10312              		.loc 1 2550 0
 10313 00e4 274B     		ldr	r3, .L540+12
 10314 00e6 4FF48072 		mov	r2, #256
 10315 00ea 1A60     		str	r2, [r3]
2551:bluetooth_rxtx.c ****                     break;
 10316              		.loc 1 2551 0
 10317 00ec 07E0     		b	.L530
ARM GAS  /tmp/ccUeeWpa.s 			page 226


 10318              	.L531:
2552:bluetooth_rxtx.c ****                 case 1:
2553:bluetooth_rxtx.c ****                     RXLED_SET;
 10319              		.loc 1 2553 0
 10320 00ee 254B     		ldr	r3, .L540+12
 10321 00f0 1022     		movs	r2, #16
 10322 00f2 1A60     		str	r2, [r3]
2554:bluetooth_rxtx.c ****                     break;
 10323              		.loc 1 2554 0
 10324 00f4 03E0     		b	.L530
 10325              	.L532:
2555:bluetooth_rxtx.c ****                 case 2:
2556:bluetooth_rxtx.c ****                     USRLED_SET;
 10326              		.loc 1 2556 0
 10327 00f6 234B     		ldr	r3, .L540+12
 10328 00f8 0222     		movs	r2, #2
 10329 00fa 1A60     		str	r2, [r3]
2557:bluetooth_rxtx.c ****                     break;
 10330              		.loc 1 2557 0
 10331 00fc 00BF     		nop
 10332              	.L530:
 10333 00fe 13E0     		b	.L534
 10334              	.L529:
2558:bluetooth_rxtx.c ****             }
2559:bluetooth_rxtx.c ****         }
2560:bluetooth_rxtx.c ****         else {
2561:bluetooth_rxtx.c ****             switch (i) {
 10335              		.loc 1 2561 0
 10336 0100 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 10337 0102 012B     		cmp	r3, #1
 10338 0104 08D0     		beq	.L535
 10339 0106 022B     		cmp	r3, #2
 10340 0108 0AD0     		beq	.L536
 10341 010a 002B     		cmp	r3, #0
 10342 010c 0CD1     		bne	.L534
2562:bluetooth_rxtx.c ****                 case 0:
2563:bluetooth_rxtx.c ****                     TXLED_CLR;
 10343              		.loc 1 2563 0
 10344 010e 1E4B     		ldr	r3, .L540+16
 10345 0110 4FF48072 		mov	r2, #256
 10346 0114 1A60     		str	r2, [r3]
2564:bluetooth_rxtx.c ****                     break;
 10347              		.loc 1 2564 0
 10348 0116 07E0     		b	.L534
 10349              	.L535:
2565:bluetooth_rxtx.c ****                 case 1:
2566:bluetooth_rxtx.c ****                     RXLED_CLR;
 10350              		.loc 1 2566 0
 10351 0118 1B4B     		ldr	r3, .L540+16
 10352 011a 1022     		movs	r2, #16
 10353 011c 1A60     		str	r2, [r3]
2567:bluetooth_rxtx.c ****                     break;
 10354              		.loc 1 2567 0
 10355 011e 03E0     		b	.L534
 10356              	.L536:
2568:bluetooth_rxtx.c ****                 case 2:
2569:bluetooth_rxtx.c ****                     USRLED_CLR;
ARM GAS  /tmp/ccUeeWpa.s 			page 227


 10357              		.loc 1 2569 0
 10358 0120 194B     		ldr	r3, .L540+16
 10359 0122 0222     		movs	r2, #2
 10360 0124 1A60     		str	r2, [r3]
2570:bluetooth_rxtx.c ****                     break;
 10361              		.loc 1 2570 0
 10362 0126 00BF     		nop
 10363              	.L534:
2571:bluetooth_rxtx.c ****             }
2572:bluetooth_rxtx.c ****         }
2573:bluetooth_rxtx.c **** 
2574:bluetooth_rxtx.c **** 		i = (i+1) % 3;
 10364              		.loc 1 2574 0
 10365 0128 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 10366 012a 5A1C     		adds	r2, r3, #1
 10367 012c 174B     		ldr	r3, .L540+20
 10368 012e 83FB0231 		smull	r3, r1, r3, r2
 10369 0132 D317     		asrs	r3, r2, #31
 10370 0134 C91A     		subs	r1, r1, r3
 10371 0136 0B46     		mov	r3, r1
 10372 0138 5B00     		lsls	r3, r3, #1
 10373 013a 0B44     		add	r3, r3, r1
 10374 013c D11A     		subs	r1, r2, r3
 10375 013e 0B46     		mov	r3, r1
 10376 0140 FB73     		strb	r3, [r7, #15]
2575:bluetooth_rxtx.c **** 
2576:bluetooth_rxtx.c **** 		handle_usb(clkn);
 10377              		.loc 1 2576 0
 10378 0142 134B     		ldr	r3, .L540+24
 10379 0144 1B68     		ldr	r3, [r3]
 10380 0146 1846     		mov	r0, r3
 10381 0148 FFF7FEFF 		bl	handle_usb
2577:bluetooth_rxtx.c ****         //wait(1);
2578:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
 10382              		.loc 1 2578 0
 10383 014c 6420     		movs	r0, #100
 10384 014e FFF7FEFF 		bl	cc2400_strobe
2579:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 10385              		.loc 1 2579 0
 10386 0152 00BF     		nop
 10387              	.L538:
 10388              		.loc 1 2579 0 is_stmt 0 discriminator 1
 10389 0154 FFF7FEFF 		bl	cc2400_status
 10390 0158 0346     		mov	r3, r0
 10391 015a 03F00403 		and	r3, r3, #4
 10392 015e 002B     		cmp	r3, #0
 10393 0160 F8D1     		bne	.L538
 10394              	.L526:
 10395              	.LBE22:
2538:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channels[i] - 1);
 10396              		.loc 1 2538 0 is_stmt 1
 10397 0162 0C4B     		ldr	r3, .L540+28
 10398 0164 1B78     		ldrb	r3, [r3]
 10399 0166 DBB2     		uxtb	r3, r3
 10400 0168 072B     		cmp	r3, #7
 10401 016a 80D0     		beq	.L539
2580:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/ccUeeWpa.s 			page 228


2581:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 10402              		.loc 1 2581 0
 10403 016c 0A4B     		ldr	r3, .L540+32
 10404 016e 0022     		movs	r2, #0
 10405 0170 1A70     		strb	r2, [r3]
2582:bluetooth_rxtx.c **** }
 10406              		.loc 1 2582 0
 10407 0172 1037     		adds	r7, r7, #16
 10408              		.cfi_def_cfa_offset 8
 10409 0174 BD46     		mov	sp, r7
 10410              		.cfi_def_cfa_register 13
 10411              		@ sp needed
 10412 0176 80BD     		pop	{r7, pc}
 10413              	.L541:
 10414              		.align	2
 10415              	.L540:
 10416 0178 EC080000 		.word	.LC2
 10417 017c 58C00920 		.word	537509976
 10418 0180 00000000 		.word	rssi_threshold
 10419 0184 38C00920 		.word	537509944
 10420 0188 3CC00920 		.word	537509948
 10421 018c 56555555 		.word	1431655766
 10422 0190 00000000 		.word	clkn
 10423 0194 00000000 		.word	requested_mode
 10424 0198 00000000 		.word	mode
 10425              		.cfi_endproc
 10426              	.LFE46:
 10428              		.section	.text.main,"ax",%progbits
 10429              		.align	2
 10430              		.global	main
 10431              		.thumb
 10432              		.thumb_func
 10434              	main:
 10435              	.LFB47:
2583:bluetooth_rxtx.c **** 
2584:bluetooth_rxtx.c **** int main()
2585:bluetooth_rxtx.c **** {
 10436              		.loc 1 2585 0
 10437              		.cfi_startproc
 10438              		@ args = 0, pretend = 0, frame = 0
 10439              		@ frame_needed = 1, uses_anonymous_args = 0
 10440 0000 80B5     		push	{r7, lr}
 10441              		.cfi_def_cfa_offset 8
 10442              		.cfi_offset 7, -8
 10443              		.cfi_offset 14, -4
 10444 0002 00AF     		add	r7, sp, #0
 10445              		.cfi_def_cfa_register 7
2586:bluetooth_rxtx.c **** 	ubertooth_init();
 10446              		.loc 1 2586 0
 10447 0004 FFF7FEFF 		bl	ubertooth_init
2587:bluetooth_rxtx.c **** 	clkn_init();
 10448              		.loc 1 2587 0
 10449 0008 FFF7FEFF 		bl	clkn_init
2588:bluetooth_rxtx.c **** 	ubertooth_usb_init(vendor_request_handler);
 10450              		.loc 1 2588 0
 10451 000c 4248     		ldr	r0, .L562
 10452 000e FFF7FEFF 		bl	ubertooth_usb_init
ARM GAS  /tmp/ccUeeWpa.s 			page 229


 10453              	.L560:
2589:bluetooth_rxtx.c **** 
2590:bluetooth_rxtx.c **** 	while (1) {
2591:bluetooth_rxtx.c **** 		handle_usb(clkn);
 10454              		.loc 1 2591 0
 10455 0012 424B     		ldr	r3, .L562+4
 10456 0014 1B68     		ldr	r3, [r3]
 10457 0016 1846     		mov	r0, r3
 10458 0018 FFF7FEFF 		bl	handle_usb
2592:bluetooth_rxtx.c **** 		if(requested_mode != mode)
 10459              		.loc 1 2592 0
 10460 001c 404B     		ldr	r3, .L562+8
 10461 001e 1B78     		ldrb	r3, [r3]
 10462 0020 DAB2     		uxtb	r2, r3
 10463 0022 404B     		ldr	r3, .L562+12
 10464 0024 1B78     		ldrb	r3, [r3]
 10465 0026 DBB2     		uxtb	r3, r3
 10466 0028 9A42     		cmp	r2, r3
 10467 002a 74D0     		beq	.L543
2593:bluetooth_rxtx.c **** 			switch (requested_mode) {
 10468              		.loc 1 2593 0
 10469 002c 3C4B     		ldr	r3, .L562+8
 10470 002e 1B78     		ldrb	r3, [r3]
 10471 0030 DBB2     		uxtb	r3, r3
 10472 0032 0D2B     		cmp	r3, #13
 10473 0034 6ED8     		bhi	.L561
 10474 0036 01A2     		adr	r2, .L546
 10475 0038 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 10476              		.p2align 2
 10477              	.L546:
 10478 003c 0F010000 		.word	.L545+1
 10479 0040 81000000 		.word	.L547+1
 10480 0044 15010000 		.word	.L561+1
 10481 0048 AB000000 		.word	.L548+1
 10482 004c EF000000 		.word	.L549+1
 10483 0050 BB000000 		.word	.L550+1
 10484 0054 E1000000 		.word	.L551+1
 10485 0058 F5000000 		.word	.L552+1
 10486 005c 8D000000 		.word	.L553+1
 10487 0060 99000000 		.word	.L554+1
 10488 0064 9F000000 		.word	.L555+1
 10489 0068 75000000 		.word	.L556+1
 10490 006c A5000000 		.word	.L557+1
 10491 0070 FB000000 		.word	.L558+1
 10492              		.p2align 1
 10493              	.L556:
2594:bluetooth_rxtx.c **** 				 case MODE_RESET:
2595:bluetooth_rxtx.c **** 					/* Allow time for the USB command to return correctly */
2596:bluetooth_rxtx.c **** 					wait(1);
 10494              		.loc 1 2596 0
 10495 0074 0120     		movs	r0, #1
 10496 0076 FFF7FEFF 		bl	wait
2597:bluetooth_rxtx.c **** 					reset();
 10497              		.loc 1 2597 0
 10498 007a FFF7FEFF 		bl	reset
2598:bluetooth_rxtx.c **** 					break;
 10499              		.loc 1 2598 0
ARM GAS  /tmp/ccUeeWpa.s 			page 230


 10500 007e 4AE0     		b	.L543
 10501              	.L547:
2599:bluetooth_rxtx.c **** 				case MODE_RX_SYMBOLS:
2600:bluetooth_rxtx.c **** 					mode = MODE_RX_SYMBOLS;
 10502              		.loc 1 2600 0
 10503 0080 284B     		ldr	r3, .L562+12
 10504 0082 0122     		movs	r2, #1
 10505 0084 1A70     		strb	r2, [r3]
2601:bluetooth_rxtx.c **** 					bt_stream_rx();
 10506              		.loc 1 2601 0
 10507 0086 FFF7FEFF 		bl	bt_stream_rx
2602:bluetooth_rxtx.c **** 					break;
 10508              		.loc 1 2602 0
 10509 008a 44E0     		b	.L543
 10510              	.L553:
2603:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW:
2604:bluetooth_rxtx.c **** 					mode = MODE_BT_FOLLOW;
 10511              		.loc 1 2604 0
 10512 008c 254B     		ldr	r3, .L562+12
 10513 008e 0822     		movs	r2, #8
 10514 0090 1A70     		strb	r2, [r3]
2605:bluetooth_rxtx.c **** 					bt_stream_rx();
 10515              		.loc 1 2605 0
 10516 0092 FFF7FEFF 		bl	bt_stream_rx
2606:bluetooth_rxtx.c **** 					break;
 10517              		.loc 1 2606 0
 10518 0096 3EE0     		b	.L543
 10519              	.L554:
2607:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW_LE:
2608:bluetooth_rxtx.c **** 					bt_follow_le();
 10520              		.loc 1 2608 0
 10521 0098 FFF7FEFF 		bl	bt_follow_le
2609:bluetooth_rxtx.c **** 					break;
 10522              		.loc 1 2609 0
 10523 009c 3BE0     		b	.L543
 10524              	.L555:
2610:bluetooth_rxtx.c **** 				case MODE_BT_PROMISC_LE:
2611:bluetooth_rxtx.c **** 					bt_promisc_le();
 10525              		.loc 1 2611 0
 10526 009e FFF7FEFF 		bl	bt_promisc_le
2612:bluetooth_rxtx.c **** 					break;
 10527              		.loc 1 2612 0
 10528 00a2 38E0     		b	.L543
 10529              	.L557:
2613:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE:
2614:bluetooth_rxtx.c **** 					bt_slave_le();
 10530              		.loc 1 2614 0
 10531 00a4 FFF7FEFF 		bl	bt_slave_le
2615:bluetooth_rxtx.c **** 					break;
 10532              		.loc 1 2615 0
 10533 00a8 35E0     		b	.L543
 10534              	.L548:
2616:bluetooth_rxtx.c **** 				case MODE_TX_TEST:
2617:bluetooth_rxtx.c **** 					mode = MODE_TX_TEST;
 10535              		.loc 1 2617 0
 10536 00aa 1E4B     		ldr	r3, .L562+12
 10537 00ac 0322     		movs	r2, #3
ARM GAS  /tmp/ccUeeWpa.s 			page 231


 10538 00ae 1A70     		strb	r2, [r3]
2618:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 10539              		.loc 1 2618 0
 10540 00b0 1D48     		ldr	r0, .L562+16
 10541 00b2 1E49     		ldr	r1, .L562+20
 10542 00b4 FFF7FEFF 		bl	cc2400_txtest
2619:bluetooth_rxtx.c **** 					break;
 10543              		.loc 1 2619 0
 10544 00b8 2DE0     		b	.L543
 10545              	.L550:
2620:bluetooth_rxtx.c **** 				case MODE_RANGE_TEST:
2621:bluetooth_rxtx.c **** 					mode = MODE_RANGE_TEST;
 10546              		.loc 1 2621 0
 10547 00ba 1A4B     		ldr	r3, .L562+12
 10548 00bc 0522     		movs	r2, #5
 10549 00be 1A70     		strb	r2, [r3]
2622:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 10550              		.loc 1 2622 0
 10551 00c0 1A48     		ldr	r0, .L562+20
 10552 00c2 FFF7FEFF 		bl	cc2400_rangetest
2623:bluetooth_rxtx.c **** 					mode = MODE_IDLE;
 10553              		.loc 1 2623 0
 10554 00c6 174B     		ldr	r3, .L562+12
 10555 00c8 0022     		movs	r2, #0
 10556 00ca 1A70     		strb	r2, [r3]
2624:bluetooth_rxtx.c **** 					if (requested_mode == MODE_RANGE_TEST)
 10557              		.loc 1 2624 0
 10558 00cc 144B     		ldr	r3, .L562+8
 10559 00ce 1B78     		ldrb	r3, [r3]
 10560 00d0 DBB2     		uxtb	r3, r3
 10561 00d2 052B     		cmp	r3, #5
 10562 00d4 03D1     		bne	.L559
2625:bluetooth_rxtx.c **** 						requested_mode = MODE_IDLE;
 10563              		.loc 1 2625 0
 10564 00d6 124B     		ldr	r3, .L562+8
 10565 00d8 0022     		movs	r2, #0
 10566 00da 1A70     		strb	r2, [r3]
2626:bluetooth_rxtx.c **** 					break;
 10567              		.loc 1 2626 0
 10568 00dc 1BE0     		b	.L543
 10569              	.L559:
 10570 00de 1AE0     		b	.L543
 10571              	.L551:
2627:bluetooth_rxtx.c **** 				case MODE_REPEATER:
2628:bluetooth_rxtx.c **** 					mode = MODE_REPEATER;
 10572              		.loc 1 2628 0
 10573 00e0 104B     		ldr	r3, .L562+12
 10574 00e2 0622     		movs	r2, #6
 10575 00e4 1A70     		strb	r2, [r3]
2629:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 10576              		.loc 1 2629 0
 10577 00e6 1148     		ldr	r0, .L562+20
 10578 00e8 FFF7FEFF 		bl	cc2400_repeater
2630:bluetooth_rxtx.c **** 					break;
 10579              		.loc 1 2630 0
 10580 00ec 13E0     		b	.L543
 10581              	.L549:
ARM GAS  /tmp/ccUeeWpa.s 			page 232


2631:bluetooth_rxtx.c **** 				case MODE_SPECAN:
2632:bluetooth_rxtx.c **** 					specan();
 10582              		.loc 1 2632 0
 10583 00ee FFF7FEFF 		bl	specan
2633:bluetooth_rxtx.c **** 					break;
 10584              		.loc 1 2633 0
 10585 00f2 10E0     		b	.L543
 10586              	.L552:
2634:bluetooth_rxtx.c **** 				case MODE_LED_SPECAN:
2635:bluetooth_rxtx.c **** 					led_specan();
 10587              		.loc 1 2635 0
 10588 00f4 FFF7FEFF 		bl	led_specan
2636:bluetooth_rxtx.c **** 					break;
 10589              		.loc 1 2636 0
 10590 00f8 0DE0     		b	.L543
 10591              	.L558:
2637:bluetooth_rxtx.c **** 				case MODE_EGO:
2638:bluetooth_rxtx.c **** 					mode = MODE_EGO;
 10592              		.loc 1 2638 0
 10593 00fa 0A4B     		ldr	r3, .L562+12
 10594 00fc 0D22     		movs	r2, #13
 10595 00fe 1A70     		strb	r2, [r3]
2639:bluetooth_rxtx.c **** 					ego_main(ego_mode);
 10596              		.loc 1 2639 0
 10597 0100 0B4B     		ldr	r3, .L562+24
 10598 0102 1B78     		ldrb	r3, [r3]
 10599 0104 DBB2     		uxtb	r3, r3
 10600 0106 1846     		mov	r0, r3
 10601 0108 FFF7FEFF 		bl	ego_main
2640:bluetooth_rxtx.c **** 					break;
 10602              		.loc 1 2640 0
 10603 010c 03E0     		b	.L543
 10604              	.L545:
2641:bluetooth_rxtx.c **** 				case MODE_IDLE:
2642:bluetooth_rxtx.c **** 					cc2400_idle();
 10605              		.loc 1 2642 0
 10606 010e FFF7FEFF 		bl	cc2400_idle
2643:bluetooth_rxtx.c **** 					break;
 10607              		.loc 1 2643 0
 10608 0112 00E0     		b	.L543
 10609              	.L561:
2644:bluetooth_rxtx.c **** 				default:
2645:bluetooth_rxtx.c **** 					/* This is really an error state, but what can you do? */
2646:bluetooth_rxtx.c **** 					break;
 10610              		.loc 1 2646 0
 10611 0114 00BF     		nop
 10612              	.L543:
2647:bluetooth_rxtx.c **** 			}
2648:bluetooth_rxtx.c **** 	}
 10613              		.loc 1 2648 0 discriminator 1
 10614 0116 7CE7     		b	.L560
 10615              	.L563:
 10616              		.align	2
 10617              	.L562:
 10618 0118 00000000 		.word	vendor_request_handler
 10619 011c 00000000 		.word	clkn
 10620 0120 00000000 		.word	requested_mode
ARM GAS  /tmp/ccUeeWpa.s 			page 233


 10621 0124 00000000 		.word	mode
 10622 0128 00000000 		.word	modulation
 10623 012c 00000000 		.word	channel
 10624 0130 00000000 		.word	ego_mode
 10625              		.cfi_endproc
 10626              	.LFE47:
 10628              		.bss
 10629              		.align	2
 10630              	restart_jamming.4707:
 10631 00d4 00000000 		.space	4
 10632              		.align	2
 10633              	first_ts.4805:
 10634 00d8 00000000 		.space	4
 10635              		.align	2
 10636              	prev_clk.4811:
 10637 00dc 00000000 		.space	4
 10638              		.text
 10639              	.Letext0:
 10640              		.file 2 "/usr/lib/gcc/arm-none-eabi/4.9.3/include/stdint-gcc.h"
 10641              		.file 3 "../../host/libubertooth/src/ubertooth_interface.h"
 10642              		.file 4 "../common/ubertooth.h"
 10643              		.file 5 "bluetooth_le.h"
 10644              		.file 6 "bluetooth.h"
 10645              		.file 7 "cc2400_rangetest.h"
ARM GAS  /tmp/ccUeeWpa.s 			page 234


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bluetooth_rxtx.c
     /tmp/ccUeeWpa.s:19     .data:0000000000000000 $d
     /tmp/ccUeeWpa.s:22     .data:0000000000000000 iap_entry
                            *COM*:0000000000000010 target
                            *COM*:0000000000000008 syncword
                            *COM*:0000000000000001 afh_enabled
                            *COM*:000000000000000a afh_map
     /tmp/ccUeeWpa.s:29     .rodata:0000000000000000 $d
     /tmp/ccUeeWpa.s:32     .rodata:0000000000000000 advertising_channels
     /tmp/ccUeeWpa.s:39     .rodata:0000000000000004 data_channels
     /tmp/ccUeeWpa.s:80     .rodata:000000000000002c whitening
     /tmp/ccUeeWpa.s:211    .rodata:00000000000000ac whitening_index
     /tmp/ccUeeWpa.s:255    .rodata:00000000000000d4 hop_interval_lut
     /tmp/ccUeeWpa.s:296    .rodata:00000000000000fc whitening_word
                            *COM*:0000000000000005 rr
     /tmp/ccUeeWpa.s:782    .rodata:000000000000087c compile_info
                            *COM*:0000000000000004 clkn
     /tmp/ccUeeWpa.s:790    .bss:0000000000000000 hop_mode
     /tmp/ccUeeWpa.s:791    .bss:0000000000000000 $d
     /tmp/ccUeeWpa.s:795    .bss:0000000000000001 do_hop
     /tmp/ccUeeWpa.s:800    .bss:0000000000000002 cs_no_squelch
     /tmp/ccUeeWpa.s:806    .data:0000000000000004 cs_threshold_req
     /tmp/ccUeeWpa.s:811    .data:0000000000000005 cs_threshold_cur
                            *COM*:0000000000000001 cs_trigger
                            *COM*:0000000000000001 keepalive_trigger
                            *COM*:0000000000000004 cs_timestamp
     /tmp/ccUeeWpa.s:821    .bss:0000000000000004 hop_direct_channel
     /tmp/ccUeeWpa.s:827    .bss:0000000000000008 clock_trim
                            *COM*:0000000000000004 idle_buf_clkn_high
                            *COM*:0000000000000004 active_buf_clkn_high
                            *COM*:0000000000000004 idle_buf_clk100ns
                            *COM*:0000000000000004 active_buf_clk100ns
     /tmp/ccUeeWpa.s:837    .bss:000000000000000c idle_buf_channel
     /tmp/ccUeeWpa.s:843    .bss:000000000000000e active_buf_channel
     /tmp/ccUeeWpa.s:849    .bss:0000000000000010 slave_mac_address
                            *COM*:0000000000000032 rxbuf1
                            *COM*:0000000000000032 rxbuf2
     /tmp/ccUeeWpa.s:858    .data:0000000000000008 active_rxbuf
     /tmp/ccUeeWpa.s:864    .data:000000000000000c idle_rxbuf
     /tmp/ccUeeWpa.s:870    .data:0000000000000010 le
                            *COM*:0000000000000108 le_promisc
     /tmp/ccUeeWpa.s:889    .bss:0000000000000018 le_jam_count
     /tmp/ccUeeWpa.s:895    .bss:000000000000001c data_cb
     /tmp/ccUeeWpa.s:901    .bss:0000000000000020 packet_cb
     /tmp/ccUeeWpa.s:907    .bss:0000000000000024 rssi_iir
                            *COM*:0000000000000320 unpacked
     /tmp/ccUeeWpa.s:913    .bss:00000000000000c2 mode
     /tmp/ccUeeWpa.s:918    .bss:00000000000000c3 requested_mode
     /tmp/ccUeeWpa.s:923    .bss:00000000000000c4 jam_mode
     /tmp/ccUeeWpa.s:928    .bss:00000000000000c5 ego_mode
     /tmp/ccUeeWpa.s:933    .bss:00000000000000c6 modulation
     /tmp/ccUeeWpa.s:940    .data:0000000000000054 channel
     /tmp/ccUeeWpa.s:947    .bss:00000000000000c8 requested_channel
     /tmp/ccUeeWpa.s:953    .bss:00000000000000ca saved_request
     /tmp/ccUeeWpa.s:960    .data:0000000000000056 low_freq
     /tmp/ccUeeWpa.s:966    .data:0000000000000058 high_freq
ARM GAS  /tmp/ccUeeWpa.s 			page 235


     /tmp/ccUeeWpa.s:971    .data:000000000000005a rssi_threshold
                            *COM*:0000000000000010 rx_dma_lli1
                            *COM*:0000000000000010 rx_dma_lli2
                            *COM*:00000000000000b0 le_dma_lli
                            *COM*:0000000000000004 rx_tc
                            *COM*:0000000000000004 rx_err
     /tmp/ccUeeWpa.s:982    .bss:00000000000000cc status
                            *COM*:0000000000000001 rssi_max
                            *COM*:0000000000000001 rssi_min
     /tmp/ccUeeWpa.s:989    .bss:00000000000000cd rssi_count
     /tmp/ccUeeWpa.s:995    .bss:00000000000000d0 rssi_sum
     /tmp/ccUeeWpa.s:998    .text.rssi_reset:0000000000000000 $t
     /tmp/ccUeeWpa.s:1002   .text.rssi_reset:0000000000000000 rssi_reset
     /tmp/ccUeeWpa.s:1042   .text.rssi_reset:0000000000000024 $d
     /tmp/ccUeeWpa.s:1050   .text.rssi_add:0000000000000000 $t
     /tmp/ccUeeWpa.s:1054   .text.rssi_add:0000000000000000 rssi_add
     /tmp/ccUeeWpa.s:1120   .text.rssi_add:000000000000005c $d
     /tmp/ccUeeWpa.s:1128   .text.rssi_iir_update:0000000000000000 $t
     /tmp/ccUeeWpa.s:1132   .text.rssi_iir_update:0000000000000000 rssi_iir_update
     /tmp/ccUeeWpa.s:1226   .text.rssi_iir_update:0000000000000084 $d
     /tmp/ccUeeWpa.s:1235   .text.cs_threshold_set:0000000000000000 $t
     /tmp/ccUeeWpa.s:1239   .text.cs_threshold_set:0000000000000000 cs_threshold_set
     /tmp/ccUeeWpa.s:1321   .text.cs_threshold_set:0000000000000084 $d
     /tmp/ccUeeWpa.s:1327   .text.enqueue:0000000000000000 $t
     /tmp/ccUeeWpa.s:1331   .text.enqueue:0000000000000000 enqueue
     /tmp/ccUeeWpa.s:1578   .text.enqueue:0000000000000180 $d
     /tmp/ccUeeWpa.s:1594   .text.enqueue_with_ts:0000000000000000 $t
     /tmp/ccUeeWpa.s:1599   .text.enqueue_with_ts:0000000000000000 enqueue_with_ts
     /tmp/ccUeeWpa.s:1780   .text.enqueue_with_ts:000000000000010c $d
     /tmp/ccUeeWpa.s:1787   .text.cs_threshold_calc_and_set:0000000000000000 $t
     /tmp/ccUeeWpa.s:1791   .text.cs_threshold_calc_and_set:0000000000000000 cs_threshold_calc_and_set
     /tmp/ccUeeWpa.s:1866   .text.cs_threshold_calc_and_set:0000000000000064 $d
     /tmp/ccUeeWpa.s:1874   .text.cs_trigger_enable:0000000000000000 $t
     /tmp/ccUeeWpa.s:1878   .text.cs_trigger_enable:0000000000000000 cs_trigger_enable
     /tmp/ccUeeWpa.s:1919   .text.cs_trigger_enable:000000000000002c $d
     /tmp/ccUeeWpa.s:1927   .text.cs_trigger_disable:0000000000000000 $t
     /tmp/ccUeeWpa.s:1931   .text.cs_trigger_disable:0000000000000000 cs_trigger_disable
     /tmp/ccUeeWpa.s:1972   .text.cs_trigger_disable:000000000000002c $d
     /tmp/ccUeeWpa.s:1984   .text.vendor_request_handler:0000000000000000 $t
     /tmp/ccUeeWpa.s:1988   .text.vendor_request_handler:0000000000000000 vendor_request_handler
     /tmp/ccUeeWpa.s:2025   .text.vendor_request_handler:0000000000000024 $d
     /tmp/ccUeeWpa.s:2086   .text.vendor_request_handler:0000000000000118 $t
     /tmp/ccUeeWpa.s:2486   .text.vendor_request_handler:00000000000003a8 $d
     /tmp/ccUeeWpa.s:2496   .text.vendor_request_handler:00000000000003c8 $t
     /tmp/ccUeeWpa.s:2880   .text.vendor_request_handler:0000000000000614 $d
     /tmp/ccUeeWpa.s:2898   .text.vendor_request_handler:0000000000000654 $t
     /tmp/ccUeeWpa.s:3288   .text.vendor_request_handler:00000000000008f4 $d
     /tmp/ccUeeWpa.s:3300   .text.vendor_request_handler:000000000000091c $t
     /tmp/ccUeeWpa.s:6251   .text.le_set_access_address:0000000000000000 le_set_access_address
     /tmp/ccUeeWpa.s:3584   .text.vendor_request_handler:0000000000000ad4 $d
     /tmp/ccUeeWpa.s:3594   .text.clkn_init:0000000000000000 $t
     /tmp/ccUeeWpa.s:3598   .text.clkn_init:0000000000000000 clkn_init
     /tmp/ccUeeWpa.s:3649   .text.clkn_init:0000000000000038 $d
     /tmp/ccUeeWpa.s:3659   .text.TIMER0_IRQHandler:0000000000000000 $t
     /tmp/ccUeeWpa.s:3664   .text.TIMER0_IRQHandler:0000000000000000 TIMER0_IRQHandler
     /tmp/ccUeeWpa.s:3833   .text.TIMER0_IRQHandler:00000000000000fc $d
     /tmp/ccUeeWpa.s:3845   .text.EINT3_IRQHandler:0000000000000000 $t
ARM GAS  /tmp/ccUeeWpa.s 			page 236


     /tmp/ccUeeWpa.s:3850   .text.EINT3_IRQHandler:0000000000000000 EINT3_IRQHandler
     /tmp/ccUeeWpa.s:3892   .text.EINT3_IRQHandler:0000000000000034 $d
     /tmp/ccUeeWpa.s:3905   .text.msleep:0000000000000000 $t
     /tmp/ccUeeWpa.s:3909   .text.msleep:0000000000000000 msleep
     /tmp/ccUeeWpa.s:3974   .text.msleep:0000000000000068 $d
     /tmp/ccUeeWpa.s:3981   .text.dma_init:0000000000000000 $t
     /tmp/ccUeeWpa.s:3985   .text.dma_init:0000000000000000 dma_init
     /tmp/ccUeeWpa.s:4159   .text.dma_init:0000000000000104 $d
     /tmp/ccUeeWpa.s:4194   .text.dma_init_le:0000000000000000 $t
     /tmp/ccUeeWpa.s:4198   .text.dma_init_le:0000000000000000 dma_init_le
     /tmp/ccUeeWpa.s:4403   .text.dma_init_le:0000000000000134 $d
     /tmp/ccUeeWpa.s:4435   .text.bt_stream_dma_handler:0000000000000000 $t
     /tmp/ccUeeWpa.s:4440   .text.bt_stream_dma_handler:0000000000000000 bt_stream_dma_handler
     /tmp/ccUeeWpa.s:4543   .text.bt_stream_dma_handler:000000000000009c $d
     /tmp/ccUeeWpa.s:4563   .text.DMA_IRQHandler:0000000000000000 $t
     /tmp/ccUeeWpa.s:4568   .text.DMA_IRQHandler:0000000000000000 DMA_IRQHandler
     /tmp/ccUeeWpa.s:4591   .text.DMA_IRQHandler:0000000000000018 $d
     /tmp/ccUeeWpa.s:4603   .text.DMA_IRQHandler:0000000000000048 $t
     /tmp/ccUeeWpa.s:4615   .text.DMA_IRQHandler:0000000000000050 $d
     /tmp/ccUeeWpa.s:4620   .text.dio_ssp_start:0000000000000000 $t
     /tmp/ccUeeWpa.s:4624   .text.dio_ssp_start:0000000000000000 dio_ssp_start
     /tmp/ccUeeWpa.s:4677   .text.dio_ssp_start:0000000000000048 $d
     /tmp/ccUeeWpa.s:4687   .text.dio_ssp_stop:0000000000000000 $t
     /tmp/ccUeeWpa.s:4691   .text.dio_ssp_stop:0000000000000000 dio_ssp_stop
     /tmp/ccUeeWpa.s:4789   .text.dio_ssp_stop:000000000000008c $d
     /tmp/ccUeeWpa.s:4808   .text.cc2400_idle:0000000000000000 $t
     /tmp/ccUeeWpa.s:4812   .text.cc2400_idle:0000000000000000 cc2400_idle
     /tmp/ccUeeWpa.s:4865   .text.cc2400_idle:0000000000000044 $d
     /tmp/ccUeeWpa.s:4872   .text.cc2400_rx:0000000000000000 $t
     /tmp/ccUeeWpa.s:4876   .text.cc2400_rx:0000000000000000 cc2400_rx
     /tmp/ccUeeWpa.s:4990   .text.cc2400_rx:00000000000000b0 $d
     /tmp/ccUeeWpa.s:4997   .text.cc2400_rx_sync:0000000000000000 $t
     /tmp/ccUeeWpa.s:5001   .text.cc2400_rx_sync:0000000000000000 cc2400_rx_sync
     /tmp/ccUeeWpa.s:5136   .text.cc2400_rx_sync:00000000000000d8 $d
     /tmp/ccUeeWpa.s:5143   .text.le_transmit:0000000000000000 $t
     /tmp/ccUeeWpa.s:5148   .text.le_transmit:0000000000000000 le_transmit
     /tmp/ccUeeWpa.s:5541   .text.le_transmit:00000000000002d4 $d
     /tmp/ccUeeWpa.s:5554   .text.le_jam:0000000000000000 $t
     /tmp/ccUeeWpa.s:5559   .text.le_jam:0000000000000000 le_jam
     /tmp/ccUeeWpa.s:5642   .text.le_jam:000000000000008c $d
     /tmp/ccUeeWpa.s:5648   .text.hop:0000000000000000 $t
     /tmp/ccUeeWpa.s:5653   .text.hop:0000000000000000 hop
     /tmp/ccUeeWpa.s:5820   .text.hop:000000000000010c $d
     /tmp/ccUeeWpa.s:5831   .text.cc2400_spi_rev:0000000000000000 $t
     /tmp/ccUeeWpa.s:5836   .text.cc2400_spi_rev:0000000000000000 cc2400_spi_rev
     /tmp/ccUeeWpa.s:5933   .text.cc2400_spi_rev:000000000000007c $d
     /tmp/ccUeeWpa.s:5940   .text.cc2400_get_rev:0000000000000000 $t
     /tmp/ccUeeWpa.s:5945   .text.cc2400_get_rev:0000000000000000 cc2400_get_rev
     /tmp/ccUeeWpa.s:5987   .text.bt_stream_rx:0000000000000000 $t
     /tmp/ccUeeWpa.s:5992   .text.bt_stream_rx:0000000000000000 bt_stream_rx
     /tmp/ccUeeWpa.s:6235   .text.bt_stream_rx:000000000000019c $d
     /tmp/ccUeeWpa.s:6247   .text.le_set_access_address:0000000000000000 $t
     /tmp/ccUeeWpa.s:6295   .text.le_set_access_address:0000000000000030 $d
     /tmp/ccUeeWpa.s:6300   .text.reset_le:0000000000000000 $t
     /tmp/ccUeeWpa.s:6305   .text.reset_le:0000000000000000 reset_le
     /tmp/ccUeeWpa.s:6401   .text.reset_le:0000000000000084 $d
     /tmp/ccUeeWpa.s:6410   .text.reset_le_promisc:0000000000000000 $t
ARM GAS  /tmp/ccUeeWpa.s 			page 237


     /tmp/ccUeeWpa.s:6415   .text.reset_le_promisc:0000000000000000 reset_le_promisc
     /tmp/ccUeeWpa.s:6441   .text.reset_le_promisc:000000000000001c $d
     /tmp/ccUeeWpa.s:6446   .text.bt_generic_le:0000000000000000 $t
     /tmp/ccUeeWpa.s:6451   .text.bt_generic_le:0000000000000000 bt_generic_le
     /tmp/ccUeeWpa.s:6877   .text.bt_generic_le:00000000000002a0 $d
     /tmp/ccUeeWpa.s:6903   .text.bt_le_sync:0000000000000000 $t
     /tmp/ccUeeWpa.s:6908   .text.bt_le_sync:0000000000000000 bt_le_sync
     /tmp/ccUeeWpa.s:7256   .text.bt_le_sync:0000000000000228 $d
     /tmp/ccUeeWpa.s:7277   .text.bt_le_sync:0000000000000270 $t
     /tmp/ccUeeWpa.s:7675   .text.bt_le_sync:0000000000000508 $d
     /tmp/ccUeeWpa.s:10630  .bss:00000000000000d4 restart_jamming.4707
     /tmp/ccUeeWpa.s:7700   .text.cb_follow_le:0000000000000000 $t
     /tmp/ccUeeWpa.s:7705   .text.cb_follow_le:0000000000000000 cb_follow_le
     /tmp/ccUeeWpa.s:7995   .text.cb_follow_le:00000000000001b8 $d
     /tmp/ccUeeWpa.s:8008   .text.connection_follow_cb:0000000000000000 $t
     /tmp/ccUeeWpa.s:8013   .text.connection_follow_cb:0000000000000000 connection_follow_cb
     /tmp/ccUeeWpa.s:8391   .text.connection_follow_cb:0000000000000260 $d
     /tmp/ccUeeWpa.s:8401   .text.bt_follow_le:0000000000000000 $t
     /tmp/ccUeeWpa.s:8406   .text.bt_follow_le:0000000000000000 bt_follow_le
     /tmp/ccUeeWpa.s:8436   .text.bt_follow_le:000000000000001c $d
     /tmp/ccUeeWpa.s:8443   .text.le_promisc_state:0000000000000000 $t
     /tmp/ccUeeWpa.s:8448   .text.le_promisc_state:0000000000000000 le_promisc_state
     /tmp/ccUeeWpa.s:8541   .text.promisc_recover_hop_increment:0000000000000000 $t
     /tmp/ccUeeWpa.s:8546   .text.promisc_recover_hop_increment:0000000000000000 promisc_recover_hop_increment
     /tmp/ccUeeWpa.s:8755   .text.promisc_recover_hop_increment:0000000000000160 $d
     /tmp/ccUeeWpa.s:10633  .bss:00000000000000d8 first_ts.4805
     /tmp/ccUeeWpa.s:8774   .text.promisc_recover_hop_interval:0000000000000000 $t
     /tmp/ccUeeWpa.s:8779   .text.promisc_recover_hop_interval:0000000000000000 promisc_recover_hop_interval
     /tmp/ccUeeWpa.s:8914   .text.promisc_recover_hop_interval:00000000000000d8 $d
     /tmp/ccUeeWpa.s:10636  .bss:00000000000000dc prev_clk.4811
     /tmp/ccUeeWpa.s:8931   .text.promisc_follow_cb:0000000000000000 $t
     /tmp/ccUeeWpa.s:8936   .text.promisc_follow_cb:0000000000000000 promisc_follow_cb
     /tmp/ccUeeWpa.s:9051   .text.promisc_follow_cb:00000000000000ac $d
     /tmp/ccUeeWpa.s:9059   .text.see_aa:0000000000000000 $t
     /tmp/ccUeeWpa.s:9064   .text.see_aa:0000000000000000 see_aa
     /tmp/ccUeeWpa.s:9185   .text.see_aa:00000000000000a4 $d
     /tmp/ccUeeWpa.s:9197   .text.cb_le_promisc:0000000000000000 $t
     /tmp/ccUeeWpa.s:9202   .text.cb_le_promisc:0000000000000000 cb_le_promisc
     /tmp/ccUeeWpa.s:9654   .text.cb_le_promisc:00000000000002e0 $d
     /tmp/ccUeeWpa.s:9670   .text.bt_promisc_le:0000000000000000 $t
     /tmp/ccUeeWpa.s:9675   .text.bt_promisc_le:0000000000000000 bt_promisc_le
     /tmp/ccUeeWpa.s:9757   .text.bt_promisc_le:000000000000006c $d
     /tmp/ccUeeWpa.s:9785   .text.bt_slave_le:0000000000000000 $t
     /tmp/ccUeeWpa.s:9790   .text.bt_slave_le:0000000000000000 bt_slave_le
     /tmp/ccUeeWpa.s:9925   .text.bt_slave_le:00000000000000dc $d
     /tmp/ccUeeWpa.s:9936   .text.specan:0000000000000000 $t
     /tmp/ccUeeWpa.s:9941   .text.specan:0000000000000000 specan
     /tmp/ccUeeWpa.s:10157  .text.specan:0000000000000178 $d
     /tmp/ccUeeWpa.s:10175  .text.led_specan:0000000000000000 $t
     /tmp/ccUeeWpa.s:10180  .text.led_specan:0000000000000000 led_specan
     /tmp/ccUeeWpa.s:10416  .text.led_specan:0000000000000178 $d
     /tmp/ccUeeWpa.s:10429  .text.main:0000000000000000 $t
     /tmp/ccUeeWpa.s:10434  .text.main:0000000000000000 main
     /tmp/ccUeeWpa.s:10478  .text.main:000000000000003c $d
     /tmp/ccUeeWpa.s:10492  .text.main:0000000000000074 $t
     /tmp/ccUeeWpa.s:10618  .text.main:0000000000000118 $d
                     .debug_frame:0000000000000010 $d
ARM GAS  /tmp/ccUeeWpa.s 			page 238



UNDEFINED SYMBOLS
cc2400_set
usb_enqueue
cc2400_get
reset
bootloader_ctrl
strlen
memcpy
queue_init
dequeue
__aeabi_ui2d
__aeabi_ddiv
__aeabi_dadd
__aeabi_d2uiz
cc2400_strobe
cc2400_status
btle_channel_index
cc2400_spi_buf
next_hop
btle_next_hop
rbit
handle_usb
memset
dio_ssp_init
btle_crcgen_lut
memcmp
btle_reverse_crc
btle_calc_crc
ubertooth_init
ubertooth_usb_init
wait
cc2400_txtest
cc2400_rangetest
cc2400_repeater
ego_main
